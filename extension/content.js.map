{
  "version": 3,
  "sources": ["../src/lists/cryptoTrustedDomainsSeed.ts", "../src/shared/types.ts", "../src/shared/uiGate.ts", "../src/shared/signatures.ts", "../src/i18n.ts", "../src/shared/utils.ts", "../src/shared/classifyAction.ts", "../src/shared/actionTexts.ts", "../src/format.ts", "../src/shared/chains.ts", "../src/runtimeSafe.ts", "../src/risk/domScanner.ts", "../src/shared/reasonKeys.ts", "../src/content.ts"],
  "sourcesContent": ["/**\n * Seed de dom\u00EDnios confi\u00E1veis crypto-only (sem twitter/discord/social).\n * Usado em allowlist/trustedDomains e listSeeds.\n */\n\nexport const CRYPTO_TRUSTED_DOMAINS_SEED: string[] = [\n  // Explorers\n  \"etherscan.io\",\n  \"etherscan.com\",\n  \"arbiscan.io\",\n  \"polygonscan.com\",\n  \"bscscan.com\",\n  \"basescan.org\",\n  \"snowtrace.io\",\n  \"optimistic.etherscan.io\",\n  // NFTs\n  \"opensea.io\",\n  \"blur.io\",\n  \"looksrare.org\",\n  \"x2y2.io\",\n  \"rarible.com\",\n  \"magiceden.io\",\n  // DEX/DeFi\n  \"uniswap.org\",\n  \"app.uniswap.org\",\n  \"1inch.io\",\n  \"app.1inch.io\",\n  \"aave.com\",\n  \"app.aave.com\",\n  \"curve.fi\",\n  \"app.curve.fi\",\n  \"balancer.fi\",\n  \"app.balancer.fi\",\n  \"sushiswap.fi\",\n  \"matcha.xyz\",\n  \"paraswap.io\",\n  \"cowswap.exchange\",\n  // Bridges/L2\n  \"bridge.arbitrum.io\",\n  \"optimism.io\",\n  \"base.org\",\n  \"arbitrum.io\",\n  \"polygon.technology\",\n  \"hop.exchange\",\n  \"stargate.finance\",\n  \"across.to\",\n  \"portalbridge.com\",\n  \"zksync.io\",\n  // Infra / Wallets\n  \"chain.link\",\n  \"lido.fi\",\n  \"stake.lido.fi\",\n  \"ens.domains\",\n  \"app.ens.domains\",\n  \"metamask.io\",\n  \"metamask.com\",\n  \"rabby.io\",\n  \"walletconnect.com\",\n  \"walletconnect.org\",\n  \"safe.global\",\n  \"revoke.cash\",\n  \"app.revoke.cash\",\n];\n", "export type WalletKind = \"EVM_INJECTED\" | \"SOLANA_INJECTED\" | \"UNKNOWN\";\nexport type WalletName =\n  | \"MetaMask\"\n  | \"Coinbase Wallet\"\n  | \"Trust\"\n  | \"Rabby\"\n  | \"OKX Wallet\"\n  | \"Binance Web3\"\n  | \"Rainbow\"\n  | \"Phantom\"\n  | \"Phantom EVM\"\n  | \"SafePal\"\n  | \"Bitget Wallet\"\n  | \"Brave Wallet\"\n  | \"Taho\"\n  | \"Ledger\"\n  | \"Frame\"\n  | \"MathWallet\"\n  | \"Solflare\"\n  | \"Backpack\"\n  | \"Injected\"\n  | \"EVM Wallet\"\n  | \"Unknown\";\n\nexport type WalletMeta = { id: string; name: string; iconHint?: string };\n\nexport type WalletBrand =\n  | \"MetaMask\"\n  | \"Coinbase Wallet\"\n  | \"Rabby\"\n  | \"Trust Wallet\"\n  | \"Brave Wallet\"\n  | \"OKX Wallet\"\n  | \"Binance Web3\"\n  | \"Bitget Wallet\"\n  | \"Phantom EVM\"\n  | \"EVM Wallet\";\n\nexport type WalletInfo = {\n  kind: WalletKind;\n  name: WalletName;\n  flags?: Record<string, boolean>;\n  walletBrand?: WalletBrand;\n  /** Display name for overlay (e.g. \"MetaMask\", \"EVM Wallet\") */\n  walletName?: string;\n};\n\nexport type EthRequest = {\n  method: string;\n  params?: any[];\n  // optional extra debugging/shape info from legacy provider entrypoints\n  rawShape?: string;\n  raw?: any;\n};\n\nexport type PendingRequestPayload = {\n  id: string;\n  url: string;\n  origin: string;\n  wallet?: WalletInfo | WalletMeta;\n  request: { method: string; params?: any[] };\n  providerTag?: string;\n  providerKey?: string;\n  providerSource?: \"window.ethereum\" | \"ethereum.providers[i]\" | \"eip6963\";\n};\n\n/** P0 UI Gate: meta sent with SG_DECISION to ensure wallet is only forwarded after user confirmed in overlay. */\nexport type DecisionMeta = {\n  uiConfirmed?: boolean;\n  uiGate?: boolean;\n  reasonKeys?: string[];\n  method?: string;\n};\n\nexport type FeeEstimateWire = {\n  ok: boolean;\n  gasLimitHex?: string;\n  feeLikelyWeiHex?: string;\n  feeMaxWeiHex?: string;\n  feeEstimated?: boolean;\n  feeReasonKey?: string;\n  error?: string;\n};\n\nexport type TxContextKind = \"SWITCH_NETWORK\" | \"NFT_PURCHASE\" | \"TOKEN_SWAP\" | \"VALUE_TRANSFER\" | \"CONTRACT_CALL\" | \"APPROVAL\";\n\nexport type AnalyzeRequest = {\n  requestId: string;\n  url: string;\n  origin: string;\n  request: EthRequest;\n  tabId?: number;\n  wallet?: WalletInfo;\n  providerHint?: { kind: ProviderKind; name?: string };\n  txCostPreview?: TxCostPreview;\n  feeEstimate?: FeeEstimateWire;\n  meta?: {\n    chainId?: string;\n    chainIdHex?: string;\n    chainIdRequested?: string;\n    txContext?: { kind: TxContextKind };\n    pageRisk?: { score: \"LOW\" | \"MEDIUM\" | \"HIGH\"; reasons: string[] };\n    preflight?: {\n      tx?: any;\n      valueWei?: string; // decimal\n      valueEth?: string; // decimal\n      gasEstimate?: string; // hex\n      gasPrice?: string; // hex\n      feeWeiEstimated?: string; // decimal\n      feeEthEstimated?: string; // decimal\n      totalEthEstimated?: string; // decimal\n    }\n  };\n};\n\nexport type SecurityMode = \"STRICT\" | \"BALANCED\" | \"RELAXED\" | \"OFF\";\nexport type ProviderKind = \"EIP6963\" | \"METAMASK\" | \"RABBY\" | \"COINBASE\" | \"PHANTOM\" | \"UNKNOWN\";\n\nexport type ChainIdHex = string; // ex \"0x1\"\nexport type Address = string; // \"0x...\" lowercase\n\n/** Domain list decision for risk/UX (whitelist never auto-allows tx). */\nexport type DomainDecision = \"TRUSTED\" | \"BLOCKED\" | \"UNKNOWN\";\n\n/** Cache key for scam token: chainId:tokenAddressLower */\nexport type ScamTokenKey = `${string}:${string}`;\n\nexport type ListSourceName = \"metamask\" | \"scamsniffer\" | \"cryptoscamdb\" | \"dappradar\" | \"mew\" | \"seed\" | \"user\";\n\nexport type ListsCacheV1 = {\n  version: 1;\n  updatedAt: number;\n  sources: Record<ListSourceName, { updatedAt?: number; etag?: string; ok?: boolean; error?: string }>;\n  trustedDomains: string[];\n  blockedDomains: string[];\n  blockedAddresses: string[];\n  scamTokens: Array<{ chainId: string; address: string; symbol?: string; name?: string; source?: ListSourceName }>;\n  userTrustedDomains: string[];\n  userBlockedDomains: string[];\n  userBlockedAddresses: string[];\n  userScamTokens: Array<{ chainId: string; address: string; symbol?: string; name?: string }>;\n  userTrustedTokens: Array<{ chainId: string; address: string }>;\n};\n\nexport type ThreatIntelAddress = {\n  address: Address;\n  chainId?: ChainIdHex;\n  label: string;\n  category: \"DRAINER\" | \"SCAM_TOKEN\" | \"SCAM_ROUTER\" | \"MALICIOUS_SPENDER\" | \"UNKNOWN\";\n  sourceId: string;\n  confidence: 1 | 2 | 3;\n  updatedAt: number;\n};\n\nexport type ThreatIntelBundle = {\n  updatedAt: number;\n  sources: Array<{ id: string; url?: string; ok: boolean; fetchedAt: number; error?: string }>;\n  trustedDomainsSeed: string[];\n  blockedDomains: string[];\n  blockedAddresses: ThreatIntelAddress[];\n};\n\nexport type AssetInfo = {\n  chainId: ChainIdHex;\n  address: Address;\n  kind: \"ERC20\" | \"ERC721\" | \"ERC1155\" | \"UNKNOWN\";\n  name?: string;\n  symbol?: string;\n  decimals?: number;\n  fetchedAt: number;\n};\n\nexport type DecodedAction = (\n  | { kind: \"APPROVE_ERC20\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"INCREASE_ALLOWANCE\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"DECREASE_ALLOWANCE\"; token: Address; spender: Address; amountRaw?: string }\n  | { kind: \"TRANSFER_ERC20\"; token: Address; to: Address; amountRaw?: string }\n  | { kind: \"TRANSFERFROM_ERC20\"; token: Address; from: Address; to: Address; amountRaw?: string }\n  | { kind: \"SET_APPROVAL_FOR_ALL\"; token: Address; operator: Address; approved: boolean }\n  | { kind: \"TRANSFER_NFT\"; token: Address; to: Address; from?: Address; tokenIdRaw?: string; amountRaw?: string; standard: \"ERC721\" | \"ERC1155\" | \"UNKNOWN\"; batch?: boolean }\n  | { kind: \"PERMIT_EIP2612\"; token: Address; spender: Address; valueType: \"LIMITED\" | \"UNLIMITED\"; valueRaw?: string; deadlineRaw?: string }\n  | { kind: \"PERMIT2_ALLOWANCE\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string; deadlineRaw?: string }\n  | { kind: \"PERMIT2_TRANSFER\"; token: Address; to: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"UNKNOWN\"; selector?: string }\n  | { kind: \"MULTICALL\"; selector: string; raw?: string }\n  )\n  & { permit2?: boolean; marketplaceHint?: string };\n\nexport type RiskLevel = \"LOW\" | \"WARN\" | \"HIGH\";\n\nexport type Recommend = \"ALLOW\" | \"WARN\" | \"HIGH\" | \"BLOCK\";\n\nexport type CheckKey =\n  | \"DOMAIN_INTEL\"\n  | \"LOOKALIKE\"\n  | \"TX_DECODE\"\n  | \"FEE_ESTIMATE\"\n  | \"ADDRESS_INTEL\"\n  | \"ASSET_ENRICH\"\n  | \"CLOUD_INTEL\";\n\nexport type CheckStatus = \"PASS\" | \"WARN\" | \"FAIL\" | \"SKIP\";\n\nexport interface CheckResult {\n  key: CheckKey;\n  status: CheckStatus;\n  noteKey?: string;\n}\n\nexport type DecodedKind =\n  | \"APPROVE\"\n  | \"SET_APPROVAL_FOR_ALL\"\n  | \"TYPED_DATA\"\n  | \"TX\"\n  | \"CONNECT\"\n  | \"SIGN\";\n\nexport type Decoded = {\n  kind: DecodedKind;\n  tokenOrCollection?: string;\n  spenderOrOperator?: string;\n  amountHuman?: string;\n  raw?: any;\n};\n\nexport type TrustVerdict = \"LIKELY_OFFICIAL\" | \"UNKNOWN\" | \"SUSPICIOUS\";\n\nexport type TrustAnalysis = {\n  verdict: TrustVerdict;\n  trustScore: number; // 0-100\n  reasons: string[];\n  matchedAllowlistDomain?: string;\n};\n\nexport type HumanExplanation = {\n  methodTitle: string;\n  methodShort: string;\n  methodWhy: string;\n  whatItDoes?: string[];\n  siteSees?: string[];\n  notHappen?: string[];\n  whyAsked?: string[];\n  risks: string[];\n  safeNotes: string[];\n  safe?: string[];\n  nextSteps: string[];\n  recommendation: string;\n  links?: Array<{ text: string; href: string }>;\n};\n\nexport type ThreatIntel = {\n  updatedAt: number;\n  sources: Array<{ id: string; url: string; ok: boolean; fetchedAt: number; error?: string }>;\n  trustedDomains: string[];\n  blockedDomains: string[];\n};\n\nexport type TxCostPreview = {\n  valueWei: string;                 // decimal string\n  feeEstimated: boolean;\n  gasLimitWei?: string;             // decimal string (gasLimit as bigint)\n  feeLikelyWei?: string;            // decimal string\n  feeMaxWei?: string;               // decimal string\n  totalLikelyWei?: string;          // decimal string\n  totalMaxWei?: string;             // decimal string\n  feeReasonKey?: string;            // i18n key when feeEstimated=false\n  /** USD per 1 unit of native token (for overlay). */\n  usdPerNative?: number;\n};\n\nexport type TxSummary = {\n  to?: string;\n  valueWei?: string;        // decimal\n  valueEth?: string;        // formatted\n  selector?: string;        // 0x + 8 hex\n  gasLimit?: string;        // decimal\n  maxFeePerGasWei?: string; // decimal\n  maxPriorityFeePerGasWei?: string; // decimal (EIP-1559 tip)\n  maxGasFeeEth?: string;    // ETH\n  maxTotalEth?: string;     // ETH (value + maxGasFee)\n  feeKnown?: boolean;\n  contractNameHint?: string;\n  dataLen?: number;         // raw data length\n};\n\nexport type Intent = \"NFT_PURCHASE\" | \"SWAP\" | \"APPROVAL\" | \"SEND\" | \"ETH_TRANSFER\" | \"TOKEN_TRANSFER\" | \"NFT_TRANSFER\" | \"CONTRACT_INTERACTION\" | \"CONNECT\" | \"SIGN\" | \"SIGNATURE\" | \"TYPED_DATA\" | \"CHAIN\" | \"SWITCH_CHAIN\" | \"ADD_CHAIN\" | \"WATCH_ASSET\" | \"SOLANA\" | \"UNKNOWN\";\n\nexport type TxExtras =\n  | {\n      approvalType: \"ERC20_APPROVE\";\n      tokenContract?: string;\n      spender?: string;\n      unlimited?: boolean;\n    }\n  | {\n      approvalType: \"NFT_SET_APPROVAL_FOR_ALL\";\n      tokenContract?: string;\n      operator?: string;\n      unlimited?: boolean;\n    }\n  | {\n      approvalType?: \"NFT_TRANSFER\";\n      tokenContract?: string;\n      toAddress?: string;\n    };\n\n/** P1: Transaction summary v1 for overlay (give/get, approvals, nfts, flags). */\nexport type TxSummaryV1 = {\n  title: string;\n  subtitle?: string;\n  give?: Array<{ amount?: string; symbol?: string; kind: \"NATIVE\" | \"ERC20\" | \"NFT\" | \"UNKNOWN\"; tokenAddress?: string; tokenId?: string; to?: string }>;\n  get?: Array<{ amount?: string; symbol?: string; kind: \"NATIVE\" | \"ERC20\" | \"NFT\" | \"UNKNOWN\"; tokenAddress?: string; tokenId?: string; to?: string }>;\n  approvals?: Array<{ kind: \"ERC20\" | \"ERC721_ALL\" | \"ERC1155_ALL\" | \"PERMIT\" | \"PERMIT2\"; tokenAddress?: string; tokenSymbol?: string; spender?: string; amount?: string; unlimited?: boolean; deadline?: string }>;\n  nfts?: Array<{ collection?: string; tokenAddress?: string; tokenId?: string; amount?: string; to?: string; marketplace?: string }>;\n  flags?: string[]; // reasonKeys\n};\n\nexport type Analysis = {\n  level: RiskLevel;\n  score: number; // 0-100\n  title: string;\n  reasons: string[];\n  decoded?: Decoded;\n  decodedAction?: DecodedAction;\n  recommend: Recommend;\n  trust?: TrustAnalysis;\n  human?: HumanExplanation;\n  suggestedTrustedDomains?: string[];\n  tx?: TxSummary;\n  txCostPreview?: TxCostPreview;\n  txExtras?: TxExtras;\n  intent?: Intent;\n  txContext?: { kind: TxContextKind };\n  chainTarget?: { chainIdHex: string; chainName?: string };\n  addChainInfo?: { chainId: string; chainName?: string; rpcUrls?: string[]; nativeCurrencySymbol?: string };\n  watchAssetInfo?: { type: string; address?: string; symbol?: string; decimals?: number; image?: string };\n  wallet?: WalletInfo;\n  safeDomain?: boolean;\n  isPhishing?: boolean;\n  domainRisk?: { scoreDelta: number; reasons: string[] };\n  addressRisk?: { flagged: boolean; reasons: string[]; matches?: string[] };\n  method?: string;\n  asset?: AssetInfo;\n  flaggedAddress?: ThreatIntelAddress;\n  provider?: { kind: ProviderKind; name?: string };\n  feeGtValue?: boolean;\n  /** Checks performed (security coverage). */\n  checks?: CheckResult[];\n  /** Coverage summary: performed/total, limited when some checks unavailable. */\n  coverage?: { performed: number; total: number; limited: boolean };\n  /** i18n key for main verdict label (e.g. verdict_ok, verdict_warn, verdict_high, verdict_block). */\n  verdictLabelKey?: string;\n  /** When tx.to is a contract (eth_getCode !== \"0x\"). */\n  toIsContract?: boolean;\n  /** Verification level: FULL = intel fresh, LOCAL = cached, BASIC = no intel. */\n  verificationLevel?: \"FULL\" | \"LOCAL\" | \"BASIC\";\n  /** Timestamp of cached intel used (if any). */\n  verificationUpdatedAt?: number;\n  /** true when domain trusted/allowlisted + no flags + no suspicious addr. */\n  knownSafe?: boolean;\n  /** true when phishing/lookalike HIGH + blacklist. */\n  knownBad?: boolean;\n  /** Spender matched denylistSpenders \u2192 BLOCK. */\n  matchedDenySpender?: boolean;\n  /** Spender matched allowlistSpenders \u2192 reduce score. */\n  matchedAllowSpender?: boolean;\n  /** Domain-related signals, e.g. METAMASK_SEED, BLACKLIST_HIT, LOOKALIKE, PUNYCODE, SEED_MATCH, SUSPICIOUS_TLD. */\n  domainSignals?: string[];\n  /** Intel source ids used, e.g. metamask, cryptoscamdb, scamsniffer, local_seed. */\n  intelSources?: string[];\n  /** List manager domain decision: TRUSTED / BLOCKED / UNKNOWN (for site reputation badge). */\n  domainListDecision?: DomainDecision;\n  /** Extras from typed-data (e.g. Permit: spender, value, deadline). */\n  typedDataExtras?: { spender?: string; value?: string; deadline?: string };\n  /** Structured decode for Permit2 / Seaport / Blur typed data (human overlay). */\n  typedDataDecoded?: {\n    permit2?: { spender: string; tokens: string[]; amounts: string[]; unlimited?: boolean; sigDeadline?: string };\n    seaport?: { offerSummary: string; considerationSummary: string; primaryType?: string };\n    isBlur?: boolean;\n  };\n  /** true when any address (to/spender/operator/tokenContract) matched address intel labels. */\n  addressIntelHit?: boolean;\n  /** Labels per role when address intel hit (human-readable label strings). */\n  addressIntel?: {\n    to?: string[];\n    spender?: string[];\n    operator?: string[];\n    tokenContract?: string[];\n  };\n  /** Result of Tenderly simulation (if run). SKIPPED when API failed (fallback). */\n  simulationOutcome?: {\n    status: \"SUCCESS\" | \"REVERT\" | \"RISK\" | \"SKIPPED\";\n    outgoingAssets: Array<{ symbol: string; amount: string; logo?: string }>;\n    incomingAssets: Array<{ symbol: string; amount: string; logo?: string }>;\n    approvals?: Array<{ token: string; spender: string; approved: boolean; unlimited?: boolean; approvalForAll?: boolean }>;\n    gasUsed: string;\n    fallback?: boolean;\n    gasCostWei?: string;\n    isHighGas?: boolean;\n    simulated?: boolean;\n    message?: string;\n  };\n  /** True when simulation predicted revert (show \"ESTA TRANSA\u00C7\u00C3O VAI FALHAR\"). */\n  simulationRevert?: boolean;\n  /** Token confidence: SCAM, TRUSTED, LOW (new/unverified), UNKNOWN. */\n  tokenConfidence?: \"SCAM\" | \"TRUSTED\" | \"LOW\" | \"UNKNOWN\";\n  /** First-seen timestamp for token (when LOW/UNKNOWN). */\n  tokenFirstSeenAt?: number;\n  /** True when honeypot detected (buy but cannot sell / transfer). */\n  isHoneypot?: boolean;\n  /** True when protection is temporarily paused (allow without showing overlay). */\n  protectionPaused?: boolean;\n  /** True when vault blocks this request (Cofre). */\n  vaultBlocked?: boolean;\n  /** Locked contract address when vaultBlocked. */\n  vaultLockedTo?: string;\n  /** ChainId for vault override (VAULT_UNLOCK). */\n  vaultChainIdHex?: string;\n  /** Standardized reason keys for consistency (maps to i18n). */\n  reasonKeys?: string[];\n  /** P1: Structured summary for overlay (title, give/get, approvals, nfts, flags). */\n  summary?: TxSummaryV1;\n  /** P1: Alias for summary (spec name summaryV1). */\n  summaryV1?: TxSummaryV1;\n}\n\nexport type SupportedWalletEntry = { name: string; kind: string };\n\n/** User-configurable settings (spec name: UserSettings). */\nexport type Settings = {\n  riskWarnings: boolean;\n  showConnectOverlay: boolean;\n  blockHighRisk: boolean;\n  requireTypedOverride?: boolean;\n  allowOverrideOnPhishing?: boolean;\n  debugMode?: boolean;\n  domainChecks: boolean;\n  allowlist: string[];\n  trustedDomains?: string[];\n  customBlockedDomains?: string[];\n  customTrustedDomains?: string[];\n  /** P0-C: User allow/deny by spender address (for approvals). */\n  allowlistSpenders?: string[];\n  denylistSpenders?: string[];\n  /** fail_open: allow when runtime unavailable; fail_closed: block on high risk. */\n  failMode?: \"fail_open\" | \"fail_closed\";\n  enableIntel?: boolean;\n  mode?: SecurityMode;\n  supportedWalletsInfo?: SupportedWalletEntry[];\n  strictBlockApprovalsUnlimited?: boolean;\n  strictBlockSetApprovalForAll?: boolean;\n  strictBlockPermitLike?: boolean;\n  assetEnrichmentEnabled?: boolean;\n  addressIntelEnabled?: boolean;\n  /** P0-E: Allow external checks (more protection; may send domain/address for validation). Default false. */\n  cloudIntelOptIn?: boolean;\n  /** Telemetry/analytics opt-in. Default false. Requires termsAccepted. Independent of cloudIntelOptIn. */\n  telemetryOptIn?: boolean;\n  /** @deprecated Use telemetryOptIn. Kept for migration. */\n  telemetryEnabled?: boolean;\n  showUsd?: boolean;\n  planTier?: \"FREE\" | \"PRO\";\n  licenseKey?: string;\n  /** Cofre SignGuard: contracts that must not be transacted without explicit unlock. */\n  vault?: {\n    enabled: boolean;\n    lockedContracts: string[];\n    /** Timestamp until which vault is temporarily unlocked (Date.now() + ms). */\n    unlockedUntil?: number;\n    /** Also block approvals/permits when spender is in lockedContracts. */\n    blockApprovals?: boolean;\n  };\n  /** Tenderly simulation (no hardcoded keys). */\n  simulation?: {\n    enabled: boolean;\n    tenderlyAccount: string;\n    tenderlyProject: string;\n    tenderlyKey: string;\n  };\n  /** Pause protection until this timestamp (Date.now() + ms). */\n  pausedUntil?: number;\n  /** Domains that bypass overlay when protection is active (e.g. trusted tools). */\n  whitelistedDomains?: string[];\n  /** Modo Fortaleza: bloqueia todas as aprova\u00E7\u00F5es de tokens exceto em sites confi\u00E1veis. */\n  fortressMode?: boolean;\n  /** Expandir se\u00E7\u00F5es detalhadas (accordions) do overlay por padr\u00E3o. */\n  defaultExpandDetails?: boolean;\n};\n\n/** Alias for Settings (spec: UserSettings). */\nexport type UserSettings = Settings;\n\n/** Stored in chrome.storage.local key \"sg_plan\". */\nexport type PlanState = {\n  tier: \"FREE\" | \"PRO\";\n  keyMasked?: string;\n  activatedAt?: number;\n  expiresAt?: number;\n};\n\nexport const SUPPORTED_WALLETS: SupportedWalletEntry[] = [\n  { name: \"MetaMask\", kind: \"EVM\" },\n  { name: \"Coinbase Wallet\", kind: \"EVM\" },\n  { name: \"Trust Wallet\", kind: \"EVM\" },\n  { name: \"OKX Wallet\", kind: \"EVM\" },\n  { name: \"Binance Web3\", kind: \"EVM\" },\n  { name: \"Rabby\", kind: \"EVM\" },\n  { name: \"Rainbow\", kind: \"EVM\" },\n  { name: \"Phantom\", kind: \"EVM/Solana\" },\n  { name: \"Brave Wallet\", kind: \"EVM\" },\n  { name: \"Bitget Wallet\", kind: \"EVM\" },\n  { name: \"MathWallet\", kind: \"EVM\" },\n  { name: \"Solflare\", kind: \"Solana\" },\n  { name: \"Backpack\", kind: \"Solana\" },\n];\n\nimport { CRYPTO_TRUSTED_DOMAINS_SEED } from \"../lists/cryptoTrustedDomainsSeed\";\n\nexport const DEFAULT_SETTINGS: Settings = {\n  riskWarnings: true,\n  showConnectOverlay: true,\n  blockHighRisk: true,\n  requireTypedOverride: true,\n  allowOverrideOnPhishing: false,\n  debugMode: false,\n  domainChecks: true,\n  mode: \"BALANCED\",\n  strictBlockApprovalsUnlimited: true,\n  strictBlockSetApprovalForAll: true,\n  strictBlockPermitLike: true,\n  assetEnrichmentEnabled: true,\n  addressIntelEnabled: true,\n  cloudIntelOptIn: false,\n  telemetryOptIn: false,\n  telemetryEnabled: false,\n  showUsd: false,\n  defaultExpandDetails: true,\n  planTier: \"FREE\",\n  licenseKey: \"\",\n  trustedDomains: CRYPTO_TRUSTED_DOMAINS_SEED.slice(0, 24),\n  supportedWalletsInfo: SUPPORTED_WALLETS,\n  allowlist: CRYPTO_TRUSTED_DOMAINS_SEED.slice(0, 24),\n  customBlockedDomains: [],\n  customTrustedDomains: [],\n  allowlistSpenders: [],\n  denylistSpenders: [],\n  failMode: \"fail_open\",\n  enableIntel: true,\n  vault: {\n    enabled: false,\n    lockedContracts: [],\n    unlockedUntil: 0,\n    blockApprovals: false,\n  },\n  simulation: {\n    enabled: false,\n    tenderlyAccount: \"\",\n    tenderlyProject: \"\",\n    tenderlyKey: \"\",\n  },\n  whitelistedDomains: [],\n  fortressMode: false,\n};\n\n", "/**\n * P0 UI Gate: methods that must NEVER bypass the SignGuard overlay (TEMP ALLOW, etc.)\n * User must always see and confirm in SignGuard before the wallet popup opens.\n */\n\nconst UI_GATED_METHODS_LIST = [\n  \"eth_requestAccounts\",\n  \"wallet_requestPermissions\",\n  \"wallet_addEthereumChain\",\n  \"wallet_switchEthereumChain\",\n  \"wallet_watchAsset\",\n  \"wallet_sendTransaction\",\n  \"eth_sendTransaction\",\n  \"eth_signTransaction\",\n  \"eth_sendRawTransaction\",\n  \"wallet_invokeSnap\",\n  \"wallet_requestSnaps\",\n  \"personal_sign\",\n  \"eth_sign\",\n  \"eth_signTypedData\",\n  \"eth_signTypedData_v3\",\n  \"eth_signTypedData_v4\",\n];\n\nconst UI_GATED_METHODS = new Set(UI_GATED_METHODS_LIST.map((m) => m.toLowerCase()));\n\nexport { UI_GATED_METHODS };\n\nexport function shouldGateUI(method: string): boolean {\n  return UI_GATED_METHODS.has(String(method || \"\").toLowerCase());\n}\n", "/** Known selectors for human-readable labels (no network). */\r\nexport const KNOWN_SELECTORS: Record<string, string> = {\r\n  \"0x095ea7b3\": \"approve(address,uint256)\",\r\n  \"0xa9059cbb\": \"transfer(address,uint256)\",\r\n  \"0x23b872dd\": \"transferFrom(address,address,uint256)\",\r\n  \"0xa22cb465\": \"setApprovalForAll(address,bool)\",\r\n  \"0x42842e0e\": \"safeTransferFrom(address,address,uint256)\",\r\n  \"0xf242432a\": \"safeTransferFrom(address,address,uint256,bytes)\",\r\n  \"0xd0e30db0\": \"deposit()\",\r\n  \"0x2e1a7d4d\": \"withdraw(uint256)\",\r\n  \"0x38ed1739\": \"swapExactTokensForTokens(...)\",\r\n  \"0x7ff36ab5\": \"swapExactETHForTokens(...)\",\r\n  \"0x18cbafe5\": \"swapExactTokensForETH(...)\",\r\n  \"0x04e45aaf\": \"exactInputSingle(...)\",\r\n  \"0xb858183f\": \"exactInput(...)\",\r\n  \"0x414bf389\": \"exactOutputSingle(...)\",\r\n  \"0x09b81346\": \"exactOutput(...)\",\r\n};\r\n\r\nexport function selectorToLabel(sel?: string | null): string | null {\r\n  if (!sel || typeof sel !== \"string\") return null;\r\n  const s = sel.toLowerCase();\r\n  return KNOWN_SELECTORS[s] ?? null;\r\n}\r\n", "export type Locale = \"pt\" | \"en\";\n\nexport function detectLocale(): Locale {\n  const raw = (navigator.languages?.[0] || navigator.language || \"en\").toLowerCase();\n  if (raw.startsWith(\"pt\")) return \"pt\";\n  return \"en\";\n}\n\nconst dict: Record<Locale, Record<string, string>> = {\n  pt: {\n    tech_displayAction: \"A\u00E7\u00E3o (classifica\u00E7\u00E3o)\",\n    tech_methodRaw: \"M\u00E9todo (raw)\",\n    tech_recommendScoreLevel: \"Recomenda\u00E7\u00E3o/score/n\u00EDvel\",\n    tech_reasons: \"Motivos\",\n    tech_decoded: \"Decodificado\",\n    dash: \"\u2014\",\n    tx_to: \"To\",\n    tx_data_length: \"Tamanho do data\",\n    more_whatItDoes: \"O que isso faz\",\n    more_risks: \"Riscos\",\n    more_safeNotes: \"Notas de seguran\u00E7a\",\n    more_nextSteps: \"Pr\u00F3ximos passos\",\n    // Brand\n    extName: \"Crypto Wallet SignGuard\",\n\n    // Overlay - generic labels\n    overlay_analyzing: \"Analisando Transa\u00E7\u00E3o...\",\n    overlay_simulating: \"O SignGuard est\u00E1 a simular o resultado.\",\n    overlay_safe: \"Parece Seguro\",\n    overlay_attention: \"Aten\u00E7\u00E3o Detectada\",\n    overlay_action: \"A\u00E7\u00E3o\",\n    overlay_simulation_balance: \"Simula\u00E7\u00E3o de Balan\u00E7o\",\n    overlay_approvals_detected: \"Aprova\u00E7\u00F5es detectadas\",\n    overlay_confirm_allow_msg: \"Tem certeza? Isso ignora prote\u00E7\u00E3o.\",\n    overlay_confirm_allow: \"Confirmar permitir 1 vez\",\n    overlay_try_again: \"Tentar novamente\",\n    overlay_analysis_taking_long: \"A an\u00E1lise est\u00E1 demorando.\",\n    overlay_fee_calculated: \"Taxas calculadas.\",\n    overlay_finishing: \"Finalizando an\u00E1lise...\",\n    overlay_typed_data_card_title: \"Assinatura (EIP-712)\",\n    overlay_typed_data_sign_warning: \"Assinar isso pode permitir gasto futuro sem nova confirma\u00E7\u00E3o.\",\n    overlay_allowance_loading: \"Allowance atual: \u2026\",\n    overlay_allowance_current: \"Allowance atual: \",\n    overlay_allowance_approved: \"Aprovado\",\n    overlay_allowance_not_approved: \"N\u00E3o aprovado\",\n    overlay_allowance_unlimited: \"Ilimitado\",\n    simulation_no_changes: \"Nenhuma mudan\u00E7a de saldo detetada.\",\n    tx_unknown: \"Transa\u00E7\u00E3o Desconhecida\",\n    dapp_unknown: \"DApp Desconhecido\",\n    overlay_requested_title: \"O que est\u00E1 sendo solicitado\",\n    overlay_site_trusted_title: \"Site confi\u00E1vel?\",\n    overlay_summary_title: \"Resumo (linguagem simples)\",\n    overlay_recommended_title: \"A\u00E7\u00E3o recomendada\",\n    overlay_note_title: \"Observa\u00E7\u00E3o\",\n\n    // Overlay - details sections\n    details_tx_title: \"Detalhes da transa\u00E7\u00E3o\",\n    details_tech_title: \"Detalhes t\u00E9cnicos\",\n    details_more_title: \"Mais explica\u00E7\u00F5es\",\n\n    // Queue\n    queue_indicator: \"Fila: {pos} de {total}\",\n\n    // Action titles\n    action_CONNECT_title: \"Conectar carteira\",\n    action_REQUEST_PERMISSIONS_title: \"Solicitar permiss\u00F5es\",\n    action_SWITCH_CHAIN_title: \"Trocar rede\",\n    action_ADD_CHAIN_title: \"Adicionar rede\",\n    action_SIGN_MESSAGE_title: \"Assinar mensagem\",\n    action_SIGN_TYPED_DATA_title: \"Assinar dados (Typed Data)\",\n    action_SEND_TX_title: \"Enviar transa\u00E7\u00E3o\",\n    action_SEND_TX_contract_title: \"Interagir com contrato\",\n    action_SEND_TX_eth_title: \"Enviar ETH\",\n    action_WATCH_ASSET_title: \"Adicionar token/ativo\",\n    action_SOLANA_title: \"Assinatura/Transa\u00E7\u00E3o Solana\",\n    action_UNKNOWN_title: \"Solicita\u00E7\u00E3o\",\n\n    // Summary bullets (plain language)\n    summary_CONNECT_1: \"O site quer ver seus endere\u00E7os e a rede atual.\",\n    summary_CONNECT_2: \"Ele poder\u00E1 pedir assinaturas/transa\u00E7\u00F5es depois.\",\n    summary_CONNECT_3: \"Conecte apenas se confiar no site.\",\n    summary_REQUEST_PERMISSIONS_1: \"O site quer permiss\u00F5es adicionais na sua carteira.\",\n    summary_REQUEST_PERMISSIONS_2: \"Revise as permiss\u00F5es na carteira antes de aceitar.\",\n    summary_SWITCH_CHAIN_1: \"O site quer trocar a rede (chain) da sua carteira.\",\n    summary_SWITCH_CHAIN_2: \"Troca de rede normalmente n\u00E3o custa gas.\",\n    explain_connect_title: \"Conectar carteira\",\n    explain_connect_short: \"Login com carteira (compartilha seu endere\u00E7o p\u00FAblico)\",\n    explain_connect_why: \"Isso permite ao site mostrar sua conta e pedir assinaturas/aprova\u00E7\u00F5es/transa\u00E7\u00F5es depois.\",\n    explain_sign_title: \"Assinar mensagem\",\n    explain_sign_short: \"Sem gas, mas assinaturas podem autorizar a\u00E7\u00F5es\",\n    explain_sign_why: \"Sites usam assinaturas para login, verifica\u00E7\u00E3o de posse ou autoriza\u00E7\u00F5es off-chain.\",\n    explain_typed_title: \"Assinar dados estruturados\",\n    explain_typed_short: \"Typed-data pode incluir permits/autoriza\u00E7\u00F5es\",\n    explain_typed_why: \"Typed-data \u00E9 frequentemente usado para permits (aprova\u00E7\u00F5es sem approve on-chain separado).\",\n    explain_tx_title: \"Enviar transa\u00E7\u00E3o\",\n    explain_tx_short: \"A\u00E7\u00E3o on-chain (pode ter taxa de gas)\",\n    explain_tx_why: \"Isso criar\u00E1 uma transa\u00E7\u00E3o on-chain se voc\u00EA aprovar na sua carteira.\",\n    explain_switch_title: \"Trocar rede\",\n    explain_switch_why: \"Alguns sites exigem uma rede espec\u00EDfica para funcionar.\",\n    explain_addchain_title: \"Adicionar rede\",\n    explain_addchain_short: \"Adiciona uma configura\u00E7\u00E3o de chain na carteira\",\n    explain_add_chain_short: \"Adicionar rede na carteira\",\n    add_chain_review_rpc: \"RPC malicioso pode enganar saldos/transa\u00E7\u00F5es; confirme a proced\u00EAncia.\",\n    add_chain_verify_chainid: \"Confirme o chainId e o nome da rede antes de adicionar.\",\n    explain_addchain_why: \"A carteira pode adicionar detalhes de RPC para a rede solicitada.\",\n    explain_watchasset_title: \"Adicionar ativo\",\n    explain_watchasset_short: \"Adiciona um token/ativo na UI da carteira\",\n    explain_watch_asset_short: \"Adicionar token/ativo na carteira\",\n    watch_asset_no_spend_but_risk: \"Adicionar token n\u00E3o gasta fundos, mas tokens podem ser golpe; confirme contrato.\",\n    watch_asset_verify_contract: \"Verifique o endere\u00E7o do contrato em um explorer confi\u00E1vel.\",\n    explain_watchasset_why: \"N\u00E3o gasta fundos, mas confirme se os detalhes do token est\u00E3o corretos.\",\n    explain_generic_title: \"Solicita\u00E7\u00E3o da carteira\",\n    explain_generic_short: \"Um site est\u00E1 pedindo uma a\u00E7\u00E3o da carteira\",\n    explain_generic_why: \"Revise os detalhes na carteira e confirme a URL do site.\",\n    human_connect_whatIs: \"Conecta seu endere\u00E7o de carteira a este site (como um login).\",\n    human_connect_sees_1: \"Seu endere\u00E7o p\u00FAblico (e sele\u00E7\u00E3o de conta)\",\n    human_connect_sees_2: \"Sua rede/chain selecionada\",\n    human_connect_sees_3: \"Atividade on-chain p\u00FAblica (tokens/NFTs s\u00E3o dados p\u00FAblicos)\",\n    human_connect_not_1: \"N\u00C3O revela sua seed phrase nem a senha da carteira\",\n    human_connect_not_2: \"N\u00C3O move fundos automaticamente por si s\u00F3\",\n    human_connect_why_1: \"Para mostrar sua conta e saldos na interface\",\n    human_connect_why_2: \"Para permitir assinar mensagens (login/verifica\u00E7\u00E3o)\",\n    human_connect_why_3: \"Para pedir aprova\u00E7\u00F5es/transa\u00E7\u00F5es depois (com sua confirma\u00E7\u00E3o)\",\n    human_connect_risk_1: \"Privacidade/rastreamento: pode vincular seu endere\u00E7o a este site\",\n    human_connect_risk_2: \"Phishing em etapas: os pr\u00F3ximos prompts podem pedir assinatura/approve\",\n    human_connect_risk_3: \"Dom\u00EDnios similares: sites falsos costumam come\u00E7ar com um connect inofensivo\",\n    human_connect_safe_1: \"Trate connect como compartilhar identidade: fa\u00E7a isso s\u00F3 em sites que voc\u00EA reconhece.\",\n    human_connect_next_1: \"Confira o dom\u00EDnio (ortografia, HTTPS, sem punycode)\",\n    human_connect_next_2: \"Se tiver d\u00FAvida, cancele e abra o site por um favorito confi\u00E1vel\",\n    human_connect_reco_suspicious: \"Cancele e verifique a URL por outro meio (favorito/busca), depois tente novamente.\",\n    human_connect_reco_ok: \"Continue apenas se voc\u00EA reconhece o site e a URL parece correta.\",\n    human_sign_whatIs: \"Cria uma assinatura criptogr\u00E1fica. Geralmente n\u00E3o custa gas, mas pode autorizar a\u00E7\u00F5es.\",\n    human_sign_risk_1: \"Assinar textos desconhecidos pode autorizar a\u00E7\u00F5es/login que voc\u00EA n\u00E3o pretendia\",\n    human_sign_risk_2: \"Blind sign pode esconder o que voc\u00EA est\u00E1 autorizando\",\n    human_typed_whatIs: \"Assina dados estruturados (typed-data). Frequentemente usado para permits/autoriza\u00E7\u00F5es.\",\n    human_typed_risk_1: \"Typed-data pode incluir permits de token que funcionam como aprova\u00E7\u00F5es\",\n    human_sign_safe_1: \"Prefira carteiras que mostrem detalhes de assinatura de forma leg\u00EDvel.\",\n    human_sign_next_1: \"Verifique a URL e leia a mensagem/typed-data com aten\u00E7\u00E3o\",\n    human_sign_next_2: \"Se o prompt for vago, cancele e pe\u00E7a contexto ao site\",\n    human_sign_reco_suspicious: \"Cancele. Dom\u00EDnio suspeito + assinatura \u00E9 um padr\u00E3o comum de phishing.\",\n    human_sign_reco_ok: \"S\u00F3 continue se voc\u00EA entende o motivo da assinatura e confia no site.\",\n    human_approve_whatIs: \"Uma aprova\u00E7\u00E3o permite que um contrato gaste seus tokens depois (at\u00E9 o limite aprovado).\",\n    human_approve_risk_1: \"Aprova\u00E7\u00F5es podem ser abusadas se o contrato gastador for malicioso ou comprometido\",\n    human_approve_risk_unlimited: \"Aprova\u00E7\u00E3o ilimitada significa que pode gastar TODO o saldo do token\",\n    human_approve_safe_1: \"Quando poss\u00EDvel, aprove apenas o m\u00EDnimo necess\u00E1rio.\",\n    human_approve_next_1: \"Confira o spender/operador e se voc\u00EA reconhece o dApp\",\n    human_approve_next_2: \"Considere revogar aprova\u00E7\u00F5es depois se n\u00E3o usar mais o site\",\n    human_approve_reco: \"Continue apenas se voc\u00EA confia no site e o spender faz sentido.\",\n    human_approve_reco_unlimited: \"Evite aprova\u00E7\u00F5es ilimitadas a menos que voc\u00EA confie muito no site e entenda o risco.\",\n    human_setApprovalForAll_whatIs: \"D\u00E1 permiss\u00E3o a um operador para mover TODOS os NFTs de uma cole\u00E7\u00E3o por voc\u00EA.\",\n    human_setApprovalForAll_risk_1: \"Isso pode permitir drenar NFTs se o operador for malicioso/comprometido\",\n    human_setApprovalForAll_safe_1: \"Aprove apenas operadores que voc\u00EA reconhece (ex.: marketplaces conhecidos).\",\n    human_setApprovalForAll_next_1: \"Verifique o endere\u00E7o do operador e se o site \u00E9 o marketplace pretendido\",\n    human_setApprovalForAll_reco: \"Cancele a menos que voc\u00EA esteja em um marketplace reconhecido e espere essa a\u00E7\u00E3o.\",\n    human_tx_whatIs: \"Isso criar\u00E1 uma transa\u00E7\u00E3o on-chain se voc\u00EA aprovar na sua carteira.\",\n    human_tx_risk_1: \"Transa\u00E7\u00F5es podem mover fundos ou alterar permiss\u00F5es dependendo da chamada\",\n    human_tx_safe_1: \"Sempre verifique destinat\u00E1rio, valor e o contrato com o qual est\u00E1 interagindo.\",\n    human_tx_next_1: \"Confira o destino (to), valor e a a\u00E7\u00E3o decodificada (se houver)\",\n    human_tx_reco_suspicious: \"Cancele. N\u00E3o envie transa\u00E7\u00F5es em dom\u00EDnios suspeitos.\",\n    human_tx_reco_ok: \"Continue apenas se voc\u00EA pretendia essa a\u00E7\u00E3o e os detalhes parecem corretos.\",\n    human_chain_whatIs: \"Muda a rede selecionada na sua carteira.\",\n    human_chain_risk_1: \"Redes/RPCs errados podem te enganar sobre ativos ou transa\u00E7\u00F5es\",\n    human_chain_safe_1: \"S\u00F3 troque/adicione redes que voc\u00EA reconhece.\",\n    human_chain_next_1: \"Confirme nome da rede e chainId no prompt da carteira\",\n    human_watchasset_whatIs: \"Adiciona um token/ativo na UI da carteira para facilitar a visualiza\u00E7\u00E3o.\",\n    human_watchasset_risk_1: \"Tokens falsos podem se passar por reais\u2014verifique endere\u00E7o e s\u00EDmbolo\",\n    human_watchasset_safe_1: \"Confirme detalhes do token em um explorer confi\u00E1vel (ex.: Etherscan).\",\n    human_watchasset_next_1: \"Verifique o contrato do token e as decimais\",\n    human_watchasset_reco: \"Continue apenas se os detalhes baterem com uma fonte oficial.\",\n    human_generic_whatIs: \"Um site solicitou uma a\u00E7\u00E3o da carteira. Revise os detalhes com cuidado.\",\n    human_generic_risk_1: \"Prompts desconhecidos podem fazer parte de fluxos de phishing\",\n    human_generic_safe_1: \"Na d\u00FAvida, cancele e verifique o site.\",\n    human_generic_next_1: \"Confira a URL e leia os detalhes do prompt da carteira\",\n    human_generic_reco: \"Continue apenas se voc\u00EA entende e esperava essa solicita\u00E7\u00E3o.\",\n    human_revoke_link_text: \"Revogar permiss\u00F5es depois: revoke.cash\",\n    trustReasonNotHttps: \"N\u00E3o \u00E9 HTTPS (maior risco de spoofing/inje\u00E7\u00E3o).\",\n    trustReasonManyHyphens: \"Muitos h\u00EDfens no dom\u00EDnio (comum em similares).\",\n    trustReasonSuspiciousKeywords: \"Dom\u00EDnio cont\u00E9m palavras de alto risco (login/verify/secure/...).\",\n    trustReasonBrandLookalike: \"Nome lembra uma marca, mas n\u00E3o \u00E9 o dom\u00EDnio oficial.\",\n    trustReasonManySubdomains: \"Estrutura de subdom\u00EDnio profunda/incomum.\",\n    trustReasonNoHost: \"N\u00E3o foi poss\u00EDvel ler o hostname do site.\",\n    trustReasonAllowlistedVariant: \"Dom\u00EDnio casa com um padr\u00E3o confi\u00E1vel.\",\n    trustReasonUnknown: \"Sem sinais fortes para um lado ou outro.\",\n    summary_ADD_CHAIN_1: \"O site quer adicionar uma nova rede na sua carteira.\",\n    summary_ADD_CHAIN_2: \"Confirme o chainId e o nome da rede com cuidado.\",\n    summary_SIGN_MESSAGE_1: \"Voc\u00EA vai assinar uma mensagem (n\u00E3o \u00E9 transa\u00E7\u00E3o).\",\n    summary_SIGN_MESSAGE_2: \"A assinatura pode ter efeitos fora da blockchain (login, termos, permiss\u00F5es).\",\n    summary_SIGN_TYPED_DATA_1: \"Voc\u00EA vai assinar dados estruturados (EIP-712).\",\n    summary_SIGN_TYPED_DATA_2: \"Isso pode autorizar gastos/ordens dependendo do conte\u00FAdo.\",\n    summary_SIGN_TYPED_DATA_3: \"Verifique quem \u00E9 o spender/contrato envolvido.\",\n    summary_SEND_TX_1: \"Voc\u00EA vai enviar uma transa\u00E7\u00E3o on-chain.\",\n    summary_SEND_TX_2: \"Isso pode mover ETH/tokens ou interagir com um contrato.\",\n    summary_SEND_TX_3: \"Confira valor, rede e destino antes de confirmar.\",\n    summary_WATCH_ASSET_1: \"O site quer adicionar um token/ativo na sua carteira.\",\n    summary_WATCH_ASSET_2: \"Confirme s\u00EDmbolo e endere\u00E7o do contrato do token.\",\n    summary_SOLANA_1: \"Assinatura ou transa\u00E7\u00E3o Solana. Os valores ser\u00E3o confirmados na carteira.\",\n    summary_UNKNOWN_1: \"O site est\u00E1 fazendo uma chamada de carteira desconhecida.\",\n    summary_UNKNOWN_2: \"Se n\u00E3o souber o que \u00E9, cancele.\",\n\n    // Costs / TX labels\n    btn_cancel: \"Cancelar\",\n    btn_block: \"Bloquear\",\n    btn_continue: \"Continuar\",\n    toast_request_expired: \"Solicita\u00E7\u00E3o expirada. Refa\u00E7a a a\u00E7\u00E3o no site e tente novamente.\",\n    simulation_tx_will_fail: \"ESTA TRANSA\u00C7\u00C3O VAI FALHAR\",\n    btn_close: \"Fechar\",\n    btn_proceed_anyway: \"Prosseguir mesmo assim\",\n    override_checkbox: \"Eu entendo o risco e quero prosseguir\",\n    override_countdown: \"({s}s)\",\n\n    tip_revoke: \"Revogar permiss\u00F5es depois: revoke.cash\",\n    cost_summary_title: \"Resumo de custos\",\n    costs_title: \"Custos e impacto\",\n    impact_title: \"Impacto\",\n    permission_for: \"Permiss\u00E3o para\",\n    addr_marked_public: \"Marcado em base p\u00FAblica\",\n    risk_title: \"Risco e por qu\u00EA\",\n    what_to_do_now: \"O que fazer agora\",\n    site_label: \"Site\",\n    network_label: \"Rede\",\n    severity_BLOCKED: \"BLOQUEADO\",\n    severity_HIGH: \"ALTO\",\n    severity_WARN: \"ATEN\u00C7\u00C3O\",\n    severity_LOW: \"BAIXO\",\n    cost_you_send: \"Voc\u00EA envia\",\n    cost_you_receive: \"Voc\u00EA recebe\",\n    cost_fee_only: \"apenas taxa\",\n    cost_value: \"Valor\",\n    cost_fee: \"Taxa estimada\",\n    cost_total: \"Total estimado\",\n    cost_fee_unknown: \"Taxa ser\u00E1 cobrada (confirme na carteira)\",\n    network_switch_title: \"Troca de rede\",\n    network_current: \"Rede atual\",\n    network_requested: \"Rede solicitada\",\n    trusted_domain_ref_title: \"Dom\u00EDnios confi\u00E1veis (refer\u00EAncia)\",\n    tx_cost_sending: \"Voc\u00EA est\u00E1 enviando {value} + taxa de rede\",\n    tx_cost_gas_only: \"Mesmo sem enviar moeda nativa, voc\u00EA pagar\u00E1 taxa de rede (gas)\",\n    gas_calculating: \"calculando\u2026\",\n\n    tx_destination: \"Destino\",\n    token_verified_uniswap: \"Token Verificado (Uniswap List)\",\n    token_unknown_unverified: \"Token Desconhecido (N\u00E3o Verificado)\",\n    tx_contract_method: \"Contrato/m\u00E9todo\",\n    tx_max_gas_fee: \"Taxa m\u00E1xima (gas)\",\n    tx_max_total: \"Total m\u00E1ximo\",\n    tx_fee_estimated_by_wallet: \"A carteira estimar\u00E1 a taxa na pr\u00F3xima etapa.\",\n\n    network_target: \"Rede alvo\",\n    switch_no_gas: \"A troca de rede normalmente N\u00C3O custa gas.\",\n    switch_next_step_gas: \"A pr\u00F3xima etapa (compra/transa\u00E7\u00E3o) ter\u00E1 taxa de rede.\",\n    switch_note_inline: \"A troca de rede normalmente N\u00C3O custa gas. Por\u00E9m a pr\u00F3xima etapa (compra/transa\u00E7\u00E3o) ter\u00E1 taxa de rede.\",\n    sendtx_reco: \"Confirme na carteira apenas se os detalhes (valor, rede e contrato) estiverem corretos.\",\n\n    // Risk/trust labels\n    risk_LOW: \"Baixo\",\n    risk_WARN: \"Aten\u00E7\u00E3o\",\n    risk_HIGH: \"Alto\",\n    recommend_ALLOW: \"Permitir\",\n    recommend_WARN: \"Avisar\",\n    recommend_HIGH: \"Alto risco\",\n    recommend_BLOCK: \"Bloquear\",\n    trust_unknown: \"Desconhecido\",\n    trust_suspicious: \"Suspeito\",\n    trust_likelyOfficial: \"Dom\u00EDnio conhecido (lista de refer\u00EAncia)\",\n    trust_domainNotRecognized: \"Dom\u00EDnio n\u00E3o reconhecido\",\n\n    // Phishing hard-block\n    phishing_hard_block: \"Dom\u00EDnio em blacklist de phishing. Bloqueado.\",\n\n    // Toasts\n    toast_extension_updated: \"Extens\u00E3o atualizada \u2014 recarregue a aba.\",\n    toast_cannot_analyze: \"N\u00E3o foi poss\u00EDvel analisar. Recarregue a aba.\",\n\n    // Options page\n    optionsTitle: \"Crypto Wallet SignGuard \u2014 Configura\u00E7\u00F5es\",\n    optionsSubtitle: \"Controle quando o SignGuard deve alertar e bloquear.\",\n    dashboardLink: \"Dashboard\",\n    onboardingTitle: \"Como usar\",\n    onboardingHowTo: \"A extens\u00E3o intercepta solicita\u00E7\u00F5es sens\u00EDveis (conex\u00E3o, assinatura, transa\u00E7\u00E3o) de carteiras injetadas (window.ethereum / window.solana). Ao detectar, mostra um overlay para voc\u00EA revisar antes de a carteira abrir.\",\n    onboardingWhatItDoes: \"Faz: alerta antes de conectar, assinar ou enviar; verifica dom\u00EDnio contra listas de phishing; mostra inten\u00E7\u00E3o da transa\u00E7\u00E3o (swap, NFT, approval).\",\n    onboardingWhatItDoesNot: \"N\u00E3o faz: n\u00E3o protege conex\u00F5es via QR/WalletConnect; n\u00E3o garante que contratos sejam seguros; n\u00E3o substitui verifica\u00E7\u00E3o manual.\",\n    onboardingLinkRevoke: \"revoke.cash \u2014 revogar permiss\u00F5es\",\n    onboardingLinkEtherscan: \"Etherscan \u2014 explorar transa\u00E7\u00F5es\",\n    exportDebugRequiresDebugMode: \"Ative o modo Debug primeiro para exportar eventos.\",\n    securityModeLabel: \"Modo de seguran\u00E7a\",\n    securityModeDesc: \"Strict bloqueia mais; Balanced alerta; Relaxed reduz fric\u00E7\u00E3o; Off desativa bloqueios.\",\n    modeStrict: \"Strict\",\n    modeBalanced: \"Balanced\",\n    modeRelaxed: \"Relaxed\",\n    modeOff: \"Off\",\n    strictBlockApprovalsUnlimitedLabel: \"Strict: bloquear approve ilimitado\",\n    strictBlockApprovalsUnlimitedDesc: \"Bloqueia aprova\u00E7\u00F5es ERC20 unlimited (MAX_UINT256).\",\n    strictBlockSetApprovalForAllLabel: \"Strict: bloquear setApprovalForAll\",\n    strictBlockSetApprovalForAllDesc: \"Bloqueia permiss\u00E3o para mover todos os NFTs.\",\n    strictBlockPermitLikeLabel: \"Strict: bloquear Permit ilimitado\",\n    strictBlockPermitLikeDesc: \"Bloqueia assinaturas Permit (EIP-2612) unlimited.\",\n    assetEnrichmentEnabledLabel: \"Enriquecimento de ativos\",\n    assetEnrichmentEnabledDesc: \"Busca s\u00EDmbolo/nome de tokens via eth_call.\",\n    addressIntelEnabledLabel: \"Threat intel de endere\u00E7os\",\n    addressIntelEnabledDesc: \"Verifica spender/operator/to contra blacklist.\",\n    riskWarningsLabel: \"Alertas de risco\",\n    riskWarningsDesc: \"Mostra avisos e recomenda\u00E7\u00F5es antes de abrir a carteira.\",\n    connectOverlayLabel: \"Overlay ao conectar\",\n    connectOverlayDesc: \"Mostra o overlay tamb\u00E9m para conex\u00E3o/permiss\u00F5es.\",\n    blockHighRiskLabel: \"Bloquear alto risco\",\n    blockHighRiskDesc: \"Bloqueia automaticamente a\u00E7\u00F5es de alto risco.\",\n    requireTypedOverrideLabel: \"Exigir override em Typed Data (alto risco)\",\n    requireTypedOverrideDesc: \"Para assinaturas EIP-712 de alto risco, exige confirma\u00E7\u00E3o extra.\",\n    allowOverrideOnPhishingLabel: \"Permitir override em phishing (N\u00C3O recomendado)\",\n    allowOverrideOnPhishingDesc: \"Se desativado (padr\u00E3o), phishing em blacklist \u00E9 bloqueado sem op\u00E7\u00E3o de prosseguir.\",\n    mode_off_reason: \"Modo OFF: sem bloqueios.\",\n    address_flagged_reason: \"Endere\u00E7o/contrato sinalizado: {label} ({category})\",\n    addr_sanctioned_block: \"Endere\u00E7o em lista de san\u00E7\u00F5es.\",\n    addr_scam_reported_warn: \"Endere\u00E7o marcado como suspeito/relatado.\",\n    addr_phishing_reported_warn: \"Endere\u00E7o marcado como suspeito/relatado.\",\n    addr_malicious_contract_warn: \"Contrato marcado como malicioso.\",\n    asset_info_reason: \"Ativo: {sym} ({kind})\",\n    reason_permission_tokens: \"Permiss\u00E3o para gastar tokens\",\n    reason_permission_all_nfts: \"Permiss\u00E3o para mover TODOS os NFTs\",\n    reason_transfer_tokens: \"Transfer\u00EAncia de tokens/NFT\",\n    domainChecksLabel: \"Checagens de dom\u00EDnio\",\n    domainChecksDesc: \"Alertas por padr\u00F5es suspeitos no dom\u00EDnio quando n\u00E3o estiver na allowlist.\",\n    allowlistLabel: \"Allowlist (dom\u00EDnios confi\u00E1veis)\",\n    allowlistDesc: \"Um dom\u00EDnio por linha. Ex.: opensea.io\",\n    vaultTitle: \"Cofre SignGuard\",\n    vaultDesc: \"Contratos nesta lista nunca podem ser transacionados sem desbloqueio expl\u00EDcito nas op\u00E7\u00F5es.\",\n    vaultAddLabel: \"Adicionar contrato ao cofre\",\n    vaultAddButton: \"Adicionar ao Cofre\",\n    vaultListLabel: \"Contratos bloqueados\",\n    vaultListEmpty: \"Nenhum contrato no cofre.\",\n    vaultRemove: \"Remover\",\n    vaultInvalidAddress: \"Endere\u00E7o inv\u00E1lido. Use 0x e 40 caracteres hexadecimais.\",\n    vaultAlreadyAdded: \"Este contrato j\u00E1 est\u00E1 no cofre.\",\n    vaultBlockedMessage: \"SignGuard: Ativo Bloqueado no Cofre. Desbloqueie nas op\u00E7\u00F5es para continuar.\",\n    vaultBlockedTitle: \"Cofre bloqueou esta a\u00E7\u00E3o\",\n    vaultBlockedReason: \"O contrato/ativo est\u00E1 no Cofre. Desbloqueie temporariamente para prosseguir.\",\n    vault_unlock_5min: \"Desbloquear 5 min\",\n    vault_unlock_30min: \"Desbloquear 30 min\",\n    vault_unlocked_toast: \"Desbloqueado por {n} min\",\n    overlay_temp_allow_10min: \"Permitir por 10 min\",\n    overlay_temp_allow_toast: \"Permitido por 10 min\",\n    page_risk_warning: \"P\u00E1gina com poss\u00EDvel risco detectado.\",\n    reason_page_risk_high: \"P\u00E1gina com risco alto detectado (ex.: lookalike, clickjacking).\",\n    reason_page_risk_medium: \"P\u00E1gina com risco m\u00E9dio (ex.: frases suspeitas, overlay).\",\n    addSuggested: \"Adicionar sugeridos\",\n    save: \"Salvar\",\n    saved: \"Salvo\",\n\n    intelTitle: \"Threat Intel\",\n    intelSubtitle: \"Listas de dom\u00EDnios (fontes plug\u00E1veis) usadas na an\u00E1lise.\",\n    intelTrustedCountLabel: \"Dom\u00EDnios confi\u00E1veis\",\n    intelBlockedCountLabel: \"Dom\u00EDnios bloqueados\",\n    intelBlockedAddressCountLabel: \"Endere\u00E7os bloqueados\",\n    intelUpdatedAtLabel: \"\u00DAltima atualiza\u00E7\u00E3o\",\n    intelUpdateNow: \"Atualizar agora\",\n    enableIntelLabel: \"Usar Threat Intel\",\n    enableIntelDesc: \"Usa listas de dom\u00EDnios confi\u00E1veis/bloqueados na an\u00E1lise.\",\n    customTrustedDomainsLabel: \"Dom\u00EDnios confi\u00E1veis (lista personalizada)\",\n    customTrustedDomainsDesc: \"Um por linha. Ex.: meusite.io\",\n    customBlockedDomainsLabel: \"Dom\u00EDnios bloqueados (lista personalizada)\",\n    customBlockedDomainsDesc: \"Um por linha. Sempre bloqueados.\",\n    exportListsLabel: \"Exportar listas\",\n\n    privacyLimitsTitle: \"Privacidade & Limita\u00E7\u00F5es\",\n    privacyLimitsLine1: \"A extens\u00E3o n\u00E3o acessa sua seed/frase secreta e n\u00E3o tem cust\u00F3dia.\",\n    privacyLimitsLine2: \"Ela analisa dom\u00EDnios e dados de transa\u00E7\u00E3o exibidos pelo navegador para alertas. N\u00E3o garante 100%.\",\n    privacyLimitsLine3: \"Threat intel pode ser atualizado via fontes p\u00FAblicas (opcional).\",\n    cloudIntelOptInLabel: \"Permitir checagens externas\",\n    cloudIntelOptInDesc: \"Mais prote\u00E7\u00E3o; pode enviar dom\u00EDnio/endere\u00E7os para valida\u00E7\u00E3o (preparado para P1).\",\n    showUsdLabel: \"Exibir valores em USD\",\n    showUsdDesc: \"Converte valores da moeda nativa e tokens para d\u00F3lar (quando dispon\u00EDvel).\",\n    tabSettings: \"Configura\u00E7\u00F5es\",\n    tabHistory: \"Hist\u00F3rico\",\n    tabPlan: \"Plano\",\n    historySubtitle: \"\u00DAltimas decis\u00F5es do overlay.\",\n    historyExport: \"Exportar JSON\",\n    historyClear: \"Limpar\",\n    historyEmpty: \"Nenhum registro.\",\n    request_expired_toast: \"Solicita\u00E7\u00E3o expirada. Refa\u00E7a a a\u00E7\u00E3o no site e tente novamente.\",\n    failopen_armed_banner: \"An\u00E1lise demorou. Voc\u00EA pode Continuar mesmo assim ou Cancelar.\",\n    decision_allow: \"Permitido\",\n    decision_block: \"Bloqueado\",\n    planSubtitle: \"Gerencie seu plano e licen\u00E7a.\",\n    planCurrent: \"Plano atual\",\n    planLicenseKey: \"Chave de licen\u00E7a\",\n    planActivate: \"Ativar\",\n    planGoPro: \"Assinar PRO\",\n    // Options: Safety notes + debug\n    safetyNotesTitle: \"Limita\u00E7\u00F5es & seguran\u00E7a\",\n    safetyNotesLine1: \"Esta extens\u00E3o monitora solicita\u00E7\u00F5es feitas por carteiras injetadas (window.ethereum / window.solana).\",\n    safetyNotesLine2: \"Conex\u00F5es via QR/WalletConnect podem n\u00E3o ser interceptadas. Sempre verifique na sua carteira.\",\n    safetyNotesLinkRevoke: \"revoke.cash\",\n    safetyNotesLinkEtherscan: \"etherscan.io\",\n    debugModeLabel: \"Modo debug\",\n    debugModeDesc: \"Armazena os \u00FAltimos 20 eventos (sem payload grande) para suporte.\",\n    exportDebug: \"Exportar\",\n\n    // Overlay: intent + permission + copy\n    looks_like: \"Parece:\",\n    intent_NFT_PURCHASE: \"Compra de NFT\",\n    intent_SWAP: \"Swap\",\n    intent_APPROVAL: \"Permiss\u00E3o\",\n    intent_SEND: \"Envio\",\n    intent_UNKNOWN: \"Desconhecido\",\n    intent_ETH_TRANSFER: \"Envio de ETH\",\n    intent_TOKEN_TRANSFER: \"Transfer\u00EAncia de token\",\n    intent_NFT_TRANSFER: \"Transfer\u00EAncia de NFT\",\n    intent_CONTRACT_INTERACTION: \"Intera\u00E7\u00E3o com contrato\",\n    intent_SWITCH_CHAIN: \"Troca de rede\",\n    intent_ADD_CHAIN: \"Adicionar rede\",\n    intent_WATCH_ASSET: \"Adicionar token\",\n    intent_SOLANA: \"Assinatura/Transa\u00E7\u00E3o Solana\",\n    intent_SIGNATURE: \"Assinatura\",\n    intent_TYPED_DATA: \"Dados tipados\",\n    wallet_label: \"Carteira\",\n    wallet_detecting: \"Detectando\u2026\",\n    wallet_evm_generic: \"Carteira EIP-1193\",\n    trust_disclaimer: \"Lista de refer\u00EAncia \u2260 garantia. Golpistas podem usar dom\u00EDnios parecidos.\",\n    hint_wallet_popup: \"Sua carteira deve abrir agora. Se n\u00E3o abrir, clique no \u00EDcone da carteira e verifique solicita\u00E7\u00F5es pendentes.\",\n    add_chain_network_label: \"Rede a adicionar\",\n    add_chain_rpc_label: \"RPC\",\n    watch_asset_token_label: \"Token a adicionar\",\n    modeLabel: \"Modo:\",\n    popupPauseProtection: \"PAUSAR PROTE\u00C7\u00C3O\",\n    popupStatusProtected: \"Protegido\",\n    popupStatusPaused: \"Pausado\",\n    fortressModeLabel: \"MODO FORTALEZA\",\n    fortressModeDesc: \"Bloqueia todas as aprova\u00E7\u00F5es de tokens, exceto em sites confi\u00E1veis.\",\n    fortress_block_message: \"SignGuard Fortaleza: Aprova\u00E7\u00E3o bloqueada em site desconhecido. Desative o modo Fortaleza para prosseguir.\",\n    honeypot_message: \"\uD83E\uDEA4 HONEYPOT: Voc\u00EA pode comprar, mas N\u00C3O poder\u00E1 vender.\",\n    info_unavailable: \"Informa\u00E7\u00E3o indispon\u00EDvel.\",\n    explain_switch_short: \"O site pediu para trocar a rede (chain) da sua carteira.\",\n    human_chain_reco: \"Continue apenas se voc\u00EA esperava a troca de rede e ela parece correta.\",\n    trustReasonAllowlisted: \"Dom\u00EDnio est\u00E1 em uma lista confi\u00E1vel (seed).\",\n    trustReasonPhishingBlacklist: \"Dom\u00EDnio est\u00E1 em blacklist de phishing (lista de refer\u00EAncia).\",\n    fee_unknown_wallet_will_estimate: \"Taxa: ser\u00E1 exibida pela carteira\",\n    label_you_send: \"Voc\u00EA envia\",\n    label_fee_likely: \"Taxa estimada (prov\u00E1vel)\",\n    label_fee_max: \"Taxa m\u00E1xima (pior caso)\",\n    label_total_likely: \"Total prov\u00E1vel\",\n    label_total_max: \"Total m\u00E1ximo\",\n    fee_gt_value: \"A taxa m\u00E1xima \u00E9 MAIOR que o valor enviado. Confirme se faz sentido.\",\n    check_wallet_network_fee: \"Voc\u00EA ainda n\u00E3o viu a taxa. Verifique o 'Network fee' na carteira antes de confirmar.\",\n    label_max_fee: \"Taxa m\u00E1xima\",\n    label_max_total: \"Total m\u00E1ximo\",\n    switch_summary_no_gas: \"Troca de rede normalmente n\u00E3o custa gas, mas pode mudar quais ativos voc\u00EA est\u00E1 vendo.\",\n    permission_title: \"Permiss\u00E3o\",\n    permission_token_contract: \"Contrato\",\n    permission_spender: \"Spender\",\n    permission_operator: \"Operator\",\n    permission_unlimited: \"Ilimitado\",\n    approval_unlimited_detected: \"Aprova\u00E7\u00E3o ilimitada detectada\",\n    permit_signature_detected: \"Assinatura tipo Permit detectada (pode autorizar gasto de tokens)\",\n    token_transfer_detected: \"Transfer\u00EAncia de token detectada\",\n    nft_transfer_detected: \"Transfer\u00EAncia de NFT detectada\",\n    transfer_token_title: \"Transfer\u00EAncia de token\",\n    transfer_nft_title: \"Transfer\u00EAncia de NFT\",\n    transfer_amount: \"Quantidade\",\n    transfer_token_id: \"Token ID\",\n    yes: \"Sim\",\n    no: \"N\u00E3o\",\n    copy: \"Copiar\",\n    chainChangeTitle: \"Solicita\u00E7\u00E3o de troca/adicionar rede\",\n    watchAssetTitle: \"Solicita\u00E7\u00E3o de adicionar ativo\",\n\n    domainPunycodeReason: \"Dom\u00EDnio usa punycode (xn--); verifique a URL.\",\n    reason_high_gas: \"Taxa de gas alta em rela\u00E7\u00E3o ao valor.\",\n    reason_new_spender: \"Novo spender \u2014 verifique.\",\n    reason_contract_target: \"Destino \u00E9 contrato.\",\n    reason_known_bad_spender: \"Spender bloqueado.\",\n    reason_known_safe_spender: \"Spender na allowlist.\",\n    reason_unlimited_approval: \"Simula\u00E7\u00E3o: aprova\u00E7\u00E3o ilimitada detectada.\",\n    reason_set_approval_for_all: \"Simula\u00E7\u00E3o: ApprovalForAll (permite mover todos os NFTs).\",\n    reason_snap_invoke: \"Snaps podem executar c\u00F3digo na carteira. Confirme a origem.\",\n    reason_sign_tx: \"Assinatura de transa\u00E7\u00E3o sem envio imediato. Pode ser usada depois para broadcast.\",\n    reason_raw_broadcast: \"Broadcast de transa\u00E7\u00E3o j\u00E1 assinada. N\u00E3o h\u00E1 confirma\u00E7\u00E3o visual pr\u00E9via do conte\u00FAdo.\",\n    reason_read_permissions: \"O site est\u00E1 a ler as permiss\u00F5es j\u00E1 concedidas \u00E0 carteira.\",\n    summary_title_snaps: \"Snaps / Extens\u00F5es da carteira\",\n    summary_title_read_permissions: \"Leitura de permiss\u00F5es\",\n    summary_title_sign_tx: \"Assinatura de transa\u00E7\u00E3o\",\n    summary_title_raw_tx: \"Broadcast de transa\u00E7\u00E3o assinada\",\n    summary_title_switch_chain: \"Troca de rede\",\n    domainDoubleDashReason: \"Dom\u00EDnio cont\u00E9m h\u00EDfen duplo (suspeito).\",\n    domainNumberPatternReason: \"Dom\u00EDnio com muitos n\u00FAmeros (comum em phishing).\",\n    domainLookalikeReason: \"Poss\u00EDvel imita\u00E7\u00E3o do dom\u00EDnio oficial de {legit}.\",\n    suspiciousWebsitePatterns: \"Padr\u00F5es suspeitos no site.\",\n    page_risk_suspicious_banner: \"\u26A0\uFE0F SignGuard: Site Suspeito Detetado\",\n    connectTitle: \"Conectar carteira\",\n    connectReason: \"O site quer conectar \u00E0 sua carteira.\",\n    walletRequestPermissionsTitle: \"Solicitar permiss\u00F5es\",\n    walletRequestPermissionsReason: \"O site quer permiss\u00F5es adicionais na carteira.\",\n    typedDataWarnReason: \"Assinatura de dados estruturados (EIP-712); pode autorizar a\u00E7\u00F5es.\",\n    signatureRequest: \"Pedido de assinatura\",\n    rawSignWarnReason: \"Assinatura de mensagem raw; pode autorizar a\u00E7\u00F5es fora da blockchain.\",\n    tokenApproval: \"Aprova\u00E7\u00E3o de token\",\n    unlimitedApprovalReason: \"Aprova\u00E7\u00E3o ilimitada detectada (MAX_UINT256).\",\n    unlimitedApprovalDetected: \"Aprova\u00E7\u00E3o ilimitada detectada\",\n    nftOperatorApprovalReason: \"Permiss\u00E3o para mover TODOS os NFTs da cole\u00E7\u00E3o.\",\n    nftOperatorApproval: \"Permiss\u00E3o de operador NFT\",\n    txPreview: \"Visualiza\u00E7\u00E3o da transa\u00E7\u00E3o\",\n    txWarnReason: \"Transa\u00E7\u00E3o on-chain; confira valor, destino e rede.\",\n    unknownMethodReason: \"M\u00E9todo de carteira desconhecido.\",\n    warningsDisabledReason: \"Alertas desativados nas configura\u00E7\u00F5es.\",\n    analyzing: \"Analisando\u2026\",\n    analyzing_subtitle: \"Site \u2022 M\u00E9todo\",\n    analyzing_hint: \"Validando dom\u00EDnio e estimando impacto\",\n    fallback_partial_check: \"Sem verifica\u00E7\u00E3o completa agora \u2014 revise os detalhes abaixo antes de prosseguir.\",\n    fallback_partial_verification: \"Verifica\u00E7\u00E3o parcial agora \u2014 revise os detalhes abaixo antes de prosseguir.\",\n    loading_base: \"Carregando base\u2026\",\n    analyzerUnavailableTitle: \"Analisador indispon\u00EDvel\",\n    analysis_unavailable: \"An\u00E1lise indispon\u00EDvel \u2014 confira na carteira antes de continuar.\",\n    dados_parciais_title: \"Dados parciais \u2014 confirme na carteira\",\n    dados_parciais_subtitle: \"Exibindo o que foi poss\u00EDvel analisar. Verifique os detalhes na carteira antes de continuar.\",\n    risk_low: \"Baixo\",\n    risk_warn: \"Aten\u00E7\u00E3o\",\n    risk_high: \"Alto\",\n    risk_block: \"Bloqueado\",\n    trustReasonAllowlistedMatched: \"Dom\u00EDnio em allowlist: {matched}.\",\n    list_empty_domains: \"Lista vazia. Abra as op\u00E7\u00F5es para adicionar dom\u00EDnios confi\u00E1veis.\",\n    btn_open_options: \"Abrir op\u00E7\u00F5es\",\n    default_human_switch_what: \"Troca a rede ativa da carteira (ex.: Ethereum \u2192 outra rede).\",\n    default_human_switch_risk: \"Voc\u00EA pode assinar/transacionar na rede errada se a troca n\u00E3o for esperada.\",\n    default_human_switch_safe: \"Confirme a rede solicitada e se o site \u00E9 o correto.\",\n    default_human_switch_next: \"Se estiver certo, aprove na carteira. Se estiver estranho, cancele.\",\n    default_human_contract_what: \"Envia uma transa\u00E7\u00E3o para um contrato (a\u00E7\u00E3o dentro do dApp).\",\n    default_human_contract_risk: \"O custo real pode variar e a a\u00E7\u00E3o pode mover ativos/tokens via contrato.\",\n    default_human_contract_safe: \"Confira destino (to), rede, valor e a taxa (Network fee) na carteira.\",\n    default_human_contract_next: \"Se os detalhes baterem, prossiga. Caso contr\u00E1rio, cancele.\",\n    default_human_eth_what: \"Envia ETH diretamente para um endere\u00E7o.\",\n    default_human_eth_risk: \"Transfer\u00EAncias s\u00E3o irrevers\u00EDveis se o destino estiver errado.\",\n    default_human_eth_safe: \"Verifique o endere\u00E7o e o valor. Desconfie de links/encurtadores.\",\n    default_human_eth_next: \"S\u00F3 confirme se voc\u00EA reconhece o destinat\u00E1rio.\",\n    default_human_typed_what: \"Assinatura off-chain (EIP-712). Pode autorizar a\u00E7\u00F5es sem pagar gas.\",\n    default_human_typed_risk: \"Pode conceder permiss\u00F5es/autoriza\u00E7\u00F5es (ex.: permit/approval) dependendo do conte\u00FAdo.\",\n    default_human_typed_safe: \"Revise o que est\u00E1 sendo autorizado (spender/operator) e o dom\u00EDnio/contrato.\",\n    default_human_typed_next: \"Se n\u00E3o entender, cancele e valide no site oficial do dApp.\",\n    default_human_generic_what: \"A\u00E7\u00E3o solicitada pela dApp.\",\n    default_human_generic_risk: \"Se algo n\u00E3o fizer sentido, cancele.\",\n    default_human_generic_safe: \"Confirme dom\u00EDnio, rede e detalhes na carteira.\",\n    default_human_generic_next: \"Prossiga apenas se tudo estiver correto.\",\n    verdict_ok: \"OK\",\n    verdict_warn: \"Aten\u00E7\u00E3o\",\n    verdict_high: \"Risco alto\",\n    verdict_block: \"Bloqueado\",\n    coverage_label: \"Cobertura\",\n    coverage_limited: \"cobertura limitada\",\n    trusted_domain_ref_empty: \"Lista de refer\u00EAncia ainda n\u00E3o carregou.\",\n    trusted_domain_ref_loading: \"Carregando lista de refer\u00EAncia\u2026\",\n    trusted_domain_ref_refresh: \"Atualizar listas\",\n    trusted_domain_ref_view_more: \"Ver mais\",\n    trusted_domains_loading: \"Carregando lista de refer\u00EAncia\u2026\",\n    trusted_domains_more: \"+{n}\",\n    trusted_domains_search_placeholder: \"Filtrar dom\u00EDnios\u2026\",\n    trusted_domains_update_now: \"Atualizar agora\",\n    trusted_domains_auto_update: \"Atualiza automaticamente nas op\u00E7\u00F5es\",\n    banner_ok_no_known_threats: \"OK: nenhum sinal conhecido de golpe/scam detectado.\",\n    banner_block_known_threat: \"Bloqueado: amea\u00E7a conhecida detectada.\",\n    banner_local_verification: \"Aten\u00E7\u00E3o: verifica\u00E7\u00E3o local (cache). Revise os detalhes abaixo antes de prosseguir.\",\n    banner_basic_verification: \"Aten\u00E7\u00E3o: verifica\u00E7\u00E3o b\u00E1sica. Revise cuidadosamente os detalhes antes de prosseguir.\",\n    list_site_reputation: \"Reputa\u00E7\u00E3o do site\",\n    list_site_trusted: \"Confi\u00E1vel\",\n    list_site_blocked: \"Bloqueado\",\n    list_site_unknown: \"Desconhecido\",\n    updated_x_hours: \"Base atualizada h\u00E1 {n} hora(s)\",\n    updated_x_days: \"Base atualizada h\u00E1 {n} dia(s)\",\n    tip_check_wallet_details: \"Confira valor, rede e taxa na carteira.\",\n    no_alerts_known: \"Nenhum alerta conhecido foi detectado para este contexto.\",\n    still_review_wallet: \"Mesmo assim, revise na carteira (valor, rede, destino e taxa).\",\n    site_status_known: \"refer\u00EAncia conhecida\",\n    site_status_not_in_list: \"Site n\u00E3o est\u00E1 na lista de refer\u00EAncia\",\n    destination_contract: \"Contrato\",\n    destination_wallet: \"Carteira\",\n    overlay_coverage_title: \"Cobertura de seguran\u00E7a\",\n    overlay_simulation_title: \"Simula\u00E7\u00E3o\",\n    overlay_address_intel_title: \"Intel de endere\u00E7os\",\n    btn_copy: \"Copiar\",\n    btn_copy_json: \"Copiar JSON\",\n    chain_not_recognized: \"Rede n\u00E3o reconhecida\",\n    simulation_skipped_caution: \"Sem simula\u00E7\u00E3o \u2014 valide com mais cautela.\",\n    toast_copied: \"Copiado\",\n    btn_ver_menos: \"Ver menos\",\n  },\n  en: {\n    tech_displayAction: \"Action (classification)\",\n    tech_methodRaw: \"Method (raw)\",\n    tech_recommendScoreLevel: \"Recommend/score/level\",\n    tech_reasons: \"Reasons\",\n    tech_decoded: \"Decoded\",\n    dash: \"\u2014\",\n    tx_to: \"To\",\n    tx_data_length: \"Data length\",\n    more_whatItDoes: \"What it does\",\n    more_risks: \"Risks\",\n    more_safeNotes: \"Safety notes\",\n    more_nextSteps: \"Next steps\",\n    // Brand\n    extName: \"Crypto Wallet SignGuard\",\n\n    // Overlay - generic labels\n    overlay_analyzing: \"Analyzing Transaction...\",\n    overlay_simulating: \"SignGuard is simulating the outcome.\",\n    overlay_safe: \"Looks Safe\",\n    overlay_attention: \"Attention Detected\",\n    overlay_action: \"Action\",\n    overlay_simulation_balance: \"Balance Simulation\",\n    overlay_approvals_detected: \"Approvals detected\",\n    overlay_confirm_allow_msg: \"Are you sure? This bypasses protection.\",\n    overlay_confirm_allow: \"Confirm allow once\",\n    overlay_try_again: \"Try again\",\n    overlay_analysis_taking_long: \"Analysis is taking too long.\",\n    overlay_fee_calculated: \"Fees calculated.\",\n    overlay_finishing: \"Finishing analysis...\",\n    overlay_typed_data_card_title: \"Signature (EIP-712)\",\n    overlay_typed_data_sign_warning: \"Signing this may allow future spending without another confirmation.\",\n    overlay_allowance_loading: \"Current allowance: \u2026\",\n    overlay_allowance_current: \"Current allowance: \",\n    overlay_allowance_approved: \"Approved\",\n    overlay_allowance_not_approved: \"Not approved\",\n    overlay_allowance_unlimited: \"Unlimited\",\n    simulation_no_changes: \"No balance changes detected.\",\n    tx_unknown: \"Unknown Transaction\",\n    dapp_unknown: \"Unknown DApp\",\n    overlay_requested_title: \"What is being requested\",\n    overlay_site_trusted_title: \"Is the site trusted?\",\n    overlay_summary_title: \"Summary (plain language)\",\n    overlay_recommended_title: \"Recommended action\",\n    overlay_note_title: \"Note\",\n\n    // Overlay - details sections\n    details_tx_title: \"Transaction details\",\n    details_tech_title: \"Technical details\",\n    details_more_title: \"More explanations\",\n\n    // Queue\n    queue_indicator: \"Queue: {pos} of {total}\",\n\n    // Action titles\n    action_CONNECT_title: \"Connect wallet\",\n    action_REQUEST_PERMISSIONS_title: \"Request permissions\",\n    action_SWITCH_CHAIN_title: \"Switch network\",\n    action_ADD_CHAIN_title: \"Add network\",\n    action_SIGN_MESSAGE_title: \"Sign message\",\n    action_SIGN_TYPED_DATA_title: \"Sign typed data\",\n    action_SEND_TX_title: \"Send transaction\",\n    action_SEND_TX_contract_title: \"Contract interaction\",\n    action_SEND_TX_eth_title: \"Send ETH\",\n    action_WATCH_ASSET_title: \"Add token/asset\",\n    action_SOLANA_title: \"Solana signature/transaction\",\n    action_UNKNOWN_title: \"Request\",\n\n    // Summary bullets\n    summary_CONNECT_1: \"The site wants to see your addresses and current network.\",\n    summary_CONNECT_2: \"It may request signatures/transactions later.\",\n    summary_CONNECT_3: \"Only connect if you trust the site.\",\n    summary_REQUEST_PERMISSIONS_1: \"The site is requesting additional wallet permissions.\",\n    summary_REQUEST_PERMISSIONS_2: \"Review permissions in your wallet before accepting.\",\n    summary_SWITCH_CHAIN_1: \"The site wants to switch your wallet network (chain).\",\n    summary_SWITCH_CHAIN_2: \"Switching networks usually costs no gas.\",\n    explain_connect_title: \"Connect wallet\",\n    explain_connect_short: \"Wallet login (share your public address)\",\n    explain_connect_why: \"This lets the site show your account and ask for signatures/approvals/transactions later.\",\n    explain_sign_title: \"Sign a message\",\n    explain_sign_short: \"No gas, but signatures can authorize actions\",\n    explain_sign_why: \"Sites use signatures to log in, verify ownership, or authorize off-chain actions.\",\n    explain_typed_title: \"Sign structured data\",\n    explain_typed_short: \"Typed-data signatures can include permits/authorizations\",\n    explain_typed_why: \"Typed-data is often used for permits (token approvals without a separate on-chain approve).\",\n    explain_tx_title: \"Send a transaction\",\n    explain_tx_short: \"On-chain action (gas fees may apply)\",\n    explain_tx_why: \"This will create an on-chain transaction if you approve it in your wallet.\",\n    explain_switch_title: \"Switch network\",\n    explain_switch_why: \"Some sites require a specific network to function.\",\n    explain_addchain_title: \"Add network\",\n    explain_addchain_short: \"Add a new chain configuration to your wallet\",\n    explain_add_chain_short: \"Add network to wallet\",\n    add_chain_review_rpc: \"Malicious RPC can deceive balances/transactions; verify the source.\",\n    add_chain_verify_chainid: \"Verify chainId and network name before adding.\",\n    explain_addchain_why: \"Wallet may add RPC details for a chain requested by the site.\",\n    explain_watchasset_title: \"Watch asset\",\n    explain_watchasset_short: \"Add a token/asset to your wallet UI\",\n    explain_watch_asset_short: \"Add token/asset to wallet\",\n    watch_asset_no_spend_but_risk: \"Adding a token does not spend funds, but scam tokens exist; verify the contract.\",\n    watch_asset_verify_contract: \"Verify the contract address on a trusted explorer.\",\n    explain_watchasset_why: \"This does not spend funds, but confirm the token details are correct.\",\n    explain_generic_title: \"Wallet request\",\n    explain_generic_short: \"A site is requesting a wallet action\",\n    explain_generic_why: \"Review details in your wallet and confirm the site URL.\",\n    human_connect_whatIs: \"Connects your wallet address to this site (like logging in).\",\n    human_connect_sees_1: \"Your public address (and account selection)\",\n    human_connect_sees_2: \"Your network/chain selection\",\n    human_connect_sees_3: \"Public on-chain activity (tokens/NFTs are public data)\",\n    human_connect_not_1: \"It does NOT reveal your seed phrase or wallet password\",\n    human_connect_not_2: \"It does NOT move funds automatically by itself\",\n    human_connect_why_1: \"To show your account and balances in the UI\",\n    human_connect_why_2: \"To let you sign messages (login/verification)\",\n    human_connect_why_3: \"To request approvals/transactions later (with your confirmation)\",\n    human_connect_risk_1: \"Privacy/tracking: it can link your address to this site\",\n    human_connect_risk_2: \"Phishing steps: next prompts may ask for signatures/approvals\",\n    human_connect_risk_3: \"Lookalike domains: fake sites often start with a harmless connect\",\n    human_connect_safe_1: \"Treat connect like sharing an identity: only do it on sites you recognize.\",\n    human_connect_next_1: \"Double-check the domain (spelling, HTTPS, no punycode)\",\n    human_connect_next_2: \"If unsure, cancel and open the site from a trusted bookmark\",\n    human_connect_reco_suspicious: \"Cancel and verify the URL in another way (bookmark/search), then try again.\",\n    human_connect_reco_ok: \"Continue only if you recognize the site and the URL looks right.\",\n    human_sign_whatIs: \"Creates a cryptographic signature. It usually does not cost gas, but it can authorize actions.\",\n    human_sign_risk_1: \"Signing unknown text can approve off-site actions or logins you didn't intend\",\n    human_sign_risk_2: \"Blind signing can hide what you're authorizing\",\n    human_typed_whatIs: \"Signs structured data (typed-data). Often used for permits/authorizations.\",\n    human_typed_risk_1: \"Typed-data may include token permits that behave like approvals\",\n    human_sign_safe_1: \"Prefer wallets that show clear human-readable signing details.\",\n    human_sign_next_1: \"Verify the site URL and read the message/typed-data carefully\",\n    human_sign_next_2: \"If you see vague prompts, cancel and ask the site for context\",\n    human_sign_reco_suspicious: \"Cancel. Suspicious domains + signature prompts are a common phishing pattern.\",\n    human_sign_reco_ok: \"Only continue if you understand what the signature is for and trust the site.\",\n    human_approve_whatIs: \"An approval lets a contract spend your tokens later (up to the approved amount).\",\n    human_approve_risk_1: \"Approvals can be abused if the spender contract is malicious or compromised\",\n    human_approve_risk_unlimited: \"Unlimited approval means it may spend ALL your token balance\",\n    human_approve_safe_1: \"Prefer approving the minimum needed amount whenever possible.\",\n    human_approve_next_1: \"Check the spender address/operator and whether you recognize the dApp\",\n    human_approve_next_2: \"Consider revoking approvals later if you no longer use the site\",\n    human_approve_reco: \"Continue only if you trust the site and the spender makes sense.\",\n    human_approve_reco_unlimited: \"Avoid unlimited approvals unless you strongly trust the site and understand the risk.\",\n    human_setApprovalForAll_whatIs: \"Gives an operator permission to move ALL NFTs in a collection on your behalf.\",\n    human_setApprovalForAll_risk_1: \"This can allow draining NFTs if the operator is malicious or compromised\",\n    human_setApprovalForAll_safe_1: \"Only approve operators you fully recognize (e.g., known marketplaces).\",\n    human_setApprovalForAll_next_1: \"Verify the operator address and confirm the site is the intended marketplace\",\n    human_setApprovalForAll_reco: \"Cancel unless you are on a recognized marketplace and expect this action.\",\n    human_tx_whatIs: \"This will create an on-chain transaction if you approve it in your wallet.\",\n    human_tx_risk_1: \"Transactions can move funds or change permissions depending on the contract call\",\n    human_tx_safe_1: \"Always verify recipient, value, and the contract you're interacting with.\",\n    human_tx_next_1: \"Check the destination (to), value, and decoded action (if available)\",\n    human_tx_reco_suspicious: \"Cancel. Do not send transactions from suspicious domains.\",\n    human_tx_reco_ok: \"Continue only if you intended this action and the details look correct.\",\n    human_chain_whatIs: \"Changes the selected network in your wallet.\",\n    human_chain_risk_1: \"Wrong networks/RPCs can mislead you about assets or transactions\",\n    human_chain_safe_1: \"Only switch/add networks you recognize.\",\n    human_chain_next_1: \"Confirm chain name and chainId in the wallet prompt\",\n    human_watchasset_whatIs: \"Adds a token/asset to your wallet UI for easier viewing.\",\n    human_watchasset_risk_1: \"Fake tokens can impersonate real ones\u2014verify contract address and symbol\",\n    human_watchasset_safe_1: \"Cross-check token details on a trusted explorer (e.g., Etherscan).\",\n    human_watchasset_next_1: \"Verify token contract address and decimals\",\n    human_watchasset_reco: \"Continue only if token details match an official source.\",\n    human_generic_whatIs: \"A site requested a wallet action. Review details carefully.\",\n    human_generic_risk_1: \"Unknown prompts can be part of phishing flows\",\n    human_generic_safe_1: \"If in doubt, cancel and verify the site.\",\n    human_generic_next_1: \"Check the URL and read the wallet prompt details\",\n    human_generic_reco: \"Continue only if you understand and expected this request.\",\n    human_revoke_link_text: \"Revoke permissions later: revoke.cash\",\n    trustReasonNotHttps: \"Not HTTPS (higher risk of spoofing/injection).\",\n    trustReasonManyHyphens: \"Many hyphens in the domain (common in lookalikes).\",\n    trustReasonSuspiciousKeywords: \"Domain contains high-risk keywords (login/verify/secure/...).\",\n    trustReasonBrandLookalike: \"Brand-like wording in domain but not the official domain.\",\n    trustReasonManySubdomains: \"Unusually deep subdomain structure.\",\n    trustReasonNoHost: \"Could not read the site hostname.\",\n    trustReasonAllowlistedVariant: \"Domain matches a trusted pattern.\",\n    trustReasonUnknown: \"No strong signals either way.\",\n    summary_ADD_CHAIN_1: \"The site wants to add a new network to your wallet.\",\n    summary_ADD_CHAIN_2: \"Carefully verify the chainId and network name.\",\n    summary_SIGN_MESSAGE_1: \"You are signing a message (not a transaction).\",\n    summary_SIGN_MESSAGE_2: \"Signatures can be used for logins/terms/permissions.\",\n    summary_SIGN_TYPED_DATA_1: \"You are signing structured data (EIP-712).\",\n    summary_SIGN_TYPED_DATA_2: \"This may authorize spending/orders depending on the content.\",\n    summary_SIGN_TYPED_DATA_3: \"Verify the spender/contract involved.\",\n    summary_SEND_TX_1: \"You are sending an on-chain transaction.\",\n    summary_SEND_TX_2: \"This may move ETH/tokens or interact with a contract.\",\n    summary_SEND_TX_3: \"Verify value, network and destination before confirming.\",\n    summary_WATCH_ASSET_1: \"The site wants to add a token/asset to your wallet.\",\n    summary_WATCH_ASSET_2: \"Verify the token symbol and contract address.\",\n    summary_SOLANA_1: \"Solana signature or transaction. Values will be confirmed in your wallet.\",\n    summary_UNKNOWN_1: \"The site is making an unknown wallet request.\",\n    summary_UNKNOWN_2: \"If you don't recognize it, cancel.\",\n\n    // Buttons / friction\n    btn_cancel: \"Cancel\",\n    btn_block: \"Block\",\n    btn_continue: \"Continue\",\n    toast_request_expired: \"Request expired. Please retry the action on the site.\",\n    simulation_tx_will_fail: \"THIS TRANSACTION WILL FAIL\",\n    btn_close: \"Close\",\n    btn_proceed_anyway: \"Proceed anyway\",\n    override_checkbox: \"I understand the risk and want to proceed\",\n    override_countdown: \"({s}s)\",\n\n    tip_revoke: \"Revoke permissions later: revoke.cash\",\n    cost_summary_title: \"Cost summary\",\n    costs_title: \"Costs and impact\",\n    impact_title: \"Impact\",\n    permission_for: \"Permission for\",\n    addr_marked_public: \"Flagged in public database\",\n    risk_title: \"Risk and why\",\n    what_to_do_now: \"What to do now\",\n    site_label: \"Site\",\n    network_label: \"Network\",\n    severity_BLOCKED: \"BLOCKED\",\n    severity_HIGH: \"HIGH\",\n    severity_WARN: \"WARNING\",\n    severity_LOW: \"LOW\",\n    cost_you_send: \"You send\",\n    cost_you_receive: \"You receive\",\n    cost_fee_only: \"fee only\",\n    cost_value: \"Value\",\n    cost_fee: \"Estimated fee\",\n    cost_total: \"Estimated total\",\n    cost_fee_unknown: \"A network fee will be charged (confirm in wallet)\",\n    network_switch_title: \"Network switch\",\n    network_current: \"Current network\",\n    network_requested: \"Requested network\",\n    trusted_domain_ref_title: \"Trusted domains (reference)\",\n    tx_cost_sending: \"You are sending {value} + network fee\",\n    tx_cost_gas_only: \"Even with no native currency sent, you will pay a network fee (gas)\",\n    gas_calculating: \"calculating\u2026\",\n\n    tx_destination: \"Destination\",\n    token_verified_uniswap: \"Token Verified (Uniswap List)\",\n    token_unknown_unverified: \"Token Unknown (Not Verified)\",\n    tx_contract_method: \"Contract/method\",\n    tx_max_gas_fee: \"Max gas fee\",\n    tx_max_total: \"Max total\",\n    tx_fee_estimated_by_wallet: \"The wallet will estimate the fee in the next step.\",\n\n    network_target: \"Target network\",\n    switch_no_gas: \"Switching networks usually costs NO gas.\",\n    switch_next_step_gas: \"The next step (purchase/transaction) will have a network fee.\",\n    switch_note_inline: \"Switching networks usually costs NO gas. The next step (purchase/transaction) will have a network fee.\",\n    sendtx_reco: \"Confirm in your wallet only if the details (value, network and contract) are correct.\",\n\n    // Risk/trust labels\n    risk_LOW: \"Low\",\n    risk_WARN: \"Warning\",\n    risk_HIGH: \"High\",\n    recommend_ALLOW: \"Allow\",\n    recommend_WARN: \"Warn\",\n    recommend_HIGH: \"High risk\",\n    recommend_BLOCK: \"Block\",\n    trust_unknown: \"Unknown\",\n    trust_suspicious: \"Suspicious\",\n    trust_likelyOfficial: \"Known domain (reference list)\",\n    trust_domainNotRecognized: \"Domain not recognized\",\n\n    // Phishing hard-block\n    phishing_hard_block: \"Domain is in a phishing blacklist. Blocked.\",\n\n    // Toasts\n    toast_extension_updated: \"Extension updated \u2014 reload the tab.\",\n    toast_cannot_analyze: \"Couldn't analyze. Reload the tab.\",\n\n    // Options page\n    optionsTitle: \"Crypto Wallet SignGuard \u2014 Settings\",\n    optionsSubtitle: \"Control when SignGuard should warn and block.\",\n    dashboardLink: \"Dashboard\",\n    onboardingTitle: \"How to use\",\n    onboardingHowTo: \"The extension intercepts sensitive requests (connect, sign, transaction) from injected wallets (window.ethereum / window.solana). When detected, it shows an overlay for you to review before the wallet opens.\",\n    onboardingWhatItDoes: \"Does: warns before connecting, signing, or sending; checks domain against phishing lists; shows transaction intent (swap, NFT, approval).\",\n    onboardingWhatItDoesNot: \"Does not: protect QR/WalletConnect connections; guarantee contracts are safe; replace manual verification.\",\n    onboardingLinkRevoke: \"revoke.cash \u2014 revoke permissions\",\n    onboardingLinkEtherscan: \"Etherscan \u2014 explore transactions\",\n    exportDebugRequiresDebugMode: \"Enable Debug Mode first to export events.\",\n    securityModeLabel: \"Security mode\",\n    securityModeDesc: \"Strict blocks more; Balanced warns; Relaxed reduces friction; Off disables blocking.\",\n    modeStrict: \"Strict\",\n    modeBalanced: \"Balanced\",\n    modeRelaxed: \"Relaxed\",\n    modeOff: \"Off\",\n    strictBlockApprovalsUnlimitedLabel: \"Strict: block unlimited approve\",\n    strictBlockApprovalsUnlimitedDesc: \"Blocks ERC20 unlimited approvals (MAX_UINT256).\",\n    strictBlockSetApprovalForAllLabel: \"Strict: block setApprovalForAll\",\n    strictBlockSetApprovalForAllDesc: \"Blocks permission to move all NFTs.\",\n    strictBlockPermitLikeLabel: \"Strict: block unlimited Permit\",\n    strictBlockPermitLikeDesc: \"Blocks Permit (EIP-2612) unlimited signatures.\",\n    assetEnrichmentEnabledLabel: \"Asset enrichment\",\n    assetEnrichmentEnabledDesc: \"Fetches token symbol/name via eth_call.\",\n    addressIntelEnabledLabel: \"Address threat intel\",\n    addressIntelEnabledDesc: \"Checks spender/operator/to against blacklist.\",\n    riskWarningsLabel: \"Risk warnings\",\n    riskWarningsDesc: \"Shows warnings and recommendations before opening your wallet.\",\n    connectOverlayLabel: \"Overlay on connect\",\n    connectOverlayDesc: \"Also show the overlay for connect/permissions requests.\",\n    blockHighRiskLabel: \"Block high risk\",\n    blockHighRiskDesc: \"Automatically blocks high-risk actions.\",\n    requireTypedOverrideLabel: \"Require override for typed data (high risk)\",\n    requireTypedOverrideDesc: \"For high-risk EIP-712 signatures, requires extra confirmation.\",\n    allowOverrideOnPhishingLabel: \"Allow override on phishing (NOT recommended)\",\n    allowOverrideOnPhishingDesc: \"If disabled (default), phishing blacklist matches are blocked with no option to proceed.\",\n    mode_off_reason: \"OFF mode: no blocking.\",\n    address_flagged_reason: \"Flagged address/contract: {label} ({category})\",\n    addr_sanctioned_block: \"Address is on a sanctions list.\",\n    addr_scam_reported_warn: \"Address marked as suspected/reported.\",\n    addr_phishing_reported_warn: \"Address marked as suspected/reported.\",\n    addr_malicious_contract_warn: \"Contract marked as malicious.\",\n    asset_info_reason: \"Asset: {sym} ({kind})\",\n    reason_permission_tokens: \"Permission to spend tokens\",\n    reason_permission_all_nfts: \"Permission to move ALL NFTs\",\n    reason_transfer_tokens: \"Token/NFT transfer\",\n    domainChecksLabel: \"Domain checks\",\n    domainChecksDesc: \"Warns about suspicious domain patterns when not on your allowlist.\",\n    allowlistLabel: \"Allowlist (trusted domains)\",\n    allowlistDesc: \"One domain per line. Example: opensea.io\",\n    vaultTitle: \"SignGuard Vault\",\n    vaultDesc: \"Contracts in this list can never be transacted without explicit unlock in options.\",\n    vaultAddLabel: \"Add contract to vault\",\n    vaultAddButton: \"Add to Vault\",\n    vaultListLabel: \"Locked contracts\",\n    vaultListEmpty: \"No contracts in vault.\",\n    vaultRemove: \"Remove\",\n    vaultInvalidAddress: \"Invalid address. Use 0x and 40 hex characters.\",\n    vaultAlreadyAdded: \"This contract is already in the vault.\",\n    vaultBlockedMessage: \"SignGuard: Asset Locked in Vault. Unlock in options to continue.\",\n    vaultBlockedTitle: \"Vault blocked this action\",\n    vaultBlockedReason: \"The contract/asset is in the Vault. Unlock temporarily to proceed.\",\n    vault_unlock_5min: \"Unlock 5 min\",\n    vault_unlock_30min: \"Unlock 30 min\",\n    vault_unlocked_toast: \"Unlocked for {n} min\",\n    overlay_temp_allow_10min: \"Allow for 10 min\",\n    overlay_temp_allow_toast: \"Allowed for 10 min\",\n    page_risk_warning: \"Possible risk detected on this page.\",\n    reason_page_risk_high: \"High-risk page detected (e.g. lookalike, clickjacking).\",\n    reason_page_risk_medium: \"Medium-risk page (e.g. suspicious phrases, overlay).\",\n    addSuggested: \"Add suggested\",\n    save: \"Save\",\n    saved: \"Saved\",\n\n    intelTitle: \"Threat Intel\",\n    intelSubtitle: \"Domain lists (pluggable sources) used in analysis.\",\n    intelTrustedCountLabel: \"Trusted domains\",\n    intelBlockedCountLabel: \"Blocked domains\",\n    intelBlockedAddressCountLabel: \"Blocked addresses\",\n    intelUpdatedAtLabel: \"Last update\",\n    intelUpdateNow: \"Update now\",\n    enableIntelLabel: \"Use Threat Intel\",\n    enableIntelDesc: \"Uses trusted/blocked domain lists in analysis.\",\n    customTrustedDomainsLabel: \"Trusted domains (custom list)\",\n    customTrustedDomainsDesc: \"One per line. Example: mysite.io\",\n    customBlockedDomainsLabel: \"Blocked domains (custom list)\",\n    customBlockedDomainsDesc: \"One per line. Always blocked.\",\n    exportListsLabel: \"Export lists\",\n\n    privacyLimitsTitle: \"Privacy & Limitations\",\n    privacyLimitsLine1: \"The extension does not access your seed phrase and has no custody.\",\n    privacyLimitsLine2: \"It analyzes domains and transaction data displayed by the browser for alerts. No 100% guarantee.\",\n    privacyLimitsLine3: \"Threat intel may be updated from public sources (optional).\",\n    cloudIntelOptInLabel: \"Allow external checks\",\n    cloudIntelOptInDesc: \"More protection; may send domain/addresses for validation (prepared for P1).\",\n    showUsdLabel: \"Show USD values\",\n    showUsdDesc: \"Converts native and token amounts to USD when available.\",\n    tabSettings: \"Settings\",\n    tabHistory: \"History\",\n    tabPlan: \"Plan\",\n    historySubtitle: \"Recent overlay decisions.\",\n    historyExport: \"Export JSON\",\n    historyClear: \"Clear\",\n    historyEmpty: \"No entries.\",\n    request_expired_toast: \"Request expired. Redo the action on the site and try again.\",\n    failopen_armed_banner: \"Analysis took too long. You can Continue anyway or Cancel.\",\n    decision_allow: \"Allowed\",\n    decision_block: \"Blocked\",\n    planSubtitle: \"Manage your plan and license.\",\n    planCurrent: \"Current plan\",\n    planLicenseKey: \"License key\",\n    planActivate: \"Activate\",\n    planGoPro: \"Subscribe PRO\",\n    // Options: Safety notes + debug\n    safetyNotesTitle: \"Limitations & security\",\n    safetyNotesLine1: \"This extension monitors requests from injected wallets (window.ethereum / window.solana).\",\n    safetyNotesLine2: \"Connections via QR/WalletConnect may not be intercepted. Always verify in your wallet.\",\n    safetyNotesLinkRevoke: \"revoke.cash\",\n    safetyNotesLinkEtherscan: \"etherscan.io\",\n    debugModeLabel: \"Debug mode\",\n    debugModeDesc: \"Stores the last 20 events (without large payloads) for support.\",\n    exportDebug: \"Export\",\n\n    // Overlay: intent + permission + copy\n    looks_like: \"Looks like:\",\n    intent_NFT_PURCHASE: \"NFT purchase\",\n    intent_SWAP: \"Swap\",\n    intent_APPROVAL: \"Permission\",\n    intent_SEND: \"Send\",\n    intent_UNKNOWN: \"Unknown\",\n    intent_ETH_TRANSFER: \"ETH transfer\",\n    intent_TOKEN_TRANSFER: \"Token transfer\",\n    intent_NFT_TRANSFER: \"NFT transfer\",\n    intent_CONTRACT_INTERACTION: \"Contract interaction\",\n    intent_SWITCH_CHAIN: \"Network switch\",\n    intent_ADD_CHAIN: \"Add network\",\n    intent_WATCH_ASSET: \"Add token\",\n    intent_SOLANA: \"Solana signature/transaction\",\n    intent_SIGNATURE: \"Signature\",\n    intent_TYPED_DATA: \"Typed data\",\n    wallet_label: \"Wallet\",\n    wallet_detecting: \"Detecting\u2026\",\n    wallet_evm_generic: \"EVM Wallet\",\n    trust_disclaimer: \"Reference list \u2260 guarantee. Scammers may use similar domains.\",\n    hint_wallet_popup: \"Your wallet should open now. If it doesn't, click the wallet icon and check for pending requests.\",\n    add_chain_network_label: \"Network to add\",\n    add_chain_rpc_label: \"RPC\",\n    watch_asset_token_label: \"Token to add\",\n    modeLabel: \"Mode:\",\n    popupPauseProtection: \"PAUSE PROTECTION\",\n    popupStatusProtected: \"Protected\",\n    popupStatusPaused: \"Paused\",\n    fortressModeLabel: \"FORTRESS MODE\",\n    fortressModeDesc: \"Blocks all token approvals except on trusted sites.\",\n    fortress_block_message: \"SignGuard Fortress: Approval blocked on unknown site. Disable Fortress mode to proceed.\",\n    honeypot_message: \"\uD83E\uDEA4 HONEYPOT: You can buy, but you will NOT be able to sell.\",\n    info_unavailable: \"Information unavailable.\",\n    explain_switch_short: \"The site is requesting a network (chain) switch in your wallet.\",\n    human_chain_reco: \"Continue only if you expected a network switch and it looks correct.\",\n    trustReasonAllowlisted: \"Domain is present in a trusted seed list.\",\n    trustReasonPhishingBlacklist: \"Domain is in a phishing blacklist (reference list).\",\n    fee_unknown_wallet_will_estimate: \"Fee: will be displayed by wallet\",\n    label_you_send: \"You send\",\n    label_fee_likely: \"Estimated fee (likely)\",\n    label_fee_max: \"Max fee (worst case)\",\n    label_total_likely: \"Total likely\",\n    label_total_max: \"Total max\",\n    fee_gt_value: \"The max fee is HIGHER than the value being sent. Make sure this is expected.\",\n    check_wallet_network_fee: \"You haven't seen the fee yet. Check the wallet 'Network fee' before confirming.\",\n    label_max_fee: \"Max fee\",\n    label_max_total: \"Max total\",\n    switch_summary_no_gas: \"Switching networks usually has no gas fee, but it changes which assets you see.\",\n    permission_title: \"Permission\",\n    permission_token_contract: \"Contract\",\n    permission_spender: \"Spender\",\n    permission_operator: \"Operator\",\n    permission_unlimited: \"Unlimited\",\n    approval_unlimited_detected: \"Unlimited approval detected\",\n    permit_signature_detected: \"Permit-style signature detected (may authorize token spending)\",\n    token_transfer_detected: \"Token transfer detected\",\n    nft_transfer_detected: \"NFT transfer detected\",\n    transfer_token_title: \"Token transfer\",\n    transfer_nft_title: \"NFT transfer\",\n    transfer_amount: \"Amount\",\n    transfer_token_id: \"Token ID\",\n    yes: \"Yes\",\n    no: \"No\",\n    copy: \"Copy\",\n    chainChangeTitle: \"Network switch/add request\",\n    watchAssetTitle: \"Add asset request\",\n\n    domainPunycodeReason: \"Domain uses punycode (xn--); verify the URL.\",\n    reason_high_gas: \"High gas fee relative to value.\",\n    reason_new_spender: \"New spender \u2014 verify.\",\n    reason_contract_target: \"Destination is a contract.\",\n    reason_known_bad_spender: \"Spender blocked.\",\n    reason_known_safe_spender: \"Spender on allowlist.\",\n    reason_unlimited_approval: \"Simulation: unlimited approval detected.\",\n    reason_set_approval_for_all: \"Simulation: ApprovalForAll (allows moving all NFTs).\",\n    reason_snap_invoke: \"Snaps can run code in your wallet. Confirm the source.\",\n    reason_sign_tx: \"Transaction signature without immediate send. May be used later for broadcast.\",\n    reason_raw_broadcast: \"Broadcast of already-signed transaction. No prior visual confirmation of content.\",\n    reason_read_permissions: \"The site is reading the permissions already granted to the wallet.\",\n    summary_title_snaps: \"Snaps / Wallet extensions\",\n    summary_title_read_permissions: \"Read permissions\",\n    summary_title_sign_tx: \"Transaction signature\",\n    summary_title_raw_tx: \"Signed transaction broadcast\",\n    summary_title_switch_chain: \"Switch network\",\n    domainDoubleDashReason: \"Domain contains double hyphen (suspicious).\",\n    domainNumberPatternReason: \"Domain with many numbers (common in phishing).\",\n    domainLookalikeReason: \"Possible lookalike of official domain {legit}.\",\n    suspiciousWebsitePatterns: \"Suspicious website patterns.\",\n    page_risk_suspicious_banner: \"\u26A0\uFE0F SignGuard: Suspicious Site Detected\",\n    connectTitle: \"Connect wallet\",\n    connectReason: \"The site wants to connect to your wallet.\",\n    walletRequestPermissionsTitle: \"Request permissions\",\n    walletRequestPermissionsReason: \"The site wants additional wallet permissions.\",\n    typedDataWarnReason: \"Structured data signature (EIP-712); may authorize actions.\",\n    signatureRequest: \"Signature request\",\n    rawSignWarnReason: \"Raw message signature; may authorize off-chain actions.\",\n    tokenApproval: \"Token approval\",\n    unlimitedApprovalReason: \"Unlimited approval detected (MAX_UINT256).\",\n    unlimitedApprovalDetected: \"Unlimited approval detected\",\n    nftOperatorApprovalReason: \"Permission to move ALL NFTs in the collection.\",\n    nftOperatorApproval: \"NFT operator approval\",\n    txPreview: \"Transaction preview\",\n    txWarnReason: \"On-chain transaction; verify value, destination and network.\",\n    unknownMethodReason: \"Unknown wallet method.\",\n    warningsDisabledReason: \"Warnings disabled in settings.\",\n    analyzing: \"Analyzing\u2026\",\n    analyzing_subtitle: \"Site \u2022 Method\",\n    analyzing_hint: \"Validating domain and estimating impact\",\n    fallback_partial_check: \"No full verification right now \u2014 review the details below before proceeding.\",\n    fallback_partial_verification: \"Partial verification now \u2014 review the details below before proceeding.\",\n    loading_base: \"Loading base\u2026\",\n    analyzerUnavailableTitle: \"Analyzer unavailable\",\n    analysis_unavailable: \"Analysis unavailable \u2014 verify in your wallet before continuing.\",\n    dados_parciais_title: \"Partial data \u2014 confirm in wallet\",\n    dados_parciais_subtitle: \"Showing what we could analyze. Verify details in your wallet before continuing.\",\n    risk_low: \"Low\",\n    risk_warn: \"Warning\",\n    risk_high: \"High\",\n    risk_block: \"Blocked\",\n    trustReasonAllowlistedMatched: \"Domain in allowlist: {matched}.\",\n    list_empty_domains: \"List empty. Open options to add trusted domains.\",\n    btn_open_options: \"Open options\",\n    default_human_switch_what: \"Switches the active network in your wallet (e.g. Ethereum \u2192 another network).\",\n    default_human_switch_risk: \"You may sign/transact on the wrong network if the switch is unexpected.\",\n    default_human_switch_safe: \"Confirm the requested network and that the site is correct.\",\n    default_human_switch_next: \"If correct, approve in the wallet. If something looks wrong, cancel.\",\n    default_human_contract_what: \"Sends a transaction to a contract (action within the dApp).\",\n    default_human_contract_risk: \"Actual cost may vary and the action may move assets/tokens via the contract.\",\n    default_human_contract_safe: \"Check destination (to), network, value and fee (Network fee) in the wallet.\",\n    default_human_contract_next: \"If details match, proceed. Otherwise, cancel.\",\n    default_human_eth_what: \"Sends ETH directly to an address.\",\n    default_human_eth_risk: \"Transfers are irreversible if the destination is wrong.\",\n    default_human_eth_safe: \"Verify the address and amount. Be wary of links/shorteners.\",\n    default_human_eth_next: \"Only confirm if you recognize the recipient.\",\n    default_human_typed_what: \"Off-chain signature (EIP-712). May authorize actions without paying gas.\",\n    default_human_typed_risk: \"May grant permissions/authorizations (e.g. permit/approval) depending on content.\",\n    default_human_typed_safe: \"Review what is being authorized (spender/operator) and the domain/contract.\",\n    default_human_typed_next: \"If unsure, cancel and verify on the dApp\u2019s official site.\",\n    default_human_generic_what: \"Action requested by the dApp.\",\n    default_human_generic_risk: \"If something doesn\u2019t make sense, cancel.\",\n    default_human_generic_safe: \"Confirm domain, network and details in the wallet.\",\n    default_human_generic_next: \"Proceed only if everything looks correct.\",\n    verdict_ok: \"OK\",\n    verdict_warn: \"Warning\",\n    verdict_high: \"High risk\",\n    verdict_block: \"Blocked\",\n    coverage_label: \"Coverage\",\n    coverage_limited: \"limited coverage\",\n    trusted_domain_ref_empty: \"Reference list has not loaded yet.\",\n    trusted_domain_ref_loading: \"Loading reference list\u2026\",\n    trusted_domain_ref_refresh: \"Update lists\",\n    trusted_domain_ref_view_more: \"View more\",\n    trusted_domains_loading: \"Loading reference list\u2026\",\n    trusted_domains_more: \"+{n}\",\n    trusted_domains_search_placeholder: \"Filter domains\u2026\",\n    trusted_domains_update_now: \"Update now\",\n    trusted_domains_auto_update: \"Updates automatically in options\",\n    banner_ok_no_known_threats: \"OK: no known scam/threat signals detected.\",\n    banner_block_known_threat: \"Blocked: known threat detected.\",\n    banner_local_verification: \"Caution: local verification (cache). Review the details below before proceeding.\",\n    banner_basic_verification: \"Caution: basic verification. Review the details carefully before proceeding.\",\n    list_site_reputation: \"Site reputation\",\n    list_site_trusted: \"Trusted\",\n    list_site_blocked: \"Blocked\",\n    list_site_unknown: \"Unknown\",\n    updated_x_hours: \"Base updated {n} hour(s) ago\",\n    updated_x_days: \"Base updated {n} day(s) ago\",\n    tip_check_wallet_details: \"Verify amount, network and fee in your wallet.\",\n    no_alerts_known: \"No known alerts were detected for this context.\",\n    still_review_wallet: \"Still, review in your wallet (value, network, destination and fee).\",\n    site_status_known: \"known reference\",\n    site_status_not_in_list: \"Site is not on the reference list\",\n    destination_contract: \"Contract\",\n    destination_wallet: \"Wallet\",\n    overlay_coverage_title: \"Security coverage\",\n    overlay_simulation_title: \"Simulation\",\n    overlay_address_intel_title: \"Address intel\",\n    btn_copy: \"Copy\",\n    btn_copy_json: \"Copy JSON\",\n    chain_not_recognized: \"Chain not recognized\",\n    simulation_skipped_caution: \"No simulation \u2014 validate with extra care.\",\n    toast_copied: \"Copied\",\n    btn_ver_menos: \"Show less\",\n  }\n};\n\nfunction format(template: string, params?: Record<string, string | number>) {\n  if (!params) return template;\n  return template.replace(/\\{(\\w+)\\}/g, (_m, k) => (k in params ? String(params[k]) : `{${k}}`));\n}\n\nexport function t(key: string, params?: Record<string, string | number>): string {\n  const loc = detectLocale();\n  const v = dict[loc]?.[key] || dict.en[key] || key;\n  const rendered = format(v, params);\n  if (rendered !== key) return rendered;\n\n  // Fallback (best-effort) for legacy chrome.i18n keys, if any.\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const c: any = (globalThis as any).chrome;\n    const msg = c?.i18n?.getMessage?.(key);\n    if (msg) return format(msg, params);\n  } catch {}\n\n  return rendered;\n}\n\nexport function safeT(key: string, params?: Record<string, string | number>): string {\n  const out = t(key, params);\n  if (out && out !== key) return out;\n  // Only treat as missing key when it looks like an i18n key (identifier)\n  if (/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(key)) {\n    return detectLocale() === \"pt\" ? \"Texto indispon\u00EDvel\" : \"Text unavailable\";\n  }\n  return key; // Already human-readable text, not a key\n}\n\n/** Check if key exists in dict or chrome.i18n. */\nexport function tHasKey(key: string): boolean {\n  if (!key || typeof key !== \"string\") return false;\n  const loc = detectLocale();\n  if (dict[loc]?.[key]) return true;\n  if (dict.en?.[key]) return true;\n  try {\n    const c: any = (globalThis as any).chrome;\n    if (c?.i18n?.getMessage?.(key)) return true;\n  } catch {}\n  return false;\n}\n\n/** Resolve key from dict or chrome.i18n; NEVER return the raw key. Returns \"\" if missing. */\nexport function tKey(key: string, params?: Record<string, string | number>): string {\n  const loc = detectLocale();\n  const v = dict[loc]?.[key] || dict.en[key];\n  if (v) return format(v, params || {});\n  try {\n    const c: any = (globalThis as any).chrome;\n    const msg = c?.i18n?.getMessage?.(key);\n    if (msg) return format(msg, params || {});\n  } catch {}\n  return \"\";\n}\n\nconst KEY_PATTERN = /^(explain_|human_|trustReason|label_|fee_|summary_|action_|intent_|permission_|reason_|add_chain_|watch_asset_|switch_|sendtx_|phishing_|recommend_|risk_|trust_|btn_|cost_|tx_|network_|more_|tech_|details_|overlay_|queue_|modeLabel|wallet_label|looks_like|info_unavailable|gas_calculating|check_wallet|dash|onboarding|options|exportDebug)/;\n\n/** If maybeKeyOrText looks like an i18n key, resolve it; else return literal. Never show raw keys. */\nexport function renderText(maybeKeyOrText: string, params?: Record<string, any>): string {\n  const s = String(maybeKeyOrText || \"\").trim();\n  if (!s) return s;\n  const looksLikeKey = KEY_PATTERN.test(s) || /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(s);\n  if (looksLikeKey) {\n    const resolved = tKey(s, params as Record<string, string | number>);\n    if (resolved) return resolved;\n    return detectLocale() === \"pt\" ? \"Texto indispon\u00EDvel\" : \"Text unavailable\";\n  }\n  return s;\n}\n\n", "export function clamp(n: number, a: number, b: number) {\n  return Math.max(a, Math.min(b, n));\n}\n\nexport function hostFromUrl(url: string): string {\n  try {\n    return new URL(url).hostname.toLowerCase();\n  } catch {\n    return \"\";\n  }\n}\n\nexport function normalizeDomainLine(s: string) {\n  return (s || \"\").trim().toLowerCase().replace(/^\\.+/, \"\").replace(/\\.+$/, \"\");\n}\n\nexport function isAllowlisted(host: string, allowlist: string[]) {\n  const h = (host || \"\").toLowerCase();\n  return allowlist.some((d) => {\n    const dom = normalizeDomainLine(d);\n    if (!dom) return false;\n    return h === dom || h.endsWith(\".\" + dom);\n  });\n}\n\n/** Normalize host for comparison: lowercase, trim trailing dot. Do NOT strip www when storing. */\nexport function normalizeHost(host: string): string {\n  return (host || \"\").toLowerCase().replace(/\\.+$/, \"\").trim();\n}\n\n/** Match host to domain: exact or subdomain. Do NOT use endsWith(domain) without dot. */\nexport function isHostMatch(host: string, domain: string): boolean {\n  const h = normalizeHost(host);\n  const d = (domain || \"\").toLowerCase().trim();\n  if (!d) return false;\n  return h === d || h.endsWith(\".\" + d);\n}\n\n/** Normalize address: lowercase 0x + 40 hex. Returns \"\" if invalid. */\nexport function normalizeAddress(addr: string): string {\n  const s = (addr || \"\").trim();\n  const hex = s.startsWith(\"0x\") ? s.slice(2) : s;\n  if (hex.length !== 40 || !/^[a-fA-F0-9]{40}$/.test(hex)) return \"\";\n  return \"0x\" + hex.toLowerCase();\n}\n\n/** Build cache key for token (chainId:addressLower). */\nexport function normalizeTokenKey(chainId: string, addr: string): string {\n  const a = normalizeAddress(addr);\n  const c = (chainId || \"\").toLowerCase().replace(/^0x/, \"\") || \"0\";\n  return `${c}:${a}`;\n}\n\nexport function isHexString(v: any): v is string {\n  return typeof v === \"string\" && /^0x[0-9a-fA-F]*$/.test(v);\n}\n\nexport function hexSelector(data: string) {\n  if (!isHexString(data) || data.length < 10) return null;\n  return data.slice(0, 10).toLowerCase();\n}\n\nexport function escapeHtml(s: any) {\n  const str = String(s ?? \"\");\n  return str\n    .replaceAll(\"&\", \"&amp;\")\n    .replaceAll(\"<\", \"&lt;\")\n    .replaceAll(\">\", \"&gt;\")\n    .replaceAll('\"', \"&quot;\")\n    .replaceAll(\"'\", \"&#039;\");\n}\n\n", "export type SGAction =\r\n  | \"CONNECT\"\r\n  | \"SWITCH_CHAIN\"\r\n  | \"ADD_CHAIN\"\r\n  | \"REQUEST_PERMISSIONS\"\r\n  | \"SIGN_MESSAGE\"\r\n  | \"SIGN_TYPED_DATA\"\r\n  | \"SEND_TX\"\r\n  | \"WATCH_ASSET\"\r\n  | \"SOLANA\"\r\n  | \"UNKNOWN\";\r\n\r\nexport function classifyByMethod(method: string): SGAction {\r\n  const m = String(method || \"\").toLowerCase().trim();\r\n\r\n  if (m === \"eth_requestaccounts\") return \"CONNECT\";\r\n  if (m === \"wallet_requestpermissions\" || m === \"wallet_getpermissions\") return \"REQUEST_PERMISSIONS\";\r\n  if (m === \"wallet_switchethereumchain\") return \"SWITCH_CHAIN\";\r\n  if (m === \"wallet_addethereumchain\") return \"ADD_CHAIN\";\r\n  if (m === \"wallet_watchasset\") return \"WATCH_ASSET\";\r\n  if (m.startsWith(\"solana:\")) return \"SOLANA\";\r\n\r\n  if (m === \"personal_sign\" || m === \"eth_sign\") return \"SIGN_MESSAGE\";\r\n  if (m === \"eth_signtypeddata\" || m === \"eth_signtypeddata_v3\" || m === \"eth_signtypeddata_v4\") return \"SIGN_TYPED_DATA\";\r\n\r\n  if (m === \"eth_sendtransaction\" || m === \"wallet_sendtransaction\") return \"SEND_TX\";\r\n\r\n  return \"UNKNOWN\";\r\n}\r\n\r\nexport function looksLikeTx(params: any): boolean {\r\n  const p0 = Array.isArray(params) ? params[0] : null;\r\n  if (!p0 || typeof p0 !== \"object\") return false;\r\n\r\n  const hasTo = typeof (p0 as any).to === \"string\" && (p0 as any).to.length > 0;\r\n  const hasFrom = typeof (p0 as any).from === \"string\" && (p0 as any).from.length > 0;\r\n  const hasDataOrValue = (\"data\" in (p0 as any)) || (\"value\" in (p0 as any));\r\n  return hasTo && hasFrom && hasDataOrValue;\r\n}\r\n\r\nexport function classifyAction(method: string, params: any): SGAction {\r\n  const a = classifyByMethod(method);\r\n  if (a !== \"UNKNOWN\") return a;\r\n  if (looksLikeTx(params)) return \"SEND_TX\";\r\n  return \"UNKNOWN\";\r\n}\r\n\r\n", "export function actionTitle(action: string): string {\r\n  switch (action) {\r\n    case \"CONNECT\": return \"Conectar carteira\";\r\n    case \"SWITCH_CHAIN\": return \"Trocar rede\";\r\n    case \"ADD_CHAIN\": return \"Adicionar rede\";\r\n    case \"REQUEST_PERMISSIONS\": return \"Conceder permiss\u00F5es\";\r\n    case \"SIGN_MESSAGE\": return \"Assinar mensagem\";\r\n    case \"SIGN_TYPED_DATA\": return \"Assinar mensagem (Typed Data)\";\r\n    case \"SEND_TX\": return \"Enviar transa\u00E7\u00E3o\";\r\n    case \"WATCH_ASSET\": return \"Adicionar token \u00E0 carteira\";\r\n    case \"SOLANA\": return \"Assinatura/Transa\u00E7\u00E3o Solana\";\r\n    default: return \"A\u00E7\u00E3o desconhecida\";\r\n  }\r\n}\r\n\r\nexport function simpleSummary(action: string): string[] {\r\n  switch (action) {\r\n    case \"SEND_TX\":\r\n      return [\r\n        \"Voc\u00EA est\u00E1 prestes a assinar/enviar uma transa\u00E7\u00E3o on-chain.\",\r\n        \"Confira valor, rede e o contrato antes de confirmar na carteira.\"\r\n      ];\r\n    case \"SWITCH_CHAIN\":\r\n      return [\r\n        \"O site pediu para trocar a rede da sua carteira.\",\r\n        \"Confira se a rede solicitada \u00E9 a esperada para esta a\u00E7\u00E3o.\"\r\n      ];\r\n    case \"CONNECT\":\r\n      return [\r\n        \"O site quer conectar \u00E0 sua carteira (como login).\",\r\n        \"Isso compartilha seu endere\u00E7o p\u00FAblico.\"\r\n      ];\r\n    case \"SIGN_MESSAGE\":\r\n    case \"SIGN_TYPED_DATA\":\r\n      return [\r\n        \"O site pediu uma assinatura.\",\r\n        \"Assinatura pode autorizar a\u00E7\u00F5es: leia o texto na carteira.\"\r\n      ];\r\n    default:\r\n      return [\r\n        \"N\u00E3o foi poss\u00EDvel classificar com seguran\u00E7a.\",\r\n        \"Se estiver em d\u00FAvida, cancele.\"\r\n      ];\r\n  }\r\n}\r\n\r\n", "export function weiToEthString(wei: bigint, decimals = 6): string {\r\n  const neg = wei < 0n;\r\n  const w = neg ? -wei : wei;\r\n  const ethInt = w / 1_000_000_000_000_000_000n;\r\n  const ethFrac = w % 1_000_000_000_000_000_000n;\r\n  const fracStrFull = ethFrac.toString().padStart(18, \"0\");\r\n  const frac = fracStrFull.slice(0, Math.max(0, decimals));\r\n  const s = decimals > 0 ? `${ethInt.toString()}.${frac}` : ethInt.toString();\r\n  return neg ? `-${s}` : s;\r\n}\r\n\r\nexport function hexToBigInt(x?: string): bigint {\r\n  if (!x) return 0n;\r\n  return BigInt(x);\r\n}\r\n", "/**\r\n * V2: Chain registry \u2014 native symbol and CoinGecko id for USD pricing.\r\n */\r\n\r\nexport type ChainInfo = {\r\n  chainIdHex: string;\r\n  name: string;\r\n  nativeSymbol: string;\r\n  coingeckoId: string;\r\n  rpcUrls: string[];\r\n};\r\n\r\nconst CHAINS: ChainInfo[] = [\r\n  { chainIdHex: \"0x1\", name: \"Ethereum\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://eth.llamarpc.com\"] },\r\n  { chainIdHex: \"0xa\", name: \"Optimism\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.optimism.io\"] },\r\n  { chainIdHex: \"0xa4b1\", name: \"Arbitrum One\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://arb1.arbitrum.io/rpc\"] },\r\n  { chainIdHex: \"0x2105\", name: \"Base\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.base.org\"] },\r\n  { chainIdHex: \"0x89\", name: \"Polygon\", nativeSymbol: \"MATIC\", coingeckoId: \"matic-network\", rpcUrls: [\"https://polygon-rpc.com\"] },\r\n  { chainIdHex: \"0x38\", name: \"BNB Smart Chain\", nativeSymbol: \"BNB\", coingeckoId: \"binancecoin\", rpcUrls: [\"https://bsc-dataseed.binance.org\"] },\r\n  { chainIdHex: \"0xa86a\", name: \"Avalanche C-Chain\", nativeSymbol: \"AVAX\", coingeckoId: \"avalanche-2\", rpcUrls: [\"https://api.avax.network/ext/bc/C/rpc\"] },\r\n  { chainIdHex: \"0xfa\", name: \"Fantom\", nativeSymbol: \"FTM\", coingeckoId: \"fantom\", rpcUrls: [\"https://rpc.ftm.tools\"] },\r\n  { chainIdHex: \"0x64\", name: \"Gnosis\", nativeSymbol: \"xDAI\", coingeckoId: \"xdai\", rpcUrls: [\"https://rpc.gnosischain.com\"] },\r\n  { chainIdHex: \"0xa4ec\", name: \"Celo\", nativeSymbol: \"CELO\", coingeckoId: \"celo\", rpcUrls: [\"https://forno.celo.org\"] },\r\n  { chainIdHex: \"0x82750\", name: \"Scroll\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://rpc.scroll.io\"] },\r\n  { chainIdHex: \"0xe708\", name: \"Linea\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://rpc.linea.build\"] },\r\n  { chainIdHex: \"0x144\", name: \"zkSync Era\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.era.zksync.io\"] },\r\n  { chainIdHex: \"0x2a\", name: \"zkSync\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.zksync.io\"] },\r\n  { chainIdHex: \"0x44d\", name: \"Polygon zkEVM\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://zkevm-rpc.com\"] },\r\n  { chainIdHex: \"0x13e31\", name: \"Polygon zkEVM (Chain 81489)\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://zkevm-rpc.com\"] },\r\n];\r\n\r\nconst byChainId = new Map<string, ChainInfo>();\r\nfor (const c of CHAINS) {\r\n  const id = c.chainIdHex.toLowerCase();\r\n  byChainId.set(id, c);\r\n  const num = id.startsWith(\"0x\") ? id : \"0x\" + id;\r\n  if (num !== id) byChainId.set(num, c);\r\n}\r\n\r\nexport function getChainInfo(chainIdHex: string | undefined): ChainInfo | null {\r\n  if (!chainIdHex) return null;\r\n  const id = String(chainIdHex).toLowerCase();\r\n  if (!id.startsWith(\"0x\")) return byChainId.get(\"0x\" + id) ?? null;\r\n  return byChainId.get(id) ?? null;\r\n}\r\n\r\nexport function getNativeSymbol(chainIdHex: string | undefined): string {\r\n  const info = getChainInfo(chainIdHex);\r\n  return info?.nativeSymbol ?? \"ETH\";\r\n}\r\n\r\nexport function getAllChains(): ChainInfo[] {\r\n  return [...CHAINS];\r\n}\r\n", "/**\r\n * Centralized runtime/storage wrappers to avoid \"Cannot read properties of undefined\"\r\n * and \"Extension context invalidated\" errors. Use in content and options scripts only.\r\n * Uses Port (long-lived) to reduce runtime.lastError / SW sleeping issues.\r\n */\r\n\r\nlet _port: chrome.runtime.Port | null = null;\r\n\r\nfunction hasRuntime(c: any): boolean {\r\n  try {\r\n    return !!(c?.runtime?.id && typeof c.runtime.sendMessage === \"function\");\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Retorna o chrome \"certo\" (o da extens\u00E3o) quando existir.\r\n * Alguns sites definem window.chrome sem runtime.id, ent\u00E3o N\u00C3O podemos priorizar globalThis.chrome cegamente.\r\n */\r\nfunction getChromeApi(): any | null {\r\n  const localChrome = typeof chrome !== \"undefined\" ? (chrome as any) : null;\r\n  if (hasRuntime(localChrome)) return localChrome;\r\n  const globalChrome = typeof globalThis !== \"undefined\" ? (globalThis as any).chrome : null;\r\n  if (hasRuntime(globalChrome)) return globalChrome;\r\n  return null;\r\n}\r\n\r\n/** Safe check: avoid crash when context invalidated. Use chrome da extens\u00E3o (runtime.id presente). */\r\nexport function canUseRuntime(): boolean {\r\n  try {\r\n    return !!getChromeApi();\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isRuntimeUsable(): boolean {\r\n  try {\r\n    return canUseRuntime();\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nconst CONTEXT_INVALID_TERMS = [\r\n  \"extension context invalidated\",\r\n  \"context invalidated\",\r\n  \"message port closed\",\r\n  \"receiving end does not exist\",\r\n  \"runtime.lastError\",\r\n];\r\n\r\nfunction isContextInvalidError(e: unknown): boolean {\r\n  const msg = String((e as Error)?.message ?? e ?? \"\").toLowerCase();\r\n  return CONTEXT_INVALID_TERMS.some((t) => msg.includes(t));\r\n}\r\n\r\nfunction getPort(): chrome.runtime.Port | null {\r\n  try {\r\n    const c = getChromeApi();\r\n    if (!c?.runtime?.connect) return null;\r\n    if (_port) return _port;\r\n    _port = c.runtime.connect({ name: \"sg_port\" });\r\n    _port?.onDisconnect.addListener(() => {\r\n      _port = null;\r\n      _portListenerInit = false;\r\n    });\r\n    return _port;\r\n  } catch {\r\n    _port = null;\r\n    return null;\r\n  }\r\n}\r\n\r\nconst _portPending = new Map<string, (r: any) => void>();\r\nlet _portListenerInit = false;\r\n\r\nfunction initPortListener() {\r\n  const p = getPort();\r\n  if (!p || _portListenerInit) return;\r\n  _portListenerInit = true;\r\n  p.onMessage.addListener((resp: any) => {\r\n    const cb = resp?.requestId != null ? _portPending.get(String(resp.requestId)) : undefined;\r\n    if (cb) {\r\n      _portPending.delete(String(resp.requestId));\r\n      try { cb(resp); } catch {}\r\n    }\r\n  });\r\n}\r\n\r\n/** Port-based request (preferred over sendMessage to avoid runtime.lastError). Sends PING via sendMessage first if port not yet connected (wakes SW). */\r\nexport function portRequest<T = any>(msg: unknown, timeoutMs = 2500): Promise<T | null> {\r\n  return new Promise((resolve) => {\r\n    (async () => {\r\n      try {\r\n        if (!_port) {\r\n          try {\r\n            await new Promise<void>((r) => {\r\n              const c = getChromeApi();\r\n              if (!c?.runtime?.sendMessage) return r();\r\n              c.runtime.sendMessage({ type: \"PING\" }, () => {\r\n                void (c?.runtime as { lastError?: { message?: string } })?.lastError;\r\n                r();\r\n              });\r\n              setTimeout(() => r(), 600);\r\n            });\r\n          } catch {\r\n            // ignore\r\n          }\r\n        }\r\n        const p = getPort();\r\n        if (!p) {\r\n          resolve(null);\r\n          return;\r\n        }\r\n        initPortListener();\r\n        const requestId = typeof crypto?.randomUUID === \"function\" ? crypto.randomUUID() : `sg_${Date.now()}_${Math.random().toString(36).slice(2)}`;\r\n        const payload = { ...(msg as object), requestId };\r\n\r\n        const timer = setTimeout(() => {\r\n          if (_portPending.has(requestId)) {\r\n            _portPending.delete(requestId);\r\n            resolve(null);\r\n          }\r\n        }, timeoutMs);\r\n\r\n        _portPending.set(requestId, (resp: any) => {\r\n          clearTimeout(timer);\r\n          resolve(resp != null ? (resp as T) : null);\r\n        });\r\n\r\n        try {\r\n          p.postMessage(payload);\r\n        } catch (e) {\r\n          clearTimeout(timer);\r\n          _portPending.delete(requestId);\r\n          resolve(null);\r\n        }\r\n      } catch {\r\n        resolve(null);\r\n      }\r\n    })();\r\n  });\r\n}\r\n\r\nconst DEFAULT_SEND_MS = 4000;\r\nconst RETRY_SEND_MS = 2500;\r\nconst LOG_PREFIX = \"[SignGuard]\";\r\n\r\nexport type SafeSendMessageOptions = {\r\n  timeoutMs?: number;\r\n  preferPort?: boolean;\r\n};\r\n\r\nfunction sendMessageOneAttempt<T>(msg: unknown, timeoutMs: number): Promise<T | null> {\r\n  return new Promise((resolve) => {\r\n    let settled = false;\r\n    const once = (value: T | null) => {\r\n      if (settled) return;\r\n      settled = true;\r\n      resolve(value);\r\n    };\r\n\r\n    const c = getChromeApi();\r\n    const rt = (() => {\r\n      try {\r\n        return c?.runtime ?? null;\r\n      } catch {\r\n        return null;\r\n      }\r\n    })();\r\n    if (!rt || !rt.id || typeof rt.sendMessage !== \"function\") {\r\n      once(null);\r\n      return;\r\n    }\r\n\r\n    const timer = setTimeout(() => {\r\n      once(null);\r\n    }, timeoutMs);\r\n\r\n    try {\r\n      rt.sendMessage(msg, (resp: T) => {\r\n        if (settled) return;\r\n        clearTimeout(timer);\r\n        try {\r\n          const err = (c?.runtime as any)?.lastError;\r\n          if (err) {\r\n            once(null);\r\n            return;\r\n          }\r\n          once(resp ?? null);\r\n        } catch {\r\n          once(null);\r\n        }\r\n      });\r\n    } catch (e) {\r\n      clearTimeout(timer);\r\n      // Production: no console.warn; keep only console.error in critical catch blocks\r\n      once(null);\r\n    }\r\n  });\r\n}\r\n\r\nexport function safeSendMessage<T = any>(msg: unknown, options?: number | SafeSendMessageOptions): Promise<T | null> {\r\n  const timeoutMs = typeof options === \"number\" ? options : (options?.timeoutMs ?? DEFAULT_SEND_MS);\r\n  const preferPort = typeof options === \"object\" && options?.preferPort === true;\r\n\r\n  if (preferPort) {\r\n    return portRequest<T>(msg, timeoutMs).then((r) => {\r\n      if (r != null && (r as any)?.ok !== false) return r as T;\r\n      return sendMessageOneAttempt<T>(msg, timeoutMs).then((res) => {\r\n        if (res != null) return res;\r\n        return sendMessageOneAttempt<T>(msg, RETRY_SEND_MS);\r\n      });\r\n    });\r\n  }\r\n\r\n  return sendMessageOneAttempt<T>(msg, timeoutMs).then((r) => {\r\n    if (r != null) return r;\r\n    return sendMessageOneAttempt<T>(msg, RETRY_SEND_MS);\r\n  });\r\n}\r\n\r\nexport type StorageResult<T> = { ok: true; data: T } | { ok: false; error: string };\r\n\r\nexport async function safeStorageGet<T = any>(keys: unknown): Promise<StorageResult<T>> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      const c = getChromeApi();\r\n      if (!c?.storage?.sync) {\r\n        resolve({ ok: false, error: \"storage_unavailable\" });\r\n        return;\r\n      }\r\n      c.storage.sync.get(keys as any, (items: T) => {\r\n        try {\r\n          const err = c.runtime?.lastError;\r\n          if (err) {\r\n            resolve({ ok: false, error: err.message || String(err) });\r\n            return;\r\n          }\r\n          resolve({ ok: true, data: items });\r\n        } catch (e) {\r\n          resolve({ ok: false, error: (e as Error)?.message || String(e) });\r\n        }\r\n      });\r\n    } catch (e) {\r\n      resolve({ ok: false, error: (e as Error)?.message || String(e) });\r\n    }\r\n  });\r\n}\r\n\r\nexport async function safeStorageSet(obj: Record<string, unknown>): Promise<StorageResult<true>> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      const c = getChromeApi();\r\n      if (!c?.storage?.sync) {\r\n        resolve({ ok: false, error: \"storage_unavailable\" });\r\n        return;\r\n      }\r\n      c.storage.sync.set(obj, () => {\r\n        try {\r\n          const err = c.runtime?.lastError;\r\n          if (err) {\r\n            resolve({ ok: false, error: err.message || String(err) });\r\n            return;\r\n          }\r\n          resolve({ ok: true, data: true });\r\n        } catch (e) {\r\n          resolve({ ok: false, error: (e as Error)?.message || String(e) });\r\n        }\r\n      });\r\n    } catch (e) {\r\n      resolve({ ok: false, error: (e as Error)?.message || String(e) });\r\n    }\r\n  });\r\n}\r\n\r\nexport async function safeLocalGet<T = any>(key: string): Promise<T | null> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      const c = getChromeApi();\r\n      if (!c?.storage?.local) {\r\n        resolve(null);\r\n        return;\r\n      }\r\n      c.storage.local.get(key, (r: Record<string, T>) => {\r\n        try {\r\n          const err = c.runtime?.lastError;\r\n          if (err) {\r\n            resolve(null);\r\n            return;\r\n          }\r\n          resolve(((r as any)?.[key] as T) ?? null);\r\n        } catch {\r\n          resolve(null);\r\n        }\r\n      });\r\n    } catch {\r\n      resolve(null);\r\n    }\r\n  });\r\n}\r\n\r\nexport async function safeLocalSet(obj: Record<string, unknown>): Promise<boolean> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      const c = getChromeApi();\r\n      if (!c?.storage?.local) {\r\n        resolve(false);\r\n        return;\r\n      }\r\n      c.storage.local.set(obj, () => {\r\n        try {\r\n          const err = c.runtime?.lastError;\r\n          resolve(!err);\r\n        } catch {\r\n          resolve(false);\r\n        }\r\n      });\r\n    } catch {\r\n      resolve(false);\r\n    }\r\n  });\r\n}\r\n\r\n/** Safe getURL - returns empty string if runtime unusable */\r\nexport function safeGetURL(path: string): string {\r\n  try {\r\n    const c = getChromeApi();\r\n    if (!c?.runtime?.getURL) return \"\";\r\n    return c.runtime.getURL(path);\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n", "/**\r\n * Page Risk Scanner \u2014 DOM-based heuristics for drainer/phishing detection.\r\n * Runs in content script context; does not require background.\r\n */\r\n\r\nexport type PageRiskLevel = \"LOW\" | \"MEDIUM\" | \"HIGH\";\r\n\r\nexport interface PageRiskResult {\r\n  riskScore: PageRiskLevel;\r\n  reasons: string[];\r\n}\r\n\r\n/** Web2 / major sites: skip all risk checks (no alerts). Hostname must end with one of these. */\r\nconst SAFE_DOMAINS: string[] = [\r\n  \"google.com\",\r\n  \"www.google.com\",\r\n  \"youtube.com\",\r\n  \"twitter.com\",\r\n  \"x.com\",\r\n  \"facebook.com\",\r\n  \"instagram.com\",\r\n  \"github.com\",\r\n  \"discord.com\",\r\n  \"linkedin.com\",\r\n  \"whatsapp.com\",\r\n  \"trello.com\",\r\n  \"notion.so\",\r\n];\r\n\r\n/** Domains considered \"safe\" for crypto \u2014 typo-squatting against these triggers HIGH. */\r\nconst SAFE_DOMAINS_LIST: string[] = [\r\n  \"opensea.io\",\r\n  \"uniswap.org\",\r\n  \"uniswap.com\",\r\n  \"metamask.io\",\r\n  \"metamask.com\",\r\n  \"etherscan.io\",\r\n  \"etherscan.com\",\r\n  \"pancakeswap.finance\",\r\n  \"pancakeswap.com\",\r\n  \"compound.finance\",\r\n  \"aave.com\",\r\n  \"ens.domains\",\r\n  \"rainbow.me\",\r\n  \"walletconnect.com\",\r\n  \"walletconnect.org\",\r\n  \"phantom.app\",\r\n  \"solana.com\",\r\n];\r\n\r\n/** Threshold: if edit distance (Levenshtein) <= this and host is not in safe list, treat as lookalike. */\r\nconst LEVENSHTEIN_LOOKALIKE_THRESHOLD = 2;\r\n\r\n/** Z-index above this is considered \"full-page overlay\" territory. */\r\nconst HIGH_Z_INDEX_THRESHOLD = 99990;\r\n\r\n/** Minimum area ratio (0\u20131) for an element to be considered \"covering\" the viewport. */\r\nconst COVER_RATIO_MIN = 0.7;\r\n\r\n/**\r\n * Levenshtein (edit) distance between two strings.\r\n */\r\nfunction levenshtein(a: string, b: string): number {\r\n  const an = a.length;\r\n  const bn = b.length;\r\n  if (an === 0) return bn;\r\n  if (bn === 0) return an;\r\n\r\n  const row0 = new Array<number>(bn + 1);\r\n  const row1 = new Array<number>(bn + 1);\r\n  for (let j = 0; j <= bn; j++) row0[j] = j;\r\n\r\n  for (let i = 1; i <= an; i++) {\r\n    row1[0] = i;\r\n    for (let j = 1; j <= bn; j++) {\r\n      const cost = a[i - 1] === b[j - 1] ? 0 : 1;\r\n      row1[j] = Math.min(\r\n        row1[j - 1] + 1,\r\n        row0[j] + 1,\r\n        row0[j - 1] + cost\r\n      );\r\n    }\r\n    for (let j = 0; j <= bn; j++) row0[j] = row1[j];\r\n  }\r\n  return row0[bn];\r\n}\r\n\r\n/**\r\n * Normalize hostname for comparison: lowercase, no www.\r\n */\r\nfunction normalizeHost(host: string): string {\r\n  return host\r\n    .toLowerCase()\r\n    .replace(/^www\\./, \"\")\r\n    .split(\"/\")[0]\r\n    .trim();\r\n}\r\n\r\n/**\r\n * Anti-spoofing: if current host is not in the safe list but is very similar\r\n * to one of them (typo-squat like 0pensea.io), return HIGH risk.\r\n */\r\nfunction checkLookalikeDomain(hostname: string): { highRisk: boolean; matchedSafe?: string } {\r\n  const host = normalizeHost(hostname);\r\n  if (!host) return { highRisk: false };\r\n\r\n  const exactMatch = SAFE_DOMAINS_LIST.some((d) => host === d || host.endsWith(\".\" + d));\r\n  if (exactMatch) return { highRisk: false };\r\n\r\n  for (const safe of SAFE_DOMAINS_LIST) {\r\n    const dist = levenshtein(host, safe);\r\n    if (dist > 0 && dist <= LEVENSHTEIN_LOOKALIKE_THRESHOLD) {\r\n      return { highRisk: true, matchedSafe: safe };\r\n    }\r\n  }\r\n  return { highRisk: false };\r\n}\r\n\r\n/**\r\n * Scan visible text for dangerous keyword combinations (same \"viewport\" = same innerText chunk).\r\n */\r\nfunction scanKeywordCombinations(text: string): boolean {\r\n  const lower = text.toLowerCase();\r\n  const hasClaim = /\\bclaim\\b/i.test(lower);\r\n  const hasAirdrop = /\\bairdrop\\b/i.test(lower);\r\n  const hasConnectWallet = /\\bconnect\\s+wallet\\b/i.test(lower) || /\\bconnect\\s+your\\s+wallet\\b/i.test(lower);\r\n  const hasMigration = /\\bmigration\\b/i.test(lower);\r\n  const hasEmergency = /\\bemergency\\b/i.test(lower);\r\n\r\n  if (hasClaim && hasAirdrop && hasConnectWallet) return true;\r\n  if (hasMigration && hasEmergency) return true;\r\n  return false;\r\n}\r\n\r\n/** Only treat as clickjacking if element is large (e.g. covering screen). Small invisible pixels ignored. */\r\nconst MIN_CLICKABLE_AREA_PX = 300 * 300; // 300x300px\r\nconst MIN_OPACITY_THRESHOLD = 0.1;\r\n\r\n/**\r\n * Detect invisible clickable elements (clickjacking: opacity near 0 but still receiving clicks).\r\n */\r\nexport function detectInvisibleClickables(doc: Document): boolean {\r\n  try {\r\n    const win = doc.defaultView;\r\n    if (!win) return false;\r\n\r\n    const candidates = doc.querySelectorAll(\"a, button, div[role='button']\");\r\n    for (let i = 0; i < candidates.length; i++) {\r\n      const el = candidates[i];\r\n      if (!(el instanceof HTMLElement)) continue;\r\n\r\n      const style = win.getComputedStyle(el);\r\n      if (!style) continue;\r\n\r\n      const opacity = parseFloat(style.opacity);\r\n      const pointerEvents = (style.pointerEvents || \"\").toLowerCase();\r\n      const isOpacityNearZero = !Number.isNaN(opacity) && opacity < MIN_OPACITY_THRESHOLD;\r\n      const hasRgbaZero =\r\n        (style.backgroundColor && /rgba?\\s*\\(\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*0\\s*\\)/.test(style.backgroundColor)) ||\r\n        (style.color && /rgba?\\s*\\(\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*0\\s*\\)/.test(style.color));\r\n      const acceptsClicks = pointerEvents === \"auto\" || pointerEvents === \"\";\r\n\r\n      if ((isOpacityNearZero || hasRgbaZero) && acceptsClicks) {\r\n        const rect = el.getBoundingClientRect();\r\n        const area = rect.width * rect.height;\r\n        if (area >= MIN_CLICKABLE_AREA_PX) return true;\r\n      }\r\n    }\r\n  } catch {\r\n    // cross-origin or restricted access\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Detect transparent or near-full-page iframes / high z-index overlays (clickjacking-style).\r\n */\r\nfunction detectSuspiciousOverlays(doc: Document): boolean {\r\n  try {\r\n    const viewportArea = (doc.defaultView?.innerWidth ?? 0) * (doc.defaultView?.innerHeight ?? 0);\r\n    if (viewportArea <= 0) return false;\r\n\r\n    const all = doc.querySelectorAll(\"iframe, div\");\r\n    for (let i = 0; i < all.length; i++) {\r\n      const el = all[i];\r\n      if (!(el instanceof HTMLElement)) continue;\r\n\r\n      const style = doc.defaultView?.getComputedStyle(el);\r\n      if (!style) continue;\r\n\r\n      const zIndex = parseInt(style.zIndex, 10);\r\n      const opacity = parseFloat(style.opacity);\r\n      const pointerEvents = style.pointerEvents;\r\n\r\n      const isHighZ = !Number.isNaN(zIndex) && zIndex >= HIGH_Z_INDEX_THRESHOLD;\r\n      const isTransparent = !Number.isNaN(opacity) && opacity < 0.1;\r\n      const isInvisibleButClicks = (isTransparent || style.visibility === \"hidden\") && pointerEvents !== \"none\";\r\n\r\n      if (el.tagName.toLowerCase() === \"iframe\") {\r\n        if (isTransparent || (isHighZ && opacity < 0.5)) {\r\n          const rect = el.getBoundingClientRect();\r\n          const area = rect.width * rect.height;\r\n          if (area >= viewportArea * COVER_RATIO_MIN) return true;\r\n        }\r\n      }\r\n\r\n      if (el.tagName.toLowerCase() === \"div\" && isHighZ) {\r\n        const rect = el.getBoundingClientRect();\r\n        const area = rect.width * rect.height;\r\n        if (area >= viewportArea * COVER_RATIO_MIN && (isTransparent || isInvisibleButClicks)) return true;\r\n      }\r\n    }\r\n  } catch {\r\n    // cross-origin or restricted access\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * True if hostname is a known Web2 / major site (whitelist). No risk scan runs.\r\n */\r\nfunction isWhitelistedDomain(hostname: string): boolean {\r\n  const host = normalizeHost(hostname);\r\n  if (!host) return false;\r\n  return SAFE_DOMAINS.some((d) => host === d || host.endsWith(\".\" + d));\r\n}\r\n\r\n/**\r\n * Run full page risk scan. Prefer calling when document.body is ready.\r\n * Returns immediately with SAFE (LOW, no reasons) for whitelisted domains.\r\n */\r\nexport function runPageRiskScan(doc: Document, hostname: string): PageRiskResult {\r\n  // Early exit: major Web2 sites \u2014 do not run any heuristics (no false positives).\r\n  if (isWhitelistedDomain(hostname)) {\r\n    return { riskScore: \"LOW\", reasons: [] };\r\n  }\r\n\r\n  const reasons: string[] = [];\r\n  let riskScore: PageRiskLevel = \"LOW\";\r\n\r\n  // 1) Lookalike domain \u2192 HIGH immediately\r\n  const lookalike = checkLookalikeDomain(hostname);\r\n  if (lookalike.highRisk) {\r\n    riskScore = \"HIGH\";\r\n    reasons.push(\r\n      lookalike.matchedSafe\r\n        ? `Domain looks like \"${lookalike.matchedSafe}\" but does not match (possible typo-squat).`\r\n        : \"Domain may be impersonating a known site.\"\r\n    );\r\n  }\r\n\r\n  // 2) Keyword combinations in body text \u2192 MEDIUM (only if not already HIGH)\r\n  try {\r\n    const bodyText = doc.body?.innerText ?? doc.documentElement?.innerText ?? \"\";\r\n    if (bodyText && scanKeywordCombinations(bodyText)) {\r\n      if (riskScore === \"LOW\") riskScore = \"MEDIUM\";\r\n      reasons.push(\"Page text contains risky phrases (e.g. claim + airdrop + connect wallet, or migration + emergency).\");\r\n    }\r\n  } catch {\r\n    // same-origin only\r\n  }\r\n\r\n  // 3) Suspicious overlay/iframe \u2192 elevate to MEDIUM or keep HIGH\r\n  if (detectSuspiciousOverlays(doc)) {\r\n    if (riskScore === \"LOW\") riskScore = \"MEDIUM\";\r\n    else if (riskScore === \"MEDIUM\") riskScore = \"HIGH\";\r\n    reasons.push(\"Page has a transparent or high z-index overlay covering most of the screen (possible clickjacking).\");\r\n  }\r\n\r\n  // 4) Invisible clickables (opacity < 0.1, pointer-events auto, area > 100x100) \u2192 HIGH\r\n  if (detectInvisibleClickables(doc)) {\r\n    riskScore = \"HIGH\";\r\n    reasons.push(\"HIDDEN_OVERLAY_DETECTED\");\r\n  }\r\n\r\n  return { riskScore, reasons };\r\n}\r\n\r\n/**\r\n * Note: When riskScore === \"HIGH\", the caller (e.g. content script) should report\r\n * the threat to telemetry via SG_TELEMETRY_THREAT so the backend can aggregate\r\n * security signals (opt-in only).\r\n */\r\n\r\n/**\r\n * Injects a fixed red warning bar at the top of the page.\r\n * Call only when riskScore === \"HIGH\". Uses inline styles so it works in any page context.\r\n */\r\nexport function injectPageRiskBanner(message: string, doc: Document): void {\r\n  try {\r\n    const id = \"signguard-page-risk-banner\";\r\n    if (doc.getElementById(id)) return;\r\n\r\n    const bar = doc.createElement(\"div\");\r\n    bar.id = id;\r\n    bar.setAttribute(\"role\", \"alert\");\r\n    bar.textContent = message;\r\n    Object.assign(bar.style, {\r\n      position: \"fixed\",\r\n      top: \"0\",\r\n      left: \"0\",\r\n      right: \"0\",\r\n      zIndex: \"999999\",\r\n      background: \"#b91c1c\",\r\n      color: \"#fff\",\r\n      padding: \"12px 20px\",\r\n      fontSize: \"16px\",\r\n      fontWeight: \"700\",\r\n      textAlign: \"center\",\r\n      fontFamily: \"ui-sans-serif, system-ui, sans-serif\",\r\n      boxShadow: \"0 2px 8px rgba(0,0,0,0.3)\",\r\n    } as CSSStyleDeclaration);\r\n\r\n    const root = doc.body ?? doc.documentElement;\r\n    root.insertBefore(bar, root.firstChild);\r\n  } catch {\r\n    // ignore if DOM not available or restricted\r\n  }\r\n}\r\n", "/**\n * P1-G: Standardized reason keys for analysis consistency.\n * Use these keys; i18n maps to human text where available.\n */\nexport const REASON_KEYS = {\n  NEW_DOMAIN: \"NEW_DOMAIN\",\n  KNOWN_BAD_DOMAIN: \"KNOWN_BAD_DOMAIN\",\n  KNOWN_SAFE_DOMAIN: \"KNOWN_SAFE_DOMAIN\",\n  UNLIMITED_APPROVAL: \"UNLIMITED_APPROVAL\",\n  SET_APPROVAL_FOR_ALL: \"SET_APPROVAL_FOR_ALL\",\n  PERMIT_GRANT: \"PERMIT_GRANT\",\n  PERMIT2_GRANT: \"PERMIT2_GRANT\",\n  HIGH_VALUE_TRANSFER: \"HIGH_VALUE_TRANSFER\",\n  NEW_SPENDER: \"NEW_SPENDER\",\n  FRESH_DEPLOY: \"FRESH_DEPLOY\",\n  SIM_FAILED: \"SIM_FAILED\",\n  TOKEN_LOW_CONFIDENCE: \"TOKEN_LOW_CONFIDENCE\",\n  ADDRESS_BLOCKLIST: \"ADDRESS_BLOCKLIST\",\n  KNOWN_BAD_SPENDER: \"KNOWN_BAD_SPENDER\",\n  KNOWN_SAFE_SPENDER: \"KNOWN_SAFE_SPENDER\",\n  TOKEN_SCAM: \"TOKEN_SCAM\",\n  PHISHING: \"PHISHING\",\n  PUNYCODE_DOMAIN: \"PUNYCODE_DOMAIN\",\n  LOOKALIKE: \"LOOKALIKE\",\n  NFT_PURCHASE: \"NFT_PURCHASE\",\n  TOKEN_SWAP: \"TOKEN_SWAP\",\n  MARKETPLACE_SIGNATURE: \"MARKETPLACE_SIGNATURE\",\n  MARKETPLACE_LISTING: \"MARKETPLACE_LISTING\",\n  HIGH_GAS: \"HIGH_GAS\",\n  CONTRACT_TARGET: \"CONTRACT_TARGET\",\n  VAULT_LOCKED: \"VAULT_LOCKED\",\n  SPENDER_DENYLIST: \"SPENDER_DENYLIST\",\n  SPENDER_ALLOWLIST: \"SPENDER_ALLOWLIST\",\n  PAGE_RISK_HIGH: \"PAGE_RISK_HIGH\",\n  PAGE_RISK_MEDIUM: \"PAGE_RISK_MEDIUM\",\n  FAILMODE_FALLBACK: \"FAILMODE_FALLBACK\",\n  SIMULATION_TIMEOUT: \"SIMULATION_TIMEOUT\",\n  SNAP_INVOKE: \"SNAP_INVOKE\",\n  REQUEST_SNAPS: \"REQUEST_SNAPS\",\n  SIGN_TRANSACTION: \"SIGN_TRANSACTION\",\n  RAW_TX_BROADCAST: \"RAW_TX_BROADCAST\",\n  READ_PERMISSIONS: \"READ_PERMISSIONS\",\n} as const;\n\nexport type ReasonKey = (typeof REASON_KEYS)[keyof typeof REASON_KEYS];\n", "// ARQUIVO: src/content.ts\nimport type { AnalyzeRequest, Analysis, Settings, CheckResult, TxCostPreview, FeeEstimateWire, DecisionMeta } from \"./shared/types\";\nimport { DEFAULT_SETTINGS } from \"./shared/types\";\nimport { shouldGateUI } from \"./shared/uiGate\";\nimport { SUGGESTED_TRUSTED_DOMAINS } from \"./shared/constants\";\nimport { selectorToLabel } from \"./shared/signatures\";\nimport { t } from \"./i18n\";\nimport { clamp, escapeHtml } from \"./shared/utils\";\nimport { normMethod } from \"./shared/normalize\";\nimport { classifyAction, type SGAction } from \"./shared/classifyAction\";\nimport { actionTitle, simpleSummary } from \"./shared/actionTexts\";\nimport { extractTx } from \"./shared/txExtract\";\nimport { ingestRpc, hasRecentSwitch, newFlowState, type FlowState } from \"./shared/flowTracker\";\nimport { hexToBigInt, weiToEthString } from \"./shared/txMath\";\nimport { weiToEthString as weiToEthFmt } from \"./format\";\nimport { getNativeSymbol, getChainInfo } from \"./shared/chains\";\nimport {\n  isRuntimeUsable,\n  safeSendMessage,\n  safeStorageGet,\n  safeGetURL,\n  safeLocalGet,\n  safeLocalSet,\n} from \"./runtimeSafe\";\nimport { runPageRiskScan, injectPageRiskBanner, type PageRiskResult } from \"./risk/domScanner\";\nimport { REASON_KEYS } from \"./shared/reasonKeys\";\n\nconst IS_TOP_FRAME = (() => {\n  try {\n    return typeof window !== \"undefined\" && window.top === window;\n  } catch {\n    return true;\n  }\n})();\nconsole.log(\"[SignGuard Content] loaded\", { top: IS_TOP_FRAME, href: location.href });\n\n/** Page risk scan result (run on init); attached to ANALYZE meta when available. */\nlet __sgPageRiskResult: PageRiskResult | null = null;\n\n/** CustomEvent name for decision (synchronous \u2192 preserves user activation for MetaMask). */\nconst SG_DECISION_EVENT = \"__sg_decision__\";\n\n/** Cache de preflight (SG_PREVIEW) por requestId \u2014 pode chegar antes do SG_REQUEST. */\nconst __sgPreflightCache = new Map<string, { chainIdHex?: string; txCostPreview?: TxCostPreview }>();\n\n/** P1-7: Dedupe Map \u2014 key -> entry; duplicates attach to same entry, get same decision. */\ntype DedupeEntry = { primaryRequestId: string; requestIds: Set<string>; addedAt: number };\nconst __sgDedupeMap = new Map<string, DedupeEntry>();\nconst DEDUPE_MS = 3000;\n\n/** Top-frame overlay broker: iframe waits for SG_RELAY_DECISION; timeout 15s then fail-open/fail-closed or overlay local. */\nconst RELAY_TIMEOUT_MS = 15000;\nconst relayPending = new Map<string, { timeoutId: ReturnType<typeof setTimeout> }>();\n\nfunction stableStringifyParams(val: unknown): string {\n  if (val === null) return \"null\";\n  if (val === undefined) return \"undefined\";\n  if (typeof val !== \"object\") return String(val);\n  if (Array.isArray(val)) return \"[\" + val.map(stableStringifyParams).join(\",\") + \"]\";\n  const obj = val as Record<string, unknown>;\n  const keys = Object.keys(obj).sort();\n  return \"{\" + keys.map((k) => JSON.stringify(k) + \":\" + stableStringifyParams(obj[k])).join(\",\") + \"}\";\n}\n\n/** M\u00E9todos RPC permitidos para encaminhamento ao mainWorld (background -> content -> mainWorld). */\nconst RPC_ALLOWED = new Set([\"eth_call\", \"eth_chainid\", \"eth_getcode\", \"eth_getblockbynumber\", \"eth_getlogs\", \"eth_estimategas\"]);\n\n/** P1: Read-only methods \u2192 auto ALLOW without overlay; still logged to diagnosis. */\nconst AUTO_ALLOW_METHODS = new Set([\"wallet_getPermissions\"]);\n\n/** Cache para allowance atual: key -> { value, ts }. TTL 15s. */\nconst __allowanceCache = new Map<string, { value: string; ts: number }>();\nconst ALLOWANCE_CACHE_TTL_MS = 15000;\n\nfunction padAddr(addr: string): string {\n  const a = String(addr).toLowerCase().replace(/^0x/, \"\");\n  return a.padStart(64, \"0\");\n}\n\nfunction encodeAllowanceCall(token: string, owner: string, spender: string): { to: string; data: string } {\n  return {\n    to: token,\n    data: \"0xdd62ed3e\" + padAddr(owner) + padAddr(spender),\n  };\n}\n\nfunction encodeIsApprovedForAllCall(token: string, owner: string, operator: string): { to: string; data: string } {\n  return {\n    to: token,\n    data: \"0xe985e9c5\" + padAddr(owner) + padAddr(operator),\n  };\n}\n\nfunction decodeUint256Hex(hex: string): bigint {\n  try {\n    const h = String(hex || \"\").replace(/^0x/, \"\");\n    if (h.length < 64) return 0n;\n    return BigInt(\"0x\" + h);\n  } catch {\n    return 0n;\n  }\n}\n\nfunction decodeBoolHex(hex: string): boolean {\n  try {\n    const h = String(hex || \"\").replace(/^0x/, \"\");\n    if (h.length < 64) return false;\n    return BigInt(\"0x\" + h.slice(-64)) !== 0n;\n  } catch {\n    return false;\n  }\n}\n\nasync function fetchCurrentAllowance(\n  chainIdHex: string | null | undefined,\n  token: string,\n  owner: string,\n  spender: string,\n  isNft: boolean\n): Promise<string | null> {\n  if (!token || !owner || !spender || !/^0x[a-fA-F0-9]{40}$/.test(token) || !/^0x[a-fA-F0-9]{40}$/.test(owner) || !/^0x[a-fA-F0-9]{40}$/.test(spender))\n    return null;\n  const key = `${chainIdHex ?? \"\"}:${token}:${owner}:${spender}:${isNft}`;\n  const cached = __allowanceCache.get(key);\n  if (cached && Date.now() - cached.ts < ALLOWANCE_CACHE_TTL_MS) return cached.value;\n\n  const { to, data } = isNft\n    ? encodeIsApprovedForAllCall(token, owner, spender)\n    : encodeAllowanceCall(token, owner, spender);\n  try {\n    const timeoutMs = 1500;\n    const res = await Promise.race([\n      rpcViaMainWorld(\"eth_call\", [{ to, data }]),\n      new Promise<never>((_, rej) => setTimeout(() => rej(new Error(\"timeout\")), timeoutMs)),\n    ]);\n    if (!res || typeof res !== \"object\" || !(res as { ok?: boolean }).ok) return null;\n    const result = (res as { result?: string }).result;\n    if (typeof result !== \"string\") return null;\n    const MAX_U256 = 2n ** 256n - 1n;\n    const value = isNft\n      ? decodeBoolHex(result)\n        ? (t(\"overlay_allowance_approved\") || \"Aprovado\")\n        : (t(\"overlay_allowance_not_approved\") || \"N\u00E3o aprovado\")\n      : (() => {\n          const v = decodeUint256Hex(result);\n          return v >= MAX_U256 ? (t(\"overlay_allowance_unlimited\") || \"Ilimitado\") : v.toString();\n        })();\n    __allowanceCache.set(key, { value, ts: Date.now() });\n    return value;\n  } catch {\n    return null;\n  }\n}\n\nfunction rpcViaMainWorld(method: string, params: any[]): Promise<{ ok: boolean; result?: any; error?: string }> {\n  return new Promise((resolve) => {\n    const requestId = typeof crypto?.randomUUID === \"function\" ? crypto.randomUUID() : `rpc_${Date.now()}_${Math.random().toString(36).slice(2)}`;\n    const timeout = setTimeout(() => {\n      window.removeEventListener(\"message\", handler);\n      resolve({ ok: false, error: \"timeout\" });\n    }, 2000);\n    const handler = (ev: MessageEvent) => {\n      if (ev.source !== window || ev.data?.source !== \"signguard-mainworld\" || ev.data?.type !== \"SG_RPC_CALL_RES\" || ev.data?.requestId !== requestId) return;\n      clearTimeout(timeout);\n      window.removeEventListener(\"message\", handler);\n      resolve({ ok: ev.data.ok ?? false, result: ev.data.result, error: ev.data.error });\n    };\n    window.addEventListener(\"message\", handler);\n    window.postMessage({ source: \"signguard-content\", type: \"SG_RPC_CALL_REQ\", requestId, method, params: params ?? [] }, \"*\");\n  });\n}\n\nchrome.runtime.onMessage.addListener((msg: any, _sender, sendResponse) => {\n  if (msg?.type !== \"SG_RPC_CALL_REQUEST\") return false;\n  const method = msg?.method ?? msg?.payload?.method;\n  const params = msg?.params ?? msg?.payload?.params ?? [];\n  if (!method || !RPC_ALLOWED.has(String(method).toLowerCase())) {\n    sendResponse({ ok: false, error: \"method_not_allowed\" });\n    return false;\n  }\n  rpcViaMainWorld(String(method), Array.isArray(params) ? params : []).then((r) => {\n    sendResponse(r);\n  });\n  return true;\n});\n\nfunction sendDecisionToMainWorld(requestId: string, allow: boolean, meta?: DecisionMeta) {\n  const detail = { type: \"SG_DECISION\" as const, requestId, allow, meta };\n  window.dispatchEvent(new CustomEvent(SG_DECISION_EVENT, { detail }));\n  window.postMessage({ source: \"signguard-content\", type: \"SG_DECISION\", requestId, allow, meta }, \"*\");\n}\n\n/** Normalize chainId to hex (e.g. 1 -> \"0x1\", \"0x1\" -> \"0x1\"). Returns null if invalid. */\nfunction toChainIdHex(chainId: string | number | null | undefined): string | null {\n  if (chainId == null || chainId === \"\") return null;\n  const s = String(chainId).trim();\n  if (s.toLowerCase().startsWith(\"0x\")) return s;\n  const n = parseInt(s, 10);\n  if (!Number.isFinite(n) || n < 0) return null;\n  return \"0x\" + n.toString(16);\n}\n\n/** Infer host from URL (strip www.). */\nfunction inferHost(url: string): string {\n  try {\n    const u = new URL(url);\n    let h = u.hostname || \"\";\n    if (h.toLowerCase().startsWith(\"www.\")) h = h.slice(4);\n    return h;\n  } catch {\n    return \"\";\n  }\n}\n\n// --- UTILS ---\nfunction showToast(text: string) {\n  try {\n    const el = document.createElement(\"div\");\n    el.className = \"sg-toast\";\n    el.textContent = text;\n    document.documentElement.appendChild(el);\n    setTimeout(() => el.remove(), 2500);\n  } catch {}\n}\n\nlet __sgSettings: Settings | null = null;\nconst __sgNativeUsd: Record<string, { usd: number; symbol: string }> = {};\n\nfunction loadSettings(): Promise<void> {\n  return new Promise((resolve) => {\n    try {\n      if (typeof chrome !== \"undefined\" && chrome.storage?.sync?.get) {\n        chrome.storage.sync.get(DEFAULT_SETTINGS, (r: Record<string, unknown>) => {\n          __sgSettings = (r && typeof r === \"object\" ? r : DEFAULT_SETTINGS) as Settings;\n          resolve();\n        });\n      } else {\n        __sgSettings = DEFAULT_SETTINGS;\n        resolve();\n      }\n    } catch {\n      __sgSettings = DEFAULT_SETTINGS;\n      resolve();\n    }\n  });\n}\n\nfunction fetchNativeUsdAndRerender(chainIdHex: string | null) {\n  if (!chainIdHex) return;\n  const key = String(chainIdHex).toLowerCase();\n  if (__sgNativeUsd[key]) return;\n  safeSendMessage<{ ok?: boolean; usdPerNative?: number; nativeSymbol?: string }>({\n    type: \"SG_GET_NATIVE_USD\",\n    payload: { chainIdHex },\n  }).then((res) => {\n    if (res?.ok && res.usdPerNative != null) {\n      __sgNativeUsd[key] = { usd: res.usdPerNative, symbol: res.nativeSymbol ?? getNativeSymbol(chainIdHex) };\n      if (__sgOverlay) updateOverlay(__sgOverlay);\n    }\n  }).catch(() => {});\n}\n\nfunction tryCopy(text: string): boolean {\n  try {\n    if (navigator.clipboard?.writeText) {\n      navigator.clipboard.writeText(text);\n      showToast(typeof t === \"function\" ? (t(\"toast_copied\") || \"Copied\") : \"Copied\");\n      return true;\n    }\n  } catch {}\n  return false;\n}\n\n/** Structured \"Mais explica\u00E7\u00F5es\" HTML: O que isso faz / Riscos / Notas de seguran\u00E7a / Pr\u00F3ximos passos. */\nfunction renderMoreExplanationsHtml(action: SGAction, isContractInteraction: boolean): string {\n  const what = t(\"more_whatItDoes\") || \"O que isso faz\";\n  const risks = t(\"more_risks\") || \"Riscos\";\n  const safe = t(\"more_safeNotes\") || \"Notas de seguran\u00E7a\";\n  const next = t(\"more_nextSteps\") || \"Pr\u00F3ximos passos\";\n\n  let whatItems: string[];\n  let riskItems: string[];\n  let safeItems: string[];\n  let nextItems: string[];\n\n  if (isContractInteraction || action === \"SEND_TX\") {\n    whatItems = [t(\"default_human_contract_what\") || \"Envia uma transa\u00E7\u00E3o para um contrato (a\u00E7\u00E3o dentro do dApp).\"];\n    riskItems = [t(\"default_human_contract_risk\") || \"O custo real pode variar e a a\u00E7\u00E3o pode mover ativos/tokens via contrato.\"];\n    safeItems = [t(\"default_human_contract_safe\") || \"Confira destino (to), rede, valor e a taxa (Network fee) na carteira.\"];\n    nextItems = [t(\"default_human_contract_next\") || \"Se os detalhes baterem, prossiga. Caso contr\u00E1rio, cancele.\"];\n  } else if (action === \"SWITCH_CHAIN\" || action === \"ADD_CHAIN\") {\n    whatItems = [t(\"explain_switch_why\") || \"Alguns sites exigem uma rede espec\u00EDfica para funcionar.\"];\n    riskItems = [t(\"switch_note_inline\") || \"Trocar rede normalmente n\u00E3o custa gas.\"];\n    safeItems = [t(\"default_human_generic_safe\") || \"Confirme dom\u00EDnio, rede e detalhes na carteira.\"];\n    nextItems = [t(\"human_connect_next_2\") || \"Confirme se a rede solicitada \u00E9 a esperada. Se n\u00E3o, cancele.\"];\n  } else if (action === \"SIGN_MESSAGE\" || action === \"SIGN_TYPED_DATA\") {\n    whatItems = [t(\"human_sign_whatIs\") || \"Cria uma assinatura criptogr\u00E1fica. Geralmente n\u00E3o custa gas, mas pode autorizar a\u00E7\u00F5es.\"];\n    riskItems = [t(\"human_sign_risk_1\") || \"Assinar textos desconhecidos pode autorizar a\u00E7\u00F5es/login que voc\u00EA n\u00E3o pretendia.\"];\n    safeItems = [t(\"human_sign_safe_1\") || \"Prefira carteiras que mostrem detalhes de assinatura de forma leg\u00EDvel.\"];\n    nextItems = [t(\"human_sign_next_1\") || \"Verifique a URL e leia a mensagem/typed-data com aten\u00E7\u00E3o.\"];\n  } else if (action === \"CONNECT\") {\n    whatItems = [t(\"human_connect_whatIs\") || \"Conecta seu endere\u00E7o de carteira a este site (como um login).\"];\n    riskItems = [t(\"human_connect_risk_1\") || \"Privacidade/rastreamento: pode vincular seu endere\u00E7o a este site.\"];\n    safeItems = [t(\"human_connect_safe_1\") || \"Trate connect como compartilhar identidade: fa\u00E7a isso s\u00F3 em sites que voc\u00EA reconhece.\"];\n    nextItems = [t(\"human_connect_next_1\") || \"Confira o dom\u00EDnio (ortografia, HTTPS, sem punycode).\"];\n  } else {\n    whatItems = [t(\"default_human_generic_what\") || \"A\u00E7\u00E3o solicitada pela dApp.\"];\n    riskItems = [t(\"default_human_generic_risk\") || \"Se algo n\u00E3o fizer sentido, cancele.\"];\n    safeItems = [t(\"default_human_generic_safe\") || \"Confirme dom\u00EDnio, rede e detalhes na carteira.\"];\n    nextItems = [t(\"default_human_generic_next\") || \"Prossiga apenas se tudo estiver correto.\"];\n  }\n\n  const ul = (items: string[]) =>\n    `<ul><li>${items.map((x) => escapeHtml(x)).join(\"</li><li>\")}</li></ul>`;\n  return (\n    `<p><strong>${escapeHtml(what)}</strong></p>${ul(whatItems)}` +\n    `<p><strong>${escapeHtml(risks)}</strong></p>${ul(riskItems)}` +\n    `<p><strong>${escapeHtml(safe)}</strong></p>${ul(safeItems)}` +\n    `<p><strong>${escapeHtml(next)}</strong></p>${ul(nextItems)}`\n  );\n}\n\n// --- HELPERS DE UI ---\nfunction getRiskColor(level: string): string {\n  if (level === \"HIGH\" || level === \"CRITICAL\" || level === \"BLOCK\") return \"#ef4444\"; // Red\n  if (level === \"WARN\") return \"#f59e0b\"; // Orange\n  return \"#22c55e\"; // Green\n}\n\nfunction renderAssetChanges(changes: Array<{ type: \"OUT\" | \"IN\"; amount: string; symbol: string }>): string {\n  if (!changes || changes.length === 0)\n    return `<div style=\"opacity:0.6; font-size:12px;\">${escapeHtml(t(\"simulation_no_changes\") || \"Nenhuma mudan\u00E7a de saldo detetada.\")}</div>`;\n  return changes\n    .map(\n      (c) => `\n    <div style=\"display:flex; justify-content:space-between; font-size:13px; margin-bottom:4px; padding:4px; background:rgba(255,255,255,0.05); border-radius:4px;\">\n      <span style=\"color:${c.type === \"OUT\" ? \"#ef4444\" : \"#22c55e\"}\">${c.type === \"OUT\" ? \"\uD83D\uDCE4 Sai\" : \"\uD83D\uDCE5 Entra\"}</span>\n      <span>${escapeHtml(c.amount)} <b>${escapeHtml(c.symbol)}</b></span>\n    </div>\n  `\n    )\n    .join(\"\");\n}\n\n/** UX human-readable panel per request type (CONNECT, ADD_CHAIN, WATCH_ASSET, etc.). */\nfunction renderTypeSpecificPanel(\n  action: SGAction,\n  meta: { host: string; method: string; params?: any; chainIdHex?: string | null; chainIdRequested?: string },\n  analysis: Analysis\n): string {\n  const host = meta.host || \"\";\n  const params = meta.params ?? [];\n  const p0 = Array.isArray(params) && params[0] && typeof params[0] === \"object\" ? params[0] : null;\n\n  if (action === \"CONNECT\") {\n    const dd = analysis.domainListDecision;\n    const signals = analysis.domainSignals ?? [];\n    const puny = host.includes(\"xn--\");\n    const trustBadge = dd === \"TRUSTED\"\n      ? '<span style=\"color:#22c55e;\">\u2713 Dom\u00EDnio confi\u00E1vel</span>'\n      : dd === \"BLOCKED\"\n        ? '<span style=\"color:#ef4444;\">\u26A0 Dom\u00EDnio bloqueado</span>'\n        : puny\n          ? '<span style=\"color:#f59e0b;\">\u26A0 Dom\u00EDnio punycode (poss\u00EDvel lookalike)</span>'\n          : '<span style=\"color:#94a3b8;\">Dom\u00EDnio n\u00E3o verificado</span>';\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\uD83D\uDD17 ${escapeHtml(actionTitle(\"CONNECT\"))}</p>\n        <p style=\"margin:0 0 6px 0; font-size:12px;\">${escapeHtml(host)}</p>\n        <p style=\"margin:0; font-size:12px;\">${trustBadge}</p>\n        ${signals.length ? `<p style=\"margin:6px 0 0 0; font-size:11px; color:#94a3b8;\">${escapeHtml(signals.join(\", \"))}</p>` : \"\"}\n      </div>`;\n  }\n\n  if (action === \"REQUEST_PERMISSIONS\") {\n    const perms = p0 && typeof p0 === \"object\" ? (Array.isArray(p0) ? p0 : Object.keys(p0)) : [];\n    const permList = perms.length ? perms.map((x: any) => escapeHtml(typeof x === \"string\" ? x : JSON.stringify(x))).join(\", \") : escapeHtml(JSON.stringify(p0 ?? \"{}\"));\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\uD83D\uDD10 ${escapeHtml(actionTitle(\"REQUEST_PERMISSIONS\"))}</p>\n        <p style=\"margin:0; font-size:12px; color:#94a3b8;\">Site poder\u00E1 ver/solicitar contas. Permiss\u00F5es: ${permList}</p>\n      </div>`;\n  }\n\n  if (action === \"ADD_CHAIN\") {\n    const info = analysis.addChainInfo ?? p0;\n    const chainId = info?.chainId ?? meta.chainIdRequested ?? \"?\";\n    const chainName = info?.chainName ?? \"?\";\n    const native = info?.nativeCurrency ?? p0?.nativeCurrency;\n    const symbol = (native?.symbol ?? native?.name ?? \"?\");\n    const decimals = native?.decimals ?? 18;\n    const rpcUrls = info?.rpcUrls ?? p0?.rpcUrls ?? [];\n    const rpc0 = Array.isArray(rpcUrls) ? rpcUrls[0] : (typeof rpcUrls === \"string\" ? rpcUrls : \"\");\n    const explorerUrls = info?.blockExplorerUrls ?? p0?.blockExplorerUrls ?? [];\n    const exp0 = Array.isArray(explorerUrls) ? explorerUrls[0] : (typeof explorerUrls === \"string\" ? explorerUrls : \"\");\n    const chainIdHex = String(chainId).startsWith(\"0x\") ? chainId : \"0x\" + parseInt(String(chainId), 10).toString(16);\n    const chainInfo = getChainInfo(chainIdHex);\n    const knownChain = chainInfo ? `${chainInfo.name} (conhecida)` : \"Rede n\u00E3o reconhecida\";\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\u2795 ${escapeHtml(actionTitle(\"ADD_CHAIN\"))}</p>\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>chainId:</b> ${escapeHtml(String(chainId))} (${escapeHtml(knownChain)})</p>\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Nome:</b> ${escapeHtml(String(chainName))}</p>\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Moeda:</b> ${escapeHtml(symbol)} (decimals: ${decimals})</p>\n        ${rpc0 ? `<p style=\"margin:0 0 4px 0; font-size:11px; color:#94a3b8;\"><b>RPC:</b> ${escapeHtml(String(rpc0).slice(0, 50))}\u2026</p>` : \"\"}\n        ${exp0 ? `<p style=\"margin:0; font-size:11px; color:#94a3b8;\"><b>Explorer:</b> ${escapeHtml(String(exp0).slice(0, 50))}\u2026</p>` : \"\"}\n      </div>`;\n  }\n\n  if (action === \"SWITCH_CHAIN\") {\n    const chainId = p0?.chainId ?? meta.chainIdRequested ?? \"?\";\n    const chainIdHex = String(chainId).startsWith(\"0x\") ? chainId : \"0x\" + parseInt(String(chainId), 10).toString(16);\n    const chainInfo = getChainInfo(chainIdHex);\n    const name = chainInfo?.name ?? analysis.chainTarget?.chainName ?? \"Rede desconhecida\";\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\uD83D\uDD04 ${escapeHtml(actionTitle(\"SWITCH_CHAIN\"))}</p>\n        <p style=\"margin:0; font-size:12px;\"><b>chainId:</b> ${escapeHtml(String(chainId))} \u2014 ${escapeHtml(name)}</p>\n      </div>`;\n  }\n\n  if (action === \"WATCH_ASSET\") {\n    const info = analysis.watchAssetInfo ?? p0?.options ?? p0;\n    const type_ = info?.type ?? p0?.type ?? \"ERC20\";\n    const addr = info?.address ?? info?.token_address ?? \"?\";\n    const symbol = info?.symbol ?? \"?\";\n    const decimals = info?.decimals ?? 18;\n    const image = info?.image ?? \"\";\n    const decimalsWarn = decimals < 0 || decimals > 18 ? '<span style=\"color:#f59e0b;\">\u26A0 decimals fora de [0..18]</span>' : \"\";\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\uD83D\uDC41 ${escapeHtml(actionTitle(\"WATCH_ASSET\"))}</p>\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Tipo:</b> ${escapeHtml(String(type_))}</p>\n        <p style=\"margin:0 0 4px 0; font-size:11px; word-break:break-all;\"><b>Endere\u00E7o:</b> ${escapeHtml(String(addr).slice(0, 20))}\u2026</p>\n        <p style=\"margin:0; font-size:12px;\"><b>Symbol:</b> ${escapeHtml(String(symbol))} (decimals: ${decimals}) ${decimalsWarn}</p>\n        ${image ? `<p style=\"margin:4px 0 0 0; font-size:11px; color:#94a3b8;\">Imagem: ${escapeHtml(String(image).slice(0, 40))}\u2026</p>` : \"\"}\n      </div>`;\n  }\n\n  if (action === \"SIGN_MESSAGE\") {\n    const msg = Array.isArray(params) && typeof params[0] === \"string\" ? params[0] : (p0 ? JSON.stringify(p0).slice(0, 200) : \"\");\n    const preview = msg ? (msg.length > 120 ? msg.slice(0, 120) + \"\u2026\" : msg) : \"\u2014\";\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\u270D\uFE0F ${escapeHtml(actionTitle(\"SIGN_MESSAGE\"))}</p>\n        <p style=\"margin:0; font-size:12px; word-break:break-word; max-height:80px; overflow-y:auto;\">${escapeHtml(preview)}</p>\n      </div>`;\n  }\n\n  if (action === \"SIGN_TYPED_DATA\") {\n    const decoded = analysis.typedDataDecoded;\n    const permit2 = decoded?.permit2;\n    const seaport = decoded?.seaport;\n    const isBlur = decoded?.isBlur;\n    const extras = analysis.typedDataExtras;\n    const raw = analysis.decoded?.raw ?? p0;\n    const domain = (typeof raw === \"object\" && raw?.domain) ? raw.domain : {};\n    const primaryType = raw?.primaryType ?? raw?.types?.EIP712Domain ? \"EIP712\" : \"?\";\n    const contract = domain?.verifyingContract ?? domain?.name ?? \"?\";\n    const isPermitLike = !!(permit2 || (extras?.spender && (extras?.value != null || extras?.deadline != null)));\n    const signWarning = t(\"overlay_typed_data_sign_warning\") || \"Assinar isso pode permitir gasto futuro sem nova confirma\u00E7\u00E3o.\";\n    let body = \"\";\n    if (isPermitLike) {\n      body += `<p style=\"margin:0 0 8px 0; font-size:11px; text-transform:uppercase; color:#f59e0b; font-weight:bold;\">${escapeHtml(t(\"overlay_typed_data_card_title\") || \"Assinatura (EIP-712)\")}</p>`;\n      if (permit2) {\n        body += `<p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Spender/Operator:</b> <code style=\"word-break:break-all;\">${escapeHtml(permit2.spender.slice(0, 14))}\u2026</code></p>`;\n        if (permit2.tokens?.length) body += `<p style=\"margin:0 0 4px 0; font-size:11px;\">Token(s): ${permit2.tokens.length} \u2014 ${permit2.unlimited ? \"\u221E Ilimitado\" : \"valor limitado\"}</p>`;\n        if (permit2.sigDeadline) body += `<p style=\"margin:0 0 4px 0; font-size:11px;\">Deadline: ${escapeHtml(permit2.sigDeadline)}</p>`;\n      }\n      if (extras?.spender) {\n        body += `<p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Spender:</b> <code style=\"word-break:break-all;\">${escapeHtml(extras.spender.slice(0, 14))}\u2026</code></p>`;\n        if (extras.value != null) body += `<p style=\"margin:0 0 4px 0; font-size:11px;\">Valor: ${escapeHtml(extras.value)}</p>`;\n        if (extras.deadline) body += `<p style=\"margin:0 0 4px 0; font-size:11px;\">Deadline: ${escapeHtml(extras.deadline)}</p>`;\n      }\n      body += `<p style=\"margin:8px 0 0 0; font-size:11px; color:#fcd34d;\">\u26A0\uFE0F ${escapeHtml(signWarning)}</p>`;\n    }\n    if (seaport) {\n      body += `<p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Seaport:</b> Voc\u00EA oferece ${escapeHtml(seaport.offerSummary)} \u2192 Recebe ${escapeHtml(seaport.considerationSummary)}</p>`;\n    }\n    if (isBlur) {\n      body += `<p style=\"margin:0 0 4px 0; font-size:12px; color:#f59e0b;\"><b>Blur:</b> Assinatura de marketplace \u2014 revise com cuidado</p>`;\n    }\n    body += `<p style=\"margin:0 0 4px 0; font-size:12px;\"><b>primaryType:</b> ${escapeHtml(String(primaryType))}</p>`;\n    body += `<p style=\"margin:0 0 4px 0; font-size:11px; word-break:break-all;\"><b>Contract:</b> ${escapeHtml(String(contract).slice(0, 24))}\u2026</p>`;\n    body += `<p style=\"margin:0; font-size:11px; color:#94a3b8;\">Leia o que voc\u00EA est\u00E1 autorizando na carteira.</p>`;\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\u270D\uFE0F ${escapeHtml(actionTitle(\"SIGN_TYPED_DATA\"))}</p>\n        ${body}\n      </div>`;\n  }\n\n  if (action === \"SEND_TX\") {\n    const tx = analysis.tx ?? p0;\n    const to = tx?.to ?? \"?\";\n    const value = tx?.valueEth ?? tx?.valueWei ?? (tx?.value != null ? String(tx.value) : \"?\");\n    const gasFmt = analysis.txCostPreview?.feeLikelyWei\n      ? weiToEthFmt(BigInt(analysis.txCostPreview.feeLikelyWei)) + \" \" + getNativeSymbol(meta.chainIdHex ?? undefined)\n      : (t(\"overlay_calculating\") || \"Calculando...\");\n    const usd = analysis.txCostPreview?.usdPerNative && analysis.txCostPreview?.feeLikelyWei\n      ? ` (~$${((parseFloat(analysis.txCostPreview.feeLikelyWei) / 1e18) * analysis.txCostPreview.usdPerNative).toFixed(2)} USD)`\n      : \"\";\n    const selector = tx?.selector ?? \"\";\n    const selLabel = selector ? selectorToLabel(selector) : null;\n    const da = analysis.decodedAction as { kind?: string; standard?: string; tokenIdRaw?: string; to?: string; amountRaw?: string } | undefined;\n    const te = analysis.txExtras as { approvalType?: string; spender?: string; operator?: string; tokenContract?: string } | undefined;\n    const isNftTransfer = da?.kind === \"TRANSFER_NFT\";\n    const nftInfo =\n      isNftTransfer && da\n        ? `<p style=\"margin:0 0 4px 0; font-size:12px;\">\uD83D\uDDBC\uFE0F ${escapeHtml(da.standard ?? \"NFT\")} transfer ${da.tokenIdRaw ? `#${da.tokenIdRaw}` : \"\"} \u2192 ${escapeHtml((da.to ?? \"?\").slice(0, 12))}\u2026</p>`\n        : \"\";\n    const isApproval =\n      te?.approvalType === \"ERC20_APPROVE\" ||\n      te?.approvalType === \"NFT_SET_APPROVAL_FOR_ALL\" ||\n      da?.kind === \"APPROVE_ERC20\" ||\n      da?.kind === \"INCREASE_ALLOWANCE\" ||\n      da?.kind === \"SET_APPROVAL_FOR_ALL\";\n    const allowanceBlock =\n      isApproval && to && /^0x[a-fA-F0-9]{40}$/.test(String(to))\n        ? `<div id=\"sg-allowance-block\" style=\"margin:8px 0 0 0; font-size:11px; color:#94a3b8;\">${escapeHtml(t(\"overlay_allowance_loading\") || \"Allowance atual: \u2026\")}</div>`\n        : \"\";\n    return `\n      <div style=\"margin-bottom:15px; background:#1e293b; padding:12px; border-radius:8px;\">\n        <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n        <p style=\"margin:0 0 6px 0; font-size:14px;\">\uD83D\uDCE4 ${escapeHtml(actionTitle(\"SEND_TX\"))}</p>\n        <p style=\"margin:0 0 4px 0; font-size:11px; word-break:break-all;\"><b>Para:</b> ${escapeHtml(String(to).slice(0, 24))}\u2026</p>\n        ${nftInfo}\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Valor:</b> ${escapeHtml(String(value))} ${getNativeSymbol(meta.chainIdHex ?? undefined)}</p>\n        <p style=\"margin:0 0 4px 0; font-size:12px;\"><b>Gas estimado:</b> ${escapeHtml(gasFmt)}${usd}</p>\n        ${selLabel ? `<p style=\"margin:0; font-size:11px; color:#38bdf8;\"><b>Fun\u00E7\u00E3o:</b> ${escapeHtml(selLabel)}</p>` : \"\"}\n        ${allowanceBlock}\n      </div>`;\n  }\n\n  return `\n    <div style=\"margin-bottom:15px;\">\n      <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin-bottom:5px;\">${escapeHtml(t(\"overlay_action\") || \"A\u00E7\u00E3o\")}</p>\n      <code style=\"background:#1e293b; padding:4px 8px; border-radius:4px; color:#38bdf8; font-size:12px;\">${escapeHtml(meta.method)}</code>\n    </div>`;\n}\n\n// --- VISUALIZA\u00C7\u00C3O (UI) ---\ntype OverlayState = {\n  requestId: string;\n  analysis: Analysis;\n  meta: { host: string; method: string; params?: any; rawShape?: string; rpcMeta?: any; chainIdHex?: string | null; chainIdRequested?: string; gateUI?: boolean };\n  container: HTMLDivElement;\n  shadow: ShadowRoot;\n  app: HTMLDivElement;\n  onKey: (e: KeyboardEvent) => void;\n  countdownTimer?: number | null;\n  keepaliveInterval?: number | null;\n  analysisLoading?: boolean;\n  domainsExpanded?: boolean;\n  _restore?: () => void;\n  _watchdogId?: ReturnType<typeof setTimeout> | null;\n  /** P1 A11y: element that had focus before overlay */\n  prevFocus?: HTMLElement | null;\n  /** P1 A11y: siblings we set inert on */\n  _inertTargets?: Element[];\n};\n\nlet __sgOverlay: OverlayState | null = null;\n\nconst OVERLAY_CSS_FALLBACK = `\n*{box-sizing:border-box}\n.sg-backdrop{position:fixed;inset:0;background:rgba(15,23,42,0.6);z-index:2147483647;display:flex;align-items:center;justify-content:center;padding:16px;pointer-events:auto}\n.sg-modal{width:min(820px,100vw);max-height:85vh;background:rgba(15,23,42,0.95);border:1px solid #334155;border-radius:14px;box-shadow:0 20px 50px rgba(0,0,0,0.5);display:flex;flex-direction:column;overflow:hidden;pointer-events:auto}\n.sg-header,.sg-body,.sg-footer{pointer-events:auto}\n.sg-header{padding:12px 16px;border-bottom:1px solid rgba(148,163,184,0.18)}\n.sg-body{flex:1;overflow-y:auto;padding:16px}\n.sg-footer{display:flex;gap:12px;justify-content:flex-end;padding:14px 16px;border-top:1px solid rgba(255,255,255,0.06);background:rgba(8,12,20,0.92)}\n.sg-card{background:rgba(2,6,23,0.5);border:1px solid rgba(148,163,184,0.18);border-radius:10px;padding:12px 16px;margin-bottom:12px}\n.sg-btn,.sg-btn-primary,.sg-btn-secondary{all:unset;cursor:pointer;padding:10px 18px;border-radius:10px;font-weight:700;font-size:13px}\n.sg-btn-primary{background:#f97316;color:#0b1220}\n.sg-btn-secondary{background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);color:#e5e7eb}\n.sg-close-btn{all:unset;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center}\ninput,textarea{background:#020617;border:1px solid rgba(148,163,184,0.2);color:#f8fafc;border-radius:8px;padding:10px}\nbody,.sg-root{font-family:system-ui,sans-serif;color:#f8fafc;background:transparent}\n`;\n\nfunction ensureOverlayCss(shadow: ShadowRoot) {\n  const applyFallback = (reason: string) => {\n    try {\n      const style = document.createElement(\"style\");\n      style.textContent = OVERLAY_CSS_FALLBACK;\n      shadow.appendChild(style);\n      console.warn(\"[SignGuard UI] CSS fallback inline applied:\", reason);\n    } catch {\n      console.warn(\"[SignGuard UI] CSS fallback failed:\", reason);\n    }\n  };\n  try {\n    let href = safeGetURL(\"overlay.css\");\n    if (!href && typeof chrome?.runtime?.getURL === \"function\") {\n      try { href = chrome.runtime.getURL(\"overlay.css\"); } catch {}\n    }\n    if (!href) {\n      applyFallback(\"getURL returned empty\");\n      return;\n    }\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = href;\n    link.onerror = () => applyFallback(\"overlay.css failed to load\");\n    shadow.appendChild(link);\n  } catch (e) {\n    applyFallback(String((e as Error)?.message ?? e));\n  }\n}\n\nfunction showOverlay(\n  requestId: string,\n  analysis: Analysis,\n  meta: { host: string; method: string; params?: any; rawShape?: string; rpcMeta?: any; chainIdHex?: string | null; chainIdRequested?: string; gateUI?: boolean }\n) {\n  console.log(\"\uD83C\uDFA8 [SignGuard UI] showOverlay CALLED for:\", requestId);\n\n  if (__sgOverlay) {\n    console.log(\"\uD83C\uDFA8 [SignGuard UI] Updating existing overlay\");\n    __sgOverlay.requestId = requestId;\n    __sgOverlay.analysis = analysis;\n    __sgOverlay.meta = meta;\n    updateOverlay(__sgOverlay);\n    try { safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"OVERLAY_SHOWN\", requestId, method: meta.method } }, 500); } catch { /* ignore */ }\n    return;\n  }\n\n  try {\n    const container = document.createElement(\"div\");\n    container.id = \"__sg_host\";\n    container.className = \"sg-root\";\n    container.setAttribute(\"data-sg-overlay\", \"1\");\n    container.style.cssText = \"position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 2147483647; pointer-events: none;\";\n\n    const shadow = container.attachShadow({ mode: \"open\" });\n    ensureOverlayCss(shadow);\n\n    const app = document.createElement(\"div\");\n    app.id = \"sg-app\";\n    app.style.pointerEvents = \"auto\";\n    shadow.appendChild(app);\n\n    const previousActive = document.activeElement as HTMLElement | null;\n    const prevOverflow = document.documentElement.style.overflow;\n    document.documentElement.style.overflow = \"hidden\";\n\n    const onKey = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        decideCurrentAndAdvance(false);\n        return;\n      }\n      if (e.key === \"Tab\") {\n        const focusables = shadow.querySelectorAll<HTMLElement>(\"button, [tabindex]:not([tabindex='-1'])\");\n        const arr = Array.from(focusables);\n        if (arr.length === 0) return;\n        const idx = arr.indexOf(document.activeElement as HTMLElement);\n        if (e.shiftKey) {\n          const next = idx <= 0 ? arr[arr.length - 1] : arr[idx - 1];\n          next?.focus();\n          e.preventDefault();\n        } else {\n          const next = idx < 0 || idx >= arr.length - 1 ? arr[0] : arr[idx + 1];\n          next?.focus();\n          e.preventDefault();\n        }\n      }\n    };\n    document.addEventListener(\"keydown\", onKey);\n\n    __sgOverlay = {\n      requestId,\n      analysis,\n      meta,\n      container,\n      shadow,\n      app,\n      onKey,\n      prevFocus: previousActive,\n      _inertTargets: [],\n      _restore: () => {\n        const state = __sgOverlay;\n        if (state?._inertTargets) {\n          for (const el of state._inertTargets) {\n            try { el.removeAttribute(\"inert\"); el.removeAttribute(\"aria-hidden\"); } catch {}\n          }\n        }\n        document.documentElement.style.overflow = prevOverflow;\n        try {\n          if (previousActive && typeof previousActive.focus === \"function\" && document.body?.contains(previousActive)) {\n            (previousActive as HTMLElement).focus();\n          } else {\n            document.body?.focus?.();\n          }\n        } catch {}\n      },\n    };\n\n    if (document.documentElement) {\n      document.documentElement.appendChild(container);\n    } else {\n      document.body.appendChild(container);\n    }\n\n    const state = __sgOverlay;\n    const inertTargets: Element[] = [];\n    for (const el of Array.from(document.documentElement.children)) {\n      if (el !== container) {\n        el.setAttribute(\"inert\", \"\");\n        el.setAttribute(\"aria-hidden\", \"true\");\n        inertTargets.push(el);\n      }\n    }\n    state._inertTargets = inertTargets;\n\n    if (state) updateOverlay(state);\n    try { safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"OVERLAY_SHOWN\", requestId, method: meta.method } }, 500); } catch { /* ignore */ }\n    setTimeout(() => {\n      const toFocus = shadow.querySelector<HTMLElement>(\"[data-sg-initial-focus]\") ?? shadow.querySelector<HTMLElement>(\"button, [tabindex]:not([tabindex='-1'])\");\n      toFocus?.focus?.();\n    }, 50);\n  } catch (e) {\n    console.error(\"\uD83C\uDFA8 [SignGuard UI] FATAL UI ERROR:\", e);\n  }\n}\n\nfunction updateOverlay(state: OverlayState) {\n  if (!state?.app) return;\n\n  const analysis = state.analysis;\n\n  // 1. ESTADO DE LOADING \u2014 esconder \"calculando\" quando feeEstimated (destravar UI)\n  const cost = analysis?.txCostPreview;\n  const feeEstimated = cost?.feeEstimated === true;\n  const showLoading = !analysis || ((analysis as { level?: string }).level === \"LOADING\" && !feeEstimated);\n  if (showLoading) {\n    if (state._watchdogId != null) clearTimeout(state._watchdogId);\n    state._watchdogId = setTimeout(() => {\n      state._watchdogId = null;\n      if (__sgOverlay?.requestId !== state.requestId || !state.app) return;\n      const tryAgainLabel = t(\"overlay_try_again\") || \"Tentar novamente\";\n      const closeLabel = t(\"btn_close\") || \"Fechar\";\n      state.app.innerHTML = `\n        <div class=\"sg-card\" style=\"background:#0f172a; padding:30px; border-radius:16px; color:white; width:360px; text-align:center; font-family:sans-serif; border:1px solid #334155; box-shadow:0 20px 50px rgba(0,0,0,0.5);\">\n          <h3 style=\"margin:0; font-size:16px;\">${escapeHtml(t(\"overlay_analyzing\") || \"Analisando Transa\u00E7\u00E3o...\")}</h3>\n          <p style=\"opacity:0.8; font-size:13px; margin-top:12px;\">${escapeHtml(t(\"overlay_analysis_taking_long\") || \"A an\u00E1lise est\u00E1 demorando.\")}</p>\n          <div style=\"display:flex; gap:12px; margin-top:20px; justify-content:center;\">\n            <button id=\"sg-btn-retry-loading\" style=\"flex:1; background:#f59e0b; color:black; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(tryAgainLabel)}</button>\n            <button id=\"sg-btn-close-loading\" style=\"flex:1; background:#334155; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(closeLabel)}</button>\n          </div>\n        </div>\n      `;\n      state.shadow.getElementById(\"sg-btn-retry-loading\")?.addEventListener(\"click\", () => retryAnalyze());\n      state.shadow.getElementById(\"sg-btn-close-loading\")?.addEventListener(\"click\", () => decideCurrentAndAdvance(false));\n    }, 8000);\n    state.app.innerHTML = `\n      <div class=\"sg-card\" style=\"background:#0f172a; padding:30px; border-radius:16px; color:white; width:360px; text-align:center; font-family:sans-serif; border:1px solid #334155; box-shadow:0 20px 50px rgba(0,0,0,0.5);\">\n        <div class=\"sg-spinner\" style=\"border:3px solid rgba(255,255,255,0.3); border-top:3px solid #38bdf8; border-radius:50%; width:30px; height:30px; animation:sg-spin 1s linear infinite; margin:0 auto 15px;\"></div>\n        <h3 style=\"margin:0; font-size:16px;\">${escapeHtml(t(\"overlay_analyzing\") || \"Analisando Transa\u00E7\u00E3o...\")}</h3>\n        <p style=\"opacity:0.6; font-size:12px; margin-top:5px;\">${feeEstimated ? (escapeHtml(t(\"overlay_fee_calculated\") || \"Taxas calculadas.\") + \" \" + (t(\"overlay_finishing\") || \"Finalizando an\u00E1lise...\")) : escapeHtml(t(\"overlay_simulating\") || \"O SignGuard est\u00E1 a simular o resultado.\")}</p>\n        <div style=\"display:flex; gap:12px; margin-top:20px; justify-content:center;\">\n          <button id=\"sg-btn-block-loading\" style=\"flex:1; background:#334155; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(t(\"btn_block\") || \"Bloquear\")}</button>\n          <button id=\"sg-btn-allow-loading\" style=\"flex:1; background:#f59e0b; color:black; border:none; padding:12px; border-radius:8px; font-weight:bold; cursor:pointer;\">${escapeHtml(t(\"overlay_continue_no_analysis\") || \"Continuar (sem an\u00E1lise)\")}</button>\n        </div>\n        <style>@keyframes sg-spin {0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>\n      </div>\n    `;\n    setTimeout(() => {\n      state.shadow.getElementById(\"sg-btn-block-loading\")?.addEventListener(\"click\", () => decideCurrentAndAdvance(false));\n      state.shadow.getElementById(\"sg-btn-allow-loading\")?.addEventListener(\"click\", () => {\n        if (confirm(t(\"overlay_confirm_allow_msg\") || \"Tem certeza? Isso ignora prote\u00E7\u00E3o.\")) {\n          decideCurrentAndAdvance(true);\n        }\n      });\n    }, 0);\n    return;\n  }\n\n  if (state._watchdogId != null) {\n    clearTimeout(state._watchdogId);\n    state._watchdogId = null;\n  }\n\n  // 2. DADOS FINAIS\n  const level = (analysis.level || (analysis.recommend === \"ALLOW\" ? \"LOW\" : analysis.recommend === \"WARN\" ? \"WARN\" : \"HIGH\")) as string;\n  const recommend = analysis.recommend ?? \"WARN\";\n  const score = analysis.score ?? 0;\n  const color = getRiskColor(level);\n  const method = state.meta?.method || (t(\"tx_unknown\") || \"Transa\u00E7\u00E3o Desconhecida\");\n  const host = state.meta?.host || (t(\"dapp_unknown\") || \"DApp Desconhecido\");\n  const rawReasons = analysis.reasons ?? [];\n  const sim = analysis.simulationOutcome;\n  const intent = analysis.intent ?? analysis.txContext?.kind;\n  const isNftPurchase = intent === \"NFT_PURCHASE\";\n  const isTokenSwap = intent === \"SWAP\" || intent === \"TOKEN_SWAP\";\n\n  const assetChanges: Array<{ type: \"OUT\" | \"IN\"; amount: string; symbol: string }> = [];\n  const outgoing = sim?.outgoingAssets ?? [];\n  const incoming = sim?.incomingAssets ?? [];\n  for (const o of outgoing)\n    assetChanges.push({ type: \"OUT\", amount: o.amount ?? \"\", symbol: o.symbol ?? \"?\" });\n  for (const i of incoming)\n    assetChanges.push({ type: \"IN\", amount: i.amount ?? \"\", symbol: i.symbol ?? \"?\" });\n  const approvals = sim?.approvals ?? [];\n\n  const tokenConf = analysis.tokenConfidence;\n  const tokenSymbol = analysis.asset?.symbol ?? analysis.asset?.name ?? (analysis as { tokenSymbol?: string }).tokenSymbol ?? \"?\";\n  const reasons = rawReasons.length > 0\n    ? rawReasons\n    : [\"Sem sinais fortes, mas confirme destino, valor e rede.\"];\n  const showTokenLowConf = (tokenConf === \"LOW\" || tokenConf === \"UNKNOWN\") && (isTokenSwap || analysis.intent === \"APPROVAL\");\n  const bannerColor = recommend === \"ALLOW\"\n    ? \"#22c55e\"\n    : recommend === \"WARN\"\n      ? \"#f59e0b\"\n      : \"#ef4444\";\n  const bannerText = recommend === \"ALLOW\"\n    ? (t(\"overlay_safe_continue\") || \"Seguro para continuar\")\n    : recommend === \"WARN\"\n      ? (t(\"overlay_attention\") || \"Aten\u00E7\u00E3o\")\n      : (t(\"overlay_danger\") || \"Perigoso / prov\u00E1vel golpe\");\n  const intentMsg = isNftPurchase\n    ? (t(\"overlay_nft_purchase_msg\") || \"Se confirmar, os valores ser\u00E3o transferidos e a aquisi\u00E7\u00E3o do NFT ser\u00E1 realizada.\")\n    : isTokenSwap\n      ? (t(\"overlay_swap_msg\") || \"Voc\u00EA est\u00E1 prestes a trocar tokens. Confirme token recebido e liquidez.\")\n      : \"\";\n  const feeStatusText = feeEstimated\n    ? (t(\"overlay_fee_calculated\") || \"Taxas calculadas.\")\n    : (t(\"overlay_calculating\") || \"Calculando...\");\n  const isFallback = !!(analysis as { _isFallback?: boolean })._isFallback;\n  const failMode = __sgSettings?.failMode ?? \"fail_open\";\n  const vaultBlocked = analysis.vaultBlocked === true;\n  const hideAllow = analysis.matchedDenySpender === true || vaultBlocked;\n  const fallbackFailClosed = isFallback && failMode === \"fail_closed\";\n  const allowLabel = fallbackFailClosed\n    ? (t(\"overlay_allow_once_risky\") || \"Permitir 1 vez (arriscado)\")\n    : isFallback && failMode === \"fail_open\"\n      ? (t(\"overlay_allow_anyway\") || \"Permitir mesmo assim\")\n      : (t(\"btn_continue\") || \"Continuar\");\n\n  const action = classifyAction(method, state.meta?.params ?? []);\n  const typePanel = renderTypeSpecificPanel(action, state.meta, analysis);\n  const showSimulation = action === \"SEND_TX\";\n\n  function getSpenderFromAnalysis(a: Analysis): string | null {\n    const da = a.decodedAction as { spender?: string; operator?: string } | undefined;\n    if (da?.spender && /^0x[a-fA-F0-9]{40}$/.test(da.spender)) return da.spender.toLowerCase();\n    if (da?.operator && /^0x[a-fA-F0-9]{40}$/.test(da.operator)) return da.operator.toLowerCase();\n    const te = a.txExtras as { spender?: string; operator?: string } | undefined;\n    if (te?.spender && /^0x[a-fA-F0-9]{40}$/.test(te.spender)) return te.spender.toLowerCase();\n    if (te?.operator) return te.operator.toLowerCase();\n    if (a.typedDataExtras?.spender && /^0x[a-fA-F0-9]{40}$/.test(a.typedDataExtras.spender)) return a.typedDataExtras.spender.toLowerCase();\n    return null;\n  }\n  const overlaySpender = getSpenderFromAnalysis(analysis);\n  const quickSpenderBlock = overlaySpender\n    ? `\n        <div style=\"margin-bottom:15px; background:#1e293b; padding:10px; border-radius:8px;\">\n          <p style=\"font-size:11px; color:#64748b; margin:0 0 6px 0;\">Spender: <code style=\"word-break:break-all;\">${escapeHtml(overlaySpender.slice(0, 10))}\u2026</code></p>\n          <div style=\"display:flex; gap:8px; flex-wrap:wrap;\">\n            <button id=\"sg-btn-allow-spender\" style=\"background:#22c55e; color:black; border:none; padding:6px 12px; border-radius:6px; font-size:12px; cursor:pointer;\">Sempre permitir</button>\n            <button id=\"sg-btn-deny-spender\" style=\"background:#ef4444; color:white; border:none; padding:6px 12px; border-radius:6px; font-size:12px; cursor:pointer;\">Sempre bloquear</button>\n          </div>\n        </div>`\n    : \"\";\n  const quickDomainBlock = `\n        <div style=\"margin-bottom:15px; background:#1e293b; padding:10px; border-radius:8px;\">\n          <p style=\"font-size:11px; color:#64748b; margin:0 0 6px 0;\">Dom\u00EDnio: ${escapeHtml(host)}</p>\n          <div style=\"display:flex; gap:8px; flex-wrap:wrap;\">\n            <button id=\"sg-btn-trust-domain\" style=\"background:#22c55e; color:black; border:none; padding:6px 12px; border-radius:6px; font-size:12px; cursor:pointer;\">Adicionar a Trusted</button>\n            <button id=\"sg-btn-block-domain\" style=\"background:#ef4444; color:white; border:none; padding:6px 12px; border-radius:6px; font-size:12px; cursor:pointer;\">Adicionar a Blocked</button>\n            <button id=\"sg-btn-temp-allow-10\" style=\"background:#334155; color:white; border:none; padding:6px 12px; border-radius:6px; font-size:12px; cursor:pointer;\">${escapeHtml(t(\"overlay_temp_allow_10min\") || \"Permitir por 10 min\")}</button>\n          </div>\n        </div>`;\n\n  state.app.innerHTML = `\n    <div class=\"sg-card\" role=\"dialog\" aria-labelledby=\"sg-overlay-title\" aria-describedby=\"sg-overlay-desc\" aria-modal=\"true\" style=\"background:#0f172a; color:white; width:380px; font-family:'Inter', sans-serif; border-radius:16px; overflow:hidden; box-shadow:0 25px 50px -12px rgba(0,0,0,0.7); border:1px solid ${color}; position:fixed; bottom:30px; right:30px; z-index:999999;\">\n      \n      <div style=\"background:${bannerColor}; padding:10px 16px; text-align:center;\">\n        <span style=\"font-weight:800; font-size:13px; text-transform:uppercase; color:${recommend === \"ALLOW\" ? \"black\" : \"white\"}; letter-spacing:0.5px;\">${escapeHtml(bannerText)}</span>\n      </div>\n      <div style=\"background:${color}; padding:10px 20px; display:flex; justify-content:space-between; align-items:center;\">\n        <span style=\"font-weight:700; font-size:13px; color:${level === \"HIGH\" || level === \"BLOCK\" ? \"white\" : \"black\"}; letter-spacing:0.5px;\">\uD83D\uDEE1\uFE0F SignGuard</span>\n        <span style=\"background:rgba(0,0,0,0.2); color:white; padding:2px 8px; border-radius:12px; font-size:11px; font-weight:bold;\">SCORE ${score}/100</span>\n      </div>\n\n      <div style=\"padding:20px;\">\n        ${(state.meta as { gateUI?: boolean }).gateUI ? `<div style=\"margin-bottom:15px; background:#1e3a5f; border:1px solid #38bdf8; padding:10px 14px; border-radius:8px; font-size:13px; color:#e0f2fe;\">${escapeHtml(t(\"overlay_confirm_before_wallet\") || \"Confirme aqui antes de abrir a carteira.\")}</div>` : \"\"}\n        <div id=\"sg-overlay-desc\" style=\"margin-bottom:15px; border-bottom:1px solid #334155; padding-bottom:15px;\">\n          <h2 id=\"sg-overlay-title\" style=\"margin:0 0 5px 0; font-size:18px; color:#f8fafc;\">${escapeHtml(host)}</h2>\n          <p style=\"margin:0; font-size:13px; color:#94a3b8;\">${escapeHtml(method)}</p>\n        </div>\n\n        ${intentMsg ? `\n        <div style=\"margin-bottom:15px; background:rgba(56,189,248,0.1); border:1px solid rgba(56,189,248,0.3); padding:10px; border-radius:8px;\">\n          <p style=\"margin:0; font-size:12px; color:#93c5fd;\">\u2139\uFE0F ${escapeHtml(intentMsg)}</p>\n        </div>\n        ` : \"\"}\n\n        ${((): string => {\n          const sum = analysis.summaryV1 ?? analysis.summary;\n          if (!sum?.title) return \"\";\n          const giveList = (sum.give ?? []).map((g) => `${g.amount ?? \"?\"} ${g.symbol ?? \"\"}`.trim()).filter(Boolean);\n          const getList = (sum.get ?? []).map((g) => `${g.amount ?? \"?\"} ${g.symbol ?? \"\"}`.trim()).filter(Boolean);\n          const approvalLines = (sum.approvals ?? []).map((a) => `${a.tokenSymbol || a.tokenAddress?.slice(0, 8) || \"?\"} \u2192 ${a.spender?.slice(0, 10) ?? \"?\"}\u2026 ${a.unlimited ? \"\u221E\" : a.amount ?? \"\"}`.trim());\n          const nftLines = (sum.nfts ?? []).map((n) => `${n.collection || n.tokenAddress?.slice(0, 8) || \"NFT\"} ${n.tokenId ? \"#\" + n.tokenId : \"\"}`.trim()).filter(Boolean);\n          const flagPills = (sum.flags ?? []).map((f) => {\n            const label = t(\"reason_\" + String(f).toLowerCase()) || f;\n            return `<span style=\"display:inline-block;background:rgba(245,158,11,0.2);color:#fcd34d;padding:2px 8px;border-radius:6px;font-size:11px;margin:2px 4px 2px 0;\">${escapeHtml(label)}</span>`;\n          }).join(\"\");\n          return `\n        <div style=\"margin-bottom:15px; background:#1e293b; border:1px solid #334155; padding:12px; border-radius:8px;\">\n          <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin:0 0 6px 0;\">${escapeHtml(t(\"overlay_summary_title\") || \"Resumo\")}</p>\n          <p style=\"margin:0 0 4px 0; font-size:14px; font-weight:600; color:#f8fafc;\">${escapeHtml(sum.title)}</p>\n          ${sum.subtitle ? `<p style=\"margin:0 0 8px 0; font-size:12px; color:#94a3b8;\">${escapeHtml(sum.subtitle)}</p>` : \"\"}\n          ${giveList.length ? `<p style=\"margin:4px 0; font-size:12px; color:#fca5a5;\">${escapeHtml(t(\"cost_you_send\") || \"Voc\u00EA envia\")}: ${escapeHtml(giveList.join(\", \"))}</p>` : \"\"}\n          ${getList.length ? `<p style=\"margin:4px 0; font-size:12px; color:#86efac;\">${escapeHtml(t(\"cost_you_receive\") || \"Voc\u00EA recebe\")}: ${escapeHtml(getList.join(\", \"))}</p>` : \"\"}\n          ${approvalLines.length ? `<p style=\"margin:4px 0; font-size:11px; color:#fcd34d;\">${escapeHtml(t(\"overlay_approvals_detected\") || \"Aprova\u00E7\u00F5es\")}: ${escapeHtml(approvalLines.join(\"; \"))}</p>` : \"\"}\n          ${nftLines.length ? `<p style=\"margin:4px 0; font-size:11px; color:#93c5fd;\">NFT: ${escapeHtml(nftLines.join(\", \"))}</p>` : \"\"}\n          ${flagPills ? `<div style=\"margin-top:8px;\">${flagPills}</div>` : \"\"}\n        </div>`;\n        })()}\n\n        ${typePanel}\n        ${quickSpenderBlock}\n        ${quickDomainBlock}\n\n        ${showSimulation ? `\n        <div style=\"margin-bottom:20px;\">\n          <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin-bottom:5px;\">${escapeHtml(t(\"overlay_simulation_balance\") || \"Simula\u00E7\u00E3o de Balan\u00E7o\")}</p>\n          <div style=\"background:#1e293b; padding:10px; border-radius:8px; max-height:100px; overflow-y:auto;\">\n            ${renderAssetChanges(assetChanges)}\n          </div>\n          ${approvals.length > 0 ? `\n          <p style=\"font-size:11px; text-transform:uppercase; color:#f59e0b; font-weight:bold; margin:10px 0 4px 0;\">${escapeHtml(t(\"overlay_approvals_detected\") || \"Aprova\u00E7\u00F5es detectadas\")}</p>\n          <div style=\"background:rgba(245,158,11,0.1); padding:8px; border-radius:6px; font-size:11px;\">\n            ${approvals.map((a) => `<p style=\"margin:0 0 4px 0;\">${a.unlimited ? \"\u221E\" : \"\"} ${escapeHtml(a.spender.slice(0, 10))}\u2026</p>`).join(\"\")}\n          </div>\n          ` : \"\"}\n          ${feeEstimated ? `<p style=\"margin:8px 0 0 0; font-size:11px; color:#64748b;\">\u2713 ${escapeHtml(feeStatusText)}</p>` : `<p style=\"margin:8px 0 0 0; font-size:11px; color:#94a3b8;\">${escapeHtml(feeStatusText)}</p>`}\n        </div>\n        ` : \"\"}\n\n        <div style=\"margin-bottom:20px;\">\n          <p style=\"font-size:11px; text-transform:uppercase; color:#64748b; font-weight:bold; margin-bottom:5px;\">${escapeHtml(t(\"overlay_risk_why\") || \"RISCO E POR QU\u00CA\")}</p>\n          ${showTokenLowConf ? `\n          <div style=\"background:rgba(245,158,11,0.15); border:1px solid rgba(245,158,11,0.4); padding:10px; border-radius:8px; margin-bottom:10px;\">\n            <p style=\"margin:0; font-size:12px; color:#fcd34d;\">Token analisado: ${escapeHtml(tokenSymbol)} \u2014 Confian\u00E7a: BAIXA (rec\u00E9m-lan\u00E7ado / pouca liquidez / sem reputa\u00E7\u00E3o)</p>\n          </div>\n          ` : \"\"}\n          <div style=\"background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3); padding:10px; border-radius:8px;\">\n            ${reasons.map((r) => `<p style=\"margin:0 0 6px 0; color:#fca5a5; font-size:12px;\">\u26A0\uFE0F ${escapeHtml(r)}</p>`).join(\"\")}\n          </div>\n        </div>\n\n        ${vaultBlocked ? `\n        <div style=\"margin-bottom:15px; background:rgba(245,158,11,0.15); border:1px solid rgba(245,158,11,0.4); padding:12px; border-radius:8px;\">\n          <p style=\"margin:0 0 10px 0; font-size:12px; color:#fcd34d;\">Este contrato est\u00E1 bloqueado pelo Vault.</p>\n          <div style=\"display:flex; gap:8px; flex-wrap:wrap;\">\n            <button id=\"sg-btn-vault-unlock-5\" style=\"background:#f59e0b; color:black; border:none; padding:8px 14px; border-radius:6px; font-weight:600; cursor:pointer; font-size:12px;\">${escapeHtml(t(\"vault_unlock_5min\") || \"Desbloquear 5 min\")}</button>\n            <button id=\"sg-btn-vault-unlock-30\" style=\"background:#eab308; color:black; border:none; padding:8px 14px; border-radius:6px; font-weight:600; cursor:pointer; font-size:12px;\">${escapeHtml(t(\"vault_unlock_30min\") || \"Desbloquear 30 min\")}</button>\n            <a id=\"sg-btn-vault-settings\" href=\"${escapeHtml((typeof chrome !== \"undefined\" && chrome?.runtime?.getURL ? chrome.runtime.getURL(\"options.html\") : \"\") + \"#vault\")}\" target=\"_blank\" rel=\"noopener\" style=\"display:inline-block; background:#334155; color:white; padding:8px 14px; border-radius:6px; font-size:12px; text-decoration:none;\">Abrir configura\u00E7\u00F5es</a>\n          </div>\n        </div>\n        ` : \"\"}\n        <div style=\"display:flex; gap:12px;\">\n          ${vaultBlocked ? `\n          <button id=\"sg-btn-block\" data-sg-initial-focus=\"1\" data-sg-secondary=\"1\" style=\"flex:1; background:#ef4444; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(t(\"btn_block\") || \"Manter bloqueado\")}</button>\n          ` : fallbackFailClosed ? `\n          <button id=\"sg-btn-block\" ${recommend === \"BLOCK\" ? 'data-sg-initial-focus=\"1\" data-sg-secondary=\"1\"' : 'data-sg-primary=\"1\"'} style=\"flex:1; background:#ef4444; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(t(\"btn_block\") || \"Bloquear\")}</button>\n          <button id=\"sg-btn-allow\" ${recommend !== \"BLOCK\" ? 'data-sg-initial-focus=\"1\" data-sg-primary=\"1\"' : 'data-sg-secondary=\"1\"'} style=\"flex:1; background:#334155; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(allowLabel)}</button>\n          ` : `\n          <button id=\"sg-btn-block\" ${hideAllow || recommend === \"BLOCK\" ? 'data-sg-initial-focus=\"1\" data-sg-secondary=\"1\"' : 'data-sg-secondary=\"1\"'} style=\"flex:1; background:#334155; color:white; border:none; padding:12px; border-radius:8px; font-weight:600; cursor:pointer;\">${escapeHtml(t(\"btn_block\") || \"Bloquear\")}</button>\n          ${hideAllow ? \"\" : `<button id=\"sg-btn-allow\" ${!hideAllow && recommend !== \"BLOCK\" ? 'data-sg-initial-focus=\"1\" data-sg-primary=\"1\"' : 'data-sg-primary=\"1\"'} style=\"flex:1; background:${color}; color:${level === \"HIGH\" || level === \"BLOCK\" ? \"white\" : \"black\"}; border:none; padding:12px; border-radius:8px; font-weight:bold; cursor:pointer;\">${escapeHtml(allowLabel)}</button>`}\n          `}\n        </div>\n        <div style=\"margin-top:12px;\">\n          <button id=\"sg-btn-retry\" style=\"width:100%; background:transparent; color:#64748b; border:1px solid #334155; padding:8px; border-radius:6px; font-size:12px; cursor:pointer;\">${escapeHtml(t(\"overlay_try_again\") || \"Tentar novamente\")}</button>\n        </div>\n\n      </div>\n    </div>\n  `;\n\n  const needsAllowFriction = (fallbackFailClosed || (isFallback && failMode === \"fail_open\"));\n  setTimeout(() => {\n    state.shadow.getElementById(\"sg-btn-block\")?.addEventListener(\"click\", () => decideCurrentAndAdvance(false));\n    const allowBtn = state.shadow.getElementById(\"sg-btn-allow\");\n    if (allowBtn) {\n      allowBtn.addEventListener(\"click\", () => {\n        if (needsAllowFriction && !(state as any).__sgAllowConfirmed) {\n          const parent = allowBtn.closest(\"div\");\n          if (parent) {\n            const confirmDiv = document.createElement(\"div\");\n            confirmDiv.id = \"sg-confirm-allow\";\n            confirmDiv.style.cssText = \"margin-top:12px; padding:12px; background:rgba(239,68,68,0.15); border:1px solid rgba(239,68,68,0.4); border-radius:8px;\";\n            confirmDiv.innerHTML = `<p style=\"margin:0 0 10px 0; font-size:12px; color:#fca5a5;\">${escapeHtml(t(\"overlay_confirm_allow_msg\") || \"Tem certeza? Isso ignora prote\u00E7\u00E3o.\")}</p>\n              <div style=\"display:flex; gap:8px;\">\n                <button id=\"sg-btn-confirm-allow\" style=\"background:#f59e0b; color:black; border:none; padding:8px 14px; border-radius:6px; font-weight:600; cursor:pointer;\">${escapeHtml(t(\"overlay_confirm_allow\") || \"Confirmar permitir 1 vez\")}</button>\n                <button id=\"sg-btn-cancel-allow\" style=\"background:#334155; color:white; border:none; padding:8px 14px; border-radius:6px; cursor:pointer;\">${escapeHtml(t(\"btn_cancel\") || \"Cancelar\")}</button>\n              </div>`;\n            parent.appendChild(confirmDiv);\n            (state as any).__sgAllowConfirmed = true;\n            state.shadow.getElementById(\"sg-btn-confirm-allow\")?.addEventListener(\"click\", () => {\n              decideCurrentAndAdvance(true);\n            });\n            state.shadow.getElementById(\"sg-btn-cancel-allow\")?.addEventListener(\"click\", () => {\n              confirmDiv.remove();\n              (state as any).__sgAllowConfirmed = false;\n            });\n          }\n          return;\n        }\n        decideCurrentAndAdvance(true);\n      });\n    }\n    state.shadow.getElementById(\"sg-btn-retry\")?.addEventListener(\"click\", () => retryAnalyze());\n    state.shadow.getElementById(\"sg-btn-allow-spender\")?.addEventListener(\"click\", async () => {\n      if (!overlaySpender) return;\n      try {\n        await safeSendMessage({ type: \"SG_UPDATE_SPENDERS\", payload: { addToAllow: overlaySpender } }, 3000);\n        await loadSettings();\n        retryAnalyze();\n      } catch {}\n    });\n    state.shadow.getElementById(\"sg-btn-deny-spender\")?.addEventListener(\"click\", async () => {\n      if (!overlaySpender) return;\n      try {\n        await safeSendMessage({ type: \"SG_UPDATE_SPENDERS\", payload: { addToDeny: overlaySpender } }, 3000);\n        await loadSettings();\n        retryAnalyze();\n      } catch {}\n    });\n    state.shadow.getElementById(\"sg-btn-trust-domain\")?.addEventListener(\"click\", async () => {\n      try {\n        await safeSendMessage({ type: \"SG_LISTS_OVERRIDE_ADD\", payload: { type: \"trusted_domain\", payload: { value: host } } }, 3000);\n        retryAnalyze();\n      } catch {}\n    });\n    state.shadow.getElementById(\"sg-btn-block-domain\")?.addEventListener(\"click\", async () => {\n      try {\n        await safeSendMessage({ type: \"SG_LISTS_OVERRIDE_ADD\", payload: { type: \"blocked_domain\", payload: { value: host } } }, 3000);\n        retryAnalyze();\n      } catch {}\n    });\n    state.shadow.getElementById(\"sg-btn-temp-allow-10\")?.addEventListener(\"click\", async () => {\n      try {\n        await safeSendMessage({ type: \"SG_ADD_TEMP_ALLOW\", payload: { host, spender: overlaySpender ?? null, ttlMs: 10 * 60 * 1000 } }, 3000);\n        showToast(t(\"overlay_temp_allow_toast\") || \"Permitido por 10 min\");\n        decideCurrentAndAdvance(true);\n      } catch {}\n    });\n    const doVaultUnlock = async (ttlMs: number) => {\n      const contract = analysis.vaultLockedTo;\n      const chainIdHex = analysis.vaultChainIdHex ?? state.meta?.chainIdHex ?? (requestQueue[0] as { chainIdHex?: string })?.chainIdHex ?? \"0x0\";\n      if (!contract) return;\n      try {\n        const res = await safeSendMessage<any>({ type: \"VAULT_UNLOCK\", payload: { chainIdHex, contract, ttlMs } }, 3000);\n        if (res?.ok) {\n          const mins = Math.round(ttlMs / 60000);\n          showToast(t(\"vault_unlocked_toast\")?.replace(\"{n}\", String(mins)) || `Desbloqueado por ${mins} min`);\n          await loadSettings();\n          retryAnalyze();\n        }\n      } catch { /* ignore */ }\n    };\n    state.shadow.getElementById(\"sg-btn-vault-unlock-5\")?.addEventListener(\"click\", () => doVaultUnlock(5 * 60 * 1000));\n    state.shadow.getElementById(\"sg-btn-vault-unlock-30\")?.addEventListener(\"click\", () => doVaultUnlock(30 * 60 * 1000));\n    const initialFocusBtn = state.shadow.querySelector<HTMLElement>(\"[data-sg-initial-focus]\");\n    if (initialFocusBtn) initialFocusBtn.focus();\n    const allowanceEl = state.shadow.getElementById(\"sg-allowance-block\");\n    if (allowanceEl && overlaySpender) {\n      const token = (analysis.tx as { to?: string } | undefined)?.to;\n      const p0 = state.meta?.params?.[0];\n      const owner = p0 && typeof p0 === \"object\" ? (p0 as { from?: string }).from : undefined;\n      const chainIdHex = state.meta?.chainIdHex ?? (requestQueue[0] as { chainIdHex?: string } | undefined)?.chainIdHex;\n      const isNft =\n        (analysis.txExtras as { approvalType?: string } | undefined)?.approvalType === \"NFT_SET_APPROVAL_FOR_ALL\" ||\n        (analysis.decodedAction as { kind?: string } | undefined)?.kind === \"SET_APPROVAL_FOR_ALL\";\n      if (token && owner && /^0x[a-fA-F0-9]{40}$/.test(token) && /^0x[a-fA-F0-9]{40}$/.test(owner)) {\n        fetchCurrentAllowance(chainIdHex, token, owner, overlaySpender, isNft).then((val) => {\n          if (val != null && __sgOverlay?.requestId === state.requestId) {\n            const el = state.shadow.getElementById(\"sg-allowance-block\");\n            if (el) el.textContent = (t(\"overlay_allowance_current\") || \"Allowance atual: \") + val;\n          }\n        }).catch(() => {});\n      }\n    }\n  }, 0);\n}\n\nfunction cleanupOverlay() {\n  if (__sgOverlay) {\n    try { if (__sgOverlay._watchdogId != null) clearTimeout(__sgOverlay._watchdogId); } catch {}\n    try { __sgOverlay._restore?.(); } catch {}\n    try { document.removeEventListener(\"keydown\", __sgOverlay.onKey); } catch {}\n    try { __sgOverlay.container.remove(); } catch {}\n    __sgOverlay = null;\n  }\n}\n\n// --- L\u00D3GICA DE DECIS\u00C3O ---\n\nconst requestQueue: Array<{\n  requestId: string;\n  method: string;\n  host: string;\n  params?: any;\n  chainIdHex?: string;\n  chainIdRequested?: string;\n  analysis: Analysis | { level: string };\n  analyzePayload?: AnalyzeRequest;\n}> = [];\n\nfunction showCurrentPending() {\n  const cur = requestQueue[0];\n  if (cur) {\n    showOverlay(cur.requestId, cur.analysis as Analysis, {\n      host: cur.host,\n      method: cur.method,\n      params: cur.params,\n      chainIdHex: cur.chainIdHex ?? null,\n      chainIdRequested: cur.chainIdRequested,\n      gateUI: (cur as { _uiGate?: boolean })._uiGate ?? false,\n    });\n  }\n}\n\n/** P0-B: Re-dispatch ANALYZE for current request (Tentar novamente). */\nasync function retryAnalyze() {\n  const cur = requestQueue[0];\n  if (!cur?.analyzePayload) return;\n  const loadingAnalysis = { level: \"LOADING\" as const, score: 0, title: \"\", reasons: [], recommend: \"WARN\" as const };\n  cur.analysis = loadingAnalysis as unknown as Analysis | { level: string };\n  if (__sgOverlay && __sgOverlay.requestId === cur.requestId) {\n    __sgOverlay.analysis = loadingAnalysis as unknown as Analysis;\n    updateOverlay(__sgOverlay);\n  }\n  try {\n    const resp = await safeSendMessage<{ ok?: boolean; analysis?: Analysis }>(\n      { type: \"ANALYZE\", payload: cur.analyzePayload },\n      { timeoutMs: 8000, preferPort: true }\n    );\n    if (resp?.analysis) {\n      cur.analysis = resp.analysis;\n      if (__sgOverlay && __sgOverlay.requestId === cur.requestId) {\n        __sgOverlay.analysis = resp.analysis;\n        updateOverlay(__sgOverlay);\n      }\n    }\n  } catch {\n    const fallback = {\n      level: \"WARN\" as const,\n      score: 0,\n      title: t(\"overlay_analysis_unavailable\") || \"An\u00E1lise indispon\u00EDvel\",\n      reasons: [t(\"overlay_analysis_fallback\") || \"N\u00E3o foi poss\u00EDvel obter a an\u00E1lise.\"],\n      recommend: \"WARN\" as const,\n    };\n    cur.analysis = fallback as unknown as Analysis | { level: string };\n    if (__sgOverlay && __sgOverlay.requestId === cur.requestId) {\n      __sgOverlay.analysis = fallback;\n      updateOverlay(__sgOverlay);\n    }\n  }\n}\n\nfunction decideCurrentAndAdvance(allow: boolean, userTriggered = true) {\n  const cur = requestQueue[0];\n  if (!cur) return;\n\n  try {\n    safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"DECISION\", requestId: cur.requestId, decision: allow ? \"ALLOW\" : \"BLOCK\", method: cur.method, host: cur.host } }, 500);\n  } catch { /* ignore */ }\n\n  console.log(`\uD83D\uDCE8 [SignGuard Content] ${userTriggered ? \"User decided\" : \"Auto\"}: ${allow ? \"ALLOW\" : \"BLOCK\"}`);\n\n  const analysis = cur.analysis as Analysis;\n  const chainKey = cur.chainIdHex ? String(cur.chainIdHex).toLowerCase() : \"\";\n  const nativeInfo = chainKey ? __sgNativeUsd[chainKey] : null;\n  const nativeSymbol = nativeInfo?.symbol ?? (cur.chainIdHex ? getNativeSymbol(cur.chainIdHex) : \"ETH\");\n  const usdPerNative = nativeInfo?.usd ?? (analysis.txCostPreview as { usdPerNative?: number } | undefined)?.usdPerNative;\n  const tx = analysis.tx ?? analysis.txCostPreview;\n  const valueEth =\n    (analysis.tx as { valueEth?: string } | undefined)?.valueEth ??\n    (tx && (tx as { valueWei?: string }).valueWei\n      ? weiToEthFmt(BigInt((tx as { valueWei: string }).valueWei))\n      : undefined);\n  const feeLikely = (analysis.txCostPreview as { feeLikelyWei?: string } | undefined)?.feeLikelyWei\n    ? weiToEthFmt(BigInt((analysis.txCostPreview as { feeLikelyWei: string }).feeLikelyWei))\n    : (analysis.tx as { maxGasFeeEth?: string } | undefined)?.maxGasFeeEth;\n  const feeMax = (analysis.txCostPreview as { feeMaxWei?: string } | undefined)?.feeMaxWei\n    ? weiToEthFmt(BigInt((analysis.txCostPreview as { feeMaxWei: string }).feeMaxWei))\n    : (analysis.tx as { maxGasFeeEth?: string } | undefined)?.maxGasFeeEth;\n  const totalLikely = (analysis.txCostPreview as { totalLikelyWei?: string } | undefined)?.totalLikelyWei\n    ? weiToEthFmt(BigInt((analysis.txCostPreview as { totalLikelyWei: string }).totalLikelyWei))\n    : (analysis.tx as { maxTotalEth?: string } | undefined)?.maxTotalEth;\n  const totalMax = (analysis.txCostPreview as { totalMaxWei?: string } | undefined)?.totalMaxWei\n    ? weiToEthFmt(BigInt((analysis.txCostPreview as { totalMaxWei: string }).totalMaxWei))\n    : (analysis.tx as { maxTotalEth?: string } | undefined)?.maxTotalEth;\n\n  const historyEvt = {\n    ts: Date.now(),\n    requestId: cur.requestId,\n    host: cur.host,\n    method: cur.method,\n    to: (analysis.tx as { to?: string } | undefined)?.to,\n    valueEth,\n    feeLikelyEth: feeLikely,\n    feeMaxEth: feeMax,\n    totalLikelyEth: totalLikely,\n    totalMaxEth: totalMax,\n    nativeSymbol,\n    usdPerNative: usdPerNative ?? undefined,\n    decision: allow ? \"ALLOW\" : \"BLOCK\",\n    score: analysis.score,\n    level: analysis.level,\n  };\n  safeSendMessage({ type: \"SG_LOG_HISTORY\", payload: historyEvt }).catch(() => {});\n\n  const uiGate = (cur as { _uiGate?: boolean })._uiGate ?? false;\n  const meta: DecisionMeta = { uiConfirmed: userTriggered, uiGate, method: cur.method };\n  if (userTriggered) {\n    try { safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"DECISION_SENT\", requestId: cur.requestId, method: cur.method, decision: allow ? \"ALLOW\" : \"BLOCK\" } }, 500); } catch { /* ignore */ }\n  }\n  const dedupeKey = (cur as any)._dedupeKey as string | undefined;\n  const entry = dedupeKey ? __sgDedupeMap.get(dedupeKey) : undefined;\n  const relayOrigin = (cur as { _relayOrigin?: Window })._relayOrigin;\n\n  if (relayOrigin) {\n    const rids = entry ? Array.from(entry.requestIds) : [cur.requestId];\n    for (const rid of rids) {\n      try {\n        relayOrigin.postMessage(\n          {\n            source: \"signguard\",\n            type: \"SG_RELAY_DECISION\",\n            relay: { requestId: rid, ts: Date.now() },\n            decision: { allow, analysis: cur.analysis, meta },\n          },\n          \"*\"\n        );\n      } catch (e) {\n        console.warn(\"[SignGuard Content] relay decision postMessage failed\", rid, e);\n      }\n    }\n    if (dedupeKey) __sgDedupeMap.delete(dedupeKey);\n  } else {\n    if (entry && dedupeKey) {\n      for (const rid of entry.requestIds) sendDecisionToMainWorld(rid, allow, meta);\n      __sgDedupeMap.delete(dedupeKey);\n    } else {\n      sendDecisionToMainWorld(cur.requestId, allow, meta);\n    }\n  }\n\n  requestQueue.shift();\n  cleanupOverlay();\n\n  if (requestQueue.length > 0) setTimeout(showCurrentPending, 100);\n}\n\nfunction requestFeeEstimateFromMainWorld(requestId: string, tx: unknown): Promise<FeeEstimateWire> {\n  return new Promise((resolve) => {\n    const timeout = setTimeout(() => {\n      window.removeEventListener(\"message\", handler);\n      resolve({ ok: false, feeEstimated: false, error: \"timeout\" });\n    }, 2200);\n    const handler = (ev: MessageEvent) => {\n      if (ev.source !== window || ev.data?.source !== \"signguard\" || ev.data?.type !== \"SG_FEE_ESTIMATE_RES\") return;\n      if (ev.data.requestId !== requestId) return;\n      clearTimeout(timeout);\n      window.removeEventListener(\"message\", handler);\n      resolve(ev.data.feeEstimate ?? { ok: false, feeEstimated: false });\n    };\n    window.addEventListener(\"message\", handler);\n    window.postMessage({ source: \"signguard-content\", type: \"SG_FEE_ESTIMATE_REQ\", payload: { requestId, tx } }, \"*\");\n  });\n}\n\n// --- LISTENER DE MENSAGENS ---\n\nwindow.addEventListener(\"message\", async (ev) => {\n  if (ev.source !== window || !ev.data) return;\n  if (ev.data.source === \"signguard-mainworld\") {\n    const d = ev.data;\n    if (d.type === \"SG_DIAG_TIMEOUT\") {\n      try {\n        safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: d.failMode === \"fail_closed\" ? \"FAILCLOSED_TIMEOUT\" : \"FAILOPEN_TIMEOUT\", requestId: d.requestId, method: d.method } }, 500);\n      } catch { /* ignore */ }\n    } else if (d.type === \"SG_RELEASED\") {\n      try {\n        safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"MAINWORLD_RELEASE\", requestId: d.requestId, method: d.method } }, 500);\n      } catch { /* ignore */ }\n    }\n    return;\n  }\n  if (ev.data.source !== \"signguard\") return;\n\n  const type = ev.data.type;\n  let requestId: string;\n  let payload: any;\n  let relayOrigin: Window | null = null;\n  let relayOriginHref = \"\";\n\n  if (type === \"SG_RELAY_DECISION\") {\n    const relay = ev.data.relay;\n    const decision = ev.data.decision;\n    const rid = relay?.requestId;\n    const allow = decision?.allow === true;\n    const meta = decision?.meta;\n    const rec = rid != null ? relayPending.get(rid) : undefined;\n    if (rec?.timeoutId) clearTimeout(rec.timeoutId);\n    if (rid != null) relayPending.delete(rid);\n    if (rid != null) sendDecisionToMainWorld(rid, allow, meta);\n    return;\n  }\n\n  if (type === \"SG_RELAY_REQUEST\") {\n    if (!IS_TOP_FRAME) return;\n    requestId = ev.data.relay?.requestId ?? \"\";\n    payload = ev.data.req ?? {};\n    relayOrigin = ev.source as Window;\n    relayOriginHref = ev.data.relay?.originHref ?? \"\";\n    console.log(\"[SignGuard Content] top received relay\", { requestId, method: payload?.method, origin: relayOriginHref });\n  } else if (type === \"SG_REQUEST\") {\n    requestId = ev.data.requestId;\n    payload = ev.data.payload ?? {};\n  } else {\n    if (type === \"SG_PREVIEW\") {\n      const pid = ev.data.requestId;\n      const ppayload = ev.data.payload;\n      const chainIdHex = ppayload?.chainIdHex;\n      const txCostPreview = ppayload?.txCostPreview;\n      __sgPreflightCache.set(pid, { chainIdHex, txCostPreview });\n      console.log(\"\uD83D\uDCE8 [SignGuard Content] SG_PREVIEW received\");\n      const cur = requestQueue.find((r) => r.requestId === pid);\n      if (cur) {\n        if (chainIdHex) cur.chainIdHex = chainIdHex;\n        if (txCostPreview) (cur.analysis as any).txCostPreview = txCostPreview;\n        if (requestQueue[0]?.requestId === pid) showCurrentPending();\n      }\n      return;\n    }\n    return;\n  }\n\n  await loadSettings();\n  const method = (payload?.method ?? \"\").toLowerCase();\n  const gateUI = shouldGateUI(method);\n  const failMode = gateUI ? \"fail_closed\" : (__sgSettings?.failMode ?? \"fail_open\");\n\n  if (!relayOrigin) {\n    window.postMessage({ source: \"signguard-content\", type: \"SG_SETTINGS\", requestId, failMode }, \"*\");\n    try {\n      safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"MAINWORLD_HOLD_START\", requestId, method: payload?.method, host: (payload?.host && String(payload.host).trim()) ? String(payload.host).trim() : \"\" } }, 500);\n    } catch { /* ignore */ }\n    console.log(\"\uD83D\uDCE8 [SignGuard Content] Request received:\", payload?.method, \"requestId=\" + requestId);\n\n    const hostForCheck = (payload?.host && String(payload.host).trim()) ? String(payload.host).trim() : (() => {\n      try { return new URL(payload?.url ?? window.location.href).hostname || \"\"; } catch { return \"\"; }\n    })();\n\n    const paused = typeof __sgSettings?.pausedUntil === \"number\" && Date.now() < __sgSettings.pausedUntil;\n\n    if (paused) {\n      console.log(\"[SignGuard UI] UI gate bypassed due to EXTENSION_PAUSED\");\n      sendDecisionToMainWorld(requestId, true, { uiConfirmed: false, uiGate: true, reasonKeys: [\"EXTENSION_PAUSED\"], method });\n      return;\n    }\n\n    if (!gateUI) {\n      try {\n        const res = await safeSendMessage<{ ok?: boolean; allowed?: boolean }>(\n          { type: \"SG_CHECK_TEMP_ALLOW\", payload: { host: hostForCheck, spender: null } },\n          { timeoutMs: 500 }\n        );\n        if (res?.ok && res?.allowed) {\n          sendDecisionToMainWorld(requestId, true, { uiConfirmed: false, uiGate: false, method });\n          return;\n        }\n      } catch { /* ignore */ }\n    }\n\n    const methodForAuto = method;\n    if (AUTO_ALLOW_METHODS.has(methodForAuto)) {\n      try {\n        safeSendMessage({ type: \"SG_DIAG_PUSH\", payload: { kind: \"REQ\", requestId, method: methodForAuto, host: hostForCheck } }, 500);\n      } catch { /* ignore */ }\n      sendDecisionToMainWorld(requestId, true, { uiConfirmed: false, uiGate: false, method });\n      return;\n    }\n\n    if (!IS_TOP_FRAME) {\n      const meth = String(payload?.method ?? \"\").toLowerCase();\n      const isUiGated = shouldGateUI(meth);\n      const allowOnTimeout = !isUiGated && failMode === \"fail_open\";\n      console.log(\"[SignGuard Content] iframe request -> relaying to top\", { requestId, method: payload?.method, href: location.href });\n      try {\n        window.top?.postMessage(\n          { source: \"signguard\", type: \"SG_RELAY_REQUEST\", relay: { requestId, originHref: location.href, ts: Date.now() }, req: payload },\n          \"*\"\n        );\n      } catch (e) {\n        console.warn(\"[SignGuard Content] relay postMessage failed\", e);\n      }\n      const timeoutId = setTimeout(() => {\n        relayPending.delete(requestId);\n        sendDecisionToMainWorld(requestId, allowOnTimeout, {\n          uiConfirmed: false,\n          uiGate: isUiGated,\n          method: payload?.method,\n          reasonKeys: [\"RELAY_TIMEOUT\"],\n        });\n        console.warn(\"[SignGuard Content] relay timeout, applying failMode\", { failMode, isUiGated });\n      }, RELAY_TIMEOUT_MS);\n      relayPending.set(requestId, { timeoutId });\n      return;\n    }\n  }\n\n  const url = payload?.url ?? window.location.href;\n  const origin = (() => {\n    try { return new URL(url).origin; } catch { return window.location.origin; }\n  })();\n\n  const rpcMeta = (payload as any)?.meta ?? null;\n  const params = Array.isArray(payload?.params) ? payload.params : [];\n  const p0 = params[0] && typeof params[0] === \"object\" ? params[0] : null;\n\n  let chainIdHex =\n    (payload as any)?.chainIdHex ||\n    toChainIdHex(rpcMeta?.chainId) ||\n    toChainIdHex((payload as any)?.chainId) ||\n    null;\n  if (method === \"wallet_switchethereumchain\" && p0?.chainId) {\n    const fromParams = toChainIdHex(p0.chainId);\n    if (fromParams) chainIdHex = fromParams;\n  }\n  if (method === \"wallet_addethereumchain\" && p0?.chainId) {\n    const fromParams = toChainIdHex(p0.chainId);\n    if (fromParams) chainIdHex = fromParams;\n  }\n\n  const host = (payload?.host && String(payload.host).trim()) ? String(payload.host).trim() : inferHost(url);\n\n  const cached = __sgPreflightCache.get(requestId);\n  const mergedChainIdHex =\n    (payload as any)?.chainIdHex || chainIdHex || cached?.chainIdHex || null;\n  const mergedMeta = rpcMeta\n    ? { ...rpcMeta, chainIdHex: mergedChainIdHex ?? undefined, chainIdRequested: rpcMeta?.chainIdRequested ?? undefined }\n    : mergedChainIdHex || (rpcMeta as any)?.chainIdRequested\n      ? { chainIdHex: mergedChainIdHex ?? undefined, chainIdRequested: (rpcMeta as any)?.chainIdRequested ?? undefined }\n      : undefined;\n\n  const txCostPreviewMerged = cached?.txCostPreview ?? (payload as any)?.txCostPreview;\n\n  const mergedMetaWithPageRisk = __sgPageRiskResult\n    ? { ...mergedMeta, pageRisk: { score: __sgPageRiskResult.riskScore, reasons: __sgPageRiskResult.reasons } }\n    : mergedMeta;\n  const analyzePayload: AnalyzeRequest = {\n    requestId,\n    url,\n    origin,\n    request: { method: payload?.method ?? \"\", params: Array.isArray(payload?.params) ? payload.params : [] },\n    meta: mergedMetaWithPageRisk,\n  };\n  if (txCostPreviewMerged) analyzePayload.txCostPreview = txCostPreviewMerged;\n\n  if (cached) __sgPreflightCache.delete(requestId);\n\n  const chainIdRequested = (rpcMeta as any)?.chainIdRequested ?? (p0 as any)?.chainId;\n\n  const pending = {\n    requestId,\n    method: payload?.method ?? \"\",\n    host,\n    params: payload?.params,\n    chainIdHex: mergedChainIdHex ?? undefined,\n    chainIdRequested: typeof chainIdRequested === \"string\" ? chainIdRequested : undefined,\n    analysis: { level: \"LOADING\", score: 0, title: \"\", reasons: [], recommend: \"WARN\" } as unknown as Analysis,\n    analyzePayload,\n  };\n  (pending as { _uiGate?: boolean })._uiGate = gateUI;\n  if (txCostPreviewMerged) (pending.analysis as any).txCostPreview = txCostPreviewMerged;\n  if (relayOrigin) {\n    (pending as { _relayOrigin?: Window })._relayOrigin = relayOrigin;\n    (pending as { _relayRequestId?: string })._relayRequestId = requestId;\n  }\n\n  // P1-7: Dedupe Map \u2014 same method+host+params+origin within 3s merges requestIds (single overlay, fan-out on decide)\n  const originHrefForDedupe = relayOriginHref || (typeof location !== \"undefined\" ? location.href : \"\");\n  const dupKey = `${host}|${method}|${stableStringifyParams(params ?? [])}|${originHrefForDedupe}`;\n  for (const [k, ent] of __sgDedupeMap.entries()) {\n    if (Date.now() - ent.addedAt >= DEDUPE_MS) __sgDedupeMap.delete(k);\n  }\n  const existing = __sgDedupeMap.get(dupKey);\n  if (existing && Date.now() - existing.addedAt < DEDUPE_MS) {\n    existing.requestIds.add(requestId);\n    return; // no new overlay; will get decision when primary is decided\n  }\n  __sgDedupeMap.set(dupKey, { primaryRequestId: requestId, requestIds: new Set([requestId]), addedAt: Date.now() });\n  (pending as any)._dedupeKey = dupKey;\n  requestQueue.push(pending);\n\n  if (requestQueue.length === 1) showCurrentPending();\n\n  const ANALYSIS_TIMEOUT_MS = 9000;\n  let watchdogFired = false;\n  const makeFallback = () => {\n    const failMode = __sgSettings?.failMode ?? \"fail_open\";\n    return {\n      level: \"WARN\" as const,\n      score: 0,\n      title: t(\"overlay_analysis_unavailable\") || \"An\u00E1lise indispon\u00EDvel\",\n      reasons: [t(\"overlay_analysis_fallback\") || \"N\u00E3o foi poss\u00EDvel obter a an\u00E1lise agora. Voc\u00EA ainda pode BLOQUEAR ou CONTINUAR.\"],\n      recommend: failMode === \"fail_closed\" ? (\"BLOCK\" as const) : (\"WARN\" as const),\n      reasonKeys: [REASON_KEYS.FAILMODE_FALLBACK],\n      _isFallback: true as const,\n    };\n  };\n  const watchdog = setTimeout(() => {\n    if (watchdogFired) return;\n    watchdogFired = true;\n    const p = requestQueue.find((r) => r.requestId === requestId);\n    if (!p || (p.analysis as any)?.level !== \"LOADING\") return;\n    const fallbackAnalysis = makeFallback() as unknown as Analysis;\n    p.analysis = fallbackAnalysis;\n    if (__sgOverlay && __sgOverlay.requestId === requestId) {\n      __sgOverlay.analysis = fallbackAnalysis;\n      updateOverlay(__sgOverlay);\n    }\n  }, ANALYSIS_TIMEOUT_MS);\n\n  try {\n    const response = await safeSendMessage<{ ok?: boolean; analysis?: Analysis }>(\n      { type: \"ANALYZE\", payload: analyzePayload },\n      { timeoutMs: 8000, preferPort: true }\n    );\n\n    clearTimeout(watchdog);\n\n    if (pending.requestId === requestId && response?.analysis) {\n      pending.analysis = response.analysis;\n      const spenderFromAnalysis = (() => {\n        const a = response.analysis as Analysis;\n        const da = a?.decodedAction as { spender?: string; operator?: string } | undefined;\n        if (da?.spender && /^0x[a-fA-F0-9]{40}$/.test(da.spender)) return da.spender.toLowerCase();\n        if (da?.operator && /^0x[a-fA-F0-9]{40}$/.test(da.operator)) return da.operator.toLowerCase();\n        const te = a?.txExtras as { spender?: string; operator?: string } | undefined;\n        if (te?.spender && /^0x[a-fA-F0-9]{40}$/.test(te.spender)) return te.spender.toLowerCase();\n        if (a?.typedDataExtras?.spender && /^0x[a-fA-F0-9]{40}$/.test(a.typedDataExtras.spender)) return a.typedDataExtras.spender.toLowerCase();\n        return null;\n      })();\n      if (!(pending as { _uiGate?: boolean })._uiGate) {\n        try {\n          const res2 = await safeSendMessage<{ ok?: boolean; allowed?: boolean }>(\n            { type: \"SG_CHECK_TEMP_ALLOW\", payload: { host: pending.host, spender: spenderFromAnalysis } },\n            { timeoutMs: 500 }\n          );\n        if (res2?.ok && res2?.allowed) {\n          const cur = requestQueue[0];\n          if (cur && cur.requestId === requestId) {\n            decideCurrentAndAdvance(true, false);\n          }\n          return;\n        }\n        } catch { /* ignore */ }\n      }\n\n      if (__sgOverlay && __sgOverlay.requestId === requestId) {\n        __sgOverlay.analysis = response.analysis;\n        updateOverlay(__sgOverlay);\n      }\n    } else if (pending.requestId === requestId && !response?.analysis) {\n      const fallbackAnalysis = (() => {\n        const failMode = __sgSettings?.failMode ?? \"fail_open\";\n        return {\n          level: \"WARN\" as const,\n          score: 0,\n          title: t(\"overlay_analysis_unavailable\") || \"An\u00E1lise indispon\u00EDvel\",\n          reasons: [t(\"overlay_analysis_fallback\") || \"N\u00E3o foi poss\u00EDvel obter a an\u00E1lise agora. Voc\u00EA ainda pode BLOQUEAR ou CONTINUAR.\"],\n          recommend: failMode === \"fail_closed\" ? (\"BLOCK\" as const) : (\"WARN\" as const),\n          reasonKeys: [REASON_KEYS.FAILMODE_FALLBACK],\n          _isFallback: true as const,\n        } as unknown as Analysis;\n      })();\n      pending.analysis = fallbackAnalysis;\n      if (__sgOverlay && __sgOverlay.requestId === requestId) {\n        __sgOverlay.analysis = fallbackAnalysis;\n        updateOverlay(__sgOverlay);\n      }\n    }\n  } catch (e) {\n    clearTimeout(watchdog);\n    console.error(\"[SignGuard] handleSGRequest crash:\", e);\n    if (pending.requestId === requestId) {\n      const failMode = __sgSettings?.failMode ?? \"fail_open\";\n      const fallbackAnalysis = {\n        level: \"WARN\" as const,\n        score: 0,\n        title: t(\"overlay_analysis_unavailable\") || \"An\u00E1lise indispon\u00EDvel\",\n        reasons: [t(\"overlay_analysis_fallback\") || \"N\u00E3o foi poss\u00EDvel obter a an\u00E1lise agora. Voc\u00EA ainda pode BLOQUEAR ou CONTINUAR.\"],\n        recommend: failMode === \"fail_closed\" ? (\"BLOCK\" as const) : (\"WARN\" as const),\n        reasonKeys: [REASON_KEYS.FAILMODE_FALLBACK],\n        _isFallback: true as const,\n      } as unknown as Analysis;\n      pending.analysis = fallbackAnalysis;\n      if (__sgOverlay && __sgOverlay.requestId === requestId) {\n        __sgOverlay.analysis = fallbackAnalysis;\n        updateOverlay(__sgOverlay);\n      }\n    }\n  }\n});\n\n// --- PAGE RISK: scan on init, banner when MEDIUM+\nfunction initPageRiskScan() {\n  try {\n    const doc = document;\n    const hostname = location.hostname || \"\";\n    __sgPageRiskResult = runPageRiskScan(doc, hostname);\n    if (__sgPageRiskResult.riskScore === \"MEDIUM\" || __sgPageRiskResult.riskScore === \"HIGH\") {\n      const msg =\n        __sgPageRiskResult.reasons?.length > 0\n          ? __sgPageRiskResult.reasons.join(\" \")\n          : (t(\"page_risk_warning\") || \"P\u00E1gina com poss\u00EDvel risco detectado.\");\n      injectPageRiskBanner(msg, doc);\n    }\n  } catch (e) {\n    console.warn(\"[SignGuard] Page risk scan failed:\", e);\n  }\n}\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initPageRiskScan);\n} else {\n  initPageRiskScan();\n}\n"],
  "mappings": "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",
  "names": ["state", "chainIdHex", "failMode"]
}
