{
  "version": 3,
  "sources": ["../src/lists/cryptoTrustedDomainsSeed.ts", "../src/shared/utils.ts", "../src/services/simulationService.ts", "../src/services/listSeeds.ts", "../src/services/listManager.ts", "../src/shared/types.ts", "../src/shared/decode.ts", "../src/background.ts", "../src/txMath.ts", "../src/i18n.ts", "../src/shared/trust.ts", "../src/shared/explain.ts", "../src/shared/constants.ts", "../src/intelSources.ts", "../src/intel.ts", "../src/addressIntel.ts", "../src/txHumanize.ts", "../src/domainRisk.ts", "../src/services/honeypotService.ts", "../src/shared/optionalOrigins.ts", "../src/permissions.ts", "../src/services/netGate.ts", "../src/services/tokenSecurity.ts", "../src/services/tokenRisk.ts", "../src/shared/chains.ts", "../src/services/priceService.ts", "../src/services/tokenMetaViaProvider.ts", "../src/services/telemetryService.ts", "../src/shared/interestMap.ts", "../src/shared/reasonKeys.ts", "../src/shared/normalize.ts"],
  "sourcesContent": ["/**\n * Seed de dom\u00EDnios confi\u00E1veis crypto-only (sem twitter/discord/social).\n * Usado em allowlist/trustedDomains e listSeeds.\n */\n\nexport const CRYPTO_TRUSTED_DOMAINS_SEED: string[] = [\n  // Explorers\n  \"etherscan.io\",\n  \"etherscan.com\",\n  \"arbiscan.io\",\n  \"polygonscan.com\",\n  \"bscscan.com\",\n  \"basescan.org\",\n  \"snowtrace.io\",\n  \"optimistic.etherscan.io\",\n  // NFTs\n  \"opensea.io\",\n  \"blur.io\",\n  \"looksrare.org\",\n  \"x2y2.io\",\n  \"rarible.com\",\n  \"magiceden.io\",\n  // DEX/DeFi\n  \"uniswap.org\",\n  \"app.uniswap.org\",\n  \"1inch.io\",\n  \"app.1inch.io\",\n  \"aave.com\",\n  \"app.aave.com\",\n  \"curve.fi\",\n  \"app.curve.fi\",\n  \"balancer.fi\",\n  \"app.balancer.fi\",\n  \"sushiswap.fi\",\n  \"matcha.xyz\",\n  \"paraswap.io\",\n  \"cowswap.exchange\",\n  // Bridges/L2\n  \"bridge.arbitrum.io\",\n  \"optimism.io\",\n  \"base.org\",\n  \"arbitrum.io\",\n  \"polygon.technology\",\n  \"hop.exchange\",\n  \"stargate.finance\",\n  \"across.to\",\n  \"portalbridge.com\",\n  \"zksync.io\",\n  // Infra / Wallets\n  \"chain.link\",\n  \"lido.fi\",\n  \"stake.lido.fi\",\n  \"ens.domains\",\n  \"app.ens.domains\",\n  \"metamask.io\",\n  \"metamask.com\",\n  \"rabby.io\",\n  \"walletconnect.com\",\n  \"walletconnect.org\",\n  \"safe.global\",\n  \"revoke.cash\",\n  \"app.revoke.cash\",\n];\n", "export function clamp(n: number, a: number, b: number) {\n  return Math.max(a, Math.min(b, n));\n}\n\nexport function hostFromUrl(url: string): string {\n  try {\n    return new URL(url).hostname.toLowerCase();\n  } catch {\n    return \"\";\n  }\n}\n\nexport function normalizeDomainLine(s: string) {\n  return (s || \"\").trim().toLowerCase().replace(/^\\.+/, \"\").replace(/\\.+$/, \"\");\n}\n\nexport function isAllowlisted(host: string, allowlist: string[]) {\n  const h = (host || \"\").toLowerCase();\n  return allowlist.some((d) => {\n    const dom = normalizeDomainLine(d);\n    if (!dom) return false;\n    return h === dom || h.endsWith(\".\" + dom);\n  });\n}\n\n/** Normalize host for comparison: lowercase, trim trailing dot. Do NOT strip www when storing. */\nexport function normalizeHost(host: string): string {\n  return (host || \"\").toLowerCase().replace(/\\.+$/, \"\").trim();\n}\n\n/** Match host to domain: exact or subdomain. Do NOT use endsWith(domain) without dot. */\nexport function isHostMatch(host: string, domain: string): boolean {\n  const h = normalizeHost(host);\n  const d = (domain || \"\").toLowerCase().trim();\n  if (!d) return false;\n  return h === d || h.endsWith(\".\" + d);\n}\n\n/** Normalize address: lowercase 0x + 40 hex. Returns \"\" if invalid. */\nexport function normalizeAddress(addr: string): string {\n  const s = (addr || \"\").trim();\n  const hex = s.startsWith(\"0x\") ? s.slice(2) : s;\n  if (hex.length !== 40 || !/^[a-fA-F0-9]{40}$/.test(hex)) return \"\";\n  return \"0x\" + hex.toLowerCase();\n}\n\n/** Build cache key for token (chainId:addressLower). */\nexport function normalizeTokenKey(chainId: string, addr: string): string {\n  const a = normalizeAddress(addr);\n  const c = (chainId || \"\").toLowerCase().replace(/^0x/, \"\") || \"0\";\n  return `${c}:${a}`;\n}\n\nexport function isHexString(v: any): v is string {\n  return typeof v === \"string\" && /^0x[0-9a-fA-F]*$/.test(v);\n}\n\nexport function hexSelector(data: string) {\n  if (!isHexString(data) || data.length < 10) return null;\n  return data.slice(0, 10).toLowerCase();\n}\n\nexport function escapeHtml(s: any) {\n  const str = String(s ?? \"\");\n  return str\n    .replaceAll(\"&\", \"&amp;\")\n    .replaceAll(\"<\", \"&lt;\")\n    .replaceAll(\">\", \"&gt;\")\n    .replaceAll('\"', \"&quot;\")\n    .replaceAll(\"'\", \"&#039;\");\n}\n\n", "/**\r\n * Tenderly transaction simulation service for SignGuard.\r\n * Simulates transactions before they are sent to detect reverts and asset changes.\r\n * Uses internal API key (isolated/free account).\r\n */\r\n\r\nimport type { Settings } from \"../shared/types\";\r\n\r\nconst TENDERLY_API_BASE = \"https://api.tenderly.co/api/v1\";\r\nconst SIMULATE_TIMEOUT_MS = 4000;\r\n\r\n/** No hardcoded credentials. Use settings.simulation (tenderlyAccount, tenderlyProject, tenderlyKey). When missing \u2192 static-only mode. */\r\n\r\n/** Request body for Tenderly simulate endpoint. */\r\nexport interface SimulateTransactionBody {\r\n  network_id: string;\r\n  from: string;\r\n  to: string;\r\n  input: string;\r\n  value: string;\r\n  gas?: number;\r\n}\r\n\r\n/** Single asset entry for UI. */\r\nexport interface SimulationAsset {\r\n  symbol: string;\r\n  amount: string;\r\n  logo?: string;\r\n}\r\n\r\n/** Approval decoded from logs. */\r\nexport type SimulationApproval = {\r\n  token: string;\r\n  spender: string;\r\n  approved: boolean;\r\n  unlimited?: boolean;\r\n  /** True when from ApprovalForAll event (ERC721/1155). */\r\n  approvalForAll?: boolean;\r\n};\r\n\r\n/** Simplified outcome for the overlay UI. */\r\nexport type SimulationOutcome = {\r\n  status: \"SUCCESS\" | \"REVERT\" | \"RISK\" | \"SKIPPED\";\r\n  outgoingAssets: SimulationAsset[];\r\n  incomingAssets: SimulationAsset[];\r\n  /** Approvals detected from simulation logs (ERC20 Approval, ERC721/1155 ApprovalForAll). */\r\n  approvals?: SimulationApproval[];\r\n  gasUsed: string;\r\n  /** True when simulation was skipped (API failure / no credentials). */\r\n  fallback?: boolean;\r\n  /** Estimated gas cost in wei (gas_used * gas_price) when available. */\r\n  gasCostWei?: string;\r\n  /** True when estimated gas cost > $50 and tx value < $50 (set by background). */\r\n  isHighGas?: boolean;\r\n  /** False when running without API (no keys / timeout); show \"Modo Est\u00E1tico\" CTA. */\r\n  simulated?: boolean;\r\n  /** Message when simulated is false (e.g. \"Modo Est\u00E1tico (Adicione chaves para Simula\u00E7\u00E3o)\"). */\r\n  message?: string;\r\n};\r\n\r\n/** Single asset change from Tenderly. */\r\ntype AssetChange = {\r\n  asset_info?: { symbol?: string; name?: string; logo?: string; decimals?: number; contract_address?: string };\r\n  type?: string;\r\n  from?: string;\r\n  to?: string;\r\n  amount?: string;\r\n  raw_amount?: string;\r\n  dollar_value?: number;\r\n};\r\n\r\n/** Raw Tenderly simulation response (relevant fields). */\r\ninterface TenderlySimulationResponse {\r\n  transaction?: {\r\n    status?: number; // 0 = success, 1 = reverted\r\n    transaction_info?: {\r\n      call_trace?: unknown;\r\n      asset_changes?: AssetChange[];\r\n      logs?: Array<{ address?: string; topics?: string[]; data?: string }>;\r\n    };\r\n  };\r\n  simulation?: { id?: string; status?: boolean };\r\n  asset_changes?: AssetChange[];\r\n  gas_used?: string;\r\n  gas_price?: string;\r\n  effective_gas_price?: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nconst KECCAK_APPROVAL = \"0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925\";\r\nconst KECCAK_APPROVAL_FOR_ALL = \"0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31\";\r\n\r\nfunction normAddr(a: string | undefined): string {\r\n  if (!a || typeof a !== \"string\") return \"\";\r\n  const s = a.toLowerCase().replace(/^0x/, \"\").padStart(40, \"0\");\r\n  return \"0x\" + s.slice(-40);\r\n}\r\n\r\n/** Decode Approval/ApprovalForAll from simulation logs. */\r\nfunction decodeApprovalsFromLogs(logs: Array<{ address?: string; topics?: string[]; data?: string }> | undefined): SimulationApproval[] {\r\n  const out: SimulationApproval[] = [];\r\n  if (!Array.isArray(logs)) return out;\r\n  for (const log of logs) {\r\n    const t0 = log.topics?.[0];\r\n    if (!t0) continue;\r\n    const t0n = t0.toLowerCase();\r\n    if (t0n === KECCAK_APPROVAL) {\r\n      const owner = log.topics?.[1] ? normAddr(\"0x\" + String(log.topics[1]).slice(-40)) : \"\";\r\n      const spender = log.topics?.[2] ? normAddr(\"0x\" + String(log.topics[2]).slice(-40)) : \"\";\r\n      const token = normAddr(log.address);\r\n      let value = 0n;\r\n      try {\r\n        if (log.data && log.data.startsWith(\"0x\")) value = BigInt(log.data);\r\n      } catch {}\r\n      const unlimited = value >= 2n ** 256n - 2n ** 255n;\r\n      out.push({ token, spender, approved: true, unlimited });\r\n    } else if (t0n === KECCAK_APPROVAL_FOR_ALL) {\r\n      const owner = log.topics?.[1] ? normAddr(\"0x\" + String(log.topics[1]).slice(-40)) : \"\";\r\n      const operator = log.topics?.[2] ? normAddr(\"0x\" + String(log.topics[2]).slice(-40)) : \"\";\r\n      const token = normAddr(log.address);\r\n      let approved = false;\r\n      try {\r\n        if (log.data && log.data.startsWith(\"0x\")) approved = BigInt(log.data) !== 0n;\r\n      } catch {}\r\n      out.push({ token, spender: operator, approved, approvalForAll: true });\r\n    }\r\n  }\r\n  return out;\r\n}\r\n\r\nfunction getSimulateUrl(settings?: Settings): string | null {\r\n  const account = settings?.simulation?.tenderlyAccount?.trim();\r\n  const project = settings?.simulation?.tenderlyProject?.trim();\r\n  if (!account || !project) return null;\r\n  return `${TENDERLY_API_BASE}/account/${encodeURIComponent(account)}/project/${encodeURIComponent(project)}/simulate`;\r\n}\r\n\r\n/**\r\n * Call Tenderly simulate API. Returns null when no credentials (static-only) or on any error/timeout.\r\n * Uses only settings.simulation (tenderlyAccount, tenderlyProject, tenderlyKey); no hardcoded keys.\r\n */\r\nexport async function simulateTransaction(\r\n  body: SimulateTransactionBody,\r\n  settings?: Settings\r\n): Promise<TenderlySimulationResponse | null> {\r\n  const key = settings?.simulation?.tenderlyKey?.trim();\r\n  const url = getSimulateUrl(settings);\r\n  if (!url || !key) return null;\r\n\r\n  let timeoutId: ReturnType<typeof setTimeout> | undefined;\r\n  try {\r\n    const controller = new AbortController();\r\n    timeoutId = setTimeout(() => controller.abort(), SIMULATE_TIMEOUT_MS);\r\n\r\n    const res = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-Access-Key\": key,\r\n      },\r\n      body: JSON.stringify(body),\r\n      signal: controller.signal,\r\n    });\r\n    clearTimeout(timeoutId);\r\n    timeoutId = undefined;\r\n    if (!res.ok) return null;\r\n    const data = (await res.json()) as TenderlySimulationResponse;\r\n    return data;\r\n  } catch {\r\n    if (timeoutId != null) try { clearTimeout(timeoutId); } catch {}\r\n    return null;\r\n  }\r\n}\r\n\r\n/** Build a SKIPPED outcome when API fails (network, 401/403, etc.). */\r\nexport function makeSkippedOutcome(): SimulationOutcome {\r\n  return {\r\n    status: \"SKIPPED\",\r\n    outgoingAssets: [],\r\n    incomingAssets: [],\r\n    gasUsed: \"0\",\r\n    fallback: true,\r\n  };\r\n}\r\n\r\n/** Neutral outcome when credentials missing or timeout \u2014 graceful degradation, no throw. */\r\nexport function makeStaticModeOutcome(): SimulationOutcome {\r\n  return {\r\n    status: \"SKIPPED\",\r\n    outgoingAssets: [],\r\n    incomingAssets: [],\r\n    gasUsed: \"0\",\r\n    fallback: true,\r\n    simulated: false,\r\n    message: \"Modo Est\u00E1tico (Adicione chaves para Simula\u00E7\u00E3o)\",\r\n  };\r\n}\r\n\r\n/**\r\n * Transform Tenderly simulation JSON into a simple outcome for the UI.\r\n * Classifies outgoing/incoming by wallet address (from tx.from).\r\n */\r\nexport function parseSimulationResult(\r\n  data: TenderlySimulationResponse | null,\r\n  walletAddress?: string\r\n): SimulationOutcome | null {\r\n  if (!data || typeof data !== \"object\") return null;\r\n\r\n  const txStatus = data.transaction?.status;\r\n  const status: SimulationOutcome[\"status\"] =\r\n    txStatus === 1 ? \"REVERT\" : txStatus === 0 ? \"SUCCESS\" : \"RISK\";\r\n\r\n  const wallet = normAddr(walletAddress);\r\n  const outgoingAssets: SimulationAsset[] = [];\r\n  const incomingAssets: SimulationAsset[] = [];\r\n\r\n  const assetChangesRaw =\r\n    data.transaction?.transaction_info?.asset_changes ?? data.asset_changes;\r\n  const assetChanges = Array.isArray(assetChangesRaw) ? assetChangesRaw : [];\r\n  for (const change of assetChanges) {\r\n    const info = change?.asset_info;\r\n    const symbol = (info?.symbol || info?.name || \"?\").toString();\r\n    const amount = (change?.amount ?? change?.raw_amount ?? \"0\").toString();\r\n    const logo = typeof info?.logo === \"string\" ? info.logo : undefined;\r\n    const entry: SimulationAsset = { symbol, amount, logo };\r\n\r\n    const fromNorm = normAddr(change?.from);\r\n    const toNorm = normAddr(change?.to);\r\n    const type = String(change?.type || \"\").toUpperCase();\r\n\r\n    if (wallet) {\r\n      if (fromNorm === wallet) outgoingAssets.push(entry);\r\n      else if (toNorm === wallet) incomingAssets.push(entry);\r\n      else if (type.includes(\"SEND\") || fromNorm) outgoingAssets.push(entry);\r\n      else if (type.includes(\"RECEIVE\") || toNorm) incomingAssets.push(entry);\r\n      else outgoingAssets.push(entry);\r\n    } else {\r\n      if (type.includes(\"SEND\") || change?.from) outgoingAssets.push(entry);\r\n      else if (type.includes(\"RECEIVE\") || change?.to) incomingAssets.push(entry);\r\n      else outgoingAssets.push(entry);\r\n    }\r\n  }\r\n\r\n  const logs = (data as any).transaction?.transaction_info?.logs;\r\n  const approvals = decodeApprovalsFromLogs(Array.isArray(logs) ? logs : undefined);\r\n\r\n  const gasUsed = typeof data.gas_used === \"string\" ? data.gas_used : (data.gas_used != null ? String(data.gas_used) : \"0\");\r\n\r\n  let gasCostWei: string | undefined;\r\n  try {\r\n    const gasPrice =\r\n      data.effective_gas_price ?? data.gas_price ?? (data as any).transaction?.gas_price;\r\n    const gasPriceStr = typeof gasPrice === \"string\" ? gasPrice : gasPrice != null ? String(gasPrice) : \"\";\r\n    const usedNum = BigInt(gasUsed);\r\n    const priceNum = gasPriceStr ? BigInt(gasPriceStr) : 0n;\r\n    if (usedNum > 0n && priceNum > 0n) {\r\n      gasCostWei = (usedNum * priceNum).toString();\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  const out: SimulationOutcome = {\r\n    status,\r\n    outgoingAssets,\r\n    incomingAssets,\r\n    gasUsed,\r\n    gasCostWei,\r\n    simulated: true,\r\n  };\r\n  if (approvals.length > 0) out.approvals = approvals;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Run simulation and return parsed outcome. On API failure (network, timeout), returns static-mode outcome.\r\n */\r\nexport async function runSimulation(\r\n  networkId: string,\r\n  from: string,\r\n  to: string,\r\n  input: string,\r\n  value: string,\r\n  gas: number | undefined,\r\n  settings?: Settings\r\n): Promise<SimulationOutcome | null> {\r\n  try {\r\n    const body: SimulateTransactionBody = {\r\n      network_id: networkId,\r\n      from,\r\n      to,\r\n      input: input || \"0x\",\r\n      value: value || \"0x0\",\r\n    };\r\n    if (gas != null && gas > 0) body.gas = gas;\r\n\r\n    const raw = await simulateTransaction(body, settings);\r\n    if (raw) return parseSimulationResult(raw, from);\r\n    return makeStaticModeOutcome();\r\n  } catch {\r\n    return makeStaticModeOutcome();\r\n  }\r\n}\r\n", "/**\r\n * V2: Seed data for lists (trusted/blocked domains). Short bootstrap \u2014 external feeds cover volume.\r\n */\r\n\r\nimport { CRYPTO_TRUSTED_DOMAINS_SEED } from \"../lists/cryptoTrustedDomainsSeed\";\r\n\r\nexport const TRUSTED_DOMAINS_SEED: string[] = [...CRYPTO_TRUSTED_DOMAINS_SEED];\r\n\r\nexport const BLOCKED_DOMAINS_SEED: string[] = [\r\n  // Minimal seed; feeds will add more\r\n];\r\n", "/**\r\n * V2: List manager \u2014 feeds, cache, user overrides. No secrets.\r\n */\r\n\r\nimport type { ListsCacheV1, ListSourceName } from \"../shared/types\";\r\nimport { normalizeHost, normalizeAddress, normalizeTokenKey, isHostMatch } from \"../shared/utils\";\r\nimport { TRUSTED_DOMAINS_SEED, BLOCKED_DOMAINS_SEED } from \"./listSeeds\";\r\n\r\nconst STORAGE_KEY = \"sg_lists_cache_v1\";\r\nconst LAST_REFRESH_KEY = \"sg_lists_last_refresh\";\r\nconst FETCH_TIMEOUT_MS = 6000;\r\nconst TTL_CACHE_MS = 12 * 60 * 60 * 1000; // 12h\r\n\r\nfunction emptyCache(): ListsCacheV1 {\r\n  return {\r\n    version: 1,\r\n    updatedAt: 0,\r\n    sources: {\r\n      metamask: {},\r\n      scamsniffer: {},\r\n      cryptoscamdb: {},\r\n      dappradar: {},\r\n      mew: {},\r\n      seed: {},\r\n      user: {},\r\n    },\r\n    trustedDomains: [],\r\n    blockedDomains: [],\r\n    blockedAddresses: [],\r\n    scamTokens: [],\r\n    userTrustedDomains: [],\r\n    userBlockedDomains: [],\r\n    userBlockedAddresses: [],\r\n    userScamTokens: [],\r\n    userTrustedTokens: [],\r\n  };\r\n}\r\n\r\nfunction normalizeChain(c: string): string {\r\n  const s = String(c ?? \"\").trim().toLowerCase();\r\n  if (!s) return \"\";\r\n  return s.startsWith(\"0x\") ? s : \"0x\" + parseInt(s, 10).toString(16);\r\n}\r\n\r\n/** Normalize domain from user input: strip protocol/path, lowercase hostname. */\r\nexport function normalizeDomainInput(input: string): string {\r\n  const s = (input ?? \"\").trim();\r\n  if (!s) return \"\";\r\n  try {\r\n    if (s.includes(\"://\") || s.toLowerCase().startsWith(\"http\")) {\r\n      return new URL(s.startsWith(\"http\") ? s : \"https://\" + s).hostname.replace(/^www\\./, \"\").toLowerCase().trim() || \"\";\r\n    }\r\n    return (s.replace(/^www\\./, \"\").toLowerCase().replace(/\\.+$/, \"\").trim()) || \"\";\r\n  } catch {\r\n    return (s.replace(/^www\\./, \"\").toLowerCase().replace(/\\.+$/, \"\").trim()) || \"\";\r\n  }\r\n}\r\n\r\n/** Normalize address: 0x + 40 hex lower. Returns \"\" if invalid. */\r\nexport function normalizeAddressInput(addr: string): string {\r\n  const s = (addr ?? \"\").trim();\r\n  const hex = s.startsWith(\"0x\") ? s.slice(2) : s;\r\n  if (hex.length !== 40 || !/^[a-fA-F0-9]{40}$/.test(hex)) return \"\";\r\n  return \"0x\" + hex.toLowerCase();\r\n}\r\n\r\n/** Parse scam token input: \"0x1:0xTOKEN\", \"1,0xTOKEN\", \"0x1,0xTOKEN\" -> { chainId: \"0x1\", address: \"0xtoken\" } or null. */\r\nexport function normalizeScamTokenInput(input: string): { chainId: string; address: string } | null {\r\n  const s = (input ?? \"\").trim();\r\n  if (!s) return null;\r\n  let chainId = \"\";\r\n  let address = \"\";\r\n  if (s.includes(\":\")) {\r\n    const [c, a] = s.split(\":\").map((x) => x.trim());\r\n    chainId = normalizeChain(c ?? \"\");\r\n    address = normalizeAddressInput(a ?? \"\");\r\n  } else if (s.includes(\",\")) {\r\n    const [c, a] = s.split(\",\").map((x) => x.trim());\r\n    chainId = normalizeChain(c ?? \"\");\r\n    address = normalizeAddressInput(a ?? \"\");\r\n  } else {\r\n    return null;\r\n  }\r\n  if (!chainId || !address) return null;\r\n  return { chainId, address };\r\n}\r\n\r\n/** Canonical scam token key: chainIdHex:addressLower */\r\nexport function scamTokenToCanonical(chainId: string, address: string): string {\r\n  const c = normalizeChain(chainId);\r\n  const a = normalizeAddressInput(address);\r\n  return c && a ? `${c}:${a}` : \"\";\r\n}\r\n\r\nexport function isTrustedToken(chainIdHex: string, tokenAddress: string, cache: ListsCacheV1): boolean {\r\n  const c = normalizeChain(chainIdHex);\r\n  const a = normalizeAddress(tokenAddress);\r\n  if (!c || !a) return false;\r\n  const list = cache.userTrustedTokens ?? [];\r\n  return list.some((t) => normalizeChain(t.chainId) === c && normalizeAddress(t.address) === a);\r\n}\r\n\r\nfunction getStorage(): Promise<ListsCacheV1 | null> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve(null);\r\n      chrome.storage.local.get(STORAGE_KEY, (r) => {\r\n        if (chrome.runtime?.lastError) return resolve(null);\r\n        const v = (r as Record<string, unknown>)?.[STORAGE_KEY];\r\n        resolve(v && typeof v === \"object\" && (v as ListsCacheV1).version === 1 ? (v as ListsCacheV1) : null);\r\n      });\r\n    } catch {\r\n      resolve(null);\r\n    }\r\n  });\r\n}\r\n\r\nfunction setStorage(cache: ListsCacheV1): Promise<void> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve();\r\n      chrome.storage.local.set(\r\n        { [STORAGE_KEY]: cache, [LAST_REFRESH_KEY]: Date.now() },\r\n        () => resolve()\r\n      );\r\n    } catch {\r\n      resolve();\r\n    }\r\n  });\r\n}\r\n\r\nasync function fetchWithTimeout(url: string, etag?: string): Promise<{ body: string; etag?: string } | null> {\r\n  try {\r\n    const ctrl = new AbortController();\r\n    const t = setTimeout(() => ctrl.abort(), FETCH_TIMEOUT_MS);\r\n    const headers: Record<string, string> = {};\r\n    if (etag) headers[\"If-None-Match\"] = etag;\r\n    const res = await fetch(url, { signal: ctrl.signal, headers });\r\n    clearTimeout(t);\r\n    const newEtag = res.headers.get(\"etag\") ?? undefined;\r\n    if (res.status === 304) return { body: \"\", etag: newEtag ?? etag };\r\n    const body = await res.text();\r\n    return { body, etag: newEtag ?? undefined };\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction parseMetamask(body: string): { blocklist?: string[]; whitelist?: string[] } {\r\n  try {\r\n    const j = JSON.parse(body) as Record<string, unknown>;\r\n    const blocklist = j.blocklist as string[] | undefined;\r\n    const whitelist = j.whitelist as string[] | undefined;\r\n    return { blocklist: Array.isArray(blocklist) ? blocklist : undefined, whitelist: Array.isArray(whitelist) ? whitelist : undefined };\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\nfunction parseScamSnifferDomains(body: string): string[] {\r\n  try {\r\n    const j = JSON.parse(body);\r\n    if (Array.isArray(j)) return j.map((x: any) => String(x?.domain ?? x ?? \"\").toLowerCase()).filter(Boolean);\r\n    if (j && typeof j === \"object\" && Array.isArray(j.domains)) return j.domains.map((x: any) => String(x?.domain ?? x ?? \"\").toLowerCase()).filter(Boolean);\r\n    return [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction parseScamSnifferAddresses(body: string): string[] {\r\n  try {\r\n    const j = JSON.parse(body);\r\n    if (Array.isArray(j)) return j.map((x: any) => normalizeAddress(String(x?.address ?? x ?? \"\"))).filter(Boolean);\r\n    return [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction parseCryptoScamDb(body: string): { blacklist?: string[]; whitelist?: string[] } {\r\n  try {\r\n    const j = JSON.parse(body) as Record<string, unknown>;\r\n    const result = j.result as Record<string, string[]> | undefined;\r\n    if (!result) return {};\r\n    return {\r\n      blacklist: Array.isArray(result.blacklist) ? result.blacklist : undefined,\r\n      whitelist: Array.isArray(result.whitelist) ? result.whitelist : undefined,\r\n    };\r\n  } catch {\r\n    return {};\r\n  }\r\n}\r\n\r\nfunction parseDappRadarTokens(body: string): Array<{ chainId: string; address: string; symbol?: string; name?: string }> {\r\n  try {\r\n    const j = JSON.parse(body);\r\n    const arr = Array.isArray(j) ? j : (j?.tokens ? j.tokens : j?.data) ?? [];\r\n    return arr\r\n      .map((x: any) => {\r\n        const chainId = String(x?.chainId ?? x?.chain ?? \"0x1\").toLowerCase();\r\n        const addr = normalizeAddress(String(x?.address ?? x?.contract ?? x ?? \"\"));\r\n        if (!addr) return null;\r\n        const chainIdHex = chainId.startsWith(\"0x\") ? chainId : \"0x\" + parseInt(chainId, 10).toString(16);\r\n        return {\r\n          chainId: chainIdHex,\r\n          address: addr,\r\n          symbol: typeof x?.symbol === \"string\" ? x.symbol : undefined,\r\n          name: typeof x?.name === \"string\" ? x.name : undefined,\r\n          source: \"dappradar\" as ListSourceName,\r\n        };\r\n      })\r\n      .filter(Boolean) as Array<{ chainId: string; address: string; symbol?: string; name?: string; source: ListSourceName }>;\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction parseMewUrls(body: string): string[] {\r\n  try {\r\n    const j = JSON.parse(body);\r\n    const arr = Array.isArray(j) ? j : (j?.urls ?? j?.list ?? []);\r\n    return arr\r\n      .map((x: any) => (typeof x === \"string\" ? x : x?.id ?? x?.url ?? \"\").trim().toLowerCase())\r\n      .filter((u: string) => u && (u.startsWith(\"http\") || u.includes(\".\")))\r\n      .map((u: string) => {\r\n        try {\r\n          const host = new URL(u.startsWith(\"http\") ? u : \"https://\" + u).hostname.replace(/^www\\./, \"\");\r\n          return host || \"\";\r\n        } catch {\r\n          return \"\";\r\n        }\r\n      })\r\n      .filter(Boolean);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction parseMewAddresses(body: string): string[] {\r\n  try {\r\n    const j = JSON.parse(body);\r\n    const arr = Array.isArray(j) ? j : (j?.addresses ?? j?.list ?? []);\r\n    return arr\r\n      .map((x: any) => normalizeAddress(String(typeof x === \"string\" ? x : x?.address ?? x?.id ?? \"\")))\r\n      .filter(Boolean);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nconst MIGRATED_KEY = \"sg_lists_migrated_v1\";\r\n\r\n/** Migrate settings.trustedDomains (sync) to userTrustedDomains (local) once. */\r\nasync function migrateTrustedDomainsFromSettings(): Promise<void> {\r\n  try {\r\n    const done = await new Promise<boolean>((resolve) => {\r\n      if (!chrome?.storage?.local) return resolve(true);\r\n      chrome.storage.local.get(MIGRATED_KEY, (r) => resolve(!!(r as any)?.[MIGRATED_KEY]));\r\n    });\r\n    if (done) return;\r\n    const [cached, sync] = await Promise.all([\r\n      getStorage(),\r\n      new Promise<Record<string, unknown>>((resolve) => {\r\n        if (!chrome?.storage?.sync) return resolve({});\r\n        chrome.storage.sync.get([\"trustedDomains\", \"allowlist\"], (r) => resolve((r as Record<string, unknown>) ?? {}));\r\n      }),\r\n    ]);\r\n    const fromSettings = (sync.trustedDomains ?? sync.allowlist) as string[] | undefined;\r\n    const arr = Array.isArray(fromSettings) ? fromSettings : [];\r\n    const userTrusted = cached?.userTrustedDomains ?? [];\r\n    if (arr.length > 0 && userTrusted.length === 0) {\r\n      const merged = [...new Set([...arr.map((d) => normalizeHost(String(d))).filter(Boolean), ...userTrusted])];\r\n      if (cached) {\r\n        (cached as ListsCacheV1).userTrustedDomains = merged;\r\n        (cached as ListsCacheV1).updatedAt = Date.now();\r\n        await setStorage(cached);\r\n      } else {\r\n        const fresh = emptyCache();\r\n        fresh.userTrustedDomains = merged;\r\n        fresh.updatedAt = Date.now();\r\n        await setStorage(fresh);\r\n      }\r\n    }\r\n    await new Promise<void>((r) => { chrome.storage.local.set({ [MIGRATED_KEY]: true }, () => r()); });\r\n  } catch {\r\n    /* ignore */\r\n  }\r\n}\r\n\r\nexport async function getLists(): Promise<ListsCacheV1> {\r\n  await migrateTrustedDomainsFromSettings();\r\n  const cache = await getStorage();\r\n  if (cache) {\r\n    if (!cache.userTrustedTokens) (cache as ListsCacheV1).userTrustedTokens = [];\r\n    return cache;\r\n  }\r\n  const fresh = emptyCache();\r\n  fresh.trustedDomains = [...new Set(TRUSTED_DOMAINS_SEED.map((d) => normalizeHost(d)).filter(Boolean))];\r\n  fresh.blockedDomains = [...new Set(BLOCKED_DOMAINS_SEED.map((d) => normalizeHost(d)).filter(Boolean))];\r\n  fresh.sources.seed = { ok: true, updatedAt: Date.now() };\r\n  fresh.updatedAt = Date.now();\r\n  await setStorage(fresh);\r\n  return fresh;\r\n}\r\n\r\n/** Priority: user > seed/feeds. TRUSTED if in trusted; BLOCKED if in blocked; else UNKNOWN. */\r\nexport function getDomainDecision(host: string, cache: ListsCacheV1): \"TRUSTED\" | \"BLOCKED\" | \"UNKNOWN\" {\r\n  const h = normalizeHost(host);\r\n  if (!h) return \"UNKNOWN\";\r\n  const inUserBlocked = cache.userBlockedDomains.some((d) => isHostMatch(h, d));\r\n  if (inUserBlocked) return \"BLOCKED\";\r\n  const inUserTrusted = cache.userTrustedDomains.some((d) => isHostMatch(h, d));\r\n  if (inUserTrusted) return \"TRUSTED\";\r\n  const inBlocked = cache.blockedDomains.some((d) => isHostMatch(h, d));\r\n  if (inBlocked) return \"BLOCKED\";\r\n  const inTrusted = cache.trustedDomains.some((d) => isHostMatch(h, d));\r\n  if (inTrusted) return \"TRUSTED\";\r\n  return \"UNKNOWN\";\r\n}\r\n\r\nexport function isBlockedAddress(addr: string, cache: ListsCacheV1): boolean {\r\n  const a = normalizeAddress(addr);\r\n  if (!a) return false;\r\n  if (cache.userBlockedAddresses.includes(a)) return true;\r\n  return cache.blockedAddresses.includes(a);\r\n}\r\n\r\nexport function isScamToken(chainId: string, tokenAddress: string, cache: ListsCacheV1): boolean {\r\n  const key = normalizeTokenKey(chainId, tokenAddress);\r\n  if (!key) return false;\r\n  const [c, addr] = key.split(\":\");\r\n  const userMatch = cache.userScamTokens.some((t) => normalizeTokenKey(t.chainId, t.address) === key);\r\n  if (userMatch) return true;\r\n  return cache.scamTokens.some((t) => normalizeTokenKey(t.chainId, t.address) === key);\r\n}\r\n\r\nexport async function refresh(forceRefresh?: boolean): Promise<ListsCacheV1> {\r\n  const cache = await getLists();\r\n  if (!forceRefresh && cache.updatedAt && Date.now() - cache.updatedAt < TTL_CACHE_MS) {\r\n    return cache;\r\n  }\r\n  const updated = { ...cache, updatedAt: Date.now() };\r\n  const trustedSet = new Set(updated.trustedDomains);\r\n  const blockedSet = new Set(updated.blockedDomains);\r\n  const blockedAddrSet = new Set(updated.blockedAddresses);\r\n  const scamKeys = new Set(updated.scamTokens.map((t) => normalizeTokenKey(t.chainId, t.address)));\r\n\r\n  // MetaMask config\r\n  try {\r\n    const meta = await fetchWithTimeout(\"https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/main/src/config.json\", updated.sources.metamask?.etag);\r\n    if (meta?.body) {\r\n      const { blocklist, whitelist } = parseMetamask(meta.body);\r\n      updated.sources.metamask = { ok: true, updatedAt: Date.now(), etag: meta.etag };\r\n      if (blocklist) blocklist.forEach((d) => { const n = normalizeHost(d); if (n) blockedSet.add(n); });\r\n      if (whitelist) whitelist.forEach((d) => { const n = normalizeHost(d); if (n) trustedSet.add(n); });\r\n    } else {\r\n      updated.sources.metamask = { ...updated.sources.metamask, ok: false, error: \"fetch failed\" };\r\n    }\r\n  } catch (e) {\r\n    updated.sources.metamask = { ...updated.sources.metamask, ok: false, error: String((e as Error)?.message ?? e) };\r\n  }\r\n\r\n  // ScamSniffer scam-database (domains + addresses)\r\n  const SCAMSNIFFER_DOMAINS_URL = \"https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/domains.json\";\r\n  const SCAMSNIFFER_ADDRESSES_URL = \"https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/address.json\";\r\n  try {\r\n    const [ssDomains, ssAddresses] = await Promise.all([\r\n      fetchWithTimeout(SCAMSNIFFER_DOMAINS_URL, updated.sources.scamsniffer?.etag),\r\n      fetchWithTimeout(SCAMSNIFFER_ADDRESSES_URL),\r\n    ]);\r\n    if (ssDomains?.body) {\r\n      const list = parseScamSnifferDomains(ssDomains.body);\r\n      list.forEach((d) => { const n = normalizeHost(d); if (n) blockedSet.add(n); });\r\n    }\r\n    if (ssAddresses?.body) {\r\n      const addrs = parseScamSnifferAddresses(ssAddresses.body);\r\n      addrs.forEach((a) => { if (a) blockedAddrSet.add(a); });\r\n    }\r\n    if (ssDomains?.body || ssAddresses?.body) {\r\n      updated.sources.scamsniffer = { ok: true, updatedAt: Date.now(), etag: ssDomains?.etag };\r\n    } else {\r\n      updated.sources.scamsniffer = { ...updated.sources.scamsniffer, ok: false, error: \"fetch failed\" };\r\n    }\r\n  } catch (e) {\r\n    updated.sources.scamsniffer = { ...updated.sources.scamsniffer, ok: false, error: String((e as Error)?.message ?? e) };\r\n  }\r\n\r\n  // CryptoScamDB (public list if available)\r\n  try {\r\n    const csdb = await fetchWithTimeout(\"https://api.cryptoscamdb.org/v1/blacklist\", updated.sources.cryptoscamdb?.etag);\r\n    if (csdb?.body) {\r\n      const { blacklist, whitelist } = parseCryptoScamDb(csdb.body);\r\n      if (blacklist) blacklist.forEach((d) => { const n = normalizeHost(d); if (n) blockedSet.add(n); });\r\n      if (whitelist) whitelist.forEach((d) => { const n = normalizeHost(d); if (n) trustedSet.add(n); });\r\n      updated.sources.cryptoscamdb = { ok: true, updatedAt: Date.now(), etag: csdb.etag };\r\n    } else {\r\n      updated.sources.cryptoscamdb = { ...updated.sources.cryptoscamdb, ok: false, error: \"fetch failed\" };\r\n    }\r\n  } catch (e) {\r\n    updated.sources.cryptoscamdb = { ...updated.sources.cryptoscamdb, ok: false, error: String((e as Error)?.message ?? e) };\r\n  }\r\n\r\n  // MEW ethereum-lists (domains + addresses)\r\n  const MEW_URLS_URL = \"https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-darklist.json\";\r\n  const MEW_ADDRESSES_URL = \"https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/addresses/addresses-darklist.json\";\r\n  try {\r\n    const [mewUrls, mewAddrs] = await Promise.all([\r\n      fetchWithTimeout(MEW_URLS_URL, updated.sources.mew?.etag),\r\n      fetchWithTimeout(MEW_ADDRESSES_URL),\r\n    ]);\r\n    if (mewUrls?.body) {\r\n      const list = parseMewUrls(mewUrls.body);\r\n      list.forEach((d) => { const n = normalizeHost(d); if (n) blockedSet.add(n); });\r\n    }\r\n    if (mewAddrs?.body) {\r\n      const addrs = parseMewAddresses(mewAddrs.body);\r\n      addrs.forEach((a) => { if (a) blockedAddrSet.add(a); });\r\n    }\r\n    if (mewUrls?.body || mewAddrs?.body) {\r\n      updated.sources.mew = { ok: true, updatedAt: Date.now(), etag: mewUrls?.etag };\r\n    } else {\r\n      updated.sources.mew = { ...updated.sources.mew, ok: false, error: \"fetch failed\" };\r\n    }\r\n  } catch (e) {\r\n    updated.sources.mew = { ...updated.sources.mew, ok: false, error: String((e as Error)?.message ?? e) };\r\n  }\r\n\r\n  // DappRadar tokens blacklist\r\n  const DAPPRADAR_TOKENS_URL = \"https://raw.githubusercontent.com/dappradar/tokens-blacklist/main/all-tokens.json\";\r\n  let dappradarTokenList: ListsCacheV1[\"scamTokens\"] = [];\r\n  try {\r\n    const dr = await fetchWithTimeout(DAPPRADAR_TOKENS_URL, updated.sources.dappradar?.etag);\r\n    if (dr?.body) {\r\n      const tokens = parseDappRadarTokens(dr.body);\r\n      tokens.forEach((t) => {\r\n        const key = normalizeTokenKey(t.chainId, t.address);\r\n        if (key) scamKeys.add(key);\r\n      });\r\n      dappradarTokenList = tokens.map((t) => ({ chainId: t.chainId, address: t.address, symbol: t.symbol, name: t.name, source: \"dappradar\" as ListSourceName }));\r\n      updated.sources.dappradar = { ok: true, updatedAt: Date.now(), etag: dr.etag };\r\n    } else {\r\n      updated.sources.dappradar = { ...updated.sources.dappradar, ok: false, error: \"fetch failed\" };\r\n    }\r\n  } catch (e) {\r\n    updated.sources.dappradar = { ...updated.sources.dappradar, ok: false, error: String((e as Error)?.message ?? e) };\r\n  }\r\n\r\n  updated.trustedDomains = [...trustedSet];\r\n  updated.blockedDomains = [...blockedSet];\r\n  updated.blockedAddresses = [...blockedAddrSet];\r\n  updated.scamTokens = [...dappradarTokenList, ...cache.userScamTokens];\r\n  await setStorage(updated);\r\n  return updated;\r\n}\r\n\r\nexport type OverrideType = \"trusted_domain\" | \"blocked_domain\" | \"blocked_address\" | \"scam_token\" | \"trusted_token\";\r\nexport type OverridePayload = { type?: OverrideType; value?: string; chainId?: string; address?: string; tokenAddress?: string };\r\n\r\n/** Normalize legacy options payloads to canonical override format. */\r\nexport function normalizeOverridePayload(typeRaw: string, payload: Record<string, unknown>): { type: OverrideType; payload: OverridePayload } | null {\r\n  const t = (typeRaw ?? \"\").toString().toLowerCase();\r\n  const domain = (payload.domain ?? payload.value ?? \"\").toString().trim();\r\n  const address = (payload.address ?? payload.tokenAddress ?? payload.value ?? \"\").toString().trim();\r\n  const chainId = (payload.chainId ?? \"\").toString().trim();\r\n  if (t === \"usertrusteddomains\" && domain) return { type: \"trusted_domain\", payload: { value: domain } };\r\n  if (t === \"userblockeddomains\" && domain) return { type: \"blocked_domain\", payload: { value: domain } };\r\n  if (t === \"userblockedaddresses\" && address) return { type: \"blocked_address\", payload: { value: address, address } };\r\n  if (t === \"userscamtokens\" && chainId && address) return { type: \"scam_token\", payload: { chainId, address } };\r\n  if (t === \"usertrustedtokens\" && chainId && address) return { type: \"trusted_token\", payload: { chainId, address } };\r\n  if (t === \"trusted_domain\" && domain) return { type: \"trusted_domain\", payload: { value: domain } };\r\n  if (t === \"blocked_domain\" && domain) return { type: \"blocked_domain\", payload: { value: domain } };\r\n  if (t === \"blocked_address\" && address) return { type: \"blocked_address\", payload: { value: address, address } };\r\n  if (t === \"scam_token\" && chainId && address) return { type: \"scam_token\", payload: { chainId, address } };\r\n  if (t === \"trusted_token\" && chainId && address) return { type: \"trusted_token\", payload: { chainId, address } };\r\n  return null;\r\n}\r\n\r\nexport async function upsertUserOverride(type: OverrideType, payload: OverridePayload): Promise<ListsCacheV1> {\r\n  const cache = await getLists();\r\n  const next = { ...cache, userTrustedDomains: [...cache.userTrustedDomains], userBlockedDomains: [...cache.userBlockedDomains], userBlockedAddresses: [...cache.userBlockedAddresses], userScamTokens: [...cache.userScamTokens], userTrustedTokens: [...(cache.userTrustedTokens ?? [])], updatedAt: Date.now() };\r\n  if (type === \"trusted_domain\") {\r\n    const v = normalizeHost(payload.value ?? \"\");\r\n    if (v && !next.userTrustedDomains.includes(v)) next.userTrustedDomains.push(v);\r\n  } else if (type === \"blocked_domain\") {\r\n    const v = normalizeHost(payload.value ?? \"\");\r\n    if (v && !next.userBlockedDomains.includes(v)) next.userBlockedDomains.push(v);\r\n  } else if (type === \"blocked_address\") {\r\n    const v = normalizeAddress(payload.value || payload.address || \"\");\r\n    if (v && !next.userBlockedAddresses.includes(v)) next.userBlockedAddresses.push(v);\r\n  } else if (type === \"scam_token\" && payload.chainId && payload.address) {\r\n    const addr = normalizeAddress(payload.address);\r\n    const c = normalizeChain(payload.chainId);\r\n    if (addr && c && !next.userScamTokens.some((t) => normalizeChain(t.chainId) === c && t.address === addr)) {\r\n      next.userScamTokens.push({ chainId: c, address: addr });\r\n    }\r\n  } else if (type === \"trusted_token\" && payload.chainId && payload.address) {\r\n    const addr = normalizeAddress(payload.address);\r\n    const c = normalizeChain(payload.chainId);\r\n    if (addr && c && !next.userTrustedTokens.some((t) => normalizeChain(t.chainId) === c && t.address === addr)) {\r\n      next.userTrustedTokens.push({ chainId: c, address: addr });\r\n    }\r\n  }\r\n  await setStorage(next);\r\n  return next;\r\n}\r\n\r\nexport async function deleteUserOverride(type: OverrideType, value: string, chainId?: string, address?: string): Promise<ListsCacheV1> {\r\n  const cache = await getLists();\r\n  const next = { ...cache, userTrustedDomains: [...cache.userTrustedDomains], userBlockedDomains: [...cache.userBlockedDomains], userBlockedAddresses: [...cache.userBlockedAddresses], userScamTokens: [...cache.userScamTokens], userTrustedTokens: [...(cache.userTrustedTokens ?? [])], updatedAt: Date.now() };\r\n  if (type === \"trusted_domain\") next.userTrustedDomains = next.userTrustedDomains.filter((d) => d !== normalizeHost(value));\r\n  else if (type === \"blocked_domain\") next.userBlockedDomains = next.userBlockedDomains.filter((d) => d !== normalizeHost(value));\r\n  else if (type === \"blocked_address\") next.userBlockedAddresses = next.userBlockedAddresses.filter((a) => a !== normalizeAddress(value || address || \"\"));\r\n  else if (type === \"scam_token\" && chainId && address) next.userScamTokens = next.userScamTokens.filter((t) => !(normalizeChain(t.chainId) === normalizeChain(chainId) && t.address === normalizeAddress(address)));\r\n  else if (type === \"trusted_token\" && chainId && address) next.userTrustedTokens = next.userTrustedTokens.filter((t) => !(normalizeChain(t.chainId) === normalizeChain(chainId) && t.address === normalizeAddress(address)));\r\n  await setStorage(next);\r\n  return next;\r\n}\r\n\r\nexport async function getLastRefresh(): Promise<number> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve(0);\r\n      chrome.storage.local.get(LAST_REFRESH_KEY, (r) => {\r\n        const v = (r as Record<string, number>)?.[LAST_REFRESH_KEY];\r\n        resolve(typeof v === \"number\" ? v : 0);\r\n      });\r\n    } catch {\r\n      resolve(0);\r\n    }\r\n  });\r\n}\r\n\r\nexport type OverrideKind = \"trustedDomains\" | \"blockedDomains\" | \"blockedAddresses\" | \"scamTokens\";\r\n\r\nexport type SetOverridesResult = { ok: boolean; cache: ListsCacheV1; invalidCount?: number; invalidExamples?: string[] };\r\n\r\n/** Replace entire user override list. Validates each item; invalid ones are skipped and reported. */\r\nexport async function setOverrides(kind: OverrideKind, values: string[]): Promise<SetOverridesResult> {\r\n  const cache = await getLists();\r\n  const next = { ...cache, updatedAt: Date.now() };\r\n  const invalid: string[] = [];\r\n  const raw = Array.isArray(values) ? values : [];\r\n\r\n  if (kind === \"trustedDomains\" || kind === \"blockedDomains\") {\r\n    const normalized: string[] = [];\r\n    for (const v of raw) {\r\n      const n = normalizeDomainInput(v);\r\n      if (n) normalized.push(n);\r\n      else if (v.trim()) invalid.push(v);\r\n    }\r\n    next.userTrustedDomains = kind === \"trustedDomains\" ? [...new Set(normalized)] : [...next.userTrustedDomains];\r\n    next.userBlockedDomains = kind === \"blockedDomains\" ? [...new Set(normalized)] : [...next.userBlockedDomains];\r\n  } else if (kind === \"blockedAddresses\") {\r\n    const normalized: string[] = [];\r\n    for (const v of raw) {\r\n      const n = normalizeAddressInput(v);\r\n      if (n) normalized.push(n);\r\n      else if (v.trim()) invalid.push(v);\r\n    }\r\n    next.userBlockedAddresses = [...new Set(normalized)];\r\n  } else if (kind === \"scamTokens\") {\r\n    const tokens: Array<{ chainId: string; address: string }> = [];\r\n    const seen = new Set<string>();\r\n    for (const v of raw) {\r\n      const parsed = normalizeScamTokenInput(v);\r\n      if (parsed) {\r\n        const key = `${parsed.chainId}:${parsed.address}`;\r\n        if (!seen.has(key)) {\r\n          seen.add(key);\r\n          tokens.push(parsed);\r\n        }\r\n      } else if (v.trim()) invalid.push(v);\r\n    }\r\n    next.userScamTokens = tokens;\r\n  }\r\n\r\n  await setStorage(next);\r\n  return {\r\n    ok: true,\r\n    cache: next,\r\n    invalidCount: invalid.length,\r\n    invalidExamples: invalid.length > 0 ? invalid.slice(0, 5) : undefined,\r\n  };\r\n}\r\n\r\nexport type ListsExportSnapshot = {\r\n  updatedAt: number;\r\n  sources: Array<{ name: string; ok: boolean; count?: number; error?: string }>;\r\n  overrides: {\r\n    trustedDomains: string[];\r\n    blockedDomains: string[];\r\n    blockedAddresses: string[];\r\n    scamTokens: Array<{ chainId: string; address: string }>;\r\n  };\r\n  totals: {\r\n    trustedDomainsTotal: number;\r\n    blockedDomainsTotal: number;\r\n    blockedAddressesTotal: number;\r\n    scamTokensTotal: number;\r\n  };\r\n};\r\n\r\n/** Export full snapshot for UI: overrides + totals + source stats. */\r\nexport async function exportSnapshot(): Promise<ListsExportSnapshot> {\r\n  const cache = await getLists();\r\n  const trustedEffective = [...new Set([...cache.trustedDomains, ...cache.userTrustedDomains])];\r\n  const blockedDomainsEffective = [...new Set([...cache.blockedDomains, ...cache.userBlockedDomains])];\r\n  const blockedAddressesEffective = [...new Set([...cache.blockedAddresses, ...cache.userBlockedAddresses])];\r\n  const scamKeys = new Set<string>();\r\n  for (const t of cache.scamTokens) scamKeys.add(normalizeTokenKey(t.chainId, t.address));\r\n  for (const t of cache.userScamTokens) scamKeys.add(normalizeTokenKey(t.chainId, t.address));\r\n\r\n  const sourceList: Array<{ name: string; ok: boolean; count?: number; error?: string }> = [];\r\n  const src = cache.sources;\r\n  if (src.metamask) sourceList.push({ name: \"MetaMask\", ok: !!src.metamask.ok, error: src.metamask.error });\r\n  if (src.scamsniffer) sourceList.push({ name: \"ScamSniffer\", ok: !!src.scamsniffer.ok, error: src.scamsniffer.error });\r\n  if (src.cryptoscamdb) sourceList.push({ name: \"CryptoScamDB\", ok: !!src.cryptoscamdb.ok, error: src.cryptoscamdb.error });\r\n  if (src.mew) sourceList.push({ name: \"MEW\", ok: !!src.mew.ok, error: src.mew.error });\r\n  if (src.dappradar) sourceList.push({ name: \"DappRadar\", ok: !!src.dappradar.ok, error: src.dappradar.error });\r\n  if (src.seed) sourceList.push({ name: \"Seed\", ok: !!src.seed.ok });\r\n\r\n  return {\r\n    updatedAt: cache.updatedAt,\r\n    sources: sourceList,\r\n    overrides: {\r\n      trustedDomains: cache.userTrustedDomains ?? [],\r\n      blockedDomains: cache.userBlockedDomains ?? [],\r\n      blockedAddresses: cache.userBlockedAddresses ?? [],\r\n      scamTokens: (cache.userScamTokens ?? []).map((t) => ({ chainId: t.chainId, address: t.address })),\r\n    },\r\n    totals: {\r\n      trustedDomainsTotal: trustedEffective.length,\r\n      blockedDomainsTotal: blockedDomainsEffective.length,\r\n      blockedAddressesTotal: blockedAddressesEffective.length,\r\n      scamTokensTotal: scamKeys.size,\r\n    },\r\n  };\r\n}\r\n\r\n/** Merge only user overrides from imported data; validates and saves. */\r\nexport async function importUserOverrides(data: {\r\n  userTrustedDomains?: string[];\r\n  userBlockedDomains?: string[];\r\n  userBlockedAddresses?: string[];\r\n  userScamTokens?: Array<{ chainId: string; address: string; symbol?: string; name?: string }>;\r\n  userTrustedTokens?: Array<{ chainId: string; address: string }>;\r\n}): Promise<ListsCacheV1> {\r\n  const cache = await getLists();\r\n  const next = { ...cache, updatedAt: Date.now() };\r\n  if (Array.isArray(data.userTrustedDomains)) next.userTrustedDomains = data.userTrustedDomains.map((d) => normalizeHost(String(d))).filter(Boolean);\r\n  if (Array.isArray(data.userBlockedDomains)) next.userBlockedDomains = data.userBlockedDomains.map((d) => normalizeHost(String(d))).filter(Boolean);\r\n  if (Array.isArray(data.userBlockedAddresses)) next.userBlockedAddresses = data.userBlockedAddresses.map((a) => normalizeAddress(String(a))).filter(Boolean);\r\n  if (Array.isArray(data.userScamTokens)) next.userScamTokens = data.userScamTokens.filter((t) => t && t.chainId && t.address).map((t) => ({ chainId: normalizeChain(String(t.chainId)), address: normalizeAddress(t.address), symbol: t.symbol, name: t.name }));\r\n  if (Array.isArray(data.userTrustedTokens)) next.userTrustedTokens = data.userTrustedTokens.filter((t) => t && t.chainId && t.address).map((t) => ({ chainId: normalizeChain(String(t.chainId)), address: normalizeAddress(t.address) }));\r\n  await setStorage(next);\r\n  return next;\r\n}\r\n\r\nexport type ListSearchType = \"domain\" | \"address\" | \"token\";\r\nexport type ListSearchResult = { value: string; source: \"trusted\" | \"blocked\"; list: \"feed\" | \"user\"; chainId?: string; address?: string; symbol?: string; name?: string };\r\n\r\n/** Local search in lists; returns paginated results. */\r\nexport function searchLists(cache: ListsCacheV1, query: string, kind: ListSearchType, limit: number, offset: number): { results: ListSearchResult[]; total: number } {\r\n  const q = (query || \"\").toLowerCase().trim();\r\n  const results: ListSearchResult[] = [];\r\n  if (kind === \"domain\") {\r\n    const allTrusted = [...cache.trustedDomains, ...cache.userTrustedDomains];\r\n    const allBlocked = [...cache.blockedDomains, ...cache.userBlockedDomains];\r\n    const trusted = allTrusted.filter((d) => !q || d.toLowerCase().includes(q));\r\n    const blocked = allBlocked.filter((d) => !q || d.toLowerCase().includes(q));\r\n    trusted.forEach((d) => results.push({ value: d, source: \"trusted\", list: cache.userTrustedDomains.includes(d) ? \"user\" : \"feed\" }));\r\n    blocked.forEach((d) => results.push({ value: d, source: \"blocked\", list: cache.userBlockedDomains.includes(d) ? \"user\" : \"feed\" }));\r\n  } else if (kind === \"address\") {\r\n    const blocked = [...cache.blockedAddresses, ...cache.userBlockedAddresses].filter((a) => !q || a.toLowerCase().includes(q));\r\n    blocked.forEach((a) => results.push({ value: a, source: \"blocked\", list: cache.userBlockedAddresses.includes(a) ? \"user\" : \"feed\" }));\r\n  } else {\r\n    const all = [...cache.scamTokens, ...cache.userScamTokens];\r\n    const filtered = all.filter((t) => !q || t.address.toLowerCase().includes(q) || (t.symbol && t.symbol.toLowerCase().includes(q)) || (t.name && t.name.toLowerCase().includes(q)));\r\n    filtered.forEach((t) => results.push({ value: t.address, source: \"blocked\", list: cache.userScamTokens.some((u) => u.chainId === t.chainId && u.address === t.address) ? \"user\" : \"feed\", chainId: t.chainId, address: t.address, symbol: t.symbol, name: t.name }));\r\n  }\r\n  const total = results.length;\r\n  const paginated = results.slice(offset, offset + limit);\r\n  return { results: paginated, total };\r\n}\r\n", "export type WalletKind = \"EVM_INJECTED\" | \"SOLANA_INJECTED\" | \"UNKNOWN\";\nexport type WalletName =\n  | \"MetaMask\"\n  | \"Coinbase Wallet\"\n  | \"Trust\"\n  | \"Rabby\"\n  | \"OKX Wallet\"\n  | \"Binance Web3\"\n  | \"Rainbow\"\n  | \"Phantom\"\n  | \"Phantom EVM\"\n  | \"SafePal\"\n  | \"Bitget Wallet\"\n  | \"Brave Wallet\"\n  | \"Taho\"\n  | \"Ledger\"\n  | \"Frame\"\n  | \"MathWallet\"\n  | \"Solflare\"\n  | \"Backpack\"\n  | \"Injected\"\n  | \"EVM Wallet\"\n  | \"Unknown\";\n\nexport type WalletMeta = { id: string; name: string; iconHint?: string };\n\nexport type WalletBrand =\n  | \"MetaMask\"\n  | \"Coinbase Wallet\"\n  | \"Rabby\"\n  | \"Trust Wallet\"\n  | \"Brave Wallet\"\n  | \"OKX Wallet\"\n  | \"Binance Web3\"\n  | \"Bitget Wallet\"\n  | \"Phantom EVM\"\n  | \"EVM Wallet\";\n\nexport type WalletInfo = {\n  kind: WalletKind;\n  name: WalletName;\n  flags?: Record<string, boolean>;\n  walletBrand?: WalletBrand;\n  /** Display name for overlay (e.g. \"MetaMask\", \"EVM Wallet\") */\n  walletName?: string;\n};\n\nexport type EthRequest = {\n  method: string;\n  params?: any[];\n  // optional extra debugging/shape info from legacy provider entrypoints\n  rawShape?: string;\n  raw?: any;\n};\n\nexport type PendingRequestPayload = {\n  id: string;\n  url: string;\n  origin: string;\n  wallet?: WalletInfo | WalletMeta;\n  request: { method: string; params?: any[] };\n  providerTag?: string;\n  providerKey?: string;\n  providerSource?: \"window.ethereum\" | \"ethereum.providers[i]\" | \"eip6963\";\n};\n\n/** P0 UI Gate: meta sent with SG_DECISION to ensure wallet is only forwarded after user confirmed in overlay. */\nexport type DecisionMeta = {\n  uiConfirmed?: boolean;\n  uiGate?: boolean;\n  reasonKeys?: string[];\n  method?: string;\n};\n\nexport type FeeEstimateWire = {\n  ok: boolean;\n  gasLimitHex?: string;\n  feeLikelyWeiHex?: string;\n  feeMaxWeiHex?: string;\n  feeEstimated?: boolean;\n  feeReasonKey?: string;\n  error?: string;\n};\n\nexport type TxContextKind = \"SWITCH_NETWORK\" | \"NFT_PURCHASE\" | \"TOKEN_SWAP\" | \"VALUE_TRANSFER\" | \"CONTRACT_CALL\" | \"APPROVAL\";\n\nexport type AnalyzeRequest = {\n  requestId: string;\n  url: string;\n  origin: string;\n  request: EthRequest;\n  tabId?: number;\n  wallet?: WalletInfo;\n  providerHint?: { kind: ProviderKind; name?: string };\n  txCostPreview?: TxCostPreview;\n  feeEstimate?: FeeEstimateWire;\n  meta?: {\n    chainId?: string;\n    chainIdHex?: string;\n    chainIdRequested?: string;\n    txContext?: { kind: TxContextKind };\n    pageRisk?: { score: \"LOW\" | \"MEDIUM\" | \"HIGH\"; reasons: string[] };\n    preflight?: {\n      tx?: any;\n      valueWei?: string; // decimal\n      valueEth?: string; // decimal\n      gasEstimate?: string; // hex\n      gasPrice?: string; // hex\n      feeWeiEstimated?: string; // decimal\n      feeEthEstimated?: string; // decimal\n      totalEthEstimated?: string; // decimal\n    }\n  };\n};\n\nexport type SecurityMode = \"STRICT\" | \"BALANCED\" | \"RELAXED\" | \"OFF\";\nexport type ProviderKind = \"EIP6963\" | \"METAMASK\" | \"RABBY\" | \"COINBASE\" | \"PHANTOM\" | \"UNKNOWN\";\n\nexport type ChainIdHex = string; // ex \"0x1\"\nexport type Address = string; // \"0x...\" lowercase\n\n/** Domain list decision for risk/UX (whitelist never auto-allows tx). */\nexport type DomainDecision = \"TRUSTED\" | \"BLOCKED\" | \"UNKNOWN\";\n\n/** Cache key for scam token: chainId:tokenAddressLower */\nexport type ScamTokenKey = `${string}:${string}`;\n\nexport type ListSourceName = \"metamask\" | \"scamsniffer\" | \"cryptoscamdb\" | \"dappradar\" | \"mew\" | \"seed\" | \"user\";\n\nexport type ListsCacheV1 = {\n  version: 1;\n  updatedAt: number;\n  sources: Record<ListSourceName, { updatedAt?: number; etag?: string; ok?: boolean; error?: string }>;\n  trustedDomains: string[];\n  blockedDomains: string[];\n  blockedAddresses: string[];\n  scamTokens: Array<{ chainId: string; address: string; symbol?: string; name?: string; source?: ListSourceName }>;\n  userTrustedDomains: string[];\n  userBlockedDomains: string[];\n  userBlockedAddresses: string[];\n  userScamTokens: Array<{ chainId: string; address: string; symbol?: string; name?: string }>;\n  userTrustedTokens: Array<{ chainId: string; address: string }>;\n};\n\nexport type ThreatIntelAddress = {\n  address: Address;\n  chainId?: ChainIdHex;\n  label: string;\n  category: \"DRAINER\" | \"SCAM_TOKEN\" | \"SCAM_ROUTER\" | \"MALICIOUS_SPENDER\" | \"UNKNOWN\";\n  sourceId: string;\n  confidence: 1 | 2 | 3;\n  updatedAt: number;\n};\n\nexport type ThreatIntelBundle = {\n  updatedAt: number;\n  sources: Array<{ id: string; url?: string; ok: boolean; fetchedAt: number; error?: string }>;\n  trustedDomainsSeed: string[];\n  blockedDomains: string[];\n  blockedAddresses: ThreatIntelAddress[];\n};\n\nexport type AssetInfo = {\n  chainId: ChainIdHex;\n  address: Address;\n  kind: \"ERC20\" | \"ERC721\" | \"ERC1155\" | \"UNKNOWN\";\n  name?: string;\n  symbol?: string;\n  decimals?: number;\n  fetchedAt: number;\n};\n\nexport type DecodedAction = (\n  | { kind: \"APPROVE_ERC20\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"INCREASE_ALLOWANCE\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"DECREASE_ALLOWANCE\"; token: Address; spender: Address; amountRaw?: string }\n  | { kind: \"TRANSFER_ERC20\"; token: Address; to: Address; amountRaw?: string }\n  | { kind: \"TRANSFERFROM_ERC20\"; token: Address; from: Address; to: Address; amountRaw?: string }\n  | { kind: \"SET_APPROVAL_FOR_ALL\"; token: Address; operator: Address; approved: boolean }\n  | { kind: \"TRANSFER_NFT\"; token: Address; to: Address; from?: Address; tokenIdRaw?: string; amountRaw?: string; standard: \"ERC721\" | \"ERC1155\" | \"UNKNOWN\"; batch?: boolean }\n  | { kind: \"PERMIT_EIP2612\"; token: Address; spender: Address; valueType: \"LIMITED\" | \"UNLIMITED\"; valueRaw?: string; deadlineRaw?: string }\n  | { kind: \"PERMIT2_ALLOWANCE\"; token: Address; spender: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string; deadlineRaw?: string }\n  | { kind: \"PERMIT2_TRANSFER\"; token: Address; to: Address; amountType: \"LIMITED\" | \"UNLIMITED\"; amountRaw?: string }\n  | { kind: \"UNKNOWN\"; selector?: string }\n  | { kind: \"MULTICALL\"; selector: string; raw?: string }\n  )\n  & { permit2?: boolean; marketplaceHint?: string };\n\nexport type RiskLevel = \"LOW\" | \"WARN\" | \"HIGH\";\n\nexport type Recommend = \"ALLOW\" | \"WARN\" | \"HIGH\" | \"BLOCK\";\n\nexport type CheckKey =\n  | \"DOMAIN_INTEL\"\n  | \"LOOKALIKE\"\n  | \"TX_DECODE\"\n  | \"FEE_ESTIMATE\"\n  | \"ADDRESS_INTEL\"\n  | \"ASSET_ENRICH\"\n  | \"CLOUD_INTEL\";\n\nexport type CheckStatus = \"PASS\" | \"WARN\" | \"FAIL\" | \"SKIP\";\n\nexport interface CheckResult {\n  key: CheckKey;\n  status: CheckStatus;\n  noteKey?: string;\n}\n\nexport type DecodedKind =\n  | \"APPROVE\"\n  | \"SET_APPROVAL_FOR_ALL\"\n  | \"TYPED_DATA\"\n  | \"TX\"\n  | \"CONNECT\"\n  | \"SIGN\";\n\nexport type Decoded = {\n  kind: DecodedKind;\n  tokenOrCollection?: string;\n  spenderOrOperator?: string;\n  amountHuman?: string;\n  raw?: any;\n};\n\nexport type TrustVerdict = \"LIKELY_OFFICIAL\" | \"UNKNOWN\" | \"SUSPICIOUS\";\n\nexport type TrustAnalysis = {\n  verdict: TrustVerdict;\n  trustScore: number; // 0-100\n  reasons: string[];\n  matchedAllowlistDomain?: string;\n};\n\nexport type HumanExplanation = {\n  methodTitle: string;\n  methodShort: string;\n  methodWhy: string;\n  whatItDoes?: string[];\n  siteSees?: string[];\n  notHappen?: string[];\n  whyAsked?: string[];\n  risks: string[];\n  safeNotes: string[];\n  safe?: string[];\n  nextSteps: string[];\n  recommendation: string;\n  links?: Array<{ text: string; href: string }>;\n};\n\nexport type ThreatIntel = {\n  updatedAt: number;\n  sources: Array<{ id: string; url: string; ok: boolean; fetchedAt: number; error?: string }>;\n  trustedDomains: string[];\n  blockedDomains: string[];\n};\n\nexport type TxCostPreview = {\n  valueWei: string;                 // decimal string\n  feeEstimated: boolean;\n  gasLimitWei?: string;             // decimal string (gasLimit as bigint)\n  feeLikelyWei?: string;            // decimal string\n  feeMaxWei?: string;               // decimal string\n  totalLikelyWei?: string;          // decimal string\n  totalMaxWei?: string;             // decimal string\n  feeReasonKey?: string;            // i18n key when feeEstimated=false\n  /** USD per 1 unit of native token (for overlay). */\n  usdPerNative?: number;\n};\n\nexport type TxSummary = {\n  to?: string;\n  valueWei?: string;        // decimal\n  valueEth?: string;        // formatted\n  selector?: string;        // 0x + 8 hex\n  gasLimit?: string;        // decimal\n  maxFeePerGasWei?: string; // decimal\n  maxPriorityFeePerGasWei?: string; // decimal (EIP-1559 tip)\n  maxGasFeeEth?: string;    // ETH\n  maxTotalEth?: string;     // ETH (value + maxGasFee)\n  feeKnown?: boolean;\n  contractNameHint?: string;\n  dataLen?: number;         // raw data length\n};\n\nexport type Intent = \"NFT_PURCHASE\" | \"SWAP\" | \"APPROVAL\" | \"SEND\" | \"ETH_TRANSFER\" | \"TOKEN_TRANSFER\" | \"NFT_TRANSFER\" | \"CONTRACT_INTERACTION\" | \"CONNECT\" | \"SIGN\" | \"SIGNATURE\" | \"TYPED_DATA\" | \"CHAIN\" | \"SWITCH_CHAIN\" | \"ADD_CHAIN\" | \"WATCH_ASSET\" | \"SOLANA\" | \"UNKNOWN\";\n\nexport type TxExtras =\n  | {\n      approvalType: \"ERC20_APPROVE\";\n      tokenContract?: string;\n      spender?: string;\n      unlimited?: boolean;\n    }\n  | {\n      approvalType: \"NFT_SET_APPROVAL_FOR_ALL\";\n      tokenContract?: string;\n      operator?: string;\n      unlimited?: boolean;\n    }\n  | {\n      approvalType?: \"NFT_TRANSFER\";\n      tokenContract?: string;\n      toAddress?: string;\n    };\n\n/** P1: Transaction summary v1 for overlay (give/get, approvals, nfts, flags). */\nexport type TxSummaryV1 = {\n  title: string;\n  subtitle?: string;\n  give?: Array<{ amount?: string; symbol?: string; kind: \"NATIVE\" | \"ERC20\" | \"NFT\" | \"UNKNOWN\"; tokenAddress?: string; tokenId?: string; to?: string }>;\n  get?: Array<{ amount?: string; symbol?: string; kind: \"NATIVE\" | \"ERC20\" | \"NFT\" | \"UNKNOWN\"; tokenAddress?: string; tokenId?: string; to?: string }>;\n  approvals?: Array<{ kind: \"ERC20\" | \"ERC721_ALL\" | \"ERC1155_ALL\" | \"PERMIT\" | \"PERMIT2\"; tokenAddress?: string; tokenSymbol?: string; spender?: string; amount?: string; unlimited?: boolean; deadline?: string }>;\n  nfts?: Array<{ collection?: string; tokenAddress?: string; tokenId?: string; amount?: string; to?: string; marketplace?: string }>;\n  flags?: string[]; // reasonKeys\n};\n\nexport type Analysis = {\n  level: RiskLevel;\n  score: number; // 0-100\n  title: string;\n  reasons: string[];\n  decoded?: Decoded;\n  decodedAction?: DecodedAction;\n  recommend: Recommend;\n  trust?: TrustAnalysis;\n  human?: HumanExplanation;\n  suggestedTrustedDomains?: string[];\n  tx?: TxSummary;\n  txCostPreview?: TxCostPreview;\n  txExtras?: TxExtras;\n  intent?: Intent;\n  txContext?: { kind: TxContextKind };\n  chainTarget?: { chainIdHex: string; chainName?: string };\n  addChainInfo?: { chainId: string; chainName?: string; rpcUrls?: string[]; nativeCurrencySymbol?: string };\n  watchAssetInfo?: { type: string; address?: string; symbol?: string; decimals?: number; image?: string };\n  wallet?: WalletInfo;\n  safeDomain?: boolean;\n  isPhishing?: boolean;\n  domainRisk?: { scoreDelta: number; reasons: string[] };\n  addressRisk?: { flagged: boolean; reasons: string[]; matches?: string[] };\n  method?: string;\n  asset?: AssetInfo;\n  flaggedAddress?: ThreatIntelAddress;\n  provider?: { kind: ProviderKind; name?: string };\n  feeGtValue?: boolean;\n  /** Checks performed (security coverage). */\n  checks?: CheckResult[];\n  /** Coverage summary: performed/total, limited when some checks unavailable. */\n  coverage?: { performed: number; total: number; limited: boolean };\n  /** i18n key for main verdict label (e.g. verdict_ok, verdict_warn, verdict_high, verdict_block). */\n  verdictLabelKey?: string;\n  /** When tx.to is a contract (eth_getCode !== \"0x\"). */\n  toIsContract?: boolean;\n  /** Verification level: FULL = intel fresh, LOCAL = cached, BASIC = no intel. */\n  verificationLevel?: \"FULL\" | \"LOCAL\" | \"BASIC\";\n  /** Timestamp of cached intel used (if any). */\n  verificationUpdatedAt?: number;\n  /** true when domain trusted/allowlisted + no flags + no suspicious addr. */\n  knownSafe?: boolean;\n  /** true when phishing/lookalike HIGH + blacklist. */\n  knownBad?: boolean;\n  /** Spender matched denylistSpenders \u2192 BLOCK. */\n  matchedDenySpender?: boolean;\n  /** Spender matched allowlistSpenders \u2192 reduce score. */\n  matchedAllowSpender?: boolean;\n  /** Domain-related signals, e.g. METAMASK_SEED, BLACKLIST_HIT, LOOKALIKE, PUNYCODE, SEED_MATCH, SUSPICIOUS_TLD. */\n  domainSignals?: string[];\n  /** Intel source ids used, e.g. metamask, cryptoscamdb, scamsniffer, local_seed. */\n  intelSources?: string[];\n  /** List manager domain decision: TRUSTED / BLOCKED / UNKNOWN (for site reputation badge). */\n  domainListDecision?: DomainDecision;\n  /** Extras from typed-data (e.g. Permit: spender, value, deadline). */\n  typedDataExtras?: { spender?: string; value?: string; deadline?: string };\n  /** Structured decode for Permit2 / Seaport / Blur typed data (human overlay). */\n  typedDataDecoded?: {\n    permit2?: { spender: string; tokens: string[]; amounts: string[]; unlimited?: boolean; sigDeadline?: string };\n    seaport?: { offerSummary: string; considerationSummary: string; primaryType?: string };\n    isBlur?: boolean;\n  };\n  /** true when any address (to/spender/operator/tokenContract) matched address intel labels. */\n  addressIntelHit?: boolean;\n  /** Labels per role when address intel hit (human-readable label strings). */\n  addressIntel?: {\n    to?: string[];\n    spender?: string[];\n    operator?: string[];\n    tokenContract?: string[];\n  };\n  /** Result of Tenderly simulation (if run). SKIPPED when API failed (fallback). */\n  simulationOutcome?: {\n    status: \"SUCCESS\" | \"REVERT\" | \"RISK\" | \"SKIPPED\";\n    outgoingAssets: Array<{ symbol: string; amount: string; logo?: string }>;\n    incomingAssets: Array<{ symbol: string; amount: string; logo?: string }>;\n    approvals?: Array<{ token: string; spender: string; approved: boolean; unlimited?: boolean; approvalForAll?: boolean }>;\n    gasUsed: string;\n    fallback?: boolean;\n    gasCostWei?: string;\n    isHighGas?: boolean;\n    simulated?: boolean;\n    message?: string;\n  };\n  /** True when simulation predicted revert (show \"ESTA TRANSA\u00C7\u00C3O VAI FALHAR\"). */\n  simulationRevert?: boolean;\n  /** Token confidence: SCAM, TRUSTED, LOW (new/unverified), UNKNOWN. */\n  tokenConfidence?: \"SCAM\" | \"TRUSTED\" | \"LOW\" | \"UNKNOWN\";\n  /** First-seen timestamp for token (when LOW/UNKNOWN). */\n  tokenFirstSeenAt?: number;\n  /** True when honeypot detected (buy but cannot sell / transfer). */\n  isHoneypot?: boolean;\n  /** True when protection is temporarily paused (allow without showing overlay). */\n  protectionPaused?: boolean;\n  /** True when vault blocks this request (Cofre). */\n  vaultBlocked?: boolean;\n  /** Locked contract address when vaultBlocked. */\n  vaultLockedTo?: string;\n  /** ChainId for vault override (VAULT_UNLOCK). */\n  vaultChainIdHex?: string;\n  /** Standardized reason keys for consistency (maps to i18n). */\n  reasonKeys?: string[];\n  /** P1: Structured summary for overlay (title, give/get, approvals, nfts, flags). */\n  summary?: TxSummaryV1;\n  /** P1: Alias for summary (spec name summaryV1). */\n  summaryV1?: TxSummaryV1;\n}\n\nexport type SupportedWalletEntry = { name: string; kind: string };\n\n/** User-configurable settings (spec name: UserSettings). */\nexport type Settings = {\n  riskWarnings: boolean;\n  showConnectOverlay: boolean;\n  blockHighRisk: boolean;\n  requireTypedOverride?: boolean;\n  allowOverrideOnPhishing?: boolean;\n  debugMode?: boolean;\n  domainChecks: boolean;\n  allowlist: string[];\n  trustedDomains?: string[];\n  customBlockedDomains?: string[];\n  customTrustedDomains?: string[];\n  /** P0-C: User allow/deny by spender address (for approvals). */\n  allowlistSpenders?: string[];\n  denylistSpenders?: string[];\n  /** fail_open: allow when runtime unavailable; fail_closed: block on high risk. */\n  failMode?: \"fail_open\" | \"fail_closed\";\n  enableIntel?: boolean;\n  mode?: SecurityMode;\n  supportedWalletsInfo?: SupportedWalletEntry[];\n  strictBlockApprovalsUnlimited?: boolean;\n  strictBlockSetApprovalForAll?: boolean;\n  strictBlockPermitLike?: boolean;\n  assetEnrichmentEnabled?: boolean;\n  addressIntelEnabled?: boolean;\n  /** P0-E: Allow external checks (more protection; may send domain/address for validation). Default false. */\n  cloudIntelOptIn?: boolean;\n  /** Telemetry/analytics opt-in. Default false. Requires termsAccepted. Independent of cloudIntelOptIn. */\n  telemetryOptIn?: boolean;\n  /** @deprecated Use telemetryOptIn. Kept for migration. */\n  telemetryEnabled?: boolean;\n  showUsd?: boolean;\n  planTier?: \"FREE\" | \"PRO\";\n  licenseKey?: string;\n  /** Cofre SignGuard: contracts that must not be transacted without explicit unlock. */\n  vault?: {\n    enabled: boolean;\n    lockedContracts: string[];\n    /** Timestamp until which vault is temporarily unlocked (Date.now() + ms). */\n    unlockedUntil?: number;\n    /** Also block approvals/permits when spender is in lockedContracts. */\n    blockApprovals?: boolean;\n  };\n  /** Tenderly simulation (no hardcoded keys). */\n  simulation?: {\n    enabled: boolean;\n    tenderlyAccount: string;\n    tenderlyProject: string;\n    tenderlyKey: string;\n  };\n  /** Pause protection until this timestamp (Date.now() + ms). */\n  pausedUntil?: number;\n  /** Domains that bypass overlay when protection is active (e.g. trusted tools). */\n  whitelistedDomains?: string[];\n  /** Modo Fortaleza: bloqueia todas as aprova\u00E7\u00F5es de tokens exceto em sites confi\u00E1veis. */\n  fortressMode?: boolean;\n  /** Expandir se\u00E7\u00F5es detalhadas (accordions) do overlay por padr\u00E3o. */\n  defaultExpandDetails?: boolean;\n};\n\n/** Alias for Settings (spec: UserSettings). */\nexport type UserSettings = Settings;\n\n/** Stored in chrome.storage.local key \"sg_plan\". */\nexport type PlanState = {\n  tier: \"FREE\" | \"PRO\";\n  keyMasked?: string;\n  activatedAt?: number;\n  expiresAt?: number;\n};\n\nexport const SUPPORTED_WALLETS: SupportedWalletEntry[] = [\n  { name: \"MetaMask\", kind: \"EVM\" },\n  { name: \"Coinbase Wallet\", kind: \"EVM\" },\n  { name: \"Trust Wallet\", kind: \"EVM\" },\n  { name: \"OKX Wallet\", kind: \"EVM\" },\n  { name: \"Binance Web3\", kind: \"EVM\" },\n  { name: \"Rabby\", kind: \"EVM\" },\n  { name: \"Rainbow\", kind: \"EVM\" },\n  { name: \"Phantom\", kind: \"EVM/Solana\" },\n  { name: \"Brave Wallet\", kind: \"EVM\" },\n  { name: \"Bitget Wallet\", kind: \"EVM\" },\n  { name: \"MathWallet\", kind: \"EVM\" },\n  { name: \"Solflare\", kind: \"Solana\" },\n  { name: \"Backpack\", kind: \"Solana\" },\n];\n\nimport { CRYPTO_TRUSTED_DOMAINS_SEED } from \"../lists/cryptoTrustedDomainsSeed\";\n\nexport const DEFAULT_SETTINGS: Settings = {\n  riskWarnings: true,\n  showConnectOverlay: true,\n  blockHighRisk: true,\n  requireTypedOverride: true,\n  allowOverrideOnPhishing: false,\n  debugMode: false,\n  domainChecks: true,\n  mode: \"BALANCED\",\n  strictBlockApprovalsUnlimited: true,\n  strictBlockSetApprovalForAll: true,\n  strictBlockPermitLike: true,\n  assetEnrichmentEnabled: true,\n  addressIntelEnabled: true,\n  cloudIntelOptIn: false,\n  telemetryOptIn: false,\n  telemetryEnabled: false,\n  showUsd: false,\n  defaultExpandDetails: true,\n  planTier: \"FREE\",\n  licenseKey: \"\",\n  trustedDomains: CRYPTO_TRUSTED_DOMAINS_SEED.slice(0, 24),\n  supportedWalletsInfo: SUPPORTED_WALLETS,\n  allowlist: CRYPTO_TRUSTED_DOMAINS_SEED.slice(0, 24),\n  customBlockedDomains: [],\n  customTrustedDomains: [],\n  allowlistSpenders: [],\n  denylistSpenders: [],\n  failMode: \"fail_open\",\n  enableIntel: true,\n  vault: {\n    enabled: false,\n    lockedContracts: [],\n    unlockedUntil: 0,\n    blockApprovals: false,\n  },\n  simulation: {\n    enabled: false,\n    tenderlyAccount: \"\",\n    tenderlyProject: \"\",\n    tenderlyKey: \"\",\n  },\n  whitelistedDomains: [],\n  fortressMode: false,\n};\n\n", "import { isHexString } from \"./utils\";\r\nimport type { DecodedAction, Address } from \"./types\";\r\n\r\nexport const SELECTOR_ERC20_APPROVE = \"0x095ea7b3\";\r\nexport const SELECTOR_INCREASE_ALLOWANCE = \"0x39509351\";\r\nexport const SELECTOR_DECREASE_ALLOWANCE = \"0xa457c2d7\";\r\nexport const SELECTOR_SET_APPROVAL_FOR_ALL = \"0xa22cb465\";\r\nexport const SELECTOR_TRANSFER = \"0xa9059cbb\";\r\nexport const SELECTOR_TRANSFER_FROM = \"0x23b872dd\";\r\nexport const SELECTOR_SAFE_TRANSFER_FROM_1 = \"0x42842e0e\";\r\nexport const SELECTOR_SAFE_TRANSFER_FROM_2 = \"0xb88d4fde\";\r\nexport const SELECTOR_ERC1155_SAFE_TRANSFER = \"0xf242432a\";\r\nexport const SELECTOR_ERC1155_SAFE_BATCH_TRANSFER = \"0x2eb2c2d6\";\r\nexport const SELECTOR_PERMIT = \"0xd505accf\";\r\n\r\n/** Permit2 AllowanceTransfer.permit(address,PermitSingle,bytes) - Uniswap Permit2 */\r\nexport const SELECTOR_PERMIT2_ALLOWANCE = \"0x2b67b570\";\r\n/** Permit2 SignatureTransfer.permitTransferFrom(single) - Uniswap Permit2 */\r\nexport const SELECTOR_PERMIT2_SIGNATURE_TRANSFER = \"0x0d58b1db\";\r\n\r\n/** Canonical Permit2 contract (Uniswap) - same address on mainnet, Arbitrum, Base, etc. */\r\nexport const PERMIT2_ADDRESS = \"0x000000000022d473030f116ddee9f6b43ac78ba3\";\r\n/** Seaport 1.5 (OpenSea) - NFT marketplace. */\r\nexport const SEAPORT_ADDRESS = \"0x00000000000000adc04c56bf30ac9d3c0aaf14dc\";\r\n/** Blur Marketplace. */\r\nexport const BLUR_MARKETPLACE = \"0x000000000000ad05ccc4f10045630fb830b95127\";\r\n\r\n/** Known marketplace/approval contracts (canonical addresses, lowercase 40 hex). */\r\nconst KNOWN_MARKETPLACES: Record<string, string> = {\r\n  [PERMIT2_ADDRESS.toLowerCase().replace(/^0x/, \"\").slice(-40)]: \"PERMIT2\",\r\n  [SEAPORT_ADDRESS.toLowerCase().replace(/^0x/, \"\").slice(-40)]: \"SEAPORT\",\r\n  [BLUR_MARKETPLACE.toLowerCase().replace(/^0x/, \"\").slice(-40)]: \"BLUR\",\r\n};\r\n\r\n/** multicall(uint256,bytes[]) - 0x5ae401dc (Uniswap Universal Router, etc.). */\r\nexport const SELECTOR_MULTICALL = \"0x5ae401dc\";\r\n\r\nconst MAX_UINT256 = 2n ** 256n - 1n;\r\n\r\nexport function getKnownMarketplace(addr: string): string | null {\r\n  if (!addr || typeof addr !== \"string\") return null;\r\n  const a = addr.toLowerCase().replace(/^0x/, \"\").padStart(40, \"0\").slice(-40);\r\n  return KNOWN_MARKETPLACES[a] ?? null;\r\n}\r\n\r\nfunction isPermit2Contract(addr: string): boolean {\r\n  if (!addr || typeof addr !== \"string\") return false;\r\n  const a = addr.toLowerCase().replace(/^0x/, \"\").padStart(40, \"0\").slice(-40);\r\n  const b = PERMIT2_ADDRESS.toLowerCase().replace(/^0x/, \"\").padStart(40, \"0\").slice(-40);\r\n  return a === b;\r\n}\r\n\r\nfunction isMaxUint256Word(word64: string) {\r\n  return /^[fF]{64}$/.test(word64);\r\n}\r\n\r\nfunction wordAt(dataNo0x: string, wordIndex: number) {\r\n  const start = wordIndex * 64;\r\n  const end = start + 64;\r\n  if (dataNo0x.length < end) return null;\r\n  return dataNo0x.slice(start, end);\r\n}\r\n\r\nfunction readWord(dataHex: string, wordIndex: number): string {\r\n  const data = dataHex.startsWith(\"0x\") ? dataHex.slice(2) : dataHex;\r\n  const start = wordIndex * 64;\r\n  return data.slice(start, start + 64);\r\n}\r\n\r\nfunction readAddress(dataHex: string, wordIndex: number): Address {\r\n  const word = readWord(dataHex, wordIndex);\r\n  return (\"0x\" + (word.length >= 40 ? word.slice(24) : word.padStart(40, \"0\"))).toLowerCase();\r\n}\r\n\r\nfunction readUint256(dataHex: string, wordIndex: number): bigint {\r\n  const word = readWord(dataHex, wordIndex);\r\n  if (!word) return 0n;\r\n  return BigInt(\"0x\" + word);\r\n}\r\n\r\nconst permit2Flag = (txTo?: string) => (isPermit2Contract(txTo || \"\") ? { permit2: true as const } : {});\r\n\r\nexport function decodeTx(data: string, txTo?: string): DecodedAction | null {\r\n  if (!isHexString(data) || data.length < 10) return null;\r\n  const lower = data.toLowerCase();\r\n  const selector = lower.slice(0, 10);\r\n  const body = lower.slice(10);\r\n  const token = (txTo || \"\").toLowerCase();\r\n\r\n  if (selector === SELECTOR_ERC20_APPROVE) {\r\n    const spender = readAddress(body, 0);\r\n    const amount = readUint256(body, 2);\r\n    const amountType = amount === MAX_UINT256 ? \"UNLIMITED\" : \"LIMITED\";\r\n    return { kind: \"APPROVE_ERC20\", token, spender, amountType, amountRaw: amount.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_INCREASE_ALLOWANCE) {\r\n    const spender = readAddress(body, 0);\r\n    const addedValue = readUint256(body, 2);\r\n    const amountType = addedValue === MAX_UINT256 ? \"UNLIMITED\" : \"LIMITED\";\r\n    return { kind: \"INCREASE_ALLOWANCE\", token, spender, amountType, amountRaw: addedValue.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_DECREASE_ALLOWANCE) {\r\n    const spender = readAddress(body, 0);\r\n    const subtractedValue = readUint256(body, 2);\r\n    return { kind: \"DECREASE_ALLOWANCE\", token, spender, amountRaw: subtractedValue.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_TRANSFER) {\r\n    const to = readAddress(body, 0);\r\n    const amount = readUint256(body, 2);\r\n    return { kind: \"TRANSFER_ERC20\", token, to, amountRaw: amount.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_TRANSFER_FROM) {\r\n    const from = readAddress(body, 0);\r\n    const to = readAddress(body, 1);\r\n    const amount = readUint256(body, 2);\r\n    return { kind: \"TRANSFERFROM_ERC20\", token, from, to, amountRaw: amount.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_SET_APPROVAL_FOR_ALL) {\r\n    const operator = readAddress(body, 0);\r\n    const approved = readUint256(body, 2) !== 0n;\r\n    return { kind: \"SET_APPROVAL_FOR_ALL\", token, operator, approved, ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_SAFE_TRANSFER_FROM_1 || selector === SELECTOR_SAFE_TRANSFER_FROM_2) {\r\n    const from = readAddress(body, 0);\r\n    const to = readAddress(body, 2);\r\n    const tokenId = readUint256(body, 4);\r\n    return { kind: \"TRANSFER_NFT\", token, to, tokenIdRaw: tokenId.toString(), standard: \"ERC721\", ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_ERC1155_SAFE_TRANSFER) {\r\n    const from = readAddress(body, 0);\r\n    const to = readAddress(body, 1);\r\n    const id = readUint256(body, 2);\r\n    const amount = readUint256(body, 3);\r\n    return { kind: \"TRANSFER_NFT\", token, from, to, tokenIdRaw: id.toString(), amountRaw: amount.toString(), standard: \"ERC1155\", ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_ERC1155_SAFE_BATCH_TRANSFER) {\r\n    const from = readAddress(body, 0);\r\n    const to = readAddress(body, 1);\r\n    return { kind: \"TRANSFER_NFT\", token, from, to, standard: \"ERC1155\", batch: true, ...permit2Flag(txTo) };\r\n  }\r\n  if (selector === SELECTOR_PERMIT) {\r\n    const spender = readAddress(body, 1);\r\n    const value = readUint256(body, 2);\r\n    const deadline = readUint256(body, 3);\r\n    const valueType = value === MAX_UINT256 ? \"UNLIMITED\" : \"LIMITED\";\r\n    return { kind: \"PERMIT_EIP2612\", token, spender, valueType, valueRaw: value.toString(), deadlineRaw: deadline.toString(), ...permit2Flag(txTo) };\r\n  }\r\n  // Permit2 AllowanceTransfer.permit(owner, PermitSingle, signature) \u2014 struct starts at offset 0x60 (word 3)\r\n  if (isPermit2Contract(txTo || \"\") && selector === SELECTOR_PERMIT2_ALLOWANCE) {\r\n    if (body.length >= 9 * 64) {\r\n      const tokenAddr = readAddress(body, 3);\r\n      const amount = readUint256(body, 4);\r\n      const spenderAddr = readAddress(body, 7);\r\n      const sigDeadline = readUint256(body, 8);\r\n      const amountType = amount === MAX_UINT256 || amount >= 2n ** 160n - 1n ? \"UNLIMITED\" : \"LIMITED\";\r\n      return { kind: \"PERMIT2_ALLOWANCE\", token: tokenAddr, spender: spenderAddr, amountType, amountRaw: amount.toString(), deadlineRaw: sigDeadline.toString(), ...permit2Flag(txTo) };\r\n    }\r\n    return { kind: \"PERMIT2_ALLOWANCE\", token: \"\", spender: \"\", amountType: \"LIMITED\" as const, amountRaw: \"0\", deadlineRaw: \"0\", ...permit2Flag(txTo) };\r\n  }\r\n  // Permit2 SignatureTransfer.permitTransferFrom(permit, transferDetails, owner, signature) \u2014 token/amount in permit struct\r\n  if (isPermit2Contract(txTo || \"\") && selector === SELECTOR_PERMIT2_SIGNATURE_TRANSFER) {\r\n    if (body.length >= 8 * 64) {\r\n      const tokenAddr = readAddress(body, 3);\r\n      const amount = readUint256(body, 4);\r\n      const toAddr = readAddress(body, 6);\r\n      const amountType = amount === MAX_UINT256 ? \"UNLIMITED\" : \"LIMITED\";\r\n      return { kind: \"PERMIT2_TRANSFER\", token: tokenAddr, to: toAddr, amountType, amountRaw: amount.toString(), ...permit2Flag(txTo) };\r\n    }\r\n    return { kind: \"PERMIT2_TRANSFER\", token: \"\", to: \"\", amountType: \"LIMITED\" as const, amountRaw: \"0\", ...permit2Flag(txTo) };\r\n  }\r\n  const mh = getKnownMarketplace(txTo || \"\");\r\n  const marketplaceHint = mh ? { marketplaceHint: mh } : {};\r\n  if (selector === SELECTOR_MULTICALL) {\r\n    return { kind: \"MULTICALL\", selector, ...marketplaceHint, ...permit2Flag(txTo) };\r\n  }\r\n  return { kind: \"UNKNOWN\", selector, ...marketplaceHint, ...permit2Flag(txTo) };\r\n}\r\n\r\nexport function decodeErc20Approve(data: string) {\r\n  // approve(address spender, uint256 value)\r\n  if (!isHexString(data)) return null;\r\n  const lower = data.toLowerCase();\r\n  if (!lower.startsWith(SELECTOR_ERC20_APPROVE)) return null;\r\n  const body = lower.slice(10); // strip selector\r\n  const spenderWord = wordAt(body, 0);\r\n  const valueWord = wordAt(body, 1);\r\n  if (!spenderWord || !valueWord) return null;\r\n\r\n  const spender = (\"0x\" + spenderWord.slice(24)).toLowerCase();\r\n  let value: bigint | null = null;\r\n  try {\r\n    value = BigInt(\"0x\" + valueWord);\r\n  } catch {\r\n    value = null;\r\n  }\r\n\r\n  return {\r\n    spender,\r\n    isMax: isMaxUint256Word(valueWord),\r\n    value,\r\n  };\r\n}\r\n\r\nexport function decodeSetApprovalForAll(data: string) {\r\n  // setApprovalForAll(address operator, bool approved)\r\n  if (!isHexString(data)) return null;\r\n  const lower = data.toLowerCase();\r\n  if (!lower.startsWith(SELECTOR_SET_APPROVAL_FOR_ALL)) return null;\r\n  const body = lower.slice(10);\r\n  const operatorWord = wordAt(body, 0);\r\n  const approvedWord = wordAt(body, 1);\r\n  if (!operatorWord || !approvedWord) return null;\r\n\r\n  const operator = (\"0x\" + operatorWord.slice(24)).toLowerCase();\r\n  const approved = /^0{63}1$/.test(approvedWord);\r\n\r\n  return { operator, approved };\r\n}\r\n\r\n", "console.log(\"\uD83D\uDEA8 [SignGuard Background] Service Worker LOADED via \" + new Date().toISOString());\n\nimport type { AnalyzeRequest, Analysis, Settings, AssetInfo, DecodedAction, SecurityMode, ThreatIntelAddress, CheckResult, CheckKey, PlanState, TxSummaryV1 } from \"./shared/types\";\nimport type { TxSummary } from \"./shared/types\";\nimport { DEFAULT_SETTINGS } from \"./shared/types\";\nimport type { Intent, TxExtras } from \"./shared/types\";\nimport { decodeErc20Approve, decodeSetApprovalForAll, decodeTx } from \"./shared/decode\";\nimport { hostFromUrl, isAllowlisted, hexSelector, isHexString } from \"./shared/utils\";\nimport { shortAddr } from \"./txMath\";\nimport { t } from \"./i18n\";\nimport { computeTrustVerdict } from \"./shared/trust\";\nimport { buildHumanLists, explainMethod } from \"./shared/explain\";\nimport { SUGGESTED_TRUSTED_DOMAINS as SUGGESTED_TRUSTED_DOMAINS_SHARED } from \"./shared/constants\";\nimport { fetchThreatIntel, hostMatches, normalizeHost, hostInBlocked, TRUSTED_SEED } from \"./intel\";\nimport type { ThreatIntel } from \"./intel\";\nimport { loadAddressIntelCachedFast, refreshAddressIntel, saveAddressIntel, normalizeAddr } from \"./addressIntel\";\nimport type { AddressIntel, AddressLabel } from \"./addressIntel\";\nimport { decodeEvmTx, extractTypedDataPermitExtras, extractPermit2FromTypedData, extractSeaportFromTypedData, isBlurTypedData } from \"./txHumanize\";\nimport { hexToBigInt, weiToEth } from \"./txMath\";\nimport { assessDomainRisk } from \"./domainRisk\";\nimport { runSimulation } from \"./services/simulationService\";\nimport { runHoneypotCheck } from \"./services/honeypotService\";\nimport { initTokenSecurity, getTokenInfo, getTokenAddressForTx, markTokenSeen, getTokenFirstSeen } from \"./services/tokenSecurity\";\nimport { extractTokenCandidates, getTokenRisk } from \"./services/tokenRisk\";\nimport { getLists, refresh as refreshLists, getDomainDecision, isBlockedAddress, isScamToken, isTrustedToken, upsertUserOverride, deleteUserOverride, normalizeOverridePayload, setOverrides, exportSnapshot } from \"./services/listManager\";\nimport { getNativeUsd, getTokenUsd } from \"./services/priceService\";\nimport { getTokenMetaViaProvider } from \"./services/tokenMetaViaProvider\";\nimport { initTelemetry, telemetry } from \"./services/telemetryService\";\nimport { INTEREST_MAP } from \"./shared/interestMap\";\nimport { REASON_KEYS } from \"./shared/reasonKeys\";\nimport { normalizeTypedDataParams, isTypedDataMethod } from \"./shared/normalize\";\nimport { hasOptionalHostPermissions, hasOptionalHostPermissionsAll, requestOptionalHostPermissionsOrigins } from \"./permissions\";\nimport { getAllOptionalOrigins } from \"./shared/optionalOrigins\";\nimport { canUseNetwork } from \"./services/netGate\";\n\nexport const SUGGESTED_TRUSTED_DOMAINS = SUGGESTED_TRUSTED_DOMAINS_SHARED;\n\n// Bootstrap: registar onMessage/onConnect logo para PING (sem depender de async init)\nchrome.runtime.onMessage.addListener((msg: any, _sender, sendResponse) => {\n  if (msg?.type === \"PING\") {\n    try { sendResponse({ ok: true, ts: Date.now() }); } catch {}\n    return true;\n  }\n  return false;\n});\nchrome.runtime.onConnect.addListener((port) => {\n  if (!port || port.name !== \"sg_port\") return;\n  port.onMessage.addListener(async (msg: any) => {\n    const requestId = msg?.requestId;\n    const payload = msg ? { ...msg } : {};\n    delete payload.requestId;\n    try {\n      const resp = await handleBgRequest(payload, port.sender);\n      port.postMessage({ requestId, ...(resp ?? { ok: true }) });\n    } catch (e: any) {\n      port.postMessage({ requestId, ok: false, error: String(e?.message || e) });\n    }\n  });\n});\n\n/** Single handler for all background requests (onMessage and Port). Used by options/content via sg_port. */\nasync function handleBgRequest(msg: any, sender?: chrome.runtime.MessageSender): Promise<any> {\n  if (!msg || typeof msg !== \"object\" || !msg.type) return { ok: false, error: \"INVALID_MESSAGE\" };\n  if (msg.type === \"PING\") return { ok: true, ts: Date.now() };\n  try {\n    switch (msg.type) {\n      case \"SG_HAS_OPTIONAL_PERMISSIONS\": {\n        const ok = await hasOptionalHostPermissionsAll();\n        return { ok: true, granted: ok };\n      }\n      case \"SG_REQUEST_OPTIONAL_PERMISSIONS\": {\n        const granted = await requestOptionalHostPermissionsOrigins(getAllOptionalOrigins());\n        return { ok: true, granted };\n      }\n      case \"GET_ETH_USD\":\n      case \"SG_GET_PRICE\": {\n        const s = await getSettings();\n        if (!(await canUseNetwork(\"pricing\", s)).ok) return { ok: false };\n        const usdPerEth = await getEthUsdPriceCached();\n        if (usdPerEth != null) return { ok: true, usdPerEth, ethUsd: usdPerEth, updatedAt: __ethUsdCache?.fetchedAt ?? Date.now() };\n        return { ok: false };\n      }\n      case \"SG_GET_NATIVE_USD\": {\n        const s = await getSettings();\n        if (!(await canUseNetwork(\"pricing\", s)).ok) return { ok: false };\n        const chainIdHex = msg.payload?.chainIdHex ?? \"0x1\";\n        const result = await getNativeUsd(chainIdHex);\n        if (result?.ok && result.usdPerNative != null) return { ok: true, usdPerNative: result.usdPerNative, nativeSymbol: result.nativeSymbol };\n        return { ok: false };\n      }\n      case \"SG_GET_TOKEN_USD\": {\n        const s = await getSettings();\n        if (!(await canUseNetwork(\"pricing\", s)).ok) return { ok: false };\n        const chainIdHex = msg.payload?.chainIdHex ?? \"0x1\";\n        const tokenAddress = msg.payload?.tokenAddress;\n        if (!tokenAddress) return { ok: false };\n        const result = await getTokenUsd(chainIdHex, tokenAddress);\n        if (result) return { ok: true, priceUsd: result.priceUsd, source: \"dexscreener\" };\n        return { ok: false };\n      }\n      case \"SG_GET_TOKEN_META\": {\n        const chainIdHex = msg.payload?.chainIdHex ?? \"0x1\";\n        const tokenAddress = msg.payload?.tokenAddress;\n        if (!tokenAddress) return { ok: false };\n        const tabId = sender?.tab?.id;\n        if (!tabId) return { ok: false, reason: \"NO_TAB\" };\n        const addrNorm = normalizeAddr(tokenAddress) || String(tokenAddress).toLowerCase();\n        const cacheKey = `${(chainIdHex || \"\").toLowerCase()}:${addrNorm}`;\n        const cached = __tokenMetaCache.get(cacheKey);\n        if (cached && Date.now() < cached.expiresAt)\n          return { ok: true, symbol: cached.value.symbol, decimals: cached.value.decimals, name: cached.value.name };\n        const result = await getTokenMetaViaProvider({\n          tabId,\n          chainIdHex,\n          token: tokenAddress,\n          rpc: (method, params) => rpcCallFull(tabId, method, params),\n        });\n        if (result.ok) {\n          __tokenMetaCache.set(cacheKey, { expiresAt: Date.now() + TOKEN_META_CACHE_TTL_MS, value: result });\n          evictTokenMetaCacheIfNeeded();\n          return { ok: true, symbol: result.symbol, decimals: result.decimals, name: result.name };\n        }\n        return { ok: false, reason: (result as { reason?: string }).reason ?? \"PROVIDER_CALL_FAILED\" };\n      }\n      case \"SG_DIAG_PUSH\": {\n        const p = msg.payload ?? {};\n        diagPush({ src: (p.src as DiagEvent[\"src\"]) ?? \"content\", kind: String(p.kind ?? \"\"), requestId: p.requestId, method: p.method, host: p.host, level: p.level, recommend: p.recommend, decision: p.decision, extra: typeof p.extra === \"object\" ? p.extra : undefined });\n        return { ok: true };\n      }\n      case \"SG_DIAG_EXPORT\": {\n        const manifest = chrome.runtime.getManifest();\n        const settings = await getSettings();\n        const settingsSnapshot: Record<string, unknown> = { riskWarnings: settings.riskWarnings, mode: settings.mode, failMode: settings.failMode, cloudIntelOptIn: settings.cloudIntelOptIn, telemetryOptIn: settings.telemetryOptIn, simulationEnabled: settings.simulation?.enabled };\n        if (settings.simulation?.tenderlyAccount) settingsSnapshot.tenderlyAccount = \"[REDACTED]\";\n        if (settings.simulation?.tenderlyProject) settingsSnapshot.tenderlyProject = \"[REDACTED]\";\n        if (settings.simulation?.tenderlyKey) settingsSnapshot.tenderlyKey = \"[REDACTED]\";\n        const DIAG_STR_MAX = 500;\n        const truncate = (v: unknown): unknown => {\n          if (typeof v === \"string\") return v.length <= DIAG_STR_MAX ? v : v.slice(0, DIAG_STR_MAX) + \"...TRUNCATED\";\n          if (Array.isArray(v)) return v.map(truncate);\n          if (v && typeof v === \"object\") return Object.fromEntries(Object.entries(v).map(([k, x]) => [k, truncate(x)]));\n          return v;\n        };\n        const lastDiagEvents = __diag.slice(-DIAG_MAX).map((e) => truncate({ ...e, host: e.host ? e.host.slice(0, 50) : undefined }) as DiagEvent);\n        const out = { extensionVersion: manifest.version, exportedAt: new Date().toISOString(), buildTime: (manifest as { buildTime?: string }).buildTime, settingsSnapshot, lastDiagEvents };\n        return { ok: true, export: out };\n      }\n      case \"SG_LISTS_STATUS\": {\n        const lists = await getLists();\n        return { ok: true, updatedAt: lists.updatedAt, counts: { trustedDomains: lists.trustedDomains.length, blockedDomains: lists.blockedDomains.length, blockedAddresses: lists.blockedAddresses.length, scamTokens: lists.scamTokens.length, userTrustedDomains: lists.userTrustedDomains.length, userBlockedDomains: lists.userBlockedDomains.length, userBlockedAddresses: lists.userBlockedAddresses.length, userScamTokens: lists.userScamTokens.length, userTrustedTokens: (lists.userTrustedTokens ?? []).length }, sources: lists.sources };\n      }\n      case \"SG_LISTS_DECIDE_DOMAIN\": {\n        const host = msg.payload?.host;\n        const lists = await getLists();\n        const decision = getDomainDecision(host ?? \"\", lists);\n        return { ok: true, decision };\n      }\n      case \"SG_LISTS_SEARCH\": {\n        const lists = await getLists();\n        const q = (msg.payload?.q ?? \"\").toString().toLowerCase().trim();\n        const type = (msg.payload?.type ?? \"domain\").toString().toLowerCase();\n        const page = Math.max(0, parseInt(msg.payload?.page, 10) || 0);\n        const pageSize = Math.min(50, Math.max(10, parseInt(msg.payload?.pageSize, 10) || 20));\n        let items: Array<{ value: string; source?: string; kind?: string }> = [];\n        if (type === \"domain\" && q) {\n          const all = [...lists.trustedDomains, ...lists.blockedDomains];\n          const filtered = all.filter((d) => d.includes(q));\n          items = filtered.slice(page * pageSize, (page + 1) * pageSize).map((d) => ({ value: d, kind: lists.trustedDomains.includes(d) ? \"trusted\" : \"blocked\" }));\n        } else if (type === \"address\" && q) {\n          const all = [...lists.blockedAddresses];\n          const filtered = all.filter((a) => a.includes(q));\n          items = filtered.slice(page * pageSize, (page + 1) * pageSize).map((a) => ({ value: a, kind: \"blocked\" }));\n        } else if (type === \"token\" && q) {\n          const filtered = lists.scamTokens.filter((t) => t.address.includes(q) || (t.symbol || \"\").toLowerCase().includes(q));\n          items = filtered.slice(page * pageSize, (page + 1) * pageSize).map((t) => ({ value: t.address, source: t.source, kind: \"scam\", chainId: t.chainId }));\n        }\n        return { ok: true, items, page, pageSize };\n      }\n      case \"SG_LISTS_OVERRIDE_ADD\": {\n        const p = msg.payload ?? {};\n        const typeRaw = p.type ?? p.overrideType;\n        let overrideType: string;\n        let payload: Record<string, unknown>;\n        if (p.payload && typeof p.payload === \"object\") {\n          overrideType = (typeRaw ?? p.payload.type ?? \"\").toString();\n          payload = p.payload as Record<string, unknown>;\n        } else {\n          overrideType = (typeRaw ?? \"\").toString();\n          payload = p as Record<string, unknown>;\n        }\n        const norm = normalizeOverridePayload(overrideType, payload);\n        if (!norm) return { ok: false, error: \"invalid_payload\" };\n        try {\n          await upsertUserOverride(norm.type, norm.payload);\n          const lists = await getLists();\n          return { ok: true, updatedAt: lists.updatedAt };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_LISTS_OVERRIDE_REMOVE\": {\n        const p = msg.payload ?? {};\n        const typeRaw = p.type ?? p.overrideType;\n        let overrideType: string;\n        let payload: Record<string, unknown>;\n        if (p.payload && typeof p.payload === \"object\") {\n          overrideType = (typeRaw ?? p.payload.type ?? \"\").toString();\n          payload = p.payload as Record<string, unknown>;\n        } else {\n          overrideType = (typeRaw ?? \"\").toString();\n          payload = p as Record<string, unknown>;\n        }\n        const norm = normalizeOverridePayload(overrideType, payload);\n        if (!norm) return { ok: false, error: \"invalid_payload\" };\n        const val = (norm.payload.value ?? norm.payload.address ?? \"\").toString();\n        const chainId = (norm.payload.chainId ?? \"\").toString();\n        const addr = (norm.payload.address ?? norm.payload.tokenAddress ?? \"\").toString();\n        try {\n          await deleteUserOverride(norm.type, val, (norm.type === \"scam_token\" || norm.type === \"trusted_token\") ? chainId : undefined, (norm.type === \"scam_token\" || norm.type === \"trusted_token\") ? addr : undefined);\n          const lists = await getLists();\n          return { ok: true, updatedAt: lists.updatedAt };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_LISTS_EXPORT\": {\n        const snapshot = await exportSnapshot();\n        return { ok: true, ...snapshot };\n      }\n      case \"SG_LISTS_OVERRIDE_SET\": {\n        const kind = msg.payload?.kind as string;\n        const values = msg.payload?.values;\n        const validKinds = [\"trustedDomains\", \"blockedDomains\", \"blockedAddresses\", \"scamTokens\"];\n        if (!validKinds.includes(kind) || !Array.isArray(values)) return { ok: false, error: \"invalid_payload\" };\n        try {\n          const result = await setOverrides(kind as \"trustedDomains\" | \"blockedDomains\" | \"blockedAddresses\" | \"scamTokens\", values);\n          return { ok: true, updatedAt: result.cache.updatedAt, invalidCount: result.invalidCount, invalidExamples: result.invalidExamples };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_LISTS_REFRESH\":\n      case \"SG_LISTS_REFRESH_NOW\": {\n        try {\n          const s = await getSettings();\n          const gate = await canUseNetwork(\"cloudIntel\", s);\n          if (!gate.ok) {\n            const lists = await getLists();\n            return { ok: true, updatedAt: lists.updatedAt, counts: { trustedDomains: lists.trustedDomains.length, blockedDomains: lists.blockedDomains.length, blockedAddresses: lists.blockedAddresses.length, scamTokens: lists.scamTokens.length, userTrustedDomains: lists.userTrustedDomains.length, userBlockedDomains: lists.userBlockedDomains.length, userBlockedAddresses: lists.userBlockedAddresses.length, userScamTokens: lists.userScamTokens.length, userTrustedTokens: (lists.userTrustedTokens ?? []).length }, sources: lists.sources, skipped: \"cloud_intel_off_or_no_permissions\" };\n          }\n          const lists = await refreshLists(true);\n          return { ok: true, updatedAt: lists.updatedAt, counts: { trustedDomains: lists.trustedDomains.length, blockedDomains: lists.blockedDomains.length, blockedAddresses: lists.blockedAddresses.length, scamTokens: lists.scamTokens.length, userTrustedDomains: lists.userTrustedDomains.length, userBlockedDomains: lists.userBlockedDomains.length, userBlockedAddresses: lists.userBlockedAddresses.length, userScamTokens: lists.userScamTokens.length, userTrustedTokens: (lists.userTrustedTokens ?? []).length }, sources: lists.sources };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_LISTS_IMPORT\": {\n        const raw = msg.payload?.data;\n        if (!raw || typeof raw !== \"object\") return { ok: false, error: \"invalid_data\" };\n        try {\n          const { importUserOverrides } = await import(\"./services/listManager\");\n          const data = raw.overrides && typeof raw.overrides === \"object\"\n            ? { userTrustedDomains: raw.overrides.trustedDomains, userBlockedDomains: raw.overrides.blockedDomains, userBlockedAddresses: raw.overrides.blockedAddresses, userScamTokens: raw.overrides.scamTokens }\n            : raw;\n          const lists = await importUserOverrides(data);\n          return { ok: true, updatedAt: lists.updatedAt };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_INTEL_SUMMARY\": {\n        const intel = await getIntelFresh();\n        return { ok: true, updatedAt: intel.updatedAt, trustedSeedCount: (intel.trustedSeed || (intel as any).trustedDomainsSeed || []).length, blockedCount: (intel.blockedDomainsList || (intel as any).blockedDomains || []).length, blockedAddressCount: (intel.blockedAddressesList || (intel as any).blockedAddresses || []).length, sources: intel.sources || [] };\n      }\n      case \"SG_INTEL_UPDATE_NOW\":\n      case \"UPDATE_INTEL_NOW\": {\n        let intel: ThreatIntel;\n        try { intel = await updateIntelNow(); } catch { intel = await getIntelFresh(); }\n        return { ok: true, updatedAt: intel.updatedAt, trustedSeedCount: (intel.trustedSeed || (intel as any).trustedDomainsSeed || []).length, blockedCount: (intel.blockedDomainsList || (intel as any).blockedDomains || []).length, blockedAddressCount: (intel.blockedAddressesList || (intel as any).blockedAddresses || []).length, sources: intel.sources || [] };\n      }\n      case \"SG_LOG_HISTORY\": {\n        const evt = msg.payload;\n        if (evt && typeof evt === \"object\") pushHistoryEvent(evt as HistoryEvent);\n        return { ok: true };\n      }\n      case \"SG_TELEMETRY_THREAT\": {\n        const p = msg.payload;\n        if (p && typeof p === \"object\") {\n          const url = typeof p.url === \"string\" ? p.url : \"\";\n          const score = typeof p.riskScore === \"number\" ? p.riskScore : 100;\n          const reasons = Array.isArray(p.reasons) ? p.reasons : [typeof p.reason === \"string\" ? p.reason : \"HIGH_RISK\"];\n          const metadata = (p.metadata && typeof p.metadata === \"object\") ? p.metadata as Record<string, unknown> : {};\n          telemetry.trackThreat(url, score, reasons, metadata).catch(() => {});\n        }\n        return { ok: true };\n      }\n      case \"SG_TELEMETRY_USAGE\": {\n        const p = msg.payload;\n        if (p && typeof p === \"object\" && typeof p.event === \"string\") telemetry.trackEvent(p.event, (p.props && typeof p.props === \"object\") ? p.props as Record<string, unknown> : undefined).catch(() => {});\n        return { ok: true };\n      }\n      case \"TELEMETRY_WALLETS_DETECTED\": {\n        const p = msg.payload;\n        if (p && typeof p === \"object\" && Array.isArray(p.wallets)) telemetry.syncUserWallets(p.wallets).catch(() => {});\n        return { ok: true };\n      }\n      case \"SG_TELEMETRY_INTERACTION\": {\n        const p = msg.payload;\n        if (p && typeof p === \"object\" && typeof p.domain === \"string\") telemetry.trackInteraction({ domain: p.domain, kind: p.kind ?? \"click\", props: (p.props && typeof p.props === \"object\") ? (p.props as Record<string, unknown>) : undefined }).catch(() => {});\n        return { ok: true };\n      }\n      case \"SG_GET_PLAN\": {\n        try {\n          const got = await new Promise<Record<string, PlanState>>((resolve) => {\n            chrome.storage.local.get(PLAN_KEY, (r) => { resolve((r as Record<string, PlanState>) ?? {}); });\n          });\n          const plan = got[PLAN_KEY] ?? { tier: \"FREE\" };\n          return { ok: true, plan };\n        } catch {\n          return { ok: false, plan: { tier: \"FREE\" } };\n        }\n      }\n      case \"SG_ACTIVATE_LICENSE\": {\n        const key = String(msg.payload?.key ?? \"\").trim();\n        const valid = key.startsWith(\"CSG-\") && key.length > 15;\n        try {\n          if (valid) {\n            const plan: PlanState = { tier: \"PRO\", keyMasked: key ? key.slice(0, 6) + \"\u2026\" + key.slice(-4) : undefined, activatedAt: Date.now() };\n            await new Promise<void>((resolve, reject) => {\n              chrome.storage.local.set({ [PLAN_KEY]: plan }, () => (chrome.runtime?.lastError ? reject(chrome.runtime.lastError) : resolve()));\n            });\n            return { ok: true, tier: \"PRO\", invalid: false };\n          }\n          return { ok: true, tier: \"FREE\", invalid: true };\n        } catch (e) {\n          return { ok: false, error: String((e as Error)?.message ?? e) };\n        }\n      }\n      case \"SG_ADDR_INTEL_SUMMARY\": {\n        const { intel: addrIntel, isMissing, isStale } = await loadAddressIntelCachedFast();\n        const labeledCount = Object.keys(addrIntel.labelsByAddress || {}).length;\n        return { ok: true, updatedAt: addrIntel.updatedAt, labeledCount, sources: addrIntel.sources || [], isMissing, isStale };\n      }\n      case \"SG_ADDR_INTEL_UPDATE_NOW\": {\n        const s = await getSettings();\n        if (!(await canUseNetwork(\"cloudIntel\", s)).ok) {\n          const { intel } = await loadAddressIntelCachedFast();\n          return { ok: true, updatedAt: intel.updatedAt, labeledCount: Object.keys(intel.labelsByAddress || {}).length, sources: intel.sources || [], skipped: \"cloud_intel_off_or_no_permissions\" };\n        }\n        const fresh = await refreshAddressIntel();\n        await saveAddressIntel(fresh);\n        const labeledCount = Object.keys(fresh.labelsByAddress || {}).length;\n        return { ok: true, updatedAt: fresh.updatedAt, labeledCount, sources: fresh.sources || [] };\n      }\n      case \"SG_UPDATE_SPENDERS\": {\n        const { addToAllow, addToDeny, removeFromAllow, removeFromDeny } = msg.payload ?? {};\n        const settings = await getSettings();\n        let allow = [...(settings.allowlistSpenders ?? [])];\n        let deny = [...(settings.denylistSpenders ?? [])];\n        const norm = (a: string) => {\n          const h = String(a).replace(/^0x/i, \"\").toLowerCase();\n          if (h.length !== 40 || !/^[a-f0-9]{40}$/.test(h)) return \"\";\n          return \"0x\" + h;\n        };\n        if (addToAllow && typeof addToAllow === \"string\" && /^0x[a-fA-F0-9]{40}$/.test(addToAllow)) {\n          allow = [...new Set([...allow, norm(addToAllow)])];\n          deny = deny.filter((x) => x !== norm(addToAllow));\n        }\n        if (addToDeny && typeof addToDeny === \"string\" && /^0x[a-fA-F0-9]{40}$/.test(addToDeny)) {\n          deny = [...new Set([...deny, norm(addToDeny)])];\n          allow = allow.filter((x) => x !== norm(addToDeny));\n        }\n        if (removeFromAllow && typeof removeFromAllow === \"string\") {\n          allow = allow.filter((x) => x !== norm(removeFromAllow));\n        }\n        if (removeFromDeny && typeof removeFromDeny === \"string\") {\n          deny = deny.filter((x) => x !== norm(removeFromDeny));\n        }\n        await new Promise<void>((resolve, reject) => {\n          chrome.storage.sync.set({ allowlistSpenders: allow, denylistSpenders: deny } as any, () =>\n            chrome.runtime?.lastError ? reject(chrome.runtime.lastError) : resolve()\n          );\n        });\n        return { ok: true };\n      }\n      case \"SG_ADD_TEMP_ALLOW\": {\n        const { host, spender, ttlMs } = msg.payload ?? {};\n        const ms = typeof ttlMs === \"number\" && ttlMs > 0 ? ttlMs : 10 * 60 * 1000;\n        await addTempAllow(host ?? \"\", spender ?? null, ms);\n        return { ok: true };\n      }\n      case \"SG_CHECK_TEMP_ALLOW\": {\n        const { host, spender } = msg.payload ?? {};\n        const allowed = await isTempAllowed(host ?? \"\", spender ?? null);\n        return { ok: true, allowed };\n      }\n      case \"VAULT_UNLOCK\": {\n        const { chainIdHex, contract, ttlMs } = msg.payload ?? {};\n        const c = normAddr40(contract);\n        if (!c) return { ok: false, error: \"invalid_contract\" };\n        const ms = Math.min(30 * 60 * 1000, Math.max(60 * 1000, Number(ttlMs) || 5 * 60 * 1000));\n        await setVaultOverride(chainIdHex ?? \"0x0\", c, ms);\n        return { ok: true, ttlMs: ms };\n      }\n      case \"SG_VAULT_UNLOCK\": {\n        const durationMs = Math.min(600_000, Math.max(60_000, (msg.payload?.durationMs ?? 5 * 60 * 1000)));\n        const settings = await getSettings();\n        const vault = settings.vault ?? { enabled: false, lockedContracts: [], unlockedUntil: 0 };\n        const next = { ...settings, vault: { ...vault, unlockedUntil: Date.now() + durationMs } };\n        await new Promise<void>((resolve, reject) => {\n          chrome.storage.sync.set(next as unknown as Record<string, unknown>, () =>\n            chrome.runtime?.lastError ? reject(chrome.runtime.lastError) : resolve()\n          );\n        });\n        return { ok: true, unlockedUntil: (next.vault as any).unlockedUntil };\n      }\n      case \"SG_TEST_SIMULATION\": {\n        const settings = await getSettings();\n        const { simulateTransaction } = await import(\"./services/simulationService\");\n        const body = {\n          network_id: \"1\",\n          from: \"0x0000000000000000000000000000000000000001\",\n          to: \"0x0000000000000000000000000000000000000002\",\n          input: \"0x\",\n          value: \"0\",\n        };\n        const res = await simulateTransaction(body, settings);\n        return { ok: res != null, error: res == null ? \"Conex\u00E3o falhou ou credenciais inv\u00E1lidas\" : undefined };\n      }\n      case \"ANALYZE\": {\n        const settings = await getSettings();\n        const req = msg.payload as AnalyzeRequest;\n        diagPush({ src: \"background\", kind: \"ANALYZE_START\", requestId: req?.requestId, method: req?.request?.method, host: req?.url ? hostFromUrl(req.url) : undefined });\n        const intel = await getIntelCachedFast();\n        const isStale = intel.updatedAt === 0 || (Date.now() - intel.updatedAt >= INTEL_TTL_MS);\n        if (isStale) ensureIntelRefreshSoon(\"analyze_path\");\n        const { intel: addrIntel, isMissing: addrMissing, isStale: addrStale } = await loadAddressIntelCachedFast();\n        if (addrMissing || addrStale) ensureAddressIntelRefreshSoon(\"analyze_path\");\n        const tabId = sender?.tab?.id;\n        const analysis = await analyze(req, settings, intel, tabId, addrIntel);\n        (analysis as Analysis & { method?: string }).method = req.request?.method;\n        const summaryV1 = buildTxSummaryV1(req, analysis, settings);\n        analysis.summary = summaryV1;\n        analysis.summaryV1 = summaryV1;\n        if (req.wallet) analysis.wallet = req.wallet;\n        if (req.txCostPreview) {\n          analysis.txCostPreview = { ...req.txCostPreview };\n          const tx = analysis.tx as { feeMaxWei?: string; totalMaxWei?: string; valueWei?: string } | undefined;\n          if (tx && !(analysis.txCostPreview as any).feeMaxWei && tx.feeMaxWei) {\n            (analysis.txCostPreview as any).feeMaxWei = tx.feeMaxWei;\n            (analysis.txCostPreview as any).totalMaxWei = tx.totalMaxWei;\n            (analysis.txCostPreview as any).feeEstimated = true;\n          }\n        }\n        const feeEst = req.feeEstimate;\n        if (feeEst?.ok && feeEst.feeEstimated && (feeEst.feeLikelyWeiHex || feeEst.feeMaxWeiHex)) {\n          const preview = analysis.txCostPreview || { valueWei: \"0\", feeEstimated: false };\n          const valueWei = BigInt(preview.valueWei || (analysis.tx as any)?.valueWei || \"0\");\n          const feeLikelyWei = feeEst.feeLikelyWeiHex ? BigInt(feeEst.feeLikelyWeiHex) : 0n;\n          const feeMaxWei = feeEst.feeMaxWeiHex ? BigInt(feeEst.feeMaxWeiHex) : feeLikelyWei;\n          analysis.txCostPreview = {\n            ...preview,\n            valueWei: valueWei.toString(),\n            gasLimitWei: feeEst.gasLimitHex ? BigInt(feeEst.gasLimitHex).toString() : preview.gasLimitWei,\n            feeLikelyWei: feeLikelyWei.toString(),\n            feeMaxWei: feeMaxWei.toString(),\n            totalLikelyWei: (valueWei + feeLikelyWei).toString(),\n            totalMaxWei: (valueWei + feeMaxWei).toString(),\n            feeEstimated: true,\n          };\n        }\n        const chainIdHex = (req.txCostPreview as any)?.chainIdHex ?? (req.meta as any)?.preflight?.chainIdHex ?? (req.meta as any)?.chainIdHex;\n        if (chainIdHex) (analysis as any).chainIdHex = chainIdHex;\n        if (settings.simulation?.enabled === true) {\n          await enrichWithSimulation(req, analysis, settings);\n        }\n        applySpenderPolicy(analysis, settings);\n        if (analysis.safeDomain) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.KNOWN_SAFE_DOMAIN);\n        }\n        const da = analysis.decodedAction as DecodedAction | undefined;\n        if (da?.kind === \"PERMIT_EIP2612\") (analysis.reasonKeys ??= []).push(REASON_KEYS.PERMIT_GRANT);\n        if ((da?.permit2 || da?.kind === \"PERMIT2_ALLOWANCE\" || da?.kind === \"PERMIT2_TRANSFER\")) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.PERMIT2_GRANT);\n        }\n        applyDrainerHeuristics(analysis);\n        applyPolicy(analysis, settings);\n        applyPageRiskOverride(req, analysis);\n        await applyVaultOverride(analysis, settings, req);\n        if (!settings.riskWarnings) {\n          analysis.recommend = \"ALLOW\";\n          analysis.level = \"LOW\";\n          analysis.score = 0;\n          analysis.reasons = [t(\"warningsDisabledReason\")];\n          analysis.title = t(\"analyzerUnavailableTitle\");\n        }\n        addChecksAndVerdict(analysis, { req, settings, intel });\n        const host = hostFromUrl(req.url);\n        const matchedBad = !!(analysis.isPhishing || (analysis.recommend === \"BLOCK\" && (analysis.reasons || []).some((r) => String(r).toLowerCase().includes(\"phishing\") || String(r).toLowerCase().includes(\"blacklist\"))));\n        const matchedSeed = !!analysis.safeDomain;\n        const signals: string[] = [];\n        if (matchedSeed) signals.push(\"SEED_MATCH\");\n        if (matchedBad) signals.push(\"BLACKLIST_HIT\");\n        if ((analysis.reasons || []).some((r) => String(r).toLowerCase().includes(\"lookalike\"))) signals.push(\"LOOKALIKE\");\n        if ((analysis.reasons || []).some((r) => String(r).toLowerCase().includes(\"punycode\") || String(r).toLowerCase().includes(\"xn--\"))) signals.push(\"PUNYCODE\");\n        if ((analysis.reasons || []).some((r) => String(r).toLowerCase().includes(\"suspicious\") || String(r).toLowerCase().includes(\"tld\"))) signals.push(\"SUSPICIOUS_TLD\");\n        Object.assign(analysis, setVerificationFields({ host, intel, usedCacheOnly: true, isStale, matchedBad, matchedSeed, signals }));\n        if (settings.cloudIntelOptIn && (req?.request?.method === \"eth_sendtransaction\" || req?.request?.method === \"wallet_sendtransaction\") && analysis.tx) {\n          const chainId = String(req?.meta?.chainId ?? (req as any)?.chainId ?? \"0x1\").replace(/^0x/, \"\").toLowerCase();\n          const to = (analysis.tx as any)?.to;\n          if (to && typeof to === \"string\" && to.startsWith(\"0x\")) {\n            let valueUsd: number | undefined;\n            const valueEth = (analysis.tx as any)?.valueEth;\n            if (typeof valueEth === \"string\" && parseFloat(valueEth) > 0) {\n              const usdPerEth = await getEthUsdPriceCached();\n              if (usdPerEth != null) valueUsd = parseFloat(valueEth) * usdPerEth;\n            }\n            telemetry.trackTx({ chainId: chainId.startsWith(\"0x\") ? chainId : \"0x\" + chainId, contractAddress: to.toLowerCase(), method: (analysis.intent as string) || \"unknown\", valueUsd }).catch(() => {});\n          }\n        }\n        if (settings.debugMode) {\n          try {\n            pushDebugEvent({ ts: Date.now(), kind: \"ANALYZE\", url: truncateStr(req?.url, 300), host: truncateStr(hostFromUrl(req?.url || \"\"), 120), method: truncateStr(req?.request?.method, 120), level: analysis.level, score: analysis.score, recommend: analysis.recommend, intent: analysis.intent, isPhishing: !!analysis.isPhishing, reasons: (analysis.reasons || []).slice(0, 8).map((r) => truncateStr(r, 240)), tx: analysis.tx ? { to: truncateStr((analysis.tx as any).to, 120), valueEth: truncateStr((analysis.tx as any).valueEth, 64), maxGasFeeEth: truncateStr((analysis.tx as any).maxGasFeeEth, 64), maxTotalEth: truncateStr((analysis.tx as any).maxTotalEth, 64), selector: truncateStr((analysis.tx as any).selector, 16) } : undefined, txExtras: analysis.txExtras ? { approvalType: (analysis.txExtras as any).approvalType, tokenContract: truncateStr((analysis.txExtras as any).tokenContract, 120), spender: truncateStr((analysis.txExtras as any).spender, 120), operator: truncateStr((analysis.txExtras as any).operator, 120), unlimited: !!(analysis.txExtras as any).unlimited } : undefined });\n          } catch {}\n        }\n        diagPush({ src: \"background\", kind: \"ANALYZE_DONE\", requestId: req?.requestId, method: req?.request?.method, host: req?.url ? hostFromUrl(req.url) : undefined, level: analysis.level, recommend: analysis.recommend, extra: { flags: analysis.summary?.flags?.slice(0, 10) } });\n        return { ok: true, analysis };\n      }\n      default:\n        return { ok: false, error: \"UNKNOWN_MESSAGE_TYPE\" };\n    }\n  } catch (e) {\n    return { ok: false, error: String((e as Error)?.message || e) };\n  }\n}\n\nconst INTEL_KEY = \"sg_threat_intel_v2\";\nconst INTEL_TTL_MS = 24 * 60 * 60 * 1000;\n\nconst HISTORY_KEY = \"sg_history_v1\";\nconst DECISION_LOG_KEY = \"sg_decision_log_v1\";\nconst VAULT_OVERRIDES_KEY = \"sg_vault_overrides_v1\";\nconst TEMP_ALLOW_KEY = \"sg_temp_allow_v1\";\n\n/** P1: Diagnosis ring buffer (in-memory, no PII/params). */\nconst DIAG_MAX = 200;\ntype DiagEvent = { ts: number; src: \"mainWorld\" | \"content\" | \"background\"; kind: string; requestId?: string; method?: string; host?: string; level?: string; recommend?: string; decision?: string; extra?: Record<string, unknown> };\nconst __diag: DiagEvent[] = [];\nfunction diagPush(e: Omit<DiagEvent, \"ts\" | \"src\"> & { src?: DiagEvent[\"src\"]; ts?: number }): void {\n  const entry: DiagEvent = { ts: e.ts ?? Date.now(), src: e.src ?? \"background\", kind: e.kind, requestId: e.requestId, method: e.method, host: e.host, level: e.level, recommend: e.recommend, decision: e.decision, extra: e.extra };\n  __diag.push(entry);\n  if (__diag.length > DIAG_MAX) __diag.splice(0, __diag.length - DIAG_MAX);\n}\n\ntype VaultOverrides = Record<string, number>; // key => unlockedUntil epochMs\n\nasync function getVaultOverrides(): Promise<VaultOverrides> {\n  try {\n    const r = await new Promise<Record<string, VaultOverrides>>((resolve) => {\n      chrome.storage.local.get(VAULT_OVERRIDES_KEY, (x) => resolve(x ?? {}));\n    });\n    const raw = r[VAULT_OVERRIDES_KEY];\n    if (!raw || typeof raw !== \"object\") return {};\n    return cleanupExpiredOverrides(raw as VaultOverrides);\n  } catch {\n    return {};\n  }\n}\n\nfunction cleanupExpiredOverrides(overrides: VaultOverrides): VaultOverrides {\n  const now = Date.now();\n  const out: VaultOverrides = {};\n  for (const [k, v] of Object.entries(overrides)) {\n    if (typeof v === \"number\" && v > now) out[k] = v;\n  }\n  return out;\n}\n\nasync function setVaultOverride(chainIdHex: string, contract: string, ttlMs: number): Promise<void> {\n  const c = normAddr40(contract);\n  if (!c) return;\n  const key = `${(chainIdHex || \"0x0\").toLowerCase()}:${c}`;\n  const overrides = await getVaultOverrides();\n  overrides[key] = Date.now() + ttlMs;\n  await new Promise<void>((resolve) => {\n    chrome.storage.local.set({ [VAULT_OVERRIDES_KEY]: overrides }, () => resolve());\n  });\n}\n\nfunction isVaultOverrideActive(overrides: VaultOverrides, chainIdHex: string, contract: string): boolean {\n  const c = normAddr40(contract);\n  if (!c) return false;\n  const key = `${(chainIdHex || \"0x0\").toLowerCase()}:${c}`;\n  const until = overrides[key];\n  return typeof until === \"number\" && until > Date.now();\n}\nconst HISTORY_MAX = 200;\nconst PLAN_KEY = \"sg_plan_v1\";\n\ntype HistoryEvent = {\n  ts: number;\n  requestId: string;\n  host?: string;\n  url?: string;\n  wallet?: string;\n  chainId?: string;\n  action?: string;\n  method?: string;\n  to?: string;\n  valueEth?: string;\n  feeLikelyEth?: string;\n  feeMaxEth?: string;\n  totalLikelyEth?: string;\n  totalMaxEth?: string;\n  /** @deprecated use usdPerNative + nativeSymbol */\n  usdPerEth?: number;\n  nativeSymbol?: string;\n  usdPerNative?: number;\n  decision: \"ALLOW\" | \"BLOCK\";\n  score?: number;\n  level?: string;\n};\n\nfunction pushHistoryEvent(evt: HistoryEvent) {\n  try {\n    const payload = { [HISTORY_KEY]: true, [DECISION_LOG_KEY]: true };\n    chrome.storage.local.get(payload, (r) => {\n      const err = chrome.runtime.lastError;\n      if (err) return;\n      const arr = Array.isArray((r as any)?.[HISTORY_KEY]) ? (r as any)[HISTORY_KEY] : [];\n      arr.push(evt);\n      const trimmed = arr.slice(-HISTORY_MAX);\n      chrome.storage.local.set({ [HISTORY_KEY]: trimmed, [DECISION_LOG_KEY]: trimmed }, () => void 0);\n    });\n  } catch {}\n}\n\ntype TempAllowEntry = { expiresAt: number };\nasync function addTempAllow(host: string, spender: string | null, ttlMs: number): Promise<void> {\n  const now = Date.now();\n  const expiresAt = now + ttlMs;\n  const got = await new Promise<Record<string, Record<string, TempAllowEntry>>>((resolve) => {\n    chrome.storage.local.get(TEMP_ALLOW_KEY, (r) => resolve((r as any) ?? {}));\n  });\n  const map = (got[TEMP_ALLOW_KEY] ?? {}) as Record<string, TempAllowEntry>;\n  if (host) map[`domain:${host.toLowerCase()}`] = { expiresAt };\n  if (spender && /^0x[a-fA-F0-9]{40}$/.test(spender)) map[`spender:${spender.toLowerCase()}`] = { expiresAt };\n  await new Promise<void>((res) => chrome.storage.local.set({ [TEMP_ALLOW_KEY]: map }, () => res()));\n}\n\nasync function isTempAllowed(host: string, spender: string | null): Promise<boolean> {\n  const now = Date.now();\n  const got = await new Promise<Record<string, Record<string, TempAllowEntry>>>((resolve) => {\n    chrome.storage.local.get(TEMP_ALLOW_KEY, (r) => resolve((r as any) ?? {}));\n  });\n  const map = (got[TEMP_ALLOW_KEY] ?? {}) as Record<string, TempAllowEntry>;\n  const entries = Object.entries(map).filter(([, v]) => v.expiresAt > now);\n  const fresh: Record<string, TempAllowEntry> = {};\n  for (const [k, v] of entries) fresh[k] = v;\n  if (entries.length < Object.keys(map).length) {\n    chrome.storage.local.set({ [TEMP_ALLOW_KEY]: fresh }, () => void 0);\n  }\n  if (host && fresh[`domain:${host.toLowerCase()}`]) return true;\n  if (spender && fresh[`spender:${spender.toLowerCase()}`]) return true;\n  return false;\n}\n\n/** Minimal intel from local seed only (no network). Used when cache is missing. */\nfunction getMinimalSeedIntel(): ThreatIntel {\n  return {\n    updatedAt: 0,\n    sources: [{ name: \"local_seed\", ok: true, count: 0, url: \"\" }],\n    blockedDomains: {},\n    allowedDomains: {},\n    blockedAddresses: {},\n    trustedSeed: [...TRUSTED_SEED],\n    blockedDomainsList: [],\n    blockedAddressesList: [],\n    trustedTokenAddresses: [],\n  };\n}\nconst ASSET_CACHE_KEY = \"sg_asset_cache\";\nconst ASSET_CACHE_TTL_MS = 7 * 24 * 60 * 60 * 1000; // 7 days\n\nconst getCodeCache = new Map<string, boolean>();\n\nasync function getToIsContract(address: string | undefined, tabId: number | undefined): Promise<boolean | undefined> {\n  const addr = (address || \"\").toLowerCase();\n  if (!addr || addr.length < 40) return undefined;\n  const cacheKey = addr;\n  const hit = getCodeCache.get(cacheKey);\n  if (hit !== undefined) return hit;\n  try {\n    const code = await Promise.race([\n      rpcCall(tabId, \"eth_getCode\", [addr, \"latest\"]),\n      new Promise<null>((_, rej) => setTimeout(() => rej(new Error(\"timeout\")), 1500)),\n    ]);\n    const isContract = !!(code && code !== \"0x\" && code !== \"0x0\" && (code as string).length > 2);\n    getCodeCache.set(cacheKey, isContract);\n    return isContract;\n  } catch {\n    return undefined;\n  }\n}\n\nasync function loadIntel(): Promise<ThreatIntel | null> {\n  try {\n    const r = await (chrome.storage.local.get as any)(INTEL_KEY);\n    return (r?.[INTEL_KEY] as ThreatIntel) ?? null;\n  } catch {\n    return null;\n  }\n}\n\nasync function saveIntel(intel: ThreatIntel) {\n  try {\n    await (chrome.storage.local.set as any)({ [INTEL_KEY]: intel });\n  } catch {}\n}\n\nasync function getIntelFresh(): Promise<ThreatIntel> {\n  const cached = await loadIntel();\n  if (cached && Date.now() - cached.updatedAt < INTEL_TTL_MS) return cached;\n  const gate = await canUseNetwork(\"cloudIntel\", await getSettings());\n  if (!gate.ok) {\n    if (cached) return cached;\n    return getMinimalSeedIntel();\n  }\n  const fresh = await fetchThreatIntel();\n  await saveIntel(fresh);\n  return fresh;\n}\n\n/** Returns cached intel only (no network). Never blocks on fetch. */\nasync function getIntelCachedFast(): Promise<ThreatIntel> {\n  const cached = await loadIntel();\n  if (cached) return cached;\n  return getMinimalSeedIntel();\n}\n\nlet _intelRefreshInProgress = false;\n\n/** Schedules an async intel refresh without blocking. Concurrency-safe. */\nfunction ensureIntelRefreshSoon(reason: string): void {\n  if (_intelRefreshInProgress) return;\n  _intelRefreshInProgress = true;\n  Promise.resolve()\n    .then(() => updateIntelNow())\n    .catch(() => {})\n    .finally(() => {\n      _intelRefreshInProgress = false;\n    });\n}\n\nasync function updateIntelNow(_opts?: { reason?: string }): Promise<ThreatIntel> {\n  const settings = await getSettings();\n  const gate = await canUseNetwork(\"cloudIntel\", settings);\n  if (!gate.ok) return getIntelCachedFast();\n  const fresh = await fetchThreatIntel();\n  await saveIntel(fresh);\n  return fresh;\n}\n\nlet _addrIntelRefreshInProgress = false;\n\nfunction ensureAddressIntelRefreshSoon(reason: string): void {\n  if (_addrIntelRefreshInProgress) return;\n  _addrIntelRefreshInProgress = true;\n  Promise.resolve()\n    .then(async () => {\n      try {\n        const s = await getSettings();\n        if (!(await canUseNetwork(\"cloudIntel\", s)).ok) return;\n        const fresh = await refreshAddressIntel();\n        await saveAddressIntel(fresh);\n      } finally {\n        _addrIntelRefreshInProgress = false;\n      }\n    })\n    .catch(() => { _addrIntelRefreshInProgress = false; });\n}\n\nchrome.runtime.onInstalled.addListener((details) => {\n  console.log(\"\uD83D\uDEA8 [SignGuard Background] Installed/Updated event fired\");\n  if (details.reason === \"install\") {\n    try {\n      chrome.tabs.create({ url: chrome.runtime.getURL(\"onboarding.html\") });\n    } catch {}\n  }\n  initTokenSecurity().catch(() => {});\n  ensureIntelRefreshSoon(\"startup\");\n  ensureAddressIntelRefreshSoon(\"startup\");\n  chrome.alarms.create(\"sg_intel_daily\", { periodInMinutes: 24 * 60 });\n  chrome.alarms.create(\"SG_REFRESH_LISTS\", { periodInMinutes: 360 });\n  getSettings().then(async (s) => {\n    if ((await canUseNetwork(\"cloudIntel\", s)).ok) refreshLists().catch(() => {});\n  });\n});\n\nchrome.alarms.onAlarm.addListener(async (a) => {\n  if (a.name === \"sg_intel_daily\") {\n    try { await updateIntelNow(); } catch {}\n    try { ensureAddressIntelRefreshSoon(\"alarm_daily\"); } catch {}\n    return;\n  }\n  if (a.name === \"SG_REFRESH_LISTS\") {\n    try {\n      const s = await getSettings();\n      if ((await canUseNetwork(\"cloudIntel\", s)).ok) await refreshLists();\n    } catch {}\n  }\n});\n\nfunction tabsSendMessageSafe(tabId: number, message: any): Promise<any | null> {\n  return new Promise((resolve) => {\n    try {\n      if (!chrome?.tabs?.sendMessage) return resolve(null);\n      chrome.tabs.sendMessage(tabId, message, (resp: any) => {\n        const err = chrome.runtime?.lastError;\n        if (err) return resolve(null);\n        resolve(resp ?? null);\n      });\n    } catch {\n      resolve(null);\n    }\n  });\n}\n\nconst RPC_ALLOWED = new Set([\"eth_call\", \"eth_chainid\", \"eth_getcode\", \"eth_getblockbynumber\", \"eth_getlogs\", \"eth_estimategas\"]);\n\nasync function rpcCall(tabId: number | undefined, method: string, params: any[]): Promise<any> {\n  if (!tabId || typeof chrome.tabs.sendMessage !== \"function\") return null;\n  const m = String(method).toLowerCase();\n  if (!RPC_ALLOWED.has(m)) return null;\n  try {\n    const resp = await tabsSendMessageSafe(tabId, { type: \"SG_RPC_CALL_REQUEST\", method: m, params: params ?? [] });\n    return (resp as any)?.ok ? (resp as any).result : null;\n  } catch {\n    return null;\n  }\n}\n\n/** Like rpcCall but returns full { ok, result, error } for preflight revert detection. */\nasync function rpcCallFull(tabId: number | undefined, method: string, params: any[]): Promise<{ ok: boolean; result?: unknown; error?: string } | null> {\n  if (!tabId || typeof chrome.tabs.sendMessage !== \"function\") return null;\n  const m = String(method).toLowerCase();\n  if (!RPC_ALLOWED.has(m)) return null;\n  try {\n    const resp = await tabsSendMessageSafe(tabId, { type: \"SG_RPC_CALL_REQUEST\", method: m, params: params ?? [] });\n    if (resp && typeof resp === \"object\") return { ok: !!(resp as any).ok, result: (resp as any).result, error: (resp as any).error };\n    return null;\n  } catch {\n    return null;\n  }\n}\n\nasync function getAssetInfo(chainId: string, address: string, tabId: number | undefined): Promise<AssetInfo | null> {\n  const key = `${(chainId || \"\").toLowerCase()}:${(address || \"\").toLowerCase()}`;\n  if (!key || key === \":\") return null;\n  try {\n    const cached: Record<string, AssetInfo> = (await (chrome.storage.local.get as any)(ASSET_CACHE_KEY))?.[ASSET_CACHE_KEY] || {};\n    const hit = cached[key];\n    if (hit && Date.now() - (hit.fetchedAt || 0) < ASSET_CACHE_TTL_MS) return hit;\n\n    const call = (to: string, data: string) => rpcCall(tabId, \"eth_call\", [{ to, data, gas: \"0x7530\" }]);\n    const nameHex = await call(address, \"0x06fdde03\");\n    const symbolHex = await call(address, \"0x95d89b41\");\n    const decimalsHex = await call(address, \"0x313ce567\");\n\n    let name = \"\";\n    let symbol = \"\";\n    let decimals: number | undefined;\n    const decodeBytes = (h: string) => {\n      if (!h || typeof h !== \"string\" || !h.startsWith(\"0x\")) return \"\";\n      const hex = h.slice(2);\n      const len = parseInt(hex.slice(64, 128), 16) || 0;\n      const data = hex.slice(128, 128 + len * 2);\n      let s = \"\";\n      for (let i = 0; i < data.length; i += 2) {\n        const c = parseInt(data.slice(i, i + 2), 16);\n        if (c > 0) s += String.fromCharCode(c);\n      }\n      return s;\n    };\n    if (nameHex) name = decodeBytes(nameHex);\n    if (symbolHex) symbol = decodeBytes(symbolHex);\n    if (decimalsHex && typeof decimalsHex === \"string\" && decimalsHex.startsWith(\"0x\")) {\n      try { decimals = parseInt(decimalsHex, 16); } catch {}\n    }\n\n    let kind: AssetInfo[\"kind\"] = \"UNKNOWN\";\n    if (decimals != null && (symbol || name)) {\n      kind = \"ERC20\";\n    } else {\n      const pad32 = (h: string) => h.replace(/^0x/, \"\").padStart(64, \"0\").slice(0, 64);\n      const sup721 = await call(address, \"0x01ffc9a7\" + pad32(\"0x80ac58cd\"));\n      const sup1155 = await call(address, \"0x01ffc9a7\" + pad32(\"0xd9b67a26\"));\n      const isTrue = (r: any) => r && /[1-9a-f]/.test(String(r).replace(/^0x/, \"\"));\n      if (isTrue(sup721)) kind = \"ERC721\";\n      else if (isTrue(sup1155)) kind = \"ERC1155\";\n    }\n\n    const info: AssetInfo = { chainId, address: address.toLowerCase(), kind, name: name || undefined, symbol: symbol || undefined, decimals, fetchedAt: Date.now() };\n    cached[key] = info;\n    await (chrome.storage.local.set as any)({ [ASSET_CACHE_KEY]: cached });\n    return info;\n  } catch {\n    return null;\n  }\n}\n\nconst DEBUG_KEY = \"sg_debug_events\";\n\nfunction clamp01(n: number, min = 0, max = 100) {\n  return Math.max(min, Math.min(max, n));\n}\n\nfunction truncateStr(s: any, max = 1200) {\n  const str = typeof s === \"string\" ? s : String(s ?? \"\");\n  if (str.length <= max) return str;\n  return str.slice(0, max) + \"\u2026\";\n}\n\nfunction pushDebugEvent(evt: any) {\n  try {\n    chrome.storage.local.get(DEBUG_KEY, (r) => {\n      const err = chrome.runtime.lastError;\n      if (err) return;\n      const arr = Array.isArray((r as any)?.[DEBUG_KEY]) ? (r as any)[DEBUG_KEY] : [];\n      arr.push(evt);\n      const trimmed = arr.slice(-20);\n      chrome.storage.local.set({ [DEBUG_KEY]: trimmed }, () => void 0);\n    });\n  } catch {}\n}\n\nconst PRICE_CACHE_KEY = \"sg_price_cache\";\nconst PRICE_CACHE_TTL_MS = 120_000; // 2 min\nlet __ethUsdCache: { usdPerEth: number; fetchedAt: number } | null = null;\n\nconst TOKEN_META_CACHE_TTL_MS = 5 * 60 * 1000; // 5 min\nconst TOKEN_META_CACHE_MAX = 500;\ntype TokenMetaCacheEntry = { expiresAt: number; value: { symbol?: string; decimals?: number; name?: string } };\nconst __tokenMetaCache = new Map<string, TokenMetaCacheEntry>();\nfunction evictTokenMetaCacheIfNeeded(): void {\n  if (__tokenMetaCache.size <= TOKEN_META_CACHE_MAX) return;\n  const now = Date.now();\n  for (const [k, v] of __tokenMetaCache) {\n    if (now >= v.expiresAt) __tokenMetaCache.delete(k);\n  }\n  if (__tokenMetaCache.size > TOKEN_META_CACHE_MAX) {\n    const keysToDelete = [...__tokenMetaCache.keys()].slice(0, __tokenMetaCache.size - TOKEN_META_CACHE_MAX);\n    keysToDelete.forEach((k) => __tokenMetaCache.delete(k));\n  }\n}\n\nasync function getEthUsdPriceCached(): Promise<number | null> {\n  const now = Date.now();\n  if (__ethUsdCache && (now - __ethUsdCache.fetchedAt) < PRICE_CACHE_TTL_MS) return __ethUsdCache.usdPerEth;\n\n  try {\n    const stored = await new Promise<{ ethUsd?: number; updatedAt?: number } | null>((resolve) => {\n      chrome.storage.local.get(PRICE_CACHE_KEY, (r) => {\n        if (chrome.runtime?.lastError) return resolve(null);\n        resolve((r as any)?.[PRICE_CACHE_KEY] ?? null);\n      });\n    });\n    if (stored?.ethUsd != null && Number.isFinite(stored.ethUsd) && stored.updatedAt != null && (now - stored.updatedAt) < PRICE_CACHE_TTL_MS) {\n      __ethUsdCache = { usdPerEth: stored.ethUsd, fetchedAt: stored.updatedAt };\n      return stored.ethUsd;\n    }\n  } catch {}\n\n  const gate = await canUseNetwork(\"pricing\", await getSettings());\n  if (!gate.ok) {\n    return __ethUsdCache?.usdPerEth ?? null;\n  }\n  try {\n    const resp = await fetch(\"https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd\", {\n      method: \"GET\",\n      headers: { \"accept\": \"application/json\" },\n    });\n    if (!resp.ok) return null;\n    const j: any = await resp.json();\n    const usd = Number(j?.ethereum?.usd);\n    if (!Number.isFinite(usd) || usd <= 0) return null;\n    __ethUsdCache = { usdPerEth: usd, fetchedAt: now };\n    try {\n      chrome.storage.local.set({ [PRICE_CACHE_KEY]: { ethUsd: usd, updatedAt: now } }, () => void 0);\n    } catch {}\n    return usd;\n  } catch {\n    return null;\n  }\n}\n\nasync function getSettings(): Promise<Settings> {\n  return await new Promise((resolve) => {\n    try {\n      chrome.storage.sync.get(DEFAULT_SETTINGS, (got) => {\n        const err = chrome.runtime.lastError;\n        if (err) return resolve(DEFAULT_SETTINGS);\n        resolve(got as Settings);\n      });\n    } catch {\n      resolve(DEFAULT_SETTINGS);\n    }\n  });\n}\n\ntry {\n  initTelemetry(getSettings);\n} catch (e) {\n  console.warn(\"SignGuard: Telemetry init failed (non-fatal):\", e);\n}\n\nconst WEB3_KEYWORDS = [\"swap\", \"dex\", \"finance\", \"crypto\", \"nft\", \"wallet\", \"bridge\", \"stake\", \"defi\", \"uniswap\", \"pancake\", \"opensea\", \"metamask\", \"phantom\"];\nconst tabSessions = new Map<number, { startTime: number; domain: string; referrer: string }>();\n\nfunction isWeb3RelevantDomain(host: string): boolean {\n  const h = (host || \"\").toLowerCase();\n  if (!h) return false;\n  return WEB3_KEYWORDS.some((k) => h.includes(k));\n}\n\n/** Map host to interest category (e.g. opensea.io -> NFT). */\nfunction domainToInterestCategory(host: string): string | undefined {\n  const h = (host || \"\").toLowerCase();\n  if (!h) return undefined;\n  for (const [key, category] of Object.entries(INTEREST_MAP)) {\n    if (h.includes(key.toLowerCase()) || h.endsWith(\".\" + key.toLowerCase())) return category;\n  }\n  return undefined;\n}\n\nasync function endSessionAndTrack(tabId: number) {\n  const s = tabSessions.get(tabId);\n  tabSessions.delete(tabId);\n  if (!s) return;\n  try {\n    const durationSec = Math.max(0, Math.round((Date.now() - s.startTime) / 1000));\n    if (durationSec > 0) await telemetry.trackSession({ domain: s.domain, referrer: s.referrer, durationSec });\n  } catch {\n    // silent (trackSession already checks telemetry opt-in internally)\n  }\n}\n\nchrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {\n  try {\n    const url = changeInfo.url ?? tab?.url;\n    const status = changeInfo.status;\n    if (status === \"complete\" && url) {\n      try {\n        const u = new URL(url);\n        const host = u.hostname || \"\";\n        if (isWeb3RelevantDomain(host)) {\n          const category = domainToInterestCategory(host);\n          if (category) {\n            telemetry.trackInterest(category).catch(() => {});\n            getSettings().then((settings) => {\n              chrome.storage.local.get([\"termsAccepted\", \"sg_user_interest_tags\"], (r) => {\n                const terms = (r as Record<string, unknown>)?.termsAccepted === true;\n                if (!terms || !settings?.telemetryOptIn) return;\n                const arr = Array.isArray((r as any)?.sg_user_interest_tags) ? (r as any).sg_user_interest_tags : [];\n                if (!arr.includes(category)) {\n                  arr.push(category);\n                  chrome.storage.local.set({ sg_user_interest_tags: arr });\n                }\n              });\n            }).catch(() => {});\n          }\n          endSessionAndTrack(tabId).then(() => {\n            tabSessions.set(tabId, { startTime: Date.now(), domain: host, referrer: \"\" });\n          });\n        }\n      } catch {\n        // ignore invalid url\n      }\n    }\n  } catch {\n    // must not break extension\n  }\n});\n\nchrome.tabs.onRemoved.addListener((tabId) => {\n  endSessionAndTrack(tabId).catch(() => {});\n});\n\nfunction normAddr40(addr: string | undefined): string | null {\n  if (!addr || typeof addr !== \"string\" || !addr.startsWith(\"0x\")) return null;\n  const hex = addr.replace(/^0x/, \"\").toLowerCase();\n  if (hex.length !== 40 || !/^[a-f0-9]{40}$/.test(hex)) return null;\n  return \"0x\" + hex;\n}\n\n/** Returns { blocked, lockedTo, chainIdHex } if vault blocks this request. Uses local overrides (per chain:contract). */\nasync function getVaultBlock(\n  settings: Settings,\n  req: AnalyzeRequest,\n  analysis: Analysis\n): Promise<{ blocked: boolean; lockedTo?: string; chainIdHex?: string }> {\n  const vault = settings.vault;\n  if (!vault?.enabled || !Array.isArray(vault.lockedContracts) || vault.lockedContracts.length === 0)\n    return { blocked: false };\n  const locked = vault.lockedContracts.map((a) => normAddr40(a)).filter((x): x is string => !!x);\n  if (locked.length === 0) return { blocked: false };\n\n  const chainIdHex =\n    (req.meta as { chainIdHex?: string })?.chainIdHex ??\n    (req.txCostPreview as { chainIdHex?: string })?.chainIdHex ??\n    \"0x0\";\n  const overrides = await getVaultOverrides();\n\n  const method = String(req?.request?.method ?? \"\").toLowerCase();\n  const params = req?.request?.params;\n\n  if (method === \"eth_sendtransaction\" || method === \"wallet_sendtransaction\") {\n    const tx = Array.isArray(params) && params[0] && typeof params[0] === \"object\" ? params[0] : null;\n    if (tx) {\n      const to = normAddr40((tx as any).to);\n      if (to && locked.includes(to)) {\n        if (isVaultOverrideActive(overrides, chainIdHex, to)) return { blocked: false };\n        const globalUntil = vault.unlockedUntil ?? 0;\n        if (globalUntil > 0 && Date.now() < globalUntil) return { blocked: false };\n        return { blocked: true, lockedTo: to, chainIdHex };\n      }\n    }\n  }\n\n  const blockApprovals = vault.blockApprovals === true;\n  const candidates = extractSpenderCandidates(analysis);\n  for (const c of candidates) {\n    if (locked.includes(c)) {\n      if (!blockApprovals) continue;\n      if (isVaultOverrideActive(overrides, chainIdHex, c)) continue;\n      const globalUntil = vault.unlockedUntil ?? 0;\n      if (globalUntil > 0 && Date.now() < globalUntil) continue;\n      return { blocked: true, lockedTo: c, chainIdHex };\n    }\n  }\n  return { blocked: false };\n}\n\nfunction applyPageRiskOverride(req: AnalyzeRequest, analysis: Analysis): void {\n  const pageRisk = (req.meta as { pageRisk?: { score: string; reasons: string[] } } | undefined)?.pageRisk;\n  if (!pageRisk) return;\n  if (pageRisk.score === \"HIGH\") {\n    analysis.score = Math.max(analysis.score, 85);\n    if (analysis.level !== \"HIGH\") analysis.level = \"WARN\";\n    if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"HIGH\";\n    analysis.reasons.unshift(t(\"reason_page_risk_high\") || REASON_KEYS.PAGE_RISK_HIGH + \": P\u00E1gina com risco alto detectado.\");\n    (analysis.reasonKeys ??= []).unshift(REASON_KEYS.PAGE_RISK_HIGH);\n  } else if (pageRisk.score === \"MEDIUM\") {\n    analysis.score = Math.max(analysis.score, 50);\n    if (analysis.level === \"LOW\") analysis.level = \"WARN\";\n    analysis.reasons.push(t(\"reason_page_risk_medium\") || REASON_KEYS.PAGE_RISK_MEDIUM + \": P\u00E1gina com risco m\u00E9dio.\");\n    (analysis.reasonKeys ??= []).push(REASON_KEYS.PAGE_RISK_MEDIUM);\n  }\n}\n\nasync function applyVaultOverride(analysis: Analysis, settings: Settings, req: AnalyzeRequest): Promise<void> {\n  const block = await getVaultBlock(settings, req, analysis);\n  if (!block.blocked) return;\n  analysis.recommend = \"BLOCK\";\n  analysis.level = \"HIGH\";\n  analysis.score = Math.max(analysis.score, 95);\n  analysis.title = t(\"vaultBlockedTitle\");\n  analysis.reasons.unshift(t(\"vaultBlockedReason\"));\n  (analysis.reasonKeys ??= []).unshift(REASON_KEYS.VAULT_LOCKED);\n  (analysis as Analysis).vaultBlocked = true;\n  if (block.lockedTo) (analysis as Analysis).vaultLockedTo = block.lockedTo;\n  if (block.chainIdHex) (analysis as Analysis).vaultChainIdHex = block.chainIdHex;\n}\n\nfunction domainHeuristicsLocalized(host: string): { level: \"LOW\" | \"WARN\"; reasons: string[] } {\n  const h = (host || \"\").toLowerCase();\n  const reasons: string[] = [];\n  if (!h) return { level: \"LOW\", reasons };\n\n  if (h.startsWith(\"xn--\") || h.includes(\".xn--\")) reasons.push(t(\"domainPunycodeReason\"));\n  if (h.includes(\"--\")) reasons.push(t(\"domainDoubleDashReason\"));\n  if (/\\d{2,}/.test(h)) reasons.push(t(\"domainNumberPatternReason\"));\n\n  const suspects = [\n    { legit: \"uniswap.org\", typos: [\"uniswa\", \"un1swap\", \"unlswap\", \"uniswap-app\"] },\n    { legit: \"opensea.io\", typos: [\"opensea-\", \"open-sea\", \"0pensea\"] },\n  ];\n  for (const s of suspects) {\n    if (s.typos.some((tt) => h.includes(tt))) reasons.push(t(\"domainLookalikeReason\", { domain: s.legit }));\n  }\n\n  return { level: reasons.length ? \"WARN\" : \"LOW\", reasons };\n}\n\nfunction summarizeTx(method: string, params: any[]): any | null {\n  const m = String(method || \"\").toLowerCase();\n  if (m !== \"eth_sendtransaction\" && m !== \"wallet_sendtransaction\") return null;\n  const tx = params?.[0];\n  if (!tx || typeof tx !== \"object\") return null;\n\n  const to = typeof (tx as any).to === \"string\" ? (tx as any).to : \"\";\n  const data = typeof (tx as any).data === \"string\" ? (tx as any).data : \"\";\n  const valueWei = hexToBigInt((tx as any).value || \"0x0\");\n  const valueEth = weiToEth(valueWei);\n\n  const gasLimit = hexToBigInt((tx as any).gas || (tx as any).gasLimit || \"0x0\");\n  const maxFeePerGas = hexToBigInt((tx as any).maxFeePerGas || \"0x0\");\n  const maxPriorityFeePerGas = hexToBigInt((tx as any).maxPriorityFeePerGas || \"0x0\");\n  const gasPrice = hexToBigInt((tx as any).gasPrice || \"0x0\");\n  const dataLen = typeof (tx as any).data === \"string\" ? (tx as any).data.length : 0;\n\n  const hasGas = gasLimit > 0n;\n  const hasFeePerGas = maxFeePerGas > 0n || gasPrice > 0n;\n  const feeKnown = !!(hasGas && hasFeePerGas);\n\n  const feePerGas = maxFeePerGas > 0n ? maxFeePerGas : gasPrice;\n  let maxGasFeeEth = \"\";\n  let maxTotalEth = \"\";\n  let feeMaxWeiStr = \"\";\n  let totalMaxWeiStr = \"\";\n  if (feeKnown && gasLimit > 0n && feePerGas > 0n) {\n    const gasFeeWei = gasLimit * feePerGas;\n    maxGasFeeEth = weiToEth(gasFeeWei);\n    maxTotalEth = weiToEth(valueWei + gasFeeWei);\n    feeMaxWeiStr = gasFeeWei.toString();\n    totalMaxWeiStr = (valueWei + gasFeeWei).toString();\n  }\n\n  const selector =\n    data && data.startsWith(\"0x\") && data.length >= 10 ? data.slice(0, 10) : \"\";\n\n  const contractNameHint = to && data && data !== \"0x\" && data.toLowerCase() !== \"0x\" ? shortAddr(to) : undefined;\n  return {\n    to,\n    valueWei: valueWei.toString(),\n    valueEth,\n    gasLimitWei: gasLimit > 0n ? gasLimit.toString() : undefined,\n    gasLimit: gasLimit > 0n ? gasLimit.toString() : undefined,\n    maxFeePerGasWei: maxFeePerGas > 0n ? maxFeePerGas.toString() : undefined,\n    maxPriorityFeePerGasWei: maxPriorityFeePerGas > 0n ? maxPriorityFeePerGas.toString() : undefined,\n    gasPriceWei: gasPrice > 0n ? gasPrice.toString() : undefined,\n    dataLen: dataLen > 0 ? dataLen : undefined,\n    feeMaxWei: feeMaxWeiStr || undefined,\n    totalMaxWei: totalMaxWeiStr || undefined,\n    maxGasFeeEth,\n    maxTotalEth,\n    selector,\n    feeKnown,\n    contractNameHint,\n  };\n}\n\nfunction isProtectionPaused(settings: Settings): boolean {\n  const until = settings.pausedUntil;\n  return typeof until === \"number\" && Number.isFinite(until) && Date.now() < until;\n}\n\n/** Extract spender candidates from analysis context (lowercase). */\nfunction extractSpenderCandidates(analysis: Analysis): string[] {\n  const out: string[] = [];\n  const add = (a: string | undefined) => {\n    if (a && typeof a === \"string\" && a.startsWith(\"0x\") && a.length === 42) {\n      out.push(a.toLowerCase());\n    }\n  };\n  const da = analysis.decodedAction;\n  if (da) {\n    if (\"spender\" in da) add(da.spender);\n    if (\"operator\" in da) add(da.operator);\n    if (\"to\" in da) add(da.to);\n  }\n  if (analysis.txExtras) {\n    const te = analysis.txExtras as { spender?: string; operator?: string };\n    add(te.spender);\n    add(te.operator);\n  }\n  if (analysis.typedDataExtras?.spender) add(analysis.typedDataExtras.spender);\n  if (analysis.tx?.to) add((analysis.tx as { to?: string }).to);\n  return [...new Set(out)];\n}\n\n/** Policy: allowlistSpenders / denylistSpenders. Runs before applyPolicy. */\nfunction applySpenderPolicy(analysis: Analysis, settings: Settings): void {\n  const deny = (settings.denylistSpenders ?? []).map((a) => String(a).toLowerCase()).filter(Boolean);\n  const allow = (settings.allowlistSpenders ?? []).map((a) => String(a).toLowerCase()).filter(Boolean);\n  const candidates = extractSpenderCandidates(analysis);\n  if (candidates.length === 0) return;\n  for (const c of candidates) {\n    if (deny.includes(c)) {\n      analysis.matchedDenySpender = true;\n      analysis.recommend = \"BLOCK\";\n      analysis.score = Math.max(analysis.score, 100);\n      analysis.level = \"HIGH\";\n      analysis.knownBad = true;\n      analysis.reasons.unshift(t(\"reason_known_bad_spender\") || REASON_KEYS.KNOWN_BAD_SPENDER + \": Spender bloqueado.\");\n      (analysis.reasonKeys ??= []).unshift(REASON_KEYS.SPENDER_DENYLIST);\n      return;\n    }\n    if (allow.includes(c)) {\n      analysis.matchedAllowSpender = true;\n      analysis.score = Math.min(analysis.score, 15);\n      analysis.level = \"LOW\";\n      analysis.knownSafe = true;\n      analysis.reasons.push(t(\"reason_known_safe_spender\") || REASON_KEYS.KNOWN_SAFE_SPENDER + \": Spender na allowlist.\");\n      (analysis.reasonKeys ??= []).push(REASON_KEYS.SPENDER_ALLOWLIST);\n    }\n  }\n  const isApprovalLike =\n    analysis.decodedAction?.kind === \"APPROVE_ERC20\" ||\n    analysis.decodedAction?.kind === \"INCREASE_ALLOWANCE\" ||\n    analysis.decodedAction?.kind === \"SET_APPROVAL_FOR_ALL\" ||\n    analysis.decodedAction?.kind === \"PERMIT_EIP2612\" ||\n    analysis.decodedAction?.kind === \"PERMIT2_ALLOWANCE\" ||\n    analysis.decodedAction?.kind === \"PERMIT2_TRANSFER\" ||\n    !!analysis.typedDataExtras?.spender;\n  if (isApprovalLike && !analysis.matchedAllowSpender && !analysis.matchedDenySpender && candidates.length > 0) {\n    const hasUnknownSpender = candidates.some((c) => !allow.includes(c));\n    if (hasUnknownSpender) {\n      analysis.reasons.push(t(\"reason_new_spender\") || REASON_KEYS.NEW_SPENDER + \": Novo spender \u2014 verifique.\");\n      (analysis.reasonKeys ??= []).push(REASON_KEYS.NEW_SPENDER);\n      analysis.score = Math.min(100, analysis.score + 25);\n      if (analysis.level !== \"HIGH\") analysis.level = \"WARN\";\n    }\n  }\n}\n\n/** Drainer heuristics: elevate to HIGH when risk combo detected. */\nfunction applyDrainerHeuristics(analysis: Analysis): void {\n  if (analysis.isPhishing || analysis.matchedDenySpender) return;\n  const decoded = analysis.decodedAction as DecodedAction | undefined;\n  const safeDomain = !!analysis.safeDomain;\n  const hasNewSpender = !analysis.matchedAllowSpender && extractSpenderCandidates(analysis).length > 0;\n  const isUnlimited =\n    ((decoded?.kind === \"APPROVE_ERC20\" || decoded?.kind === \"INCREASE_ALLOWANCE\") && (decoded as any).amountType === \"UNLIMITED\") ||\n    (decoded?.kind === \"PERMIT_EIP2612\" && decoded.valueType === \"UNLIMITED\") ||\n    (decoded?.kind === \"PERMIT2_ALLOWANCE\" && (decoded as any).amountType === \"UNLIMITED\");\n  const isSetApprovalForAllNft = decoded?.kind === \"SET_APPROVAL_FOR_ALL\" && decoded.approved;\n  const isPermit2Unknown = ((decoded as { permit2?: boolean } | undefined)?.permit2 || decoded?.kind === \"PERMIT2_ALLOWANCE\" || decoded?.kind === \"PERMIT2_TRANSFER\") && hasNewSpender;\n\n  if (!safeDomain && isUnlimited && hasNewSpender) {\n    analysis.level = \"HIGH\";\n    analysis.score = Math.max(analysis.score, 85);\n    if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"HIGH\";\n    (analysis.reasonKeys ??= []).push(REASON_KEYS.NEW_DOMAIN);\n  }\n  if (isPermit2Unknown) {\n    analysis.level = \"HIGH\";\n    analysis.score = Math.max(analysis.score, 80);\n    if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"HIGH\";\n    (analysis.reasonKeys ??= []).push(REASON_KEYS.PERMIT2_GRANT);\n  }\n  if (!safeDomain && isSetApprovalForAllNft) {\n    analysis.level = \"HIGH\";\n    analysis.score = Math.max(analysis.score, 80);\n    if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"HIGH\";\n    (analysis.reasonKeys ??= []).push(REASON_KEYS.SET_APPROVAL_FOR_ALL);\n  }\n}\n\nfunction applyPolicy(analysis: Analysis, settings: Settings): void {\n  if (isProtectionPaused(settings)) {\n    (analysis as Analysis).protectionPaused = true;\n    analysis.recommend = \"ALLOW\";\n    analysis.score = 0;\n    analysis.reasons = [t(\"mode_off_reason\")];\n    return;\n  }\n  const mode = (settings.mode || \"BALANCED\") as SecurityMode;\n  if (mode === \"OFF\") {\n    analysis.recommend = \"ALLOW\";\n    analysis.score = 0;\n    analysis.reasons = [t(\"mode_off_reason\")];\n    return;\n  }\n  const decoded = analysis.decodedAction as DecodedAction | undefined;\n  const m = (analysis as Analysis & { method?: string }).method ?? \"\";\n  // Phishing / matchedDenySpender always blocked regardless of mode\n  if (analysis.isPhishing) { analysis.recommend = \"BLOCK\"; return; }\n  if (analysis.matchedDenySpender) { analysis.recommend = \"BLOCK\"; return; }\n  // P1 Policy: STRICT => snaps BLOCK, raw/sign HIGH (explicit confirm); BALANCED => snaps/raw/sign HIGH; RELAXED => WARN (flags visible)\n  if (m === \"wallet_invokesnap\" || m === \"wallet_requestsnaps\") {\n    if (mode === \"STRICT\") { analysis.recommend = \"BLOCK\"; return; }\n    if (mode === \"BALANCED\") { analysis.recommend = \"HIGH\"; return; }\n    if (mode === \"RELAXED\") { if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"WARN\"; return; }\n  }\n  if (m === \"eth_sendrawtransaction\" || m === \"eth_signtransaction\") {\n    if (mode === \"STRICT\") { analysis.recommend = \"HIGH\"; return; }\n    if (mode === \"BALANCED\") { analysis.recommend = \"HIGH\"; return; }\n    if (mode === \"RELAXED\") { if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"WARN\"; return; }\n  }\n  if (mode === \"STRICT\") {\n    if (decoded?.kind === \"SET_APPROVAL_FOR_ALL\" && decoded.approved && (settings.strictBlockSetApprovalForAll ?? true)) { analysis.recommend = \"BLOCK\"; return; }\n    if ((decoded?.kind === \"APPROVE_ERC20\" || decoded?.kind === \"INCREASE_ALLOWANCE\") && (decoded as any).amountType === \"UNLIMITED\" && (settings.strictBlockApprovalsUnlimited ?? true)) { analysis.recommend = \"BLOCK\"; return; }\n    if (decoded?.kind === \"PERMIT_EIP2612\" && decoded.valueType === \"UNLIMITED\" && (settings.strictBlockPermitLike ?? true)) { analysis.recommend = \"BLOCK\"; return; }\n    if (decoded?.kind === \"PERMIT2_ALLOWANCE\" && (decoded as any).amountType === \"UNLIMITED\" && (settings.strictBlockPermitLike ?? true)) { analysis.recommend = \"BLOCK\"; return; }\n    if (analysis.flaggedAddress) { analysis.recommend = \"BLOCK\"; return; }\n  }\n  if (mode === \"BALANCED\") {\n    if (analysis.flaggedAddress) { analysis.recommend = \"HIGH\"; return; }\n    if (((decoded?.kind === \"APPROVE_ERC20\" || decoded?.kind === \"INCREASE_ALLOWANCE\") && (decoded as any).amountType === \"UNLIMITED\") || (decoded?.kind === \"SET_APPROVAL_FOR_ALL\" && decoded?.approved)) {\n      if (analysis.recommend !== \"BLOCK\") analysis.recommend = \"HIGH\";\n    }\n  }\n  if (mode === \"RELAXED\") {\n    // Reduces friction, phishing still BLOCK (handled above)\n    if (analysis.flaggedAddress) { analysis.recommend = \"HIGH\"; return; }\n    // Don't auto-BLOCK approvals in RELAXED\n  }\n}\n\nfunction chainName(chainIdHex: string): string {\n  const id = String(chainIdHex || \"\").toLowerCase();\n  const map: Record<string,string> = {\n    \"0x1\":\"Ethereum\",\n    \"0x89\":\"Polygon\",\n    \"0xa4b1\":\"Arbitrum\",\n    \"0xa\":\"Optimism\",\n    \"0x38\":\"BNB Chain\",\n    \"0xa86a\":\"Avalanche\"\n  };\n  return map[id] || chainIdHex;\n}\n\n/** P1: Build TxSummaryV1 for overlay from request + analysis. */\nfunction buildTxSummaryV1(req: AnalyzeRequest, analysis: Analysis, _settings: Settings): TxSummaryV1 {\n  const method = (analysis as Analysis & { method?: string }).method ?? req.request?.method ?? \"\";\n  const m = String(method).toLowerCase();\n  const existing = analysis.summary;\n  if (existing && existing.title) {\n    const flags = [...(existing.flags ?? []), ...(analysis.reasonKeys ?? [])].filter((x, i, a) => a.indexOf(x) === i);\n    return { ...existing, flags: flags.length ? flags : existing.flags };\n  }\n  if (m === \"wallet_switchethereumchain\") {\n    const chainIdHex = (req.request?.params as any)?.[0]?.chainId;\n    const name = chainIdHex ? chainName(chainIdHex) : \"\";\n    return {\n      title: t(\"summary_title_switch_chain\") || \"Troca de rede\",\n      subtitle: chainIdHex ? `${chainIdHex} \u2192 ${name}` : undefined,\n      flags: [],\n    };\n  }\n  if (m === \"wallet_getpermissions\") {\n    return {\n      title: t(\"summary_title_read_permissions\") || \"Leitura de permiss\u00F5es\",\n      flags: analysis.reasonKeys ?? [REASON_KEYS.READ_PERMISSIONS],\n    };\n  }\n  if (m === \"wallet_invokesnap\" || m === \"wallet_requestsnaps\") {\n    return {\n      title: t(\"summary_title_snaps\") || \"Snaps / Extens\u00F5es da carteira\",\n      flags: analysis.reasonKeys ?? [m === \"wallet_invokesnap\" ? REASON_KEYS.SNAP_INVOKE : REASON_KEYS.REQUEST_SNAPS],\n    };\n  }\n  if (m === \"eth_signtransaction\") {\n    return {\n      title: t(\"summary_title_sign_tx\") || \"Assinatura de transa\u00E7\u00E3o\",\n      flags: analysis.reasonKeys ?? [REASON_KEYS.SIGN_TRANSACTION],\n    };\n  }\n  if (m === \"eth_sendrawtransaction\") {\n    return existing ?? {\n      title: t(\"summary_title_raw_tx\") || \"Broadcast de transa\u00E7\u00E3o assinada\",\n      flags: analysis.reasonKeys ?? [REASON_KEYS.RAW_TX_BROADCAST],\n    };\n  }\n  const sim = analysis.simulationOutcome;\n  const give = (sim?.outgoingAssets ?? []).map((o) => ({ amount: o.amount, symbol: o.symbol, kind: \"ERC20\" as const }));\n  const get = (sim?.incomingAssets ?? []).map((i) => ({ amount: i.amount, symbol: i.symbol, kind: \"ERC20\" as const }));\n  const approvals: NonNullable<TxSummaryV1[\"approvals\"]> = (sim?.approvals ?? []).map((a) => ({\n    kind: \"ERC20\" as const,\n    tokenAddress: a.token,\n    spender: a.spender,\n    unlimited: a.unlimited,\n  }));\n  const flags = analysis.reasonKeys ?? [];\n  const tx = analysis.tx as { to?: string; valueEth?: string; selector?: string } | undefined;\n  if (analysis.decodedAction && !give.length && !get.length && (m === \"eth_sendtransaction\" || m === \"wallet_sendtransaction\")) {\n    const da = analysis.decodedAction;\n    if (\"spender\" in da && da.spender) {\n      approvals.push({\n        kind: (da as any).kind === \"SET_APPROVAL_FOR_ALL\" ? \"ERC721_ALL\" : \"ERC20\",\n        tokenAddress: (da as any).token ?? tx?.to,\n        spender: (da as any).spender,\n        unlimited: (da as any).amountType === \"UNLIMITED\",\n      });\n    }\n  }\n  return {\n    title: analysis.title || (t(\"action_SEND_TX_contract_title\") || \"Intera\u00E7\u00E3o com contrato\"),\n    subtitle: tx?.to ? `${tx.to.slice(0, 10)}\u2026` : undefined,\n    give: give.length ? give : undefined,\n    get: get.length ? get : undefined,\n    approvals: approvals.length ? approvals : undefined,\n    flags: flags.length ? flags : undefined,\n  };\n}\n\nfunction intentFromTxDataAndValue(data: string, valueWei: bigint, selector: string): Intent {\n  const dataNorm = typeof data === \"string\" ? data : \"\";\n  const hasData = !!dataNorm && dataNorm !== \"0x\" && dataNorm.toLowerCase() !== \"0x\";\n  const hasValue = valueWei > 0n;\n\n  const s = String(selector || \"\").toLowerCase();\n  if (hasData && s && s.startsWith(\"0x\") && s.length === 10) {\n    if (s === \"0x095ea7b3\" || s === \"0xa22cb465\") return \"APPROVAL\";\n    const swap = new Set([\n      \"0x38ed1739\", \"0x7ff36ab5\", \"0x18cbafe5\", \"0x04e45aaf\", \"0xb858183f\", \"0x5023b4df\", \"0x09b81346\",\n    ]);\n    if (swap.has(s)) return \"SWAP\";\n    const nftPurchase = new Set([\n      \"0xfb0f3ee1\", \"0xb3a34c4c\", \"0xed98a574\", \"0xf2d12b12\",\n      \"0xab834bab\", \"0x24856bc3\", \"0xa6f97b27\", \"0x1b14e9e1\",\n    ]);\n    if (nftPurchase.has(s)) return \"NFT_PURCHASE\";\n  }\n\n  if (hasData && hasValue) return \"CONTRACT_INTERACTION\";\n  if (hasData) return \"CONTRACT_INTERACTION\";\n  if (!hasData && hasValue) return \"ETH_TRANSFER\";\n  if (!s || !s.startsWith(\"0x\") || s.length !== 10) return \"UNKNOWN\";\n  return \"CONTRACT_INTERACTION\";\n}\n\nfunction intentFromSelector(selector: string): Intent {\n  const s = String(selector || \"\").toLowerCase();\n  if (!s || !s.startsWith(\"0x\") || s.length !== 10) return \"UNKNOWN\";\n  if (s === \"0x095ea7b3\" || s === \"0xa22cb465\") return \"APPROVAL\";\n\n  const swap = new Set([\n    \"0x38ed1739\", \"0x7ff36ab5\", \"0x18cbafe5\", \"0x04e45aaf\", \"0xb858183f\", \"0x5023b4df\", \"0x09b81346\",\n  ]);\n  if (swap.has(s)) return \"SWAP\";\n\n  const nftPurchase = new Set([\n    \"0xfb0f3ee1\", \"0xb3a34c4c\", \"0xed98a574\", \"0xf2d12b12\",\n    \"0xab834bab\", \"0x24856bc3\", \"0xa6f97b27\", \"0x1b14e9e1\",\n  ]);\n  if (nftPurchase.has(s)) return \"NFT_PURCHASE\";\n\n  return \"CONTRACT_INTERACTION\";\n}\n\ntype TxContextKind = \"SWITCH_NETWORK\" | \"NFT_PURCHASE\" | \"TOKEN_SWAP\" | \"VALUE_TRANSFER\" | \"CONTRACT_CALL\" | \"APPROVAL\";\n\nfunction detectTxContext(opts: { host: string; txTo: string; data: string; valueWei: bigint; selector: string }): TxContextKind {\n  const { host, data, valueWei, selector } = opts;\n  const s = String(selector || \"\").toLowerCase();\n  const h = (host || \"\").toLowerCase();\n  const hasData = !!data && data !== \"0x\" && data.toLowerCase() !== \"0x\";\n  const hasValue = valueWei > 0n;\n\n  const approveSelectors = new Set([\"0x095ea7b3\", \"0xa22cb465\"]);\n  if (approveSelectors.has(s)) return \"APPROVAL\";\n\n  const swapSelectors = new Set([\"0x38ed1739\", \"0x7ff36ab5\", \"0x18cbafe5\", \"0x04e45aaf\", \"0xb858183f\", \"0x5023b4df\", \"0x09b81346\"]);\n  if (swapSelectors.has(s)) return \"TOKEN_SWAP\";\n\n  const seaportSelectors = new Set([\"0xfb0f3ee1\", \"0xb3a34c4c\", \"0xed98a574\", \"0xf2d12b12\", \"0xab834bab\", \"0x24856bc3\", \"0xa6f97b27\", \"0x1b14e9e1\"]);\n  if (seaportSelectors.has(s)) return \"NFT_PURCHASE\";\n\n  if (!hasData && hasValue) return \"VALUE_TRANSFER\";\n  return \"CONTRACT_CALL\";\n}\n\nfunction addChecksAndVerdict(\n  analysis: Analysis,\n  ctx: { req: AnalyzeRequest; settings: Settings; intel: ThreatIntel | null }\n): void {\n  const host = hostFromUrl(ctx.req.url);\n  const method = (ctx.req.request?.method || \"\").toLowerCase();\n  const intelEnabled = ctx.settings.enableIntel !== false;\n  const checks: CheckResult[] = [];\n\n  // DOMAIN_INTEL\n  if (!ctx.settings.domainChecks) {\n    checks.push({ key: \"DOMAIN_INTEL\" as CheckKey, status: \"SKIP\" });\n  } else if (analysis.isPhishing) {\n    checks.push({ key: \"DOMAIN_INTEL\" as CheckKey, status: \"FAIL\" });\n  } else if (host && intelEnabled && ctx.intel && (analysis.safeDomain || analysis.trust?.verdict === \"LIKELY_OFFICIAL\")) {\n    checks.push({ key: \"DOMAIN_INTEL\" as CheckKey, status: \"PASS\" });\n  } else if (host) {\n    checks.push({ key: \"DOMAIN_INTEL\" as CheckKey, status: \"WARN\", noteKey: \"coverage_limited\" });\n  } else {\n    checks.push({ key: \"DOMAIN_INTEL\" as CheckKey, status: \"SKIP\" });\n  }\n\n  // LOOKALIKE\n  if (!host) {\n    checks.push({ key: \"LOOKALIKE\" as CheckKey, status: \"SKIP\" });\n  } else if ((analysis.reasons || []).some((r) => String(r).toLowerCase().includes(\"lookalike\") || String(r).toLowerCase().includes(\"imitation\"))) {\n    checks.push({ key: \"LOOKALIKE\" as CheckKey, status: \"WARN\" });\n  } else {\n    checks.push({ key: \"LOOKALIKE\" as CheckKey, status: \"PASS\" });\n  }\n\n  // TX_DECODE (relevant for tx/sign)\n  const intent = analysis.intent;\n  if (method.includes(\"sendtransaction\") || method.includes(\"signtypeddata\") || method.includes(\"sign\")) {\n    if (intent && intent !== \"UNKNOWN\") {\n      checks.push({ key: \"TX_DECODE\" as CheckKey, status: \"PASS\" });\n    } else {\n      checks.push({ key: \"TX_DECODE\" as CheckKey, status: \"WARN\" });\n    }\n  } else {\n    checks.push({ key: \"TX_DECODE\" as CheckKey, status: \"SKIP\" });\n  }\n\n  // FEE_ESTIMATE\n  const feeKnown = !!(analysis.txCostPreview?.feeEstimated || (analysis.tx as any)?.feeKnown);\n  if (method.includes(\"sendtransaction\")) {\n    checks.push({ key: \"FEE_ESTIMATE\" as CheckKey, status: feeKnown ? \"PASS\" : \"WARN\", noteKey: feeKnown ? undefined : \"fee_unknown_wallet_will_estimate\" });\n  } else {\n    checks.push({ key: \"FEE_ESTIMATE\" as CheckKey, status: \"SKIP\" });\n  }\n\n  // ADDRESS_INTEL\n  if (!(ctx.settings.addressIntelEnabled ?? true)) {\n    checks.push({ key: \"ADDRESS_INTEL\" as CheckKey, status: \"SKIP\" });\n  } else if (analysis.flaggedAddress) {\n    checks.push({ key: \"ADDRESS_INTEL\" as CheckKey, status: \"FAIL\" });\n  } else if (method.includes(\"sendtransaction\") || method.includes(\"signtypeddata\")) {\n    checks.push({ key: \"ADDRESS_INTEL\" as CheckKey, status: \"PASS\" });\n  } else {\n    checks.push({ key: \"ADDRESS_INTEL\" as CheckKey, status: \"SKIP\" });\n  }\n\n  // ASSET_ENRICH\n  if (!(ctx.settings.assetEnrichmentEnabled ?? true)) {\n    checks.push({ key: \"ASSET_ENRICH\" as CheckKey, status: \"SKIP\" });\n  } else if (analysis.asset?.symbol != null || analysis.asset?.name != null) {\n    checks.push({ key: \"ASSET_ENRICH\" as CheckKey, status: \"PASS\" });\n  } else if (method.includes(\"sendtransaction\") && analysis.decodedAction) {\n    checks.push({ key: \"ASSET_ENRICH\" as CheckKey, status: \"WARN\" });\n  } else {\n    checks.push({ key: \"ASSET_ENRICH\" as CheckKey, status: \"SKIP\" });\n  }\n\n  // CLOUD_INTEL (not implemented yet)\n  checks.push({ key: \"CLOUD_INTEL\" as CheckKey, status: \"SKIP\" });\n\n  const total = checks.length;\n  const performed = checks.filter((c) => c.status !== \"SKIP\").length;\n  const limited = checks.some((c) => c.status === \"WARN\" && (c.noteKey === \"fee_unknown_wallet_will_estimate\" || c.key === \"DOMAIN_INTEL\" || c.key === \"ASSET_ENRICH\"));\n\n  let verdictLabelKey: string;\n  if (analysis.recommend === \"BLOCK\") verdictLabelKey = \"verdict_block\";\n  else if (analysis.score <= 20 && !checks.some((c) => c.status === \"FAIL\")) verdictLabelKey = \"verdict_ok\";\n  else if (analysis.score <= 60) verdictLabelKey = \"verdict_warn\";\n  else verdictLabelKey = \"verdict_high\";\n\n  (analysis as Analysis).checks = checks;\n  (analysis as Analysis).coverage = { performed, total, limited };\n  (analysis as Analysis).verdictLabelKey = verdictLabelKey;\n}\n\nconst SIMULATION_CACHE_TTL_MS = 30000;\nconst SIMULATION_TIMEOUT_MS = 2200;\nconst __simulationCache = new Map<string, { outcome: Awaited<ReturnType<typeof runSimulation>>; ts: number }>();\n\n/** Run Tenderly simulation for eth_sendTransaction and merge outcome into analysis. Cache 30s, timeout 2.2s. Without simulation permission/setting, skips Tenderly and falls back to eth_call preflight only. */\nasync function enrichWithSimulation(req: AnalyzeRequest, analysis: Analysis, settings: Settings): Promise<void> {\n  const method = (req?.request?.method || \"\").toLowerCase();\n  if (!method.includes(\"sendtransaction\")) return;\n  const simGate = await canUseNetwork(\"simulation\", settings);\n  const mayCallTenderly = simGate.ok;\n\n  const params = req?.request?.params;\n  const tx = Array.isArray(params) && params[0] && typeof params[0] === \"object\" ? params[0] as Record<string, unknown> : null;\n  if (!tx) return;\n\n  const from = typeof tx.from === \"string\" ? tx.from : \"0x0000000000000000000000000000000000000000\";\n  const to = typeof tx.to === \"string\" ? tx.to : \"0x0000000000000000000000000000000000000000\";\n  const input = typeof tx.data === \"string\" ? tx.data : \"0x\";\n  const value = typeof tx.value === \"string\" ? tx.value : \"0x0\";\n  let gas: number | undefined;\n  if (typeof tx.gas === \"string\" && tx.gas.startsWith(\"0x\")) {\n    try { gas = parseInt(tx.gas, 16); } catch {}\n  } else if (typeof tx.gas === \"number\") gas = tx.gas;\n\n  const rawChainId = req?.meta?.chainId ?? (req as any)?.chainId ?? \"1\";\n  const networkId = String(rawChainId).replace(/^0x/, \"\");\n\n  const cacheKey = `${req.requestId}|${networkId}|${to}|${(input || \"\").slice(0, 66)}`;\n  const cached = __simulationCache.get(cacheKey);\n  if (cached && Date.now() - cached.ts < SIMULATION_CACHE_TTL_MS && cached.outcome) {\n    analysis.simulationOutcome = cached.outcome;\n    return;\n  }\n  for (const [k, v] of __simulationCache) {\n    if (Date.now() - v.ts > SIMULATION_CACHE_TTL_MS) __simulationCache.delete(k);\n  }\n\n  let outcome: Awaited<ReturnType<typeof runSimulation>> | null = null;\n  if (mayCallTenderly) {\n    try {\n      const outcomePromise = runSimulation(networkId, from, to, input, value, gas, settings);\n      const timeoutPromise = new Promise<never>((_, rej) =>\n        setTimeout(() => rej(new Error(\"SIMULATION_TIMEOUT\")), SIMULATION_TIMEOUT_MS)\n      );\n      outcome = await Promise.race([outcomePromise, timeoutPromise]);\n    } catch (e) {\n    if (String((e as Error)?.message || e).includes(\"SIMULATION_TIMEOUT\")) {\n      (analysis.reasonKeys ??= []).push(REASON_KEYS.SIMULATION_TIMEOUT);\n    }\n    }\n  }\n  if (!outcome) {\n    // Preflight without Tenderly: eth_call with same params to detect quick revert\n    const tabId = req.tabId;\n    if (tabId && to && to !== \"0x0000000000000000000000000000000000000000\") {\n      try {\n        const callResp = await rpcCallFull(tabId, \"eth_call\", [{ to, from, data: input, value: value || \"0x0\" }, \"latest\"]);\n        if (callResp && !callResp.ok && typeof callResp.error === \"string\" && callResp.error.toLowerCase().includes(\"revert\")) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.SIM_FAILED);\n          analysis.reasons.unshift(t(\"simulation_tx_will_fail\") || \"Pr\u00E9-execu\u00E7\u00E3o indica falha (revert).\");\n          analysis.recommend = \"BLOCK\";\n          analysis.score = Math.max(analysis.score, 85);\n          analysis.level = \"HIGH\";\n        }\n      } catch {\n        // ignore\n      }\n    }\n    return;\n  }\n  try {\n    analysis.simulationOutcome = outcome;\n    __simulationCache.set(cacheKey, { outcome, ts: Date.now() });\n\n    // P1-8: Simulation approvals -> score/reasons\n    const approvals = outcome.approvals ?? [];\n    for (const a of approvals) {\n      if (a.approved) {\n        if (a.unlimited) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.UNLIMITED_APPROVAL);\n          analysis.reasons.push(t(\"reason_unlimited_approval\") || REASON_KEYS.UNLIMITED_APPROVAL);\n          analysis.level = \"HIGH\";\n          analysis.score = Math.max(analysis.score, 90);\n        }\n        if (a.approvalForAll) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.SET_APPROVAL_FOR_ALL);\n          analysis.reasons.push(t(\"reason_set_approval_for_all\") || REASON_KEYS.SET_APPROVAL_FOR_ALL);\n          analysis.level = \"HIGH\";\n          analysis.score = Math.max(analysis.score, 90);\n        }\n      }\n    }\n\n    if (settings.cloudIntelOptIn !== false) {\n      try {\n        let valueUsd: number | undefined;\n        const usdPerEth = await getEthUsdPriceCached();\n        if (usdPerEth != null && value) {\n          const valueWei = hexToBigInt(value || \"0x0\");\n          valueUsd = Number(valueWei) / 1e18 * usdPerEth;\n        }\n        await telemetry.trackTransaction({\n          chainId: networkId.startsWith(\"0x\") ? networkId : \"0x\" + networkId,\n          contractAddress: to,\n          value: value || \"0x0\",\n          inputData: input || \"0x\",\n          tokenSymbol: analysis.asset?.symbol,\n          valueUsd,\n        });\n      } catch {\n        // silent\n      }\n    }\n\n    try {\n      const gasCostWei = (outcome as any).gasCostWei;\n      if (gasCostWei && typeof gasCostWei === \"string\") {\n        const usdPerEth = await getEthUsdPriceCached();\n        if (usdPerEth != null && usdPerEth > 0) {\n          const valueWei = hexToBigInt(value || \"0x0\");\n          const gasCostNum = BigInt(gasCostWei);\n          const gasCostUsd = Number(gasCostNum) / 1e18 * usdPerEth;\n          const valueUsd = Number(valueWei) / 1e18 * usdPerEth;\n          if (analysis.txCostPreview) (analysis.txCostPreview as any).usdPerNative = usdPerEth;\n          if (gasCostUsd > 50 && valueUsd < 50) {\n            (outcome as any).isHighGas = true;\n            analysis.reasons.unshift(t(\"reason_high_gas\") || REASON_KEYS.HIGH_GAS + \": Taxa de gas alta em rela\u00E7\u00E3o ao valor.\");\n          }\n          if (gasCostUsd > 80) {\n            (outcome as any).isHighGas = true;\n            if (!analysis.reasons.some((r) => String(r).includes(\"HIGH_GAS\") || String(r).includes(\"alta\"))) {\n              analysis.reasons.unshift(t(\"reason_high_gas\") || REASON_KEYS.HIGH_GAS + \": Taxa de gas muito alta.\");\n            }\n          }\n        }\n      }\n    } catch {\n      // ignore\n    }\n\n    if (outcome.status === \"REVERT\") {\n      analysis.simulationRevert = true;\n      analysis.reasons.unshift(t(\"simulation_tx_will_fail\"));\n      analysis.recommend = \"BLOCK\";\n      analysis.score = Math.max(analysis.score, 100);\n      analysis.level = \"HIGH\";\n      analysis.title = t(\"simulation_tx_will_fail\");\n    }\n    // When simulation was skipped (no Tenderly key), preflight eth_call can still detect revert\n    if (outcome.fallback && req.tabId && to && to !== \"0x0000000000000000000000000000000000000000\") {\n      try {\n        const callResp = await rpcCallFull(req.tabId, \"eth_call\", [{ to, from, data: input, value: value || \"0x0\" }, \"latest\"]);\n        if (callResp && !callResp.ok && typeof callResp.error === \"string\" && callResp.error.toLowerCase().includes(\"revert\")) {\n          (analysis.reasonKeys ??= []).push(REASON_KEYS.SIM_FAILED);\n          analysis.reasons.unshift(t(\"simulation_tx_will_fail\") || \"Pr\u00E9-execu\u00E7\u00E3o indica falha (revert).\");\n          analysis.recommend = \"BLOCK\";\n          analysis.score = Math.max(analysis.score, 85);\n          analysis.level = \"HIGH\";\n        }\n      } catch {\n        // ignore\n      }\n    }\n\n    if (outcome.status === \"SUCCESS\") {\n      const tokenAddress = (analysis as any).tokenAddress as string | undefined;\n      try {\n        const honeypot = await runHoneypotCheck(networkId, from, to, input, value, gas, settings, tokenAddress);\n        if (honeypot.isHoneypot) {\n          analysis.isHoneypot = true;\n          analysis.recommend = \"BLOCK\";\n          analysis.score = Math.max(analysis.score, 100);\n          analysis.level = \"HIGH\";\n          analysis.reasons.unshift(honeypot.reason || t(\"honeypot_message\"));\n          analysis.title = t(\"honeypot_message\");\n        }\n      } catch {\n        // Honeypot check optional\n      }\n    }\n  } catch {\n    // Fail silently: overlay works without simulation\n  }\n}\n\nfunction setVerificationFields(ctx: {\n  host: string;\n  intel: ThreatIntel;\n  usedCacheOnly: boolean;\n  isStale: boolean;\n  matchedBad: boolean;\n  matchedSeed: boolean;\n  signals: string[];\n}): Partial<Analysis> {\n  const { intel, isStale, matchedBad, matchedSeed, signals } = ctx;\n  const hasCache = intel.updatedAt > 0;\n  let verificationLevel: \"FULL\" | \"LOCAL\" | \"BASIC\" = \"BASIC\";\n  if (matchedBad) {\n    verificationLevel = hasCache ? \"FULL\" : \"BASIC\";\n    return {\n      verificationLevel,\n      verificationUpdatedAt: hasCache ? intel.updatedAt : undefined,\n      knownBad: true,\n      knownSafe: false,\n      domainSignals: signals.length ? signals : undefined,\n      intelSources: (intel.sources || []).map((s: any) => (typeof s === \"string\" ? s : s.name || s.id || \"\")).filter(Boolean),\n    };\n  }\n  if (hasCache && !isStale) verificationLevel = \"FULL\";\n  else if (hasCache && isStale) verificationLevel = \"LOCAL\";\n  else verificationLevel = \"BASIC\";\n  return {\n    verificationLevel,\n    verificationUpdatedAt: hasCache ? intel.updatedAt : undefined,\n    knownSafe: matchedSeed,\n    knownBad: false,\n    domainSignals: signals.length ? signals : undefined,\n    intelSources: (intel.sources || []).map((s: any) => (typeof s === \"string\" ? s : s.name || s.id || \"\")).filter(Boolean),\n  };\n}\n\nfunction labelsFor(addrIntel: AddressIntel | null | undefined, addr: string): AddressLabel[] {\n  const a = normalizeAddr(addr);\n  if (!a) return [];\n  return (addrIntel?.labelsByAddress?.[a] || []) as AddressLabel[];\n}\n\nasync function analyze(req: AnalyzeRequest, settings: Settings, intel: ThreatIntel | null, tabId?: number, addrIntel?: AddressIntel | null): Promise<Analysis> {\n  const host = hostFromUrl(req.url);\n  const reasons: string[] = [];\n  let level: Analysis[\"level\"] = \"LOW\";\n  let score = 0;\n  let title = \"Looks OK\";\n\n  const trust = computeTrustVerdict(host, settings.allowlist);\n  const explain = explainMethod(req.request?.method || \"\");\n  const lists = buildHumanLists(req.request?.method || \"\", trust.verdict);\n\n  // List manager: domain/address/token lists (SEED + FEEDS + user overrides)\n  let listCache: Awaited<ReturnType<typeof getLists>> | null = null;\n  try {\n    listCache = await getLists();\n  } catch {}\n  const listDomainDecision = listCache ? getDomainDecision(host, listCache) : \"UNKNOWN\" as const;\n  if (listDomainDecision === \"BLOCKED\") {\n    return {\n      level: \"HIGH\",\n      score: 100,\n      title: t(\"suspiciousWebsitePatterns\"),\n      reasons: [t(\"trustReasonPhishingBlacklist\"), \"Domain is on the blocklist.\"],\n      decoded: { kind: \"TX\", raw: { host } },\n      recommend: \"BLOCK\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain: false,\n      isPhishing: true,\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n  const listTrusted = listDomainDecision === \"TRUSTED\";\n\n  // Domain checks (optional)\n  if (settings.domainChecks && host && !isAllowlisted(host, settings.allowlist)) {\n    const d = domainHeuristicsLocalized(host);\n    if (d.level === \"WARN\") {\n      reasons.push(...d.reasons);\n      level = \"WARN\";\n      score = Math.max(score, 45);\n      title = t(\"suspiciousWebsitePatterns\");\n    }\n  }\n\n  const method = (req.request?.method || \"\").toLowerCase();\n\n  // P1: wallet_getPermissions \u2014 read-only, LOW/INFO; ANALYZE exists for consistency/diagn\u00F3stico (content may auto-allow without overlay)\n  if (method === \"wallet_getpermissions\") {\n    level = \"LOW\";\n    score = 10;\n    title = t(\"summary_title_read_permissions\") || \"Leitura de permiss\u00F5es\";\n    (reasons as string[]).push(t(\"reason_read_permissions\") || \"O site est\u00E1 a ler as permiss\u00F5es j\u00E1 concedidas \u00E0 carteira.\");\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { method, params: req.request.params } },\n      recommend: \"ALLOW\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain: false,\n      method,\n      reasonKeys: [REASON_KEYS.READ_PERMISSIONS],\n      human: {\n        methodTitle: title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n\n  // P1: Snaps / raw tx / sign tx \u2014 high risk, explicit confirmation (safeDomain not computed yet)\n  if (method === \"wallet_invokesnap\" || method === \"wallet_requestsnaps\") {\n    const isInvoke = method === \"wallet_invokesnap\";\n    (reasons as string[]).push(t(\"reason_snap_invoke\") || \"Snaps podem executar c\u00F3digo na carteira. Confirme a origem.\");\n    level = \"HIGH\";\n    score = 90;\n    title = t(\"summary_title_snaps\") || \"Snaps / Extens\u00F5es da carteira\";\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { method, params: req.request.params } },\n      recommend: \"HIGH\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain: false,\n      method,\n      reasonKeys: [isInvoke ? REASON_KEYS.SNAP_INVOKE : REASON_KEYS.REQUEST_SNAPS],\n      human: {\n        methodTitle: title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n  if (method === \"eth_signtransaction\") {\n    (reasons as string[]).push(t(\"reason_sign_tx\") || \"Assinatura de transa\u00E7\u00E3o sem envio imediato. Pode ser usada depois para broadcast.\");\n    level = \"HIGH\";\n    score = 75;\n    title = t(\"summary_title_sign_tx\") || \"Assinatura de transa\u00E7\u00E3o\";\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { method, params: req.request.params } },\n      recommend: \"HIGH\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain: false,\n      method,\n      reasonKeys: [REASON_KEYS.SIGN_TRANSACTION],\n      human: {\n        methodTitle: title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n  if (method === \"eth_sendrawtransaction\") {\n    const rawTx = (req.request?.params as any)?.[0];\n    const rawStr = typeof rawTx === \"string\" ? rawTx : \"\";\n    let subtitle = \"\";\n    if (rawStr && rawStr.startsWith(\"0x\")) {\n      const len = (rawStr.length - 2) / 2;\n      const prefix = rawStr.length >= 4 ? rawStr.slice(0, 4).toLowerCase() : \"\";\n      if (prefix === \"0x02\") subtitle = `EIP-1559 \u00B7 ${len} bytes`;\n      else if (prefix === \"0x01\") subtitle = `EIP-2930 \u00B7 ${len} bytes`;\n      else subtitle = `rawTx \u00B7 ${len} bytes`;\n    }\n    (reasons as string[]).push(t(\"reason_raw_broadcast\") || \"Broadcast de transa\u00E7\u00E3o j\u00E1 assinada. N\u00E3o h\u00E1 confirma\u00E7\u00E3o visual pr\u00E9via do conte\u00FAdo.\");\n    level = \"HIGH\";\n    score = 85;\n    title = t(\"summary_title_raw_tx\") || \"Broadcast de transa\u00E7\u00E3o assinada\";\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { method, params: req.request.params } },\n      recommend: \"HIGH\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain: false,\n      method,\n      reasonKeys: [REASON_KEYS.RAW_TX_BROADCAST],\n      summary: { title, subtitle: subtitle || undefined, flags: [REASON_KEYS.RAW_TX_BROADCAST] },\n      human: {\n        methodTitle: title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n\n  // Modo Fortaleza: block token approvals on non-trusted sites\n  if (settings.fortressMode === true && (method === \"eth_sendtransaction\" || method === \"wallet_sendtransaction\")) {\n    const tx = req.request?.params?.[0] as { data?: string } | undefined;\n    const data = typeof tx?.data === \"string\" ? tx.data : \"\";\n    const selector = data && data.length >= 10 ? data.slice(0, 10).toLowerCase() : \"\";\n    const isApproval = selector === \"0x095ea7b3\" || selector === \"0xa22cb465\" || selector === \"0x39509351\";\n    if (isApproval) {\n      const fortressAllowlist = [\n        ...(settings.allowlist || []),\n        ...(settings.trustedDomains || []),\n        ...(settings.whitelistedDomains || []),\n      ];\n      if (!isAllowlisted(host, fortressAllowlist)) {\n        const fortressMsg = t(\"fortress_block_message\");\n        return {\n          level: \"HIGH\",\n          score: 100,\n          title: fortressMsg,\n          reasons: [fortressMsg],\n          decoded: { kind: \"TX\", raw: { host, method } },\n          recommend: \"BLOCK\",\n          trust,\n          suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n          safeDomain: false,\n          human: {\n            methodTitle: explain.title,\n            methodShort: explain.short,\n            methodWhy: explain.why,\n            whatItDoes: lists.whatItDoes,\n            risks: lists.risks,\n            safeNotes: lists.safeNotes,\n            nextSteps: lists.nextSteps,\n            recommendation: fortressMsg,\n          },\n        };\n      }\n    }\n  }\n\n  // Threat intel (blocked/trusted seed) \u2014 respect enableIntel; merge user custom lists\n  const intelHost = normalizeHost(host || \"\");\n  const customBlocked = (settings.customBlockedDomains || []).map((d) => String(d || \"\").trim().toLowerCase()).filter(Boolean);\n  const customTrusted = (settings.customTrustedDomains || settings.allowlist || []).map((d) => String(d || \"\").trim().toLowerCase()).filter(Boolean);\n  const inCustomBlocked = customBlocked.some((d) => hostMatches(intelHost, d));\n  const inCustomTrusted = customTrusted.some((d) => hostMatches(intelHost, d));\n  const intelEnabled = settings.enableIntel !== false;\n  const isBlocked = inCustomBlocked || (!!intelEnabled && !!intel && hostInBlocked(intel, intelHost));\n  const isTrustedSeed = inCustomTrusted || (!!intel && (intel.trustedSeed || (intel as any).trustedDomainsSeed || (intel as any).trustedDomains)?.some?.((d: string) => hostMatches(intelHost, d)));\n  const safeDomain = (isTrustedSeed || listTrusted) && !isBlocked;\n\n  // Strong lookalike scoring (always)\n  try {\n    const brands = [\"opensea\", \"uniswap\", \"metamask\", \"blur\", \"etherscan\"];\n    const dr = assessDomainRisk(intelHost, brands);\n    if (dr.scoreDelta > 0) {\n      reasons.push(...dr.reasons);\n      score = Math.max(score, clamp01(score + dr.scoreDelta, 0, 100));\n      // If we detected lookalike and it's NOT trusted seed, elevate to HIGH (but don't BLOCK by itself)\n      const looksLike = dr.reasons.some((r) => String(r || \"\").toLowerCase().includes(\"lookalike\"));\n      if (looksLike && !isTrustedSeed) {\n        level = \"HIGH\";\n        score = Math.max(score, 85);\n        title = t(\"suspiciousWebsitePatterns\");\n      } else {\n        level = \"WARN\";\n        score = Math.max(score, 45);\n        title = t(\"suspiciousWebsitePatterns\");\n      }\n    }\n  } catch {}\n\n  if (isBlocked) {\n    return {\n      level: \"HIGH\",\n      score: 100,\n      title: t(\"suspiciousWebsitePatterns\"),\n      reasons: [t(\"trustReasonPhishingBlacklist\"), ...reasons],\n      decoded: { kind: \"TX\", raw: { host } },\n      recommend: \"BLOCK\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain,\n      isPhishing: true,\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_generic_reco\"),\n      }\n    };\n  }\n\n  if (isTrustedSeed || listTrusted) {\n    reasons.push(t(\"trustReasonAllowlisted\"));\n    score = Math.max(0, score - 15);\n  }\n\n  // Solana (solana:connect, solana:signMessage, etc.)\n  if (method.startsWith(\"solana:\")) {\n    return {\n      level: \"WARN\",\n      score: 50,\n      title: t(\"watchAssetTitle\"),\n      reasons: [t(\"intent_SOLANA\")],\n      decoded: { kind: \"SIGN\", raw: { method, params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      intent: \"SOLANA\",\n      human: {\n        methodTitle: t(\"intent_SOLANA\"),\n        methodShort: t(\"summary_SOLANA_1\"),\n        methodWhy: t(\"explain_generic_why\"),\n        whatItDoes: [],\n        risks: [t(\"human_generic_risk_1\")],\n        safeNotes: [t(\"human_generic_safe_1\")],\n        nextSteps: [t(\"human_generic_next_1\")],\n        recommendation: t(\"human_generic_reco\"),\n      },\n    };\n  }\n\n  // Connect / permissions\n  if (method === \"eth_requestaccounts\" || method === \"wallet_requestpermissions\") {\n    const isPerms = method === \"wallet_requestpermissions\";\n    const baseTitle = isPerms ? t(\"walletRequestPermissionsTitle\") : t(\"connectTitle\");\n    const baseReason = isPerms ? t(\"walletRequestPermissionsReason\") : t(\"connectReason\");\n    const connectReasons = reasons.length ? reasons.slice() : [baseReason];\n    if (settings.showConnectOverlay) {\n      // SPEC: if showConnectOverlay=true -> WARN (score >= 30)\n      return {\n        level: level === \"HIGH\" ? \"HIGH\" : \"WARN\",\n        score: Math.max(score, 30),\n        title: level === \"WARN\" ? title : baseTitle,\n        reasons: connectReasons,\n        decoded: { kind: \"CONNECT\", raw: { host } },\n        recommend: \"WARN\",\n        trust,\n        suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n        safeDomain,\n        human: {\n          methodTitle: explain.title,\n          methodShort: explain.short,\n          methodWhy: explain.why,\n          whatItDoes: lists.whatItDoes,\n          siteSees: [t(\"human_connect_sees_1\"), t(\"human_connect_sees_2\"), t(\"human_connect_sees_3\")],\n          notHappen: [t(\"human_connect_not_1\"), t(\"human_connect_not_2\")],\n          whyAsked: [t(\"human_connect_why_1\"), t(\"human_connect_why_2\"), t(\"human_connect_why_3\")],\n          risks: lists.risks,\n          safeNotes: lists.safeNotes,\n          nextSteps: lists.nextSteps,\n          recommendation:\n            trust.verdict === \"SUSPICIOUS\"\n              ? t(\"human_connect_reco_suspicious\")\n              : t(\"human_connect_reco_ok\"),\n        },\n      };\n    }\n    return {\n      level,\n      score,\n      title: level === \"WARN\" ? title : baseTitle,\n      reasons: connectReasons,\n      decoded: { kind: \"CONNECT\", raw: { host } },\n      recommend: level === \"WARN\" ? \"WARN\" : \"ALLOW\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain,\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        siteSees: [t(\"human_connect_sees_1\"), t(\"human_connect_sees_2\"), t(\"human_connect_sees_3\")],\n        notHappen: [t(\"human_connect_not_1\"), t(\"human_connect_not_2\")],\n        whyAsked: [t(\"human_connect_why_1\"), t(\"human_connect_why_2\"), t(\"human_connect_why_3\")],\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation:\n          trust.verdict === \"SUSPICIOUS\"\n            ? t(\"human_connect_reco_suspicious\")\n            : t(\"human_connect_reco_ok\"),\n      },\n    };\n  }\n\n  // Typed data signatures (eth_signTypedData, eth_signTypedData_v3, eth_signTypedData_v4)\n  if (isTypedDataMethod(method)) {\n    reasons.push(t(\"typedDataWarnReason\"));\n    if (level !== \"HIGH\") level = \"WARN\";\n    score = Math.max(score, 60);\n    title = t(\"signatureRequest\");\n\n    const norm = normalizeTypedDataParams(method, req.request.params);\n    const raw = norm.typedDataRaw ?? \"\";\n\n    let permitExtras: { spender?: string; value?: string; deadline?: string } | null = null;\n    let typedDataDecoded: Analysis[\"typedDataDecoded\"] = undefined;\n    try {\n      if (raw) {\n        permitExtras = extractTypedDataPermitExtras(raw);\n        if (raw.length > 200_000) {\n          reasons.push(\"Payload muito grande; confirme na carteira.\");\n          level = \"HIGH\";\n          score = Math.max(score, 85);\n          return {\n            level,\n            score,\n            title,\n            reasons,\n            decoded: { kind: \"TYPED_DATA\", raw: { size: raw.length } },\n            recommend: \"WARN\",\n            trust,\n            suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n            safeDomain,\n            human: {\n              methodTitle: explain.title,\n              methodShort: explain.short,\n              methodWhy: explain.why,\n              whatItDoes: lists.whatItDoes,\n              risks: lists.risks,\n              safeNotes: lists.safeNotes,\n              nextSteps: lists.nextSteps,\n              recommendation:\n                trust.verdict === \"SUSPICIOUS\" ? t(\"human_sign_reco_suspicious\") : t(\"human_sign_reco_ok\"),\n            }\n          };\n        }\n        const j: any = norm.typedDataObj ?? (() => { try { return JSON.parse(raw); } catch { return null; } })();\n        const domainName = String(j?.domain?.name || \"\");\n        const msg: any = j?.message || {};\n\n        if (permitExtras) {\n          reasons.push(t(\"permit_signature_detected\"));\n          if (permitExtras.spender) {\n            reasons.push(t(\"permit_spender_check\") || \"Verifique o spender.\");\n          }\n          level = \"HIGH\";\n          score = Math.max(score, 90);\n        }\n        const looksPermit2 = domainName.toLowerCase().includes(\"permit2\") || (!!msg?.permitted && !!msg?.spender);\n        const looksApproveLike = !!msg?.spender && ((\"value\" in msg) || (\"amount\" in msg));\n        const looksSeaport = domainName.toLowerCase().includes(\"seaport\") || (!!msg?.offer && !!msg?.consideration);\n\n        if (!permitExtras && (looksPermit2 || looksApproveLike)) {\n          reasons.push(\"Assinatura pode permitir que um endere\u00E7o gaste seus tokens.\");\n          if (String(msg?.spender || \"\").trim()) {\n            reasons.push(REASON_KEYS.PERMIT2_GRANT);\n            level = \"HIGH\";\n            score = Math.max(score, 90);\n          }\n        }\n        if (looksSeaport) {\n          reasons.push(REASON_KEYS.MARKETPLACE_LISTING);\n          score = Math.max(score, 70);\n        }\n        const permit2 = extractPermit2FromTypedData(raw);\n        if (permit2?.unlimited) {\n          reasons.push(REASON_KEYS.UNLIMITED_APPROVAL);\n          level = \"HIGH\";\n          score = Math.max(score, 90);\n        }\n        const seaport = extractSeaportFromTypedData(raw);\n        const blur = isBlurTypedData(raw);\n        typedDataDecoded = {\n          ...(permit2 && { permit2: { spender: permit2.spender, tokens: permit2.tokens, amounts: permit2.amounts, unlimited: permit2.unlimited, sigDeadline: permit2.sigDeadline } }),\n          ...(seaport && { seaport: { offerSummary: seaport.offerSummary, considerationSummary: seaport.considerationSummary, primaryType: seaport.primaryType } }),\n          ...(blur && { isBlur: true }),\n        };\n      }\n    } catch {}\n\n    const typedDataExtras = permitExtras ? { spender: permitExtras.spender, value: permitExtras.value, deadline: permitExtras.deadline } : undefined;\n    const typedDataReasonKeys: string[] = [];\n    if (permitExtras?.spender) typedDataReasonKeys.push(REASON_KEYS.PERMIT_GRANT);\n    try {\n      const j2: any = norm.typedDataObj ?? (typeof raw === \"string\" ? (() => { try { return JSON.parse(raw); } catch { return null; } })() : null);\n      const dn = String(j2?.domain?.name || \"\").toLowerCase();\n      const msg2 = j2?.message || {};\n      const looksP2 = dn.includes(\"permit2\") || (!!msg2?.permitted && !!msg2?.spender);\n      const permit2Dec = typeof raw === \"string\" ? extractPermit2FromTypedData(raw) : null;\n      if (looksP2 || (permit2Dec && permit2Dec.spender)) typedDataReasonKeys.push(REASON_KEYS.PERMIT2_GRANT);\n    } catch {}\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      reasonKeys: typedDataReasonKeys.length ? typedDataReasonKeys : undefined,\n      decoded: { kind: \"TYPED_DATA\", raw: { params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain,\n      typedDataExtras,\n      typedDataDecoded,\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation:\n          trust.verdict === \"SUSPICIOUS\" ? t(\"human_sign_reco_suspicious\") : t(\"human_sign_reco_ok\"),\n      }\n    };\n  }\n\n  if (method === \"personal_sign\" || method === \"eth_sign\") {\n    reasons.push(t(\"rawSignWarnReason\"));\n    if (level !== \"HIGH\") level = \"WARN\";\n    score = Math.max(score, 55);\n    title = t(\"signatureRequest\");\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"SIGN\", raw: { params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation:\n          trust.verdict === \"SUSPICIOUS\" ? t(\"human_sign_reco_suspicious\") : t(\"human_sign_reco_ok\"),\n      }\n    };\n  }\n\n  // wallet_switchethereumchain\n  if (method === \"wallet_switchethereumchain\") {\n    reasons.push(t(\"explain_switch_short\"));\n    if (level !== \"HIGH\") level = \"WARN\";\n    score = Math.max(score, 45);\n    title = t(\"chainChangeTitle\");\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain,\n      intent: \"SWITCH_CHAIN\",\n      chainTarget: (() => {\n        try {\n          const p0 = (req.request.params as any)?.[0];\n          const chainIdHex = String(p0?.chainId || \"\");\n          if (!chainIdHex) return undefined;\n          return { chainIdHex, chainName: chainName(chainIdHex) };\n        } catch { return undefined; }\n      })(),\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_chain_reco\"),\n      }\n    };\n  }\n\n  // wallet_addEthereumChain\n  if (method === \"wallet_addethereumchain\") {\n    reasons.push(t(\"add_chain_review_rpc\"));\n    reasons.push(t(\"add_chain_verify_chainid\"));\n    if (level !== \"HIGH\") level = \"WARN\";\n    score = Math.max(score, 45);\n    title = t(\"chainChangeTitle\");\n    const p0 = (req.request.params as any)?.[0];\n    const addChainInfo = p0 ? {\n      chainId: String(p0.chainId || \"\"),\n      chainName: String(p0.chainName || \"\"),\n      rpcUrls: Array.isArray(p0.rpcUrls) ? p0.rpcUrls : (p0.rpcUrls ? [p0.rpcUrls] : []),\n      nativeCurrencySymbol: p0?.nativeCurrency?.symbol ? String(p0.nativeCurrency.symbol) : undefined,\n    } : undefined;\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      safeDomain,\n      intent: \"ADD_CHAIN\",\n      chainTarget: addChainInfo ? { chainIdHex: addChainInfo.chainId, chainName: addChainInfo.chainName } : undefined,\n      addChainInfo,\n      human: {\n        methodTitle: explain.title,\n        methodShort: t(\"explain_add_chain_short\"),\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_chain_reco\"),\n      }\n    };\n  }\n\n  // wallet_watchAsset\n  if (method === \"wallet_watchasset\") {\n    reasons.push(t(\"watch_asset_no_spend_but_risk\"));\n    reasons.push(t(\"watch_asset_verify_contract\"));\n    if (level !== \"HIGH\") level = \"WARN\";\n    score = Math.max(score, 40);\n    title = t(\"watchAssetTitle\");\n    const p0 = (req.request.params as any)?.[0];\n    const opts = p0?.options || p0;\n    const watchAssetInfo = opts ? {\n      type: String(opts.type || \"ERC20\"),\n      address: typeof opts.address === \"string\" ? opts.address : undefined,\n      symbol: typeof opts.symbol === \"string\" ? opts.symbol : undefined,\n      decimals: typeof opts.decimals === \"number\" ? opts.decimals : undefined,\n      image: typeof opts.image === \"string\" ? opts.image : undefined,\n    } : undefined;\n    return {\n      level,\n      score,\n      title,\n      reasons,\n      decoded: { kind: \"TX\", raw: { params: req.request.params } },\n      recommend: \"WARN\",\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      intent: \"WATCH_ASSET\",\n      watchAssetInfo,\n      human: {\n        methodTitle: explain.title,\n        methodShort: t(\"explain_watch_asset_short\"),\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: t(\"human_watchasset_reco\"),\n      }\n    };\n  }\n\n  // Transactions\n  if (method === \"eth_sendtransaction\" || method === \"wallet_sendtransaction\") {\n    await initTokenSecurity().catch(() => {});\n    const tx = (req.request.params?.[0] ?? {}) as any;\n    const to = (tx.to ?? \"\").toLowerCase();\n    const data = typeof tx.data === \"string\" ? tx.data : \"\";\n    const value = tx.value ?? \"0x0\";\n    const txSummary = summarizeTx(method, (req.request.params || []) as any) as (TxSummary | null);\n    const selector = (txSummary?.selector || \"\").toLowerCase();\n    const chainId = (req.meta?.chainId ?? \"\").toString().toLowerCase() || undefined;\n    const decodedAction = isHexString(data) && data.startsWith(\"0x\") ? decodeTx(data.toLowerCase(), to) : null;\n    const valueWei = hexToBigInt((tx as any).value || \"0x0\");\n    let intent: Intent = decodedAction\n      ? (decodedAction.kind === \"APPROVE_ERC20\" || decodedAction.kind === \"INCREASE_ALLOWANCE\" || decodedAction.kind === \"DECREASE_ALLOWANCE\" || decodedAction.kind === \"SET_APPROVAL_FOR_ALL\" || decodedAction.kind === \"PERMIT_EIP2612\" || decodedAction.kind === \"PERMIT2_ALLOWANCE\"\n          ? \"APPROVAL\"\n          : decodedAction.kind === \"TRANSFER_ERC20\" || decodedAction.kind === \"TRANSFERFROM_ERC20\" || decodedAction.kind === \"PERMIT2_TRANSFER\"\n          ? \"TOKEN_TRANSFER\"\n          : decodedAction.kind === \"TRANSFER_NFT\"\n          ? \"NFT_TRANSFER\"\n          : intentFromTxDataAndValue(data, valueWei, selector))\n      : intentFromTxDataAndValue(data, valueWei, selector);\n    let txExtras: TxExtras | undefined;\n    let flaggedAddr: ThreatIntelAddress | undefined;\n    let asset: AssetInfo | null = null;\n\n    const tokenAddr = getTokenAddressForTx(to, decodedAction);\n    const tokenInfo = tokenAddr ? getTokenInfo(tokenAddr) : undefined;\n    const tokenMeta = tokenAddr\n      ? {\n          tokenVerified: tokenInfo?.v ?? false,\n          tokenAddress: tokenAddr,\n          tokenSymbol: tokenInfo?.s,\n          tokenLogoUri: tokenInfo?.l || undefined,\n        }\n      : {};\n\n    const labelsTo = (settings.addressIntelEnabled ?? true) ? labelsFor(addrIntel ?? null, to) : [];\n    const labelsSpender = (settings.addressIntelEnabled ?? true) && decodedAction && \"spender\" in decodedAction ? labelsFor(addrIntel ?? null, decodedAction.spender || \"\") : [];\n    const labelsOperator = (settings.addressIntelEnabled ?? true) && decodedAction && \"operator\" in decodedAction ? labelsFor(addrIntel ?? null, decodedAction.operator || \"\") : [];\n    const labelsTokenContract = (settings.addressIntelEnabled ?? true) && decodedAction && \"token\" in decodedAction ? labelsFor(addrIntel ?? null, decodedAction.token || to) : [];\n    const hasAddrIntelHit = labelsTo.length > 0 || labelsSpender.length > 0 || labelsOperator.length > 0 || labelsTokenContract.length > 0;\n    const addrIntelReasons: string[] = [];\n    let addrIntelScore = 0;\n    let addrIntelRecommend: Analysis[\"recommend\"] | undefined;\n    if (hasAddrIntelHit) {\n      const allLabels = [...labelsTo, ...labelsSpender, ...labelsOperator, ...labelsTokenContract];\n      if (allLabels.includes(\"SANCTIONED\")) {\n        addrIntelReasons.push(t(\"addr_sanctioned_block\"));\n        addrIntelScore = 100;\n        addrIntelRecommend = \"BLOCK\";\n      } else {\n        if (allLabels.some((l) => l === \"SCAM_REPORTED\" || l === \"PHISHING_REPORTED\")) addrIntelReasons.push(t(\"addr_scam_reported_warn\"));\n        if (allLabels.includes(\"MALICIOUS_CONTRACT\")) addrIntelReasons.push(t(\"addr_malicious_contract_warn\"));\n        addrIntelScore = 80;\n        addrIntelRecommend = \"HIGH\";\n      }\n    }\n    const addressIntelPartial = hasAddrIntelHit\n      ? {\n          addressIntelHit: true as const,\n          addressIntel: {\n            to: labelsTo.map(String),\n            spender: labelsSpender.map(String),\n            operator: labelsOperator.map(String),\n            tokenContract: labelsTokenContract.map(String),\n          },\n        }\n      : {};\n\n    if (decodedAction && (settings.addressIntelEnabled ?? true)) {\n      const candidates: string[] = [to];\n      if (\"spender\" in decodedAction && decodedAction.spender) candidates.push(decodedAction.spender);\n      if (\"operator\" in decodedAction && decodedAction.operator) candidates.push(decodedAction.operator);\n      if (\"to\" in decodedAction && decodedAction.to) candidates.push(decodedAction.to);\n      if (\"from\" in decodedAction && decodedAction.from) candidates.push(decodedAction.from);\n      const blocked = (intel as any)?.blockedAddressesList || (intel as any)?.blockedAddresses || [];\n      for (const addr of candidates) {\n        const a = addr.toLowerCase();\n        if (!a || a.length < 40) continue;\n        const match = blocked.find((b: any) => b.address.toLowerCase() === a && (!b.chainId || b.chainId.toLowerCase() === (chainId || \"\")));\n        if (match) { flaggedAddr = match; reasons.unshift(t(\"address_flagged_reason\", { label: match.label, category: match.category })); break; }\n        if (listCache && isBlockedAddress(a, listCache)) {\n          reasons.unshift(\"Address is on the blocklist.\");\n          level = \"HIGH\";\n          score = Math.max(score, 95);\n          flaggedAddr = { address: a, label: \"Blocklist\", category: \"blocklist\" as any, sourceId: \"blocklist\", confidence: 1 as const, updatedAt: Date.now() };\n          break;\n        }\n      }\n    }\n\n    const tokenForAsset = decodedAction && (\"token\" in decodedAction && decodedAction.token) ? decodedAction.token : to;\n    const chainIdHex = (chainId || \"0x1\").startsWith(\"0x\") ? (chainId || \"0x1\") : \"0x\" + (chainId || \"1\");\n    if (listCache && tokenForAsset && isScamToken(chainIdHex, tokenForAsset, listCache)) {\n      reasons.unshift(\"Token contract is marked as scam / suspicious.\");\n      level = \"HIGH\";\n      score = Math.max(score, 95);\n    }\n    let tokenConfidencePartial: Partial<Analysis> = {};\n    if (tokenForAsset && listCache) {\n      await markTokenSeen(chainIdHex, tokenForAsset);\n      const firstSeen = await getTokenFirstSeen(chainIdHex, tokenForAsset);\n      const tokenScam = isScamToken(chainIdHex, tokenForAsset, listCache);\n      const tokenTrusted = isTrustedToken(chainIdHex, tokenForAsset, listCache) || !!(tokenInfo?.v);\n      const isNew = firstSeen ? (Date.now() - firstSeen < 7 * 24 * 60 * 60 * 1000) : true;\n      let tokenConfidence: \"SCAM\" | \"TRUSTED\" | \"LOW\" | \"UNKNOWN\" = \"UNKNOWN\";\n      if (tokenScam) tokenConfidence = \"SCAM\";\n      else if (tokenTrusted) tokenConfidence = \"TRUSTED\";\n      else if (isNew) tokenConfidence = \"LOW\";\n      tokenConfidencePartial = { tokenConfidence, tokenFirstSeenAt: firstSeen ?? undefined };\n      if (tokenConfidence === \"LOW\") reasons.push(`Token analisado: ${tokenInfo?.s ?? \"?\"} \u2014 Confian\u00E7a: BAIXA (rec\u00E9m-lan\u00E7ado / pouca liquidez / sem reputa\u00E7\u00E3o)`);\n    }\n    Object.assign(tokenMeta, tokenConfidencePartial);\n    if (decodedAction && tokenForAsset && (settings.assetEnrichmentEnabled ?? true) && tabId) {\n      try { asset = await getAssetInfo(chainId || \"0x1\", tokenForAsset, tabId); } catch {}\n    }\n\n    if (asset) reasons.push(t(\"asset_info_reason\", { sym: asset.symbol || asset.name || \"?\", kind: asset.kind }));\n\n    if (isHexString(data) && data.startsWith(\"0x\")) {\n      const ap = decodeErc20Approve(data.toLowerCase());\n      const incDec = decodedAction && (decodedAction.kind === \"INCREASE_ALLOWANCE\" || decodedAction.kind === \"DECREASE_ALLOWANCE\") ? decodedAction : null;\n      if (incDec) {\n        const isUnlimited = incDec.kind === \"INCREASE_ALLOWANCE\" && (incDec as any).amountType === \"UNLIMITED\";\n        const spender = \"spender\" in incDec ? incDec.spender : \"\";\n        if (isUnlimited) {\n          reasons.push(t(\"unlimitedApprovalReason\"));\n          level = \"HIGH\";\n          score = Math.max(score, 90);\n          title = t(\"unlimitedApprovalDetected\");\n        } else {\n          reasons.push(incDec.kind === \"INCREASE_ALLOWANCE\" ? \"Aumenta limite de gasto (increaseAllowance).\" : \"Diminui limite de gasto (decreaseAllowance).\");\n          level = \"WARN\";\n          score = Math.max(score, 40);\n          title = incDec.kind === \"INCREASE_ALLOWANCE\" ? \"Increase Allowance\" : \"Decrease Allowance\";\n        }\n        txExtras = {\n          approvalType: \"ERC20_APPROVE\",\n          tokenContract: typeof (tx as any).to === \"string\" ? String((tx as any).to) : undefined,\n          spender,\n          unlimited: isUnlimited,\n        };\n        return {\n          level: hasAddrIntelHit && addrIntelRecommend === \"BLOCK\" ? \"HIGH\" : level,\n          score: Math.max(score, addrIntelScore),\n          title,\n          reasons: hasAddrIntelHit ? [...addrIntelReasons, ...reasons] : reasons,\n          decoded: { kind: \"APPROVE\", spenderOrOperator: spender, amountHuman: isUnlimited ? \"UNLIMITED\" : (incDec as any).amountRaw ?? \"?\", raw: { to, value, selector: hexSelector(data) } },\n          decodedAction: incDec,\n          recommend: isUnlimited ? (addrIntelRecommend ?? (settings.blockHighRisk ? \"BLOCK\" : \"WARN\")) : (addrIntelRecommend ?? \"WARN\"),\n          trust,\n          suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n          tx: txSummary || undefined,\n          txExtras,\n          intent: \"APPROVAL\",\n          asset: asset || undefined,\n          flaggedAddress: flaggedAddr,\n          provider: req.providerHint ? { kind: req.providerHint.kind as any, name: req.providerHint.name } : undefined,\n          ...addressIntelPartial,\n          ...tokenMeta,\n          human: {\n            methodTitle: explain.title,\n            methodShort: explain.short,\n            methodWhy: explain.why,\n            whatItDoes: [t(\"human_approve_whatIs\"), t(\"human_approve_safe_1\")].slice(0, 2),\n            risks: isUnlimited ? [t(\"human_approve_risk_1\"), t(\"human_approve_risk_unlimited\")].slice(0, 3) : [t(\"human_approve_risk_1\")].slice(0, 3),\n            safeNotes: [t(\"human_approve_safe_1\")].slice(0, 1),\n            nextSteps: [t(\"human_approve_next_1\"), t(\"human_approve_next_2\")].slice(0, 3),\n            recommendation: isUnlimited ? t(\"human_approve_reco_unlimited\") : t(\"human_approve_reco\"),\n            links: [{ text: t(\"human_revoke_link_text\"), href: \"https://revoke.cash\" }],\n          }\n        };\n      }\n      if (ap) {\n        if (ap.isMax) {\n          reasons.push(t(\"unlimitedApprovalReason\"));\n          level = \"HIGH\";\n          score = Math.max(score, 90);\n          title = t(\"unlimitedApprovalDetected\");\n          txExtras = {\n            approvalType: \"ERC20_APPROVE\",\n            tokenContract: typeof (tx as any).to === \"string\" ? String((tx as any).to) : undefined,\n            spender: ap.spender,\n            unlimited: true,\n          };\n          return {\n            level: hasAddrIntelHit && addrIntelRecommend === \"BLOCK\" ? \"HIGH\" : level,\n            score: Math.max(score, addrIntelScore),\n            title,\n            reasons: hasAddrIntelHit ? [...addrIntelReasons, ...reasons] : reasons,\n            decoded: {\n              kind: \"APPROVE\",\n              spenderOrOperator: ap.spender,\n              amountHuman: \"UNLIMITED\",\n              raw: { to, value, selector: hexSelector(data) }\n            },\n            decodedAction: decodedAction?.kind === \"APPROVE_ERC20\" ? decodedAction : undefined,\n            recommend: addrIntelRecommend ?? (settings.blockHighRisk ? \"BLOCK\" : \"WARN\"),\n            trust,\n            suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n            tx: txSummary || undefined,\n            txExtras,\n            intent: \"APPROVAL\",\n            asset: asset || undefined,\n            flaggedAddress: flaggedAddr,\n            provider: req.providerHint ? { kind: req.providerHint.kind as any, name: req.providerHint.name } : undefined,\n            ...addressIntelPartial,\n            ...tokenMeta,\n            human: {\n              methodTitle: explain.title,\n              methodShort: explain.short,\n              methodWhy: explain.why,\n              whatItDoes: [t(\"human_approve_whatIs\"), t(\"human_approve_safe_1\")].slice(0, 2),\n              risks: [t(\"human_approve_risk_1\"), t(\"human_approve_risk_unlimited\")].slice(0, 3),\n              safeNotes: [t(\"human_approve_safe_1\")].slice(0, 1),\n              nextSteps: [t(\"human_approve_next_1\"), t(\"human_approve_next_2\")].slice(0, 3),\n              recommendation: t(\"human_approve_reco_unlimited\"),\n              links: [{ text: t(\"human_revoke_link_text\"), href: \"https://revoke.cash\" }],\n            }\n          };\n        } else {\n          reasons.push(t(\"tokenApproval\"));\n          level = \"WARN\";\n          score = Math.max(score, 40);\n          title = t(\"tokenApproval\");\n          txExtras = {\n            approvalType: \"ERC20_APPROVE\",\n            tokenContract: typeof (tx as any).to === \"string\" ? String((tx as any).to) : undefined,\n            spender: ap.spender,\n            unlimited: false,\n          };\n          return {\n            level: hasAddrIntelHit && addrIntelRecommend === \"BLOCK\" ? \"HIGH\" : level,\n            score: Math.max(score, addrIntelScore),\n            title,\n            reasons: hasAddrIntelHit ? [...addrIntelReasons, ...reasons] : reasons,\n            decoded: {\n              kind: \"APPROVE\",\n              spenderOrOperator: ap.spender,\n              amountHuman: ap.value ? ap.value.toString() : \"UNKNOWN\",\n              raw: { to, value, selector: hexSelector(data) }\n            },\n            decodedAction: decodedAction?.kind === \"APPROVE_ERC20\" ? decodedAction : undefined,\n            recommend: addrIntelRecommend ?? \"WARN\",\n            trust,\n            suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n            tx: txSummary || undefined,\n            txExtras,\n            intent: \"APPROVAL\",\n            asset: asset || undefined,\n            flaggedAddress: flaggedAddr,\n            provider: req.providerHint ? { kind: req.providerHint.kind as any, name: req.providerHint.name } : undefined,\n            ...addressIntelPartial,\n            ...tokenMeta,\n            human: {\n              methodTitle: explain.title,\n              methodShort: explain.short,\n              methodWhy: explain.why,\n              whatItDoes: [t(\"human_approve_whatIs\"), t(\"human_approve_safe_1\")].slice(0, 2),\n              risks: [t(\"human_approve_risk_1\")].slice(0, 3),\n              safeNotes: [t(\"human_approve_safe_1\")].slice(0, 1),\n              nextSteps: [t(\"human_approve_next_1\"), t(\"human_approve_next_2\")].slice(0, 3),\n              recommendation: t(\"human_approve_reco\"),\n              links: [{ text: t(\"human_revoke_link_text\"), href: \"https://revoke.cash\" }],\n            }\n          };\n        }\n      }\n\n      const sa = decodeSetApprovalForAll(data.toLowerCase());\n      if (sa && sa.approved) {\n        reasons.push(t(\"nftOperatorApprovalReason\"));\n        level = \"HIGH\";\n        score = Math.max(score, 95);\n        title = t(\"nftOperatorApproval\");\n        txExtras = {\n          approvalType: \"NFT_SET_APPROVAL_FOR_ALL\",\n          tokenContract: typeof (tx as any).to === \"string\" ? String((tx as any).to) : undefined,\n          operator: sa.operator,\n          unlimited: true,\n        };\n        return {\n          level: hasAddrIntelHit && addrIntelRecommend === \"BLOCK\" ? \"HIGH\" : level,\n          score: Math.max(score, addrIntelScore),\n          title,\n          reasons: hasAddrIntelHit ? [...addrIntelReasons, ...reasons] : reasons,\n          decoded: {\n            kind: \"SET_APPROVAL_FOR_ALL\",\n            spenderOrOperator: sa.operator,\n            raw: { to, value, selector: hexSelector(data) }\n          },\n          decodedAction: decodedAction?.kind === \"SET_APPROVAL_FOR_ALL\" ? decodedAction : undefined,\n          recommend: addrIntelRecommend ?? (settings.blockHighRisk ? \"BLOCK\" : \"WARN\"),\n          trust,\n          suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n          tx: txSummary || undefined,\n          txExtras,\n          intent: \"APPROVAL\",\n          asset: asset || undefined,\n          flaggedAddress: flaggedAddr,\n          provider: req.providerHint ? { kind: req.providerHint.kind as any, name: req.providerHint.name } : undefined,\n          ...addressIntelPartial,\n          ...tokenMeta,\n          human: {\n            methodTitle: explain.title,\n            methodShort: explain.short,\n            methodWhy: explain.why,\n            whatItDoes: [t(\"human_setApprovalForAll_whatIs\")].slice(0, 2),\n            risks: [t(\"human_setApprovalForAll_risk_1\")].slice(0, 3),\n            safeNotes: [t(\"human_setApprovalForAll_safe_1\")].slice(0, 1),\n            nextSteps: [t(\"human_setApprovalForAll_next_1\")].slice(0, 3),\n            recommendation: t(\"human_setApprovalForAll_reco\"),\n            links: [{ text: t(\"human_revoke_link_text\"), href: \"https://revoke.cash\" }],\n          }\n        };\n      }\n    }\n\n    if (decodedAction?.kind === \"TRANSFER_NFT\" && !txExtras) {\n      txExtras = {\n        approvalType: \"NFT_TRANSFER\",\n        tokenContract: decodedAction.token,\n        toAddress: decodedAction.to,\n      };\n    }\n\n    if (decodedAction) {\n      if (decodedAction.kind === \"APPROVE_ERC20\" || decodedAction.kind === \"INCREASE_ALLOWANCE\" || decodedAction.kind === \"DECREASE_ALLOWANCE\" || decodedAction.kind === \"PERMIT_EIP2612\" || decodedAction.kind === \"PERMIT2_ALLOWANCE\") reasons.push(t(\"reason_permission_tokens\"));\n      else if (decodedAction.kind === \"SET_APPROVAL_FOR_ALL\" && decodedAction.approved) reasons.push(t(\"reason_permission_all_nfts\"));\n      else if (decodedAction.kind === \"TRANSFER_ERC20\" || decodedAction.kind === \"TRANSFERFROM_ERC20\" || decodedAction.kind === \"PERMIT2_TRANSFER\") reasons.push(t(\"token_transfer_detected\"));\n      else if (decodedAction.kind === \"TRANSFER_NFT\") reasons.push(t(\"nft_transfer_detected\"));\n      else if (decodedAction.kind !== \"UNKNOWN\") reasons.push(t(\"reason_transfer_tokens\"));\n    }\n    // Default tx\n    if (level === \"LOW\") {\n      title = t(\"txPreview\");\n      score = 20;\n      reasons.push(t(\"txWarnReason\"));\n    }\n    if (txSummary?.valueEth) reasons.push(`Transa\u00E7\u00E3o: envia ${txSummary.valueEth} ETH.`);\n    if (txSummary?.feeKnown) {\n      if (txSummary.maxGasFeeEth) reasons.push(`Taxa m\u00E1xima: ${txSummary.maxGasFeeEth} ETH.`);\n      if (txSummary.maxTotalEth) reasons.push(`Total m\u00E1ximo: ${txSummary.maxTotalEth} ETH.`);\n    } else {\n      reasons.push(t(\"fee_unknown_wallet_will_estimate\"));\n      reasons.push(t(\"check_wallet_network_fee\"));\n    }\n    const feeGtValue = !!(txSummary?.feeKnown && txSummary.maxGasFeeEth && txSummary.valueEth && parseFloat(txSummary.maxGasFeeEth) > parseFloat(txSummary.valueEth));\n    if (feeGtValue) reasons.unshift(t(\"fee_gt_value\"));\n    const toIsContract = await getToIsContract(to || undefined, tabId);\n    const host = hostFromUrl(req.url || \"\");\n    const txCtx = detectTxContext({ host, txTo: to, data, valueWei, selector });\n    if (intent === \"NFT_PURCHASE\") reasons.push(\"Compra de NFT: ao confirmar, valor ser\u00E1 transferido e NFT adquirido.\");\n    if (intent === \"SWAP\") {\n      reasons.push(\"Swap/compra de token via contrato: ao confirmar, voc\u00EA troca ativo por token.\");\n      if (listCache) {\n        const sim = (req as any)?.simulationOutcome;\n        const pathTokens = extractTokenCandidates(to, data, decodedAction, sim);\n        for (const addr of pathTokens.slice(0, 5)) {\n          try {\n            const risk = await getTokenRisk(addr, chainIdHex, listCache);\n            if (risk.confidence === \"LOW\" && risk.symbol) {\n              reasons.push(`Token analisado: ${risk.symbol} \u2014 Confian\u00E7a: BAIXA (rec\u00E9m-lan\u00E7ado / pouca liquidez / sem reputa\u00E7\u00E3o)`);\n              if (!tokenConfidencePartial.tokenConfidence || tokenConfidencePartial.tokenConfidence === \"UNKNOWN\") {\n                tokenConfidencePartial = { ...tokenConfidencePartial, tokenConfidence: \"LOW\" };\n                Object.assign(tokenMeta, tokenConfidencePartial);\n              }\n              break;\n            }\n          } catch { /* ignore */ }\n        }\n      }\n    }\n    if (valueWei > 0n) reasons.push(\"Envia valor nativo (ETH).\");\n    if (toIsContract === true) reasons.push(t(\"reason_contract_target\") || REASON_KEYS.CONTRACT_TARGET + \": Destino \u00E9 contrato.\");\n    if (reasons.length === 0) reasons.push(\"Transa\u00E7\u00E3o on-chain: confirme valor, destino e rede.\");\n    const defaultRecommend = level === \"HIGH\" ? (settings.blockHighRisk ? \"BLOCK\" : \"WARN\") : (level === \"WARN\" ? \"WARN\" : \"ALLOW\");\n    return {\n      level: hasAddrIntelHit && addrIntelRecommend === \"BLOCK\" ? \"HIGH\" : level,\n      score: Math.max(score, addrIntelScore),\n      title,\n      reasons: hasAddrIntelHit ? [...addrIntelReasons, ...reasons] : reasons,\n      decoded: { kind: \"TX\", raw: { to, value, selector: hexSelector(data) } },\n      decodedAction: decodedAction || undefined,\n      recommend: addrIntelRecommend ?? defaultRecommend,\n      trust,\n      suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n      tx: txSummary || undefined,\n      txExtras,\n      intent,\n      txContext: { kind: txCtx },\n      safeDomain,\n      asset: asset || undefined,\n      flaggedAddress: flaggedAddr,\n      provider: req.providerHint ? { kind: req.providerHint.kind as any, name: req.providerHint.name } : undefined,\n      feeGtValue,\n      toIsContract,\n      ...addressIntelPartial,\n      ...tokenMeta,\n      human: {\n        methodTitle: explain.title,\n        methodShort: explain.short,\n        methodWhy: explain.why,\n        whatItDoes: lists.whatItDoes,\n        risks: lists.risks,\n        safeNotes: lists.safeNotes,\n        safe: lists.safeNotes,\n        nextSteps: lists.nextSteps,\n        recommendation: trust.verdict === \"SUSPICIOUS\" ? t(\"human_tx_reco_suspicious\") : t(\"human_tx_reco_ok\"),\n      }\n    };\n  }\n\n  // Unknown method: allow\n  return {\n    level,\n    score,\n    title: level === \"WARN\" ? title : \"Request\",\n    reasons: reasons.length ? reasons : [t(\"unknownMethodReason\")],\n    decoded: { kind: \"TX\", raw: { method: req.request.method } },\n    recommend: level === \"WARN\" ? \"WARN\" : \"ALLOW\"\n    ,\n    trust,\n    suggestedTrustedDomains: [...SUGGESTED_TRUSTED_DOMAINS],\n    human: {\n      methodTitle: explain.title,\n      methodShort: explain.short,\n      methodWhy: explain.why,\n      whatItDoes: lists.whatItDoes,\n      risks: lists.risks,\n      safeNotes: lists.safeNotes,\n      nextSteps: lists.nextSteps,\n      recommendation: t(\"human_generic_reco\"),\n    }\n  };\n}\n\nchrome.runtime.onMessage.addListener((msg, sender, sendResponse) => {\n  console.log(\"\u2699\uFE0F [SignGuard Background] Message received:\", msg?.type, msg);\n  if (!msg || typeof msg !== \"object\" || !msg.type) {\n    try { sendResponse({ ok: false, error: \"INVALID_MESSAGE\" }); } catch {}\n    return false;\n  }\n  if (msg.type === \"PING\") return false;\n  handleBgRequest(msg, sender).then(sendResponse).catch((err) => {\n    try { sendResponse({ ok: false, error: String((err as Error)?.message || err) }); } catch {}\n  });\n  return true;\n});\n", "export function hexToBigInt(hex?: string): bigint {\r\n  if (!hex) return 0n;\r\n  try { return BigInt(hex); } catch { return 0n; }\r\n}\r\n\r\nexport function weiToEth(wei: bigint, decimals = 6): string {\r\n  const base = 10n ** 18n;\r\n  const whole = wei / base;\r\n  const frac = wei % base;\r\n  const fracStr = frac.toString().padStart(18, \"0\").slice(0, decimals);\r\n  const s = `${whole}.${fracStr}`;\r\n  return s.replace(/\\.?0+$/, (m) => (m === \".\" ? \"\" : m));\r\n}\r\n\r\nexport function shortAddr(addr?: string): string {\r\n  if (!addr || typeof addr !== \"string\") return \"\";\r\n  if (addr.length <= 12) return addr;\r\n  return addr.slice(0, 6) + \"\u2026\" + addr.slice(-4);\r\n}\r\n\r\n", "export type Locale = \"pt\" | \"en\";\n\nexport function detectLocale(): Locale {\n  const raw = (navigator.languages?.[0] || navigator.language || \"en\").toLowerCase();\n  if (raw.startsWith(\"pt\")) return \"pt\";\n  return \"en\";\n}\n\nconst dict: Record<Locale, Record<string, string>> = {\n  pt: {\n    tech_displayAction: \"A\u00E7\u00E3o (classifica\u00E7\u00E3o)\",\n    tech_methodRaw: \"M\u00E9todo (raw)\",\n    tech_recommendScoreLevel: \"Recomenda\u00E7\u00E3o/score/n\u00EDvel\",\n    tech_reasons: \"Motivos\",\n    tech_decoded: \"Decodificado\",\n    dash: \"\u2014\",\n    tx_to: \"To\",\n    tx_data_length: \"Tamanho do data\",\n    more_whatItDoes: \"O que isso faz\",\n    more_risks: \"Riscos\",\n    more_safeNotes: \"Notas de seguran\u00E7a\",\n    more_nextSteps: \"Pr\u00F3ximos passos\",\n    // Brand\n    extName: \"Crypto Wallet SignGuard\",\n\n    // Overlay - generic labels\n    overlay_analyzing: \"Analisando Transa\u00E7\u00E3o...\",\n    overlay_simulating: \"O SignGuard est\u00E1 a simular o resultado.\",\n    overlay_safe: \"Parece Seguro\",\n    overlay_attention: \"Aten\u00E7\u00E3o Detectada\",\n    overlay_action: \"A\u00E7\u00E3o\",\n    overlay_simulation_balance: \"Simula\u00E7\u00E3o de Balan\u00E7o\",\n    overlay_approvals_detected: \"Aprova\u00E7\u00F5es detectadas\",\n    overlay_confirm_allow_msg: \"Tem certeza? Isso ignora prote\u00E7\u00E3o.\",\n    overlay_confirm_allow: \"Confirmar permitir 1 vez\",\n    overlay_try_again: \"Tentar novamente\",\n    overlay_analysis_taking_long: \"A an\u00E1lise est\u00E1 demorando.\",\n    overlay_fee_calculated: \"Taxas calculadas.\",\n    overlay_finishing: \"Finalizando an\u00E1lise...\",\n    overlay_typed_data_card_title: \"Assinatura (EIP-712)\",\n    overlay_typed_data_sign_warning: \"Assinar isso pode permitir gasto futuro sem nova confirma\u00E7\u00E3o.\",\n    overlay_allowance_loading: \"Allowance atual: \u2026\",\n    overlay_allowance_current: \"Allowance atual: \",\n    overlay_allowance_approved: \"Aprovado\",\n    overlay_allowance_not_approved: \"N\u00E3o aprovado\",\n    overlay_allowance_unlimited: \"Ilimitado\",\n    simulation_no_changes: \"Nenhuma mudan\u00E7a de saldo detetada.\",\n    tx_unknown: \"Transa\u00E7\u00E3o Desconhecida\",\n    dapp_unknown: \"DApp Desconhecido\",\n    overlay_requested_title: \"O que est\u00E1 sendo solicitado\",\n    overlay_site_trusted_title: \"Site confi\u00E1vel?\",\n    overlay_summary_title: \"Resumo (linguagem simples)\",\n    overlay_recommended_title: \"A\u00E7\u00E3o recomendada\",\n    overlay_note_title: \"Observa\u00E7\u00E3o\",\n\n    // Overlay - details sections\n    details_tx_title: \"Detalhes da transa\u00E7\u00E3o\",\n    details_tech_title: \"Detalhes t\u00E9cnicos\",\n    details_more_title: \"Mais explica\u00E7\u00F5es\",\n\n    // Queue\n    queue_indicator: \"Fila: {pos} de {total}\",\n\n    // Action titles\n    action_CONNECT_title: \"Conectar carteira\",\n    action_REQUEST_PERMISSIONS_title: \"Solicitar permiss\u00F5es\",\n    action_SWITCH_CHAIN_title: \"Trocar rede\",\n    action_ADD_CHAIN_title: \"Adicionar rede\",\n    action_SIGN_MESSAGE_title: \"Assinar mensagem\",\n    action_SIGN_TYPED_DATA_title: \"Assinar dados (Typed Data)\",\n    action_SEND_TX_title: \"Enviar transa\u00E7\u00E3o\",\n    action_SEND_TX_contract_title: \"Interagir com contrato\",\n    action_SEND_TX_eth_title: \"Enviar ETH\",\n    action_WATCH_ASSET_title: \"Adicionar token/ativo\",\n    action_SOLANA_title: \"Assinatura/Transa\u00E7\u00E3o Solana\",\n    action_UNKNOWN_title: \"Solicita\u00E7\u00E3o\",\n\n    // Summary bullets (plain language)\n    summary_CONNECT_1: \"O site quer ver seus endere\u00E7os e a rede atual.\",\n    summary_CONNECT_2: \"Ele poder\u00E1 pedir assinaturas/transa\u00E7\u00F5es depois.\",\n    summary_CONNECT_3: \"Conecte apenas se confiar no site.\",\n    summary_REQUEST_PERMISSIONS_1: \"O site quer permiss\u00F5es adicionais na sua carteira.\",\n    summary_REQUEST_PERMISSIONS_2: \"Revise as permiss\u00F5es na carteira antes de aceitar.\",\n    summary_SWITCH_CHAIN_1: \"O site quer trocar a rede (chain) da sua carteira.\",\n    summary_SWITCH_CHAIN_2: \"Troca de rede normalmente n\u00E3o custa gas.\",\n    explain_connect_title: \"Conectar carteira\",\n    explain_connect_short: \"Login com carteira (compartilha seu endere\u00E7o p\u00FAblico)\",\n    explain_connect_why: \"Isso permite ao site mostrar sua conta e pedir assinaturas/aprova\u00E7\u00F5es/transa\u00E7\u00F5es depois.\",\n    explain_sign_title: \"Assinar mensagem\",\n    explain_sign_short: \"Sem gas, mas assinaturas podem autorizar a\u00E7\u00F5es\",\n    explain_sign_why: \"Sites usam assinaturas para login, verifica\u00E7\u00E3o de posse ou autoriza\u00E7\u00F5es off-chain.\",\n    explain_typed_title: \"Assinar dados estruturados\",\n    explain_typed_short: \"Typed-data pode incluir permits/autoriza\u00E7\u00F5es\",\n    explain_typed_why: \"Typed-data \u00E9 frequentemente usado para permits (aprova\u00E7\u00F5es sem approve on-chain separado).\",\n    explain_tx_title: \"Enviar transa\u00E7\u00E3o\",\n    explain_tx_short: \"A\u00E7\u00E3o on-chain (pode ter taxa de gas)\",\n    explain_tx_why: \"Isso criar\u00E1 uma transa\u00E7\u00E3o on-chain se voc\u00EA aprovar na sua carteira.\",\n    explain_switch_title: \"Trocar rede\",\n    explain_switch_why: \"Alguns sites exigem uma rede espec\u00EDfica para funcionar.\",\n    explain_addchain_title: \"Adicionar rede\",\n    explain_addchain_short: \"Adiciona uma configura\u00E7\u00E3o de chain na carteira\",\n    explain_add_chain_short: \"Adicionar rede na carteira\",\n    add_chain_review_rpc: \"RPC malicioso pode enganar saldos/transa\u00E7\u00F5es; confirme a proced\u00EAncia.\",\n    add_chain_verify_chainid: \"Confirme o chainId e o nome da rede antes de adicionar.\",\n    explain_addchain_why: \"A carteira pode adicionar detalhes de RPC para a rede solicitada.\",\n    explain_watchasset_title: \"Adicionar ativo\",\n    explain_watchasset_short: \"Adiciona um token/ativo na UI da carteira\",\n    explain_watch_asset_short: \"Adicionar token/ativo na carteira\",\n    watch_asset_no_spend_but_risk: \"Adicionar token n\u00E3o gasta fundos, mas tokens podem ser golpe; confirme contrato.\",\n    watch_asset_verify_contract: \"Verifique o endere\u00E7o do contrato em um explorer confi\u00E1vel.\",\n    explain_watchasset_why: \"N\u00E3o gasta fundos, mas confirme se os detalhes do token est\u00E3o corretos.\",\n    explain_generic_title: \"Solicita\u00E7\u00E3o da carteira\",\n    explain_generic_short: \"Um site est\u00E1 pedindo uma a\u00E7\u00E3o da carteira\",\n    explain_generic_why: \"Revise os detalhes na carteira e confirme a URL do site.\",\n    human_connect_whatIs: \"Conecta seu endere\u00E7o de carteira a este site (como um login).\",\n    human_connect_sees_1: \"Seu endere\u00E7o p\u00FAblico (e sele\u00E7\u00E3o de conta)\",\n    human_connect_sees_2: \"Sua rede/chain selecionada\",\n    human_connect_sees_3: \"Atividade on-chain p\u00FAblica (tokens/NFTs s\u00E3o dados p\u00FAblicos)\",\n    human_connect_not_1: \"N\u00C3O revela sua seed phrase nem a senha da carteira\",\n    human_connect_not_2: \"N\u00C3O move fundos automaticamente por si s\u00F3\",\n    human_connect_why_1: \"Para mostrar sua conta e saldos na interface\",\n    human_connect_why_2: \"Para permitir assinar mensagens (login/verifica\u00E7\u00E3o)\",\n    human_connect_why_3: \"Para pedir aprova\u00E7\u00F5es/transa\u00E7\u00F5es depois (com sua confirma\u00E7\u00E3o)\",\n    human_connect_risk_1: \"Privacidade/rastreamento: pode vincular seu endere\u00E7o a este site\",\n    human_connect_risk_2: \"Phishing em etapas: os pr\u00F3ximos prompts podem pedir assinatura/approve\",\n    human_connect_risk_3: \"Dom\u00EDnios similares: sites falsos costumam come\u00E7ar com um connect inofensivo\",\n    human_connect_safe_1: \"Trate connect como compartilhar identidade: fa\u00E7a isso s\u00F3 em sites que voc\u00EA reconhece.\",\n    human_connect_next_1: \"Confira o dom\u00EDnio (ortografia, HTTPS, sem punycode)\",\n    human_connect_next_2: \"Se tiver d\u00FAvida, cancele e abra o site por um favorito confi\u00E1vel\",\n    human_connect_reco_suspicious: \"Cancele e verifique a URL por outro meio (favorito/busca), depois tente novamente.\",\n    human_connect_reco_ok: \"Continue apenas se voc\u00EA reconhece o site e a URL parece correta.\",\n    human_sign_whatIs: \"Cria uma assinatura criptogr\u00E1fica. Geralmente n\u00E3o custa gas, mas pode autorizar a\u00E7\u00F5es.\",\n    human_sign_risk_1: \"Assinar textos desconhecidos pode autorizar a\u00E7\u00F5es/login que voc\u00EA n\u00E3o pretendia\",\n    human_sign_risk_2: \"Blind sign pode esconder o que voc\u00EA est\u00E1 autorizando\",\n    human_typed_whatIs: \"Assina dados estruturados (typed-data). Frequentemente usado para permits/autoriza\u00E7\u00F5es.\",\n    human_typed_risk_1: \"Typed-data pode incluir permits de token que funcionam como aprova\u00E7\u00F5es\",\n    human_sign_safe_1: \"Prefira carteiras que mostrem detalhes de assinatura de forma leg\u00EDvel.\",\n    human_sign_next_1: \"Verifique a URL e leia a mensagem/typed-data com aten\u00E7\u00E3o\",\n    human_sign_next_2: \"Se o prompt for vago, cancele e pe\u00E7a contexto ao site\",\n    human_sign_reco_suspicious: \"Cancele. Dom\u00EDnio suspeito + assinatura \u00E9 um padr\u00E3o comum de phishing.\",\n    human_sign_reco_ok: \"S\u00F3 continue se voc\u00EA entende o motivo da assinatura e confia no site.\",\n    human_approve_whatIs: \"Uma aprova\u00E7\u00E3o permite que um contrato gaste seus tokens depois (at\u00E9 o limite aprovado).\",\n    human_approve_risk_1: \"Aprova\u00E7\u00F5es podem ser abusadas se o contrato gastador for malicioso ou comprometido\",\n    human_approve_risk_unlimited: \"Aprova\u00E7\u00E3o ilimitada significa que pode gastar TODO o saldo do token\",\n    human_approve_safe_1: \"Quando poss\u00EDvel, aprove apenas o m\u00EDnimo necess\u00E1rio.\",\n    human_approve_next_1: \"Confira o spender/operador e se voc\u00EA reconhece o dApp\",\n    human_approve_next_2: \"Considere revogar aprova\u00E7\u00F5es depois se n\u00E3o usar mais o site\",\n    human_approve_reco: \"Continue apenas se voc\u00EA confia no site e o spender faz sentido.\",\n    human_approve_reco_unlimited: \"Evite aprova\u00E7\u00F5es ilimitadas a menos que voc\u00EA confie muito no site e entenda o risco.\",\n    human_setApprovalForAll_whatIs: \"D\u00E1 permiss\u00E3o a um operador para mover TODOS os NFTs de uma cole\u00E7\u00E3o por voc\u00EA.\",\n    human_setApprovalForAll_risk_1: \"Isso pode permitir drenar NFTs se o operador for malicioso/comprometido\",\n    human_setApprovalForAll_safe_1: \"Aprove apenas operadores que voc\u00EA reconhece (ex.: marketplaces conhecidos).\",\n    human_setApprovalForAll_next_1: \"Verifique o endere\u00E7o do operador e se o site \u00E9 o marketplace pretendido\",\n    human_setApprovalForAll_reco: \"Cancele a menos que voc\u00EA esteja em um marketplace reconhecido e espere essa a\u00E7\u00E3o.\",\n    human_tx_whatIs: \"Isso criar\u00E1 uma transa\u00E7\u00E3o on-chain se voc\u00EA aprovar na sua carteira.\",\n    human_tx_risk_1: \"Transa\u00E7\u00F5es podem mover fundos ou alterar permiss\u00F5es dependendo da chamada\",\n    human_tx_safe_1: \"Sempre verifique destinat\u00E1rio, valor e o contrato com o qual est\u00E1 interagindo.\",\n    human_tx_next_1: \"Confira o destino (to), valor e a a\u00E7\u00E3o decodificada (se houver)\",\n    human_tx_reco_suspicious: \"Cancele. N\u00E3o envie transa\u00E7\u00F5es em dom\u00EDnios suspeitos.\",\n    human_tx_reco_ok: \"Continue apenas se voc\u00EA pretendia essa a\u00E7\u00E3o e os detalhes parecem corretos.\",\n    human_chain_whatIs: \"Muda a rede selecionada na sua carteira.\",\n    human_chain_risk_1: \"Redes/RPCs errados podem te enganar sobre ativos ou transa\u00E7\u00F5es\",\n    human_chain_safe_1: \"S\u00F3 troque/adicione redes que voc\u00EA reconhece.\",\n    human_chain_next_1: \"Confirme nome da rede e chainId no prompt da carteira\",\n    human_watchasset_whatIs: \"Adiciona um token/ativo na UI da carteira para facilitar a visualiza\u00E7\u00E3o.\",\n    human_watchasset_risk_1: \"Tokens falsos podem se passar por reais\u2014verifique endere\u00E7o e s\u00EDmbolo\",\n    human_watchasset_safe_1: \"Confirme detalhes do token em um explorer confi\u00E1vel (ex.: Etherscan).\",\n    human_watchasset_next_1: \"Verifique o contrato do token e as decimais\",\n    human_watchasset_reco: \"Continue apenas se os detalhes baterem com uma fonte oficial.\",\n    human_generic_whatIs: \"Um site solicitou uma a\u00E7\u00E3o da carteira. Revise os detalhes com cuidado.\",\n    human_generic_risk_1: \"Prompts desconhecidos podem fazer parte de fluxos de phishing\",\n    human_generic_safe_1: \"Na d\u00FAvida, cancele e verifique o site.\",\n    human_generic_next_1: \"Confira a URL e leia os detalhes do prompt da carteira\",\n    human_generic_reco: \"Continue apenas se voc\u00EA entende e esperava essa solicita\u00E7\u00E3o.\",\n    human_revoke_link_text: \"Revogar permiss\u00F5es depois: revoke.cash\",\n    trustReasonNotHttps: \"N\u00E3o \u00E9 HTTPS (maior risco de spoofing/inje\u00E7\u00E3o).\",\n    trustReasonManyHyphens: \"Muitos h\u00EDfens no dom\u00EDnio (comum em similares).\",\n    trustReasonSuspiciousKeywords: \"Dom\u00EDnio cont\u00E9m palavras de alto risco (login/verify/secure/...).\",\n    trustReasonBrandLookalike: \"Nome lembra uma marca, mas n\u00E3o \u00E9 o dom\u00EDnio oficial.\",\n    trustReasonManySubdomains: \"Estrutura de subdom\u00EDnio profunda/incomum.\",\n    trustReasonNoHost: \"N\u00E3o foi poss\u00EDvel ler o hostname do site.\",\n    trustReasonAllowlistedVariant: \"Dom\u00EDnio casa com um padr\u00E3o confi\u00E1vel.\",\n    trustReasonUnknown: \"Sem sinais fortes para um lado ou outro.\",\n    summary_ADD_CHAIN_1: \"O site quer adicionar uma nova rede na sua carteira.\",\n    summary_ADD_CHAIN_2: \"Confirme o chainId e o nome da rede com cuidado.\",\n    summary_SIGN_MESSAGE_1: \"Voc\u00EA vai assinar uma mensagem (n\u00E3o \u00E9 transa\u00E7\u00E3o).\",\n    summary_SIGN_MESSAGE_2: \"A assinatura pode ter efeitos fora da blockchain (login, termos, permiss\u00F5es).\",\n    summary_SIGN_TYPED_DATA_1: \"Voc\u00EA vai assinar dados estruturados (EIP-712).\",\n    summary_SIGN_TYPED_DATA_2: \"Isso pode autorizar gastos/ordens dependendo do conte\u00FAdo.\",\n    summary_SIGN_TYPED_DATA_3: \"Verifique quem \u00E9 o spender/contrato envolvido.\",\n    summary_SEND_TX_1: \"Voc\u00EA vai enviar uma transa\u00E7\u00E3o on-chain.\",\n    summary_SEND_TX_2: \"Isso pode mover ETH/tokens ou interagir com um contrato.\",\n    summary_SEND_TX_3: \"Confira valor, rede e destino antes de confirmar.\",\n    summary_WATCH_ASSET_1: \"O site quer adicionar um token/ativo na sua carteira.\",\n    summary_WATCH_ASSET_2: \"Confirme s\u00EDmbolo e endere\u00E7o do contrato do token.\",\n    summary_SOLANA_1: \"Assinatura ou transa\u00E7\u00E3o Solana. Os valores ser\u00E3o confirmados na carteira.\",\n    summary_UNKNOWN_1: \"O site est\u00E1 fazendo uma chamada de carteira desconhecida.\",\n    summary_UNKNOWN_2: \"Se n\u00E3o souber o que \u00E9, cancele.\",\n\n    // Costs / TX labels\n    btn_cancel: \"Cancelar\",\n    btn_block: \"Bloquear\",\n    btn_continue: \"Continuar\",\n    toast_request_expired: \"Solicita\u00E7\u00E3o expirada. Refa\u00E7a a a\u00E7\u00E3o no site e tente novamente.\",\n    simulation_tx_will_fail: \"ESTA TRANSA\u00C7\u00C3O VAI FALHAR\",\n    btn_close: \"Fechar\",\n    btn_proceed_anyway: \"Prosseguir mesmo assim\",\n    override_checkbox: \"Eu entendo o risco e quero prosseguir\",\n    override_countdown: \"({s}s)\",\n\n    tip_revoke: \"Revogar permiss\u00F5es depois: revoke.cash\",\n    cost_summary_title: \"Resumo de custos\",\n    costs_title: \"Custos e impacto\",\n    impact_title: \"Impacto\",\n    permission_for: \"Permiss\u00E3o para\",\n    addr_marked_public: \"Marcado em base p\u00FAblica\",\n    risk_title: \"Risco e por qu\u00EA\",\n    what_to_do_now: \"O que fazer agora\",\n    site_label: \"Site\",\n    network_label: \"Rede\",\n    severity_BLOCKED: \"BLOQUEADO\",\n    severity_HIGH: \"ALTO\",\n    severity_WARN: \"ATEN\u00C7\u00C3O\",\n    severity_LOW: \"BAIXO\",\n    cost_you_send: \"Voc\u00EA envia\",\n    cost_you_receive: \"Voc\u00EA recebe\",\n    cost_fee_only: \"apenas taxa\",\n    cost_value: \"Valor\",\n    cost_fee: \"Taxa estimada\",\n    cost_total: \"Total estimado\",\n    cost_fee_unknown: \"Taxa ser\u00E1 cobrada (confirme na carteira)\",\n    network_switch_title: \"Troca de rede\",\n    network_current: \"Rede atual\",\n    network_requested: \"Rede solicitada\",\n    trusted_domain_ref_title: \"Dom\u00EDnios confi\u00E1veis (refer\u00EAncia)\",\n    tx_cost_sending: \"Voc\u00EA est\u00E1 enviando {value} + taxa de rede\",\n    tx_cost_gas_only: \"Mesmo sem enviar moeda nativa, voc\u00EA pagar\u00E1 taxa de rede (gas)\",\n    gas_calculating: \"calculando\u2026\",\n\n    tx_destination: \"Destino\",\n    token_verified_uniswap: \"Token Verificado (Uniswap List)\",\n    token_unknown_unverified: \"Token Desconhecido (N\u00E3o Verificado)\",\n    tx_contract_method: \"Contrato/m\u00E9todo\",\n    tx_max_gas_fee: \"Taxa m\u00E1xima (gas)\",\n    tx_max_total: \"Total m\u00E1ximo\",\n    tx_fee_estimated_by_wallet: \"A carteira estimar\u00E1 a taxa na pr\u00F3xima etapa.\",\n\n    network_target: \"Rede alvo\",\n    switch_no_gas: \"A troca de rede normalmente N\u00C3O custa gas.\",\n    switch_next_step_gas: \"A pr\u00F3xima etapa (compra/transa\u00E7\u00E3o) ter\u00E1 taxa de rede.\",\n    switch_note_inline: \"A troca de rede normalmente N\u00C3O custa gas. Por\u00E9m a pr\u00F3xima etapa (compra/transa\u00E7\u00E3o) ter\u00E1 taxa de rede.\",\n    sendtx_reco: \"Confirme na carteira apenas se os detalhes (valor, rede e contrato) estiverem corretos.\",\n\n    // Risk/trust labels\n    risk_LOW: \"Baixo\",\n    risk_WARN: \"Aten\u00E7\u00E3o\",\n    risk_HIGH: \"Alto\",\n    recommend_ALLOW: \"Permitir\",\n    recommend_WARN: \"Avisar\",\n    recommend_HIGH: \"Alto risco\",\n    recommend_BLOCK: \"Bloquear\",\n    trust_unknown: \"Desconhecido\",\n    trust_suspicious: \"Suspeito\",\n    trust_likelyOfficial: \"Dom\u00EDnio conhecido (lista de refer\u00EAncia)\",\n    trust_domainNotRecognized: \"Dom\u00EDnio n\u00E3o reconhecido\",\n\n    // Phishing hard-block\n    phishing_hard_block: \"Dom\u00EDnio em blacklist de phishing. Bloqueado.\",\n\n    // Toasts\n    toast_extension_updated: \"Extens\u00E3o atualizada \u2014 recarregue a aba.\",\n    toast_cannot_analyze: \"N\u00E3o foi poss\u00EDvel analisar. Recarregue a aba.\",\n\n    // Options page\n    optionsTitle: \"Crypto Wallet SignGuard \u2014 Configura\u00E7\u00F5es\",\n    optionsSubtitle: \"Controle quando o SignGuard deve alertar e bloquear.\",\n    dashboardLink: \"Dashboard\",\n    onboardingTitle: \"Como usar\",\n    onboardingHowTo: \"A extens\u00E3o intercepta solicita\u00E7\u00F5es sens\u00EDveis (conex\u00E3o, assinatura, transa\u00E7\u00E3o) de carteiras injetadas (window.ethereum / window.solana). Ao detectar, mostra um overlay para voc\u00EA revisar antes de a carteira abrir.\",\n    onboardingWhatItDoes: \"Faz: alerta antes de conectar, assinar ou enviar; verifica dom\u00EDnio contra listas de phishing; mostra inten\u00E7\u00E3o da transa\u00E7\u00E3o (swap, NFT, approval).\",\n    onboardingWhatItDoesNot: \"N\u00E3o faz: n\u00E3o protege conex\u00F5es via QR/WalletConnect; n\u00E3o garante que contratos sejam seguros; n\u00E3o substitui verifica\u00E7\u00E3o manual.\",\n    onboardingLinkRevoke: \"revoke.cash \u2014 revogar permiss\u00F5es\",\n    onboardingLinkEtherscan: \"Etherscan \u2014 explorar transa\u00E7\u00F5es\",\n    exportDebugRequiresDebugMode: \"Ative o modo Debug primeiro para exportar eventos.\",\n    securityModeLabel: \"Modo de seguran\u00E7a\",\n    securityModeDesc: \"Strict bloqueia mais; Balanced alerta; Relaxed reduz fric\u00E7\u00E3o; Off desativa bloqueios.\",\n    modeStrict: \"Strict\",\n    modeBalanced: \"Balanced\",\n    modeRelaxed: \"Relaxed\",\n    modeOff: \"Off\",\n    strictBlockApprovalsUnlimitedLabel: \"Strict: bloquear approve ilimitado\",\n    strictBlockApprovalsUnlimitedDesc: \"Bloqueia aprova\u00E7\u00F5es ERC20 unlimited (MAX_UINT256).\",\n    strictBlockSetApprovalForAllLabel: \"Strict: bloquear setApprovalForAll\",\n    strictBlockSetApprovalForAllDesc: \"Bloqueia permiss\u00E3o para mover todos os NFTs.\",\n    strictBlockPermitLikeLabel: \"Strict: bloquear Permit ilimitado\",\n    strictBlockPermitLikeDesc: \"Bloqueia assinaturas Permit (EIP-2612) unlimited.\",\n    assetEnrichmentEnabledLabel: \"Enriquecimento de ativos\",\n    assetEnrichmentEnabledDesc: \"Busca s\u00EDmbolo/nome de tokens via eth_call.\",\n    addressIntelEnabledLabel: \"Threat intel de endere\u00E7os\",\n    addressIntelEnabledDesc: \"Verifica spender/operator/to contra blacklist.\",\n    riskWarningsLabel: \"Alertas de risco\",\n    riskWarningsDesc: \"Mostra avisos e recomenda\u00E7\u00F5es antes de abrir a carteira.\",\n    connectOverlayLabel: \"Overlay ao conectar\",\n    connectOverlayDesc: \"Mostra o overlay tamb\u00E9m para conex\u00E3o/permiss\u00F5es.\",\n    blockHighRiskLabel: \"Bloquear alto risco\",\n    blockHighRiskDesc: \"Bloqueia automaticamente a\u00E7\u00F5es de alto risco.\",\n    requireTypedOverrideLabel: \"Exigir override em Typed Data (alto risco)\",\n    requireTypedOverrideDesc: \"Para assinaturas EIP-712 de alto risco, exige confirma\u00E7\u00E3o extra.\",\n    allowOverrideOnPhishingLabel: \"Permitir override em phishing (N\u00C3O recomendado)\",\n    allowOverrideOnPhishingDesc: \"Se desativado (padr\u00E3o), phishing em blacklist \u00E9 bloqueado sem op\u00E7\u00E3o de prosseguir.\",\n    mode_off_reason: \"Modo OFF: sem bloqueios.\",\n    address_flagged_reason: \"Endere\u00E7o/contrato sinalizado: {label} ({category})\",\n    addr_sanctioned_block: \"Endere\u00E7o em lista de san\u00E7\u00F5es.\",\n    addr_scam_reported_warn: \"Endere\u00E7o marcado como suspeito/relatado.\",\n    addr_phishing_reported_warn: \"Endere\u00E7o marcado como suspeito/relatado.\",\n    addr_malicious_contract_warn: \"Contrato marcado como malicioso.\",\n    asset_info_reason: \"Ativo: {sym} ({kind})\",\n    reason_permission_tokens: \"Permiss\u00E3o para gastar tokens\",\n    reason_permission_all_nfts: \"Permiss\u00E3o para mover TODOS os NFTs\",\n    reason_transfer_tokens: \"Transfer\u00EAncia de tokens/NFT\",\n    domainChecksLabel: \"Checagens de dom\u00EDnio\",\n    domainChecksDesc: \"Alertas por padr\u00F5es suspeitos no dom\u00EDnio quando n\u00E3o estiver na allowlist.\",\n    allowlistLabel: \"Allowlist (dom\u00EDnios confi\u00E1veis)\",\n    allowlistDesc: \"Um dom\u00EDnio por linha. Ex.: opensea.io\",\n    vaultTitle: \"Cofre SignGuard\",\n    vaultDesc: \"Contratos nesta lista nunca podem ser transacionados sem desbloqueio expl\u00EDcito nas op\u00E7\u00F5es.\",\n    vaultAddLabel: \"Adicionar contrato ao cofre\",\n    vaultAddButton: \"Adicionar ao Cofre\",\n    vaultListLabel: \"Contratos bloqueados\",\n    vaultListEmpty: \"Nenhum contrato no cofre.\",\n    vaultRemove: \"Remover\",\n    vaultInvalidAddress: \"Endere\u00E7o inv\u00E1lido. Use 0x e 40 caracteres hexadecimais.\",\n    vaultAlreadyAdded: \"Este contrato j\u00E1 est\u00E1 no cofre.\",\n    vaultBlockedMessage: \"SignGuard: Ativo Bloqueado no Cofre. Desbloqueie nas op\u00E7\u00F5es para continuar.\",\n    vaultBlockedTitle: \"Cofre bloqueou esta a\u00E7\u00E3o\",\n    vaultBlockedReason: \"O contrato/ativo est\u00E1 no Cofre. Desbloqueie temporariamente para prosseguir.\",\n    vault_unlock_5min: \"Desbloquear 5 min\",\n    vault_unlock_30min: \"Desbloquear 30 min\",\n    vault_unlocked_toast: \"Desbloqueado por {n} min\",\n    overlay_temp_allow_10min: \"Permitir por 10 min\",\n    overlay_temp_allow_toast: \"Permitido por 10 min\",\n    page_risk_warning: \"P\u00E1gina com poss\u00EDvel risco detectado.\",\n    reason_page_risk_high: \"P\u00E1gina com risco alto detectado (ex.: lookalike, clickjacking).\",\n    reason_page_risk_medium: \"P\u00E1gina com risco m\u00E9dio (ex.: frases suspeitas, overlay).\",\n    addSuggested: \"Adicionar sugeridos\",\n    save: \"Salvar\",\n    saved: \"Salvo\",\n\n    intelTitle: \"Threat Intel\",\n    intelSubtitle: \"Listas de dom\u00EDnios (fontes plug\u00E1veis) usadas na an\u00E1lise.\",\n    intelTrustedCountLabel: \"Dom\u00EDnios confi\u00E1veis\",\n    intelBlockedCountLabel: \"Dom\u00EDnios bloqueados\",\n    intelBlockedAddressCountLabel: \"Endere\u00E7os bloqueados\",\n    intelUpdatedAtLabel: \"\u00DAltima atualiza\u00E7\u00E3o\",\n    intelUpdateNow: \"Atualizar agora\",\n    enableIntelLabel: \"Usar Threat Intel\",\n    enableIntelDesc: \"Usa listas de dom\u00EDnios confi\u00E1veis/bloqueados na an\u00E1lise.\",\n    customTrustedDomainsLabel: \"Dom\u00EDnios confi\u00E1veis (lista personalizada)\",\n    customTrustedDomainsDesc: \"Um por linha. Ex.: meusite.io\",\n    customBlockedDomainsLabel: \"Dom\u00EDnios bloqueados (lista personalizada)\",\n    customBlockedDomainsDesc: \"Um por linha. Sempre bloqueados.\",\n    exportListsLabel: \"Exportar listas\",\n\n    privacyLimitsTitle: \"Privacidade & Limita\u00E7\u00F5es\",\n    privacyLimitsLine1: \"A extens\u00E3o n\u00E3o acessa sua seed/frase secreta e n\u00E3o tem cust\u00F3dia.\",\n    privacyLimitsLine2: \"Ela analisa dom\u00EDnios e dados de transa\u00E7\u00E3o exibidos pelo navegador para alertas. N\u00E3o garante 100%.\",\n    privacyLimitsLine3: \"Threat intel pode ser atualizado via fontes p\u00FAblicas (opcional).\",\n    cloudIntelOptInLabel: \"Permitir checagens externas\",\n    cloudIntelOptInDesc: \"Mais prote\u00E7\u00E3o; pode enviar dom\u00EDnio/endere\u00E7os para valida\u00E7\u00E3o (preparado para P1).\",\n    showUsdLabel: \"Exibir valores em USD\",\n    showUsdDesc: \"Converte valores da moeda nativa e tokens para d\u00F3lar (quando dispon\u00EDvel).\",\n    tabSettings: \"Configura\u00E7\u00F5es\",\n    tabHistory: \"Hist\u00F3rico\",\n    tabPlan: \"Plano\",\n    historySubtitle: \"\u00DAltimas decis\u00F5es do overlay.\",\n    historyExport: \"Exportar JSON\",\n    historyClear: \"Limpar\",\n    historyEmpty: \"Nenhum registro.\",\n    request_expired_toast: \"Solicita\u00E7\u00E3o expirada. Refa\u00E7a a a\u00E7\u00E3o no site e tente novamente.\",\n    failopen_armed_banner: \"An\u00E1lise demorou. Voc\u00EA pode Continuar mesmo assim ou Cancelar.\",\n    decision_allow: \"Permitido\",\n    decision_block: \"Bloqueado\",\n    planSubtitle: \"Gerencie seu plano e licen\u00E7a.\",\n    planCurrent: \"Plano atual\",\n    planLicenseKey: \"Chave de licen\u00E7a\",\n    planActivate: \"Ativar\",\n    planGoPro: \"Assinar PRO\",\n    // Options: Safety notes + debug\n    safetyNotesTitle: \"Limita\u00E7\u00F5es & seguran\u00E7a\",\n    safetyNotesLine1: \"Esta extens\u00E3o monitora solicita\u00E7\u00F5es feitas por carteiras injetadas (window.ethereum / window.solana).\",\n    safetyNotesLine2: \"Conex\u00F5es via QR/WalletConnect podem n\u00E3o ser interceptadas. Sempre verifique na sua carteira.\",\n    safetyNotesLinkRevoke: \"revoke.cash\",\n    safetyNotesLinkEtherscan: \"etherscan.io\",\n    debugModeLabel: \"Modo debug\",\n    debugModeDesc: \"Armazena os \u00FAltimos 20 eventos (sem payload grande) para suporte.\",\n    exportDebug: \"Exportar\",\n\n    // Overlay: intent + permission + copy\n    looks_like: \"Parece:\",\n    intent_NFT_PURCHASE: \"Compra de NFT\",\n    intent_SWAP: \"Swap\",\n    intent_APPROVAL: \"Permiss\u00E3o\",\n    intent_SEND: \"Envio\",\n    intent_UNKNOWN: \"Desconhecido\",\n    intent_ETH_TRANSFER: \"Envio de ETH\",\n    intent_TOKEN_TRANSFER: \"Transfer\u00EAncia de token\",\n    intent_NFT_TRANSFER: \"Transfer\u00EAncia de NFT\",\n    intent_CONTRACT_INTERACTION: \"Intera\u00E7\u00E3o com contrato\",\n    intent_SWITCH_CHAIN: \"Troca de rede\",\n    intent_ADD_CHAIN: \"Adicionar rede\",\n    intent_WATCH_ASSET: \"Adicionar token\",\n    intent_SOLANA: \"Assinatura/Transa\u00E7\u00E3o Solana\",\n    intent_SIGNATURE: \"Assinatura\",\n    intent_TYPED_DATA: \"Dados tipados\",\n    wallet_label: \"Carteira\",\n    wallet_detecting: \"Detectando\u2026\",\n    wallet_evm_generic: \"Carteira EIP-1193\",\n    trust_disclaimer: \"Lista de refer\u00EAncia \u2260 garantia. Golpistas podem usar dom\u00EDnios parecidos.\",\n    hint_wallet_popup: \"Sua carteira deve abrir agora. Se n\u00E3o abrir, clique no \u00EDcone da carteira e verifique solicita\u00E7\u00F5es pendentes.\",\n    add_chain_network_label: \"Rede a adicionar\",\n    add_chain_rpc_label: \"RPC\",\n    watch_asset_token_label: \"Token a adicionar\",\n    modeLabel: \"Modo:\",\n    popupPauseProtection: \"PAUSAR PROTE\u00C7\u00C3O\",\n    popupStatusProtected: \"Protegido\",\n    popupStatusPaused: \"Pausado\",\n    fortressModeLabel: \"MODO FORTALEZA\",\n    fortressModeDesc: \"Bloqueia todas as aprova\u00E7\u00F5es de tokens, exceto em sites confi\u00E1veis.\",\n    fortress_block_message: \"SignGuard Fortaleza: Aprova\u00E7\u00E3o bloqueada em site desconhecido. Desative o modo Fortaleza para prosseguir.\",\n    honeypot_message: \"\uD83E\uDEA4 HONEYPOT: Voc\u00EA pode comprar, mas N\u00C3O poder\u00E1 vender.\",\n    info_unavailable: \"Informa\u00E7\u00E3o indispon\u00EDvel.\",\n    explain_switch_short: \"O site pediu para trocar a rede (chain) da sua carteira.\",\n    human_chain_reco: \"Continue apenas se voc\u00EA esperava a troca de rede e ela parece correta.\",\n    trustReasonAllowlisted: \"Dom\u00EDnio est\u00E1 em uma lista confi\u00E1vel (seed).\",\n    trustReasonPhishingBlacklist: \"Dom\u00EDnio est\u00E1 em blacklist de phishing (lista de refer\u00EAncia).\",\n    fee_unknown_wallet_will_estimate: \"Taxa: ser\u00E1 exibida pela carteira\",\n    label_you_send: \"Voc\u00EA envia\",\n    label_fee_likely: \"Taxa estimada (prov\u00E1vel)\",\n    label_fee_max: \"Taxa m\u00E1xima (pior caso)\",\n    label_total_likely: \"Total prov\u00E1vel\",\n    label_total_max: \"Total m\u00E1ximo\",\n    fee_gt_value: \"A taxa m\u00E1xima \u00E9 MAIOR que o valor enviado. Confirme se faz sentido.\",\n    check_wallet_network_fee: \"Voc\u00EA ainda n\u00E3o viu a taxa. Verifique o 'Network fee' na carteira antes de confirmar.\",\n    label_max_fee: \"Taxa m\u00E1xima\",\n    label_max_total: \"Total m\u00E1ximo\",\n    switch_summary_no_gas: \"Troca de rede normalmente n\u00E3o custa gas, mas pode mudar quais ativos voc\u00EA est\u00E1 vendo.\",\n    permission_title: \"Permiss\u00E3o\",\n    permission_token_contract: \"Contrato\",\n    permission_spender: \"Spender\",\n    permission_operator: \"Operator\",\n    permission_unlimited: \"Ilimitado\",\n    approval_unlimited_detected: \"Aprova\u00E7\u00E3o ilimitada detectada\",\n    permit_signature_detected: \"Assinatura tipo Permit detectada (pode autorizar gasto de tokens)\",\n    token_transfer_detected: \"Transfer\u00EAncia de token detectada\",\n    nft_transfer_detected: \"Transfer\u00EAncia de NFT detectada\",\n    transfer_token_title: \"Transfer\u00EAncia de token\",\n    transfer_nft_title: \"Transfer\u00EAncia de NFT\",\n    transfer_amount: \"Quantidade\",\n    transfer_token_id: \"Token ID\",\n    yes: \"Sim\",\n    no: \"N\u00E3o\",\n    copy: \"Copiar\",\n    chainChangeTitle: \"Solicita\u00E7\u00E3o de troca/adicionar rede\",\n    watchAssetTitle: \"Solicita\u00E7\u00E3o de adicionar ativo\",\n\n    domainPunycodeReason: \"Dom\u00EDnio usa punycode (xn--); verifique a URL.\",\n    reason_high_gas: \"Taxa de gas alta em rela\u00E7\u00E3o ao valor.\",\n    reason_new_spender: \"Novo spender \u2014 verifique.\",\n    reason_contract_target: \"Destino \u00E9 contrato.\",\n    reason_known_bad_spender: \"Spender bloqueado.\",\n    reason_known_safe_spender: \"Spender na allowlist.\",\n    reason_unlimited_approval: \"Simula\u00E7\u00E3o: aprova\u00E7\u00E3o ilimitada detectada.\",\n    reason_set_approval_for_all: \"Simula\u00E7\u00E3o: ApprovalForAll (permite mover todos os NFTs).\",\n    reason_snap_invoke: \"Snaps podem executar c\u00F3digo na carteira. Confirme a origem.\",\n    reason_sign_tx: \"Assinatura de transa\u00E7\u00E3o sem envio imediato. Pode ser usada depois para broadcast.\",\n    reason_raw_broadcast: \"Broadcast de transa\u00E7\u00E3o j\u00E1 assinada. N\u00E3o h\u00E1 confirma\u00E7\u00E3o visual pr\u00E9via do conte\u00FAdo.\",\n    reason_read_permissions: \"O site est\u00E1 a ler as permiss\u00F5es j\u00E1 concedidas \u00E0 carteira.\",\n    summary_title_snaps: \"Snaps / Extens\u00F5es da carteira\",\n    summary_title_read_permissions: \"Leitura de permiss\u00F5es\",\n    summary_title_sign_tx: \"Assinatura de transa\u00E7\u00E3o\",\n    summary_title_raw_tx: \"Broadcast de transa\u00E7\u00E3o assinada\",\n    summary_title_switch_chain: \"Troca de rede\",\n    domainDoubleDashReason: \"Dom\u00EDnio cont\u00E9m h\u00EDfen duplo (suspeito).\",\n    domainNumberPatternReason: \"Dom\u00EDnio com muitos n\u00FAmeros (comum em phishing).\",\n    domainLookalikeReason: \"Poss\u00EDvel imita\u00E7\u00E3o do dom\u00EDnio oficial de {legit}.\",\n    suspiciousWebsitePatterns: \"Padr\u00F5es suspeitos no site.\",\n    page_risk_suspicious_banner: \"\u26A0\uFE0F SignGuard: Site Suspeito Detetado\",\n    connectTitle: \"Conectar carteira\",\n    connectReason: \"O site quer conectar \u00E0 sua carteira.\",\n    walletRequestPermissionsTitle: \"Solicitar permiss\u00F5es\",\n    walletRequestPermissionsReason: \"O site quer permiss\u00F5es adicionais na carteira.\",\n    typedDataWarnReason: \"Assinatura de dados estruturados (EIP-712); pode autorizar a\u00E7\u00F5es.\",\n    signatureRequest: \"Pedido de assinatura\",\n    rawSignWarnReason: \"Assinatura de mensagem raw; pode autorizar a\u00E7\u00F5es fora da blockchain.\",\n    tokenApproval: \"Aprova\u00E7\u00E3o de token\",\n    unlimitedApprovalReason: \"Aprova\u00E7\u00E3o ilimitada detectada (MAX_UINT256).\",\n    unlimitedApprovalDetected: \"Aprova\u00E7\u00E3o ilimitada detectada\",\n    nftOperatorApprovalReason: \"Permiss\u00E3o para mover TODOS os NFTs da cole\u00E7\u00E3o.\",\n    nftOperatorApproval: \"Permiss\u00E3o de operador NFT\",\n    txPreview: \"Visualiza\u00E7\u00E3o da transa\u00E7\u00E3o\",\n    txWarnReason: \"Transa\u00E7\u00E3o on-chain; confira valor, destino e rede.\",\n    unknownMethodReason: \"M\u00E9todo de carteira desconhecido.\",\n    warningsDisabledReason: \"Alertas desativados nas configura\u00E7\u00F5es.\",\n    analyzing: \"Analisando\u2026\",\n    analyzing_subtitle: \"Site \u2022 M\u00E9todo\",\n    analyzing_hint: \"Validando dom\u00EDnio e estimando impacto\",\n    fallback_partial_check: \"Sem verifica\u00E7\u00E3o completa agora \u2014 revise os detalhes abaixo antes de prosseguir.\",\n    fallback_partial_verification: \"Verifica\u00E7\u00E3o parcial agora \u2014 revise os detalhes abaixo antes de prosseguir.\",\n    loading_base: \"Carregando base\u2026\",\n    analyzerUnavailableTitle: \"Analisador indispon\u00EDvel\",\n    analysis_unavailable: \"An\u00E1lise indispon\u00EDvel \u2014 confira na carteira antes de continuar.\",\n    dados_parciais_title: \"Dados parciais \u2014 confirme na carteira\",\n    dados_parciais_subtitle: \"Exibindo o que foi poss\u00EDvel analisar. Verifique os detalhes na carteira antes de continuar.\",\n    risk_low: \"Baixo\",\n    risk_warn: \"Aten\u00E7\u00E3o\",\n    risk_high: \"Alto\",\n    risk_block: \"Bloqueado\",\n    trustReasonAllowlistedMatched: \"Dom\u00EDnio em allowlist: {matched}.\",\n    list_empty_domains: \"Lista vazia. Abra as op\u00E7\u00F5es para adicionar dom\u00EDnios confi\u00E1veis.\",\n    btn_open_options: \"Abrir op\u00E7\u00F5es\",\n    default_human_switch_what: \"Troca a rede ativa da carteira (ex.: Ethereum \u2192 outra rede).\",\n    default_human_switch_risk: \"Voc\u00EA pode assinar/transacionar na rede errada se a troca n\u00E3o for esperada.\",\n    default_human_switch_safe: \"Confirme a rede solicitada e se o site \u00E9 o correto.\",\n    default_human_switch_next: \"Se estiver certo, aprove na carteira. Se estiver estranho, cancele.\",\n    default_human_contract_what: \"Envia uma transa\u00E7\u00E3o para um contrato (a\u00E7\u00E3o dentro do dApp).\",\n    default_human_contract_risk: \"O custo real pode variar e a a\u00E7\u00E3o pode mover ativos/tokens via contrato.\",\n    default_human_contract_safe: \"Confira destino (to), rede, valor e a taxa (Network fee) na carteira.\",\n    default_human_contract_next: \"Se os detalhes baterem, prossiga. Caso contr\u00E1rio, cancele.\",\n    default_human_eth_what: \"Envia ETH diretamente para um endere\u00E7o.\",\n    default_human_eth_risk: \"Transfer\u00EAncias s\u00E3o irrevers\u00EDveis se o destino estiver errado.\",\n    default_human_eth_safe: \"Verifique o endere\u00E7o e o valor. Desconfie de links/encurtadores.\",\n    default_human_eth_next: \"S\u00F3 confirme se voc\u00EA reconhece o destinat\u00E1rio.\",\n    default_human_typed_what: \"Assinatura off-chain (EIP-712). Pode autorizar a\u00E7\u00F5es sem pagar gas.\",\n    default_human_typed_risk: \"Pode conceder permiss\u00F5es/autoriza\u00E7\u00F5es (ex.: permit/approval) dependendo do conte\u00FAdo.\",\n    default_human_typed_safe: \"Revise o que est\u00E1 sendo autorizado (spender/operator) e o dom\u00EDnio/contrato.\",\n    default_human_typed_next: \"Se n\u00E3o entender, cancele e valide no site oficial do dApp.\",\n    default_human_generic_what: \"A\u00E7\u00E3o solicitada pela dApp.\",\n    default_human_generic_risk: \"Se algo n\u00E3o fizer sentido, cancele.\",\n    default_human_generic_safe: \"Confirme dom\u00EDnio, rede e detalhes na carteira.\",\n    default_human_generic_next: \"Prossiga apenas se tudo estiver correto.\",\n    verdict_ok: \"OK\",\n    verdict_warn: \"Aten\u00E7\u00E3o\",\n    verdict_high: \"Risco alto\",\n    verdict_block: \"Bloqueado\",\n    coverage_label: \"Cobertura\",\n    coverage_limited: \"cobertura limitada\",\n    trusted_domain_ref_empty: \"Lista de refer\u00EAncia ainda n\u00E3o carregou.\",\n    trusted_domain_ref_loading: \"Carregando lista de refer\u00EAncia\u2026\",\n    trusted_domain_ref_refresh: \"Atualizar listas\",\n    trusted_domain_ref_view_more: \"Ver mais\",\n    trusted_domains_loading: \"Carregando lista de refer\u00EAncia\u2026\",\n    trusted_domains_more: \"+{n}\",\n    trusted_domains_search_placeholder: \"Filtrar dom\u00EDnios\u2026\",\n    trusted_domains_update_now: \"Atualizar agora\",\n    trusted_domains_auto_update: \"Atualiza automaticamente nas op\u00E7\u00F5es\",\n    banner_ok_no_known_threats: \"OK: nenhum sinal conhecido de golpe/scam detectado.\",\n    banner_block_known_threat: \"Bloqueado: amea\u00E7a conhecida detectada.\",\n    banner_local_verification: \"Aten\u00E7\u00E3o: verifica\u00E7\u00E3o local (cache). Revise os detalhes abaixo antes de prosseguir.\",\n    banner_basic_verification: \"Aten\u00E7\u00E3o: verifica\u00E7\u00E3o b\u00E1sica. Revise cuidadosamente os detalhes antes de prosseguir.\",\n    list_site_reputation: \"Reputa\u00E7\u00E3o do site\",\n    list_site_trusted: \"Confi\u00E1vel\",\n    list_site_blocked: \"Bloqueado\",\n    list_site_unknown: \"Desconhecido\",\n    updated_x_hours: \"Base atualizada h\u00E1 {n} hora(s)\",\n    updated_x_days: \"Base atualizada h\u00E1 {n} dia(s)\",\n    tip_check_wallet_details: \"Confira valor, rede e taxa na carteira.\",\n    no_alerts_known: \"Nenhum alerta conhecido foi detectado para este contexto.\",\n    still_review_wallet: \"Mesmo assim, revise na carteira (valor, rede, destino e taxa).\",\n    site_status_known: \"refer\u00EAncia conhecida\",\n    site_status_not_in_list: \"Site n\u00E3o est\u00E1 na lista de refer\u00EAncia\",\n    destination_contract: \"Contrato\",\n    destination_wallet: \"Carteira\",\n    overlay_coverage_title: \"Cobertura de seguran\u00E7a\",\n    overlay_simulation_title: \"Simula\u00E7\u00E3o\",\n    overlay_address_intel_title: \"Intel de endere\u00E7os\",\n    btn_copy: \"Copiar\",\n    btn_copy_json: \"Copiar JSON\",\n    chain_not_recognized: \"Rede n\u00E3o reconhecida\",\n    simulation_skipped_caution: \"Sem simula\u00E7\u00E3o \u2014 valide com mais cautela.\",\n    toast_copied: \"Copiado\",\n    btn_ver_menos: \"Ver menos\",\n  },\n  en: {\n    tech_displayAction: \"Action (classification)\",\n    tech_methodRaw: \"Method (raw)\",\n    tech_recommendScoreLevel: \"Recommend/score/level\",\n    tech_reasons: \"Reasons\",\n    tech_decoded: \"Decoded\",\n    dash: \"\u2014\",\n    tx_to: \"To\",\n    tx_data_length: \"Data length\",\n    more_whatItDoes: \"What it does\",\n    more_risks: \"Risks\",\n    more_safeNotes: \"Safety notes\",\n    more_nextSteps: \"Next steps\",\n    // Brand\n    extName: \"Crypto Wallet SignGuard\",\n\n    // Overlay - generic labels\n    overlay_analyzing: \"Analyzing Transaction...\",\n    overlay_simulating: \"SignGuard is simulating the outcome.\",\n    overlay_safe: \"Looks Safe\",\n    overlay_attention: \"Attention Detected\",\n    overlay_action: \"Action\",\n    overlay_simulation_balance: \"Balance Simulation\",\n    overlay_approvals_detected: \"Approvals detected\",\n    overlay_confirm_allow_msg: \"Are you sure? This bypasses protection.\",\n    overlay_confirm_allow: \"Confirm allow once\",\n    overlay_try_again: \"Try again\",\n    overlay_analysis_taking_long: \"Analysis is taking too long.\",\n    overlay_fee_calculated: \"Fees calculated.\",\n    overlay_finishing: \"Finishing analysis...\",\n    overlay_typed_data_card_title: \"Signature (EIP-712)\",\n    overlay_typed_data_sign_warning: \"Signing this may allow future spending without another confirmation.\",\n    overlay_allowance_loading: \"Current allowance: \u2026\",\n    overlay_allowance_current: \"Current allowance: \",\n    overlay_allowance_approved: \"Approved\",\n    overlay_allowance_not_approved: \"Not approved\",\n    overlay_allowance_unlimited: \"Unlimited\",\n    simulation_no_changes: \"No balance changes detected.\",\n    tx_unknown: \"Unknown Transaction\",\n    dapp_unknown: \"Unknown DApp\",\n    overlay_requested_title: \"What is being requested\",\n    overlay_site_trusted_title: \"Is the site trusted?\",\n    overlay_summary_title: \"Summary (plain language)\",\n    overlay_recommended_title: \"Recommended action\",\n    overlay_note_title: \"Note\",\n\n    // Overlay - details sections\n    details_tx_title: \"Transaction details\",\n    details_tech_title: \"Technical details\",\n    details_more_title: \"More explanations\",\n\n    // Queue\n    queue_indicator: \"Queue: {pos} of {total}\",\n\n    // Action titles\n    action_CONNECT_title: \"Connect wallet\",\n    action_REQUEST_PERMISSIONS_title: \"Request permissions\",\n    action_SWITCH_CHAIN_title: \"Switch network\",\n    action_ADD_CHAIN_title: \"Add network\",\n    action_SIGN_MESSAGE_title: \"Sign message\",\n    action_SIGN_TYPED_DATA_title: \"Sign typed data\",\n    action_SEND_TX_title: \"Send transaction\",\n    action_SEND_TX_contract_title: \"Contract interaction\",\n    action_SEND_TX_eth_title: \"Send ETH\",\n    action_WATCH_ASSET_title: \"Add token/asset\",\n    action_SOLANA_title: \"Solana signature/transaction\",\n    action_UNKNOWN_title: \"Request\",\n\n    // Summary bullets\n    summary_CONNECT_1: \"The site wants to see your addresses and current network.\",\n    summary_CONNECT_2: \"It may request signatures/transactions later.\",\n    summary_CONNECT_3: \"Only connect if you trust the site.\",\n    summary_REQUEST_PERMISSIONS_1: \"The site is requesting additional wallet permissions.\",\n    summary_REQUEST_PERMISSIONS_2: \"Review permissions in your wallet before accepting.\",\n    summary_SWITCH_CHAIN_1: \"The site wants to switch your wallet network (chain).\",\n    summary_SWITCH_CHAIN_2: \"Switching networks usually costs no gas.\",\n    explain_connect_title: \"Connect wallet\",\n    explain_connect_short: \"Wallet login (share your public address)\",\n    explain_connect_why: \"This lets the site show your account and ask for signatures/approvals/transactions later.\",\n    explain_sign_title: \"Sign a message\",\n    explain_sign_short: \"No gas, but signatures can authorize actions\",\n    explain_sign_why: \"Sites use signatures to log in, verify ownership, or authorize off-chain actions.\",\n    explain_typed_title: \"Sign structured data\",\n    explain_typed_short: \"Typed-data signatures can include permits/authorizations\",\n    explain_typed_why: \"Typed-data is often used for permits (token approvals without a separate on-chain approve).\",\n    explain_tx_title: \"Send a transaction\",\n    explain_tx_short: \"On-chain action (gas fees may apply)\",\n    explain_tx_why: \"This will create an on-chain transaction if you approve it in your wallet.\",\n    explain_switch_title: \"Switch network\",\n    explain_switch_why: \"Some sites require a specific network to function.\",\n    explain_addchain_title: \"Add network\",\n    explain_addchain_short: \"Add a new chain configuration to your wallet\",\n    explain_add_chain_short: \"Add network to wallet\",\n    add_chain_review_rpc: \"Malicious RPC can deceive balances/transactions; verify the source.\",\n    add_chain_verify_chainid: \"Verify chainId and network name before adding.\",\n    explain_addchain_why: \"Wallet may add RPC details for a chain requested by the site.\",\n    explain_watchasset_title: \"Watch asset\",\n    explain_watchasset_short: \"Add a token/asset to your wallet UI\",\n    explain_watch_asset_short: \"Add token/asset to wallet\",\n    watch_asset_no_spend_but_risk: \"Adding a token does not spend funds, but scam tokens exist; verify the contract.\",\n    watch_asset_verify_contract: \"Verify the contract address on a trusted explorer.\",\n    explain_watchasset_why: \"This does not spend funds, but confirm the token details are correct.\",\n    explain_generic_title: \"Wallet request\",\n    explain_generic_short: \"A site is requesting a wallet action\",\n    explain_generic_why: \"Review details in your wallet and confirm the site URL.\",\n    human_connect_whatIs: \"Connects your wallet address to this site (like logging in).\",\n    human_connect_sees_1: \"Your public address (and account selection)\",\n    human_connect_sees_2: \"Your network/chain selection\",\n    human_connect_sees_3: \"Public on-chain activity (tokens/NFTs are public data)\",\n    human_connect_not_1: \"It does NOT reveal your seed phrase or wallet password\",\n    human_connect_not_2: \"It does NOT move funds automatically by itself\",\n    human_connect_why_1: \"To show your account and balances in the UI\",\n    human_connect_why_2: \"To let you sign messages (login/verification)\",\n    human_connect_why_3: \"To request approvals/transactions later (with your confirmation)\",\n    human_connect_risk_1: \"Privacy/tracking: it can link your address to this site\",\n    human_connect_risk_2: \"Phishing steps: next prompts may ask for signatures/approvals\",\n    human_connect_risk_3: \"Lookalike domains: fake sites often start with a harmless connect\",\n    human_connect_safe_1: \"Treat connect like sharing an identity: only do it on sites you recognize.\",\n    human_connect_next_1: \"Double-check the domain (spelling, HTTPS, no punycode)\",\n    human_connect_next_2: \"If unsure, cancel and open the site from a trusted bookmark\",\n    human_connect_reco_suspicious: \"Cancel and verify the URL in another way (bookmark/search), then try again.\",\n    human_connect_reco_ok: \"Continue only if you recognize the site and the URL looks right.\",\n    human_sign_whatIs: \"Creates a cryptographic signature. It usually does not cost gas, but it can authorize actions.\",\n    human_sign_risk_1: \"Signing unknown text can approve off-site actions or logins you didn't intend\",\n    human_sign_risk_2: \"Blind signing can hide what you're authorizing\",\n    human_typed_whatIs: \"Signs structured data (typed-data). Often used for permits/authorizations.\",\n    human_typed_risk_1: \"Typed-data may include token permits that behave like approvals\",\n    human_sign_safe_1: \"Prefer wallets that show clear human-readable signing details.\",\n    human_sign_next_1: \"Verify the site URL and read the message/typed-data carefully\",\n    human_sign_next_2: \"If you see vague prompts, cancel and ask the site for context\",\n    human_sign_reco_suspicious: \"Cancel. Suspicious domains + signature prompts are a common phishing pattern.\",\n    human_sign_reco_ok: \"Only continue if you understand what the signature is for and trust the site.\",\n    human_approve_whatIs: \"An approval lets a contract spend your tokens later (up to the approved amount).\",\n    human_approve_risk_1: \"Approvals can be abused if the spender contract is malicious or compromised\",\n    human_approve_risk_unlimited: \"Unlimited approval means it may spend ALL your token balance\",\n    human_approve_safe_1: \"Prefer approving the minimum needed amount whenever possible.\",\n    human_approve_next_1: \"Check the spender address/operator and whether you recognize the dApp\",\n    human_approve_next_2: \"Consider revoking approvals later if you no longer use the site\",\n    human_approve_reco: \"Continue only if you trust the site and the spender makes sense.\",\n    human_approve_reco_unlimited: \"Avoid unlimited approvals unless you strongly trust the site and understand the risk.\",\n    human_setApprovalForAll_whatIs: \"Gives an operator permission to move ALL NFTs in a collection on your behalf.\",\n    human_setApprovalForAll_risk_1: \"This can allow draining NFTs if the operator is malicious or compromised\",\n    human_setApprovalForAll_safe_1: \"Only approve operators you fully recognize (e.g., known marketplaces).\",\n    human_setApprovalForAll_next_1: \"Verify the operator address and confirm the site is the intended marketplace\",\n    human_setApprovalForAll_reco: \"Cancel unless you are on a recognized marketplace and expect this action.\",\n    human_tx_whatIs: \"This will create an on-chain transaction if you approve it in your wallet.\",\n    human_tx_risk_1: \"Transactions can move funds or change permissions depending on the contract call\",\n    human_tx_safe_1: \"Always verify recipient, value, and the contract you're interacting with.\",\n    human_tx_next_1: \"Check the destination (to), value, and decoded action (if available)\",\n    human_tx_reco_suspicious: \"Cancel. Do not send transactions from suspicious domains.\",\n    human_tx_reco_ok: \"Continue only if you intended this action and the details look correct.\",\n    human_chain_whatIs: \"Changes the selected network in your wallet.\",\n    human_chain_risk_1: \"Wrong networks/RPCs can mislead you about assets or transactions\",\n    human_chain_safe_1: \"Only switch/add networks you recognize.\",\n    human_chain_next_1: \"Confirm chain name and chainId in the wallet prompt\",\n    human_watchasset_whatIs: \"Adds a token/asset to your wallet UI for easier viewing.\",\n    human_watchasset_risk_1: \"Fake tokens can impersonate real ones\u2014verify contract address and symbol\",\n    human_watchasset_safe_1: \"Cross-check token details on a trusted explorer (e.g., Etherscan).\",\n    human_watchasset_next_1: \"Verify token contract address and decimals\",\n    human_watchasset_reco: \"Continue only if token details match an official source.\",\n    human_generic_whatIs: \"A site requested a wallet action. Review details carefully.\",\n    human_generic_risk_1: \"Unknown prompts can be part of phishing flows\",\n    human_generic_safe_1: \"If in doubt, cancel and verify the site.\",\n    human_generic_next_1: \"Check the URL and read the wallet prompt details\",\n    human_generic_reco: \"Continue only if you understand and expected this request.\",\n    human_revoke_link_text: \"Revoke permissions later: revoke.cash\",\n    trustReasonNotHttps: \"Not HTTPS (higher risk of spoofing/injection).\",\n    trustReasonManyHyphens: \"Many hyphens in the domain (common in lookalikes).\",\n    trustReasonSuspiciousKeywords: \"Domain contains high-risk keywords (login/verify/secure/...).\",\n    trustReasonBrandLookalike: \"Brand-like wording in domain but not the official domain.\",\n    trustReasonManySubdomains: \"Unusually deep subdomain structure.\",\n    trustReasonNoHost: \"Could not read the site hostname.\",\n    trustReasonAllowlistedVariant: \"Domain matches a trusted pattern.\",\n    trustReasonUnknown: \"No strong signals either way.\",\n    summary_ADD_CHAIN_1: \"The site wants to add a new network to your wallet.\",\n    summary_ADD_CHAIN_2: \"Carefully verify the chainId and network name.\",\n    summary_SIGN_MESSAGE_1: \"You are signing a message (not a transaction).\",\n    summary_SIGN_MESSAGE_2: \"Signatures can be used for logins/terms/permissions.\",\n    summary_SIGN_TYPED_DATA_1: \"You are signing structured data (EIP-712).\",\n    summary_SIGN_TYPED_DATA_2: \"This may authorize spending/orders depending on the content.\",\n    summary_SIGN_TYPED_DATA_3: \"Verify the spender/contract involved.\",\n    summary_SEND_TX_1: \"You are sending an on-chain transaction.\",\n    summary_SEND_TX_2: \"This may move ETH/tokens or interact with a contract.\",\n    summary_SEND_TX_3: \"Verify value, network and destination before confirming.\",\n    summary_WATCH_ASSET_1: \"The site wants to add a token/asset to your wallet.\",\n    summary_WATCH_ASSET_2: \"Verify the token symbol and contract address.\",\n    summary_SOLANA_1: \"Solana signature or transaction. Values will be confirmed in your wallet.\",\n    summary_UNKNOWN_1: \"The site is making an unknown wallet request.\",\n    summary_UNKNOWN_2: \"If you don't recognize it, cancel.\",\n\n    // Buttons / friction\n    btn_cancel: \"Cancel\",\n    btn_block: \"Block\",\n    btn_continue: \"Continue\",\n    toast_request_expired: \"Request expired. Please retry the action on the site.\",\n    simulation_tx_will_fail: \"THIS TRANSACTION WILL FAIL\",\n    btn_close: \"Close\",\n    btn_proceed_anyway: \"Proceed anyway\",\n    override_checkbox: \"I understand the risk and want to proceed\",\n    override_countdown: \"({s}s)\",\n\n    tip_revoke: \"Revoke permissions later: revoke.cash\",\n    cost_summary_title: \"Cost summary\",\n    costs_title: \"Costs and impact\",\n    impact_title: \"Impact\",\n    permission_for: \"Permission for\",\n    addr_marked_public: \"Flagged in public database\",\n    risk_title: \"Risk and why\",\n    what_to_do_now: \"What to do now\",\n    site_label: \"Site\",\n    network_label: \"Network\",\n    severity_BLOCKED: \"BLOCKED\",\n    severity_HIGH: \"HIGH\",\n    severity_WARN: \"WARNING\",\n    severity_LOW: \"LOW\",\n    cost_you_send: \"You send\",\n    cost_you_receive: \"You receive\",\n    cost_fee_only: \"fee only\",\n    cost_value: \"Value\",\n    cost_fee: \"Estimated fee\",\n    cost_total: \"Estimated total\",\n    cost_fee_unknown: \"A network fee will be charged (confirm in wallet)\",\n    network_switch_title: \"Network switch\",\n    network_current: \"Current network\",\n    network_requested: \"Requested network\",\n    trusted_domain_ref_title: \"Trusted domains (reference)\",\n    tx_cost_sending: \"You are sending {value} + network fee\",\n    tx_cost_gas_only: \"Even with no native currency sent, you will pay a network fee (gas)\",\n    gas_calculating: \"calculating\u2026\",\n\n    tx_destination: \"Destination\",\n    token_verified_uniswap: \"Token Verified (Uniswap List)\",\n    token_unknown_unverified: \"Token Unknown (Not Verified)\",\n    tx_contract_method: \"Contract/method\",\n    tx_max_gas_fee: \"Max gas fee\",\n    tx_max_total: \"Max total\",\n    tx_fee_estimated_by_wallet: \"The wallet will estimate the fee in the next step.\",\n\n    network_target: \"Target network\",\n    switch_no_gas: \"Switching networks usually costs NO gas.\",\n    switch_next_step_gas: \"The next step (purchase/transaction) will have a network fee.\",\n    switch_note_inline: \"Switching networks usually costs NO gas. The next step (purchase/transaction) will have a network fee.\",\n    sendtx_reco: \"Confirm in your wallet only if the details (value, network and contract) are correct.\",\n\n    // Risk/trust labels\n    risk_LOW: \"Low\",\n    risk_WARN: \"Warning\",\n    risk_HIGH: \"High\",\n    recommend_ALLOW: \"Allow\",\n    recommend_WARN: \"Warn\",\n    recommend_HIGH: \"High risk\",\n    recommend_BLOCK: \"Block\",\n    trust_unknown: \"Unknown\",\n    trust_suspicious: \"Suspicious\",\n    trust_likelyOfficial: \"Known domain (reference list)\",\n    trust_domainNotRecognized: \"Domain not recognized\",\n\n    // Phishing hard-block\n    phishing_hard_block: \"Domain is in a phishing blacklist. Blocked.\",\n\n    // Toasts\n    toast_extension_updated: \"Extension updated \u2014 reload the tab.\",\n    toast_cannot_analyze: \"Couldn't analyze. Reload the tab.\",\n\n    // Options page\n    optionsTitle: \"Crypto Wallet SignGuard \u2014 Settings\",\n    optionsSubtitle: \"Control when SignGuard should warn and block.\",\n    dashboardLink: \"Dashboard\",\n    onboardingTitle: \"How to use\",\n    onboardingHowTo: \"The extension intercepts sensitive requests (connect, sign, transaction) from injected wallets (window.ethereum / window.solana). When detected, it shows an overlay for you to review before the wallet opens.\",\n    onboardingWhatItDoes: \"Does: warns before connecting, signing, or sending; checks domain against phishing lists; shows transaction intent (swap, NFT, approval).\",\n    onboardingWhatItDoesNot: \"Does not: protect QR/WalletConnect connections; guarantee contracts are safe; replace manual verification.\",\n    onboardingLinkRevoke: \"revoke.cash \u2014 revoke permissions\",\n    onboardingLinkEtherscan: \"Etherscan \u2014 explore transactions\",\n    exportDebugRequiresDebugMode: \"Enable Debug Mode first to export events.\",\n    securityModeLabel: \"Security mode\",\n    securityModeDesc: \"Strict blocks more; Balanced warns; Relaxed reduces friction; Off disables blocking.\",\n    modeStrict: \"Strict\",\n    modeBalanced: \"Balanced\",\n    modeRelaxed: \"Relaxed\",\n    modeOff: \"Off\",\n    strictBlockApprovalsUnlimitedLabel: \"Strict: block unlimited approve\",\n    strictBlockApprovalsUnlimitedDesc: \"Blocks ERC20 unlimited approvals (MAX_UINT256).\",\n    strictBlockSetApprovalForAllLabel: \"Strict: block setApprovalForAll\",\n    strictBlockSetApprovalForAllDesc: \"Blocks permission to move all NFTs.\",\n    strictBlockPermitLikeLabel: \"Strict: block unlimited Permit\",\n    strictBlockPermitLikeDesc: \"Blocks Permit (EIP-2612) unlimited signatures.\",\n    assetEnrichmentEnabledLabel: \"Asset enrichment\",\n    assetEnrichmentEnabledDesc: \"Fetches token symbol/name via eth_call.\",\n    addressIntelEnabledLabel: \"Address threat intel\",\n    addressIntelEnabledDesc: \"Checks spender/operator/to against blacklist.\",\n    riskWarningsLabel: \"Risk warnings\",\n    riskWarningsDesc: \"Shows warnings and recommendations before opening your wallet.\",\n    connectOverlayLabel: \"Overlay on connect\",\n    connectOverlayDesc: \"Also show the overlay for connect/permissions requests.\",\n    blockHighRiskLabel: \"Block high risk\",\n    blockHighRiskDesc: \"Automatically blocks high-risk actions.\",\n    requireTypedOverrideLabel: \"Require override for typed data (high risk)\",\n    requireTypedOverrideDesc: \"For high-risk EIP-712 signatures, requires extra confirmation.\",\n    allowOverrideOnPhishingLabel: \"Allow override on phishing (NOT recommended)\",\n    allowOverrideOnPhishingDesc: \"If disabled (default), phishing blacklist matches are blocked with no option to proceed.\",\n    mode_off_reason: \"OFF mode: no blocking.\",\n    address_flagged_reason: \"Flagged address/contract: {label} ({category})\",\n    addr_sanctioned_block: \"Address is on a sanctions list.\",\n    addr_scam_reported_warn: \"Address marked as suspected/reported.\",\n    addr_phishing_reported_warn: \"Address marked as suspected/reported.\",\n    addr_malicious_contract_warn: \"Contract marked as malicious.\",\n    asset_info_reason: \"Asset: {sym} ({kind})\",\n    reason_permission_tokens: \"Permission to spend tokens\",\n    reason_permission_all_nfts: \"Permission to move ALL NFTs\",\n    reason_transfer_tokens: \"Token/NFT transfer\",\n    domainChecksLabel: \"Domain checks\",\n    domainChecksDesc: \"Warns about suspicious domain patterns when not on your allowlist.\",\n    allowlistLabel: \"Allowlist (trusted domains)\",\n    allowlistDesc: \"One domain per line. Example: opensea.io\",\n    vaultTitle: \"SignGuard Vault\",\n    vaultDesc: \"Contracts in this list can never be transacted without explicit unlock in options.\",\n    vaultAddLabel: \"Add contract to vault\",\n    vaultAddButton: \"Add to Vault\",\n    vaultListLabel: \"Locked contracts\",\n    vaultListEmpty: \"No contracts in vault.\",\n    vaultRemove: \"Remove\",\n    vaultInvalidAddress: \"Invalid address. Use 0x and 40 hex characters.\",\n    vaultAlreadyAdded: \"This contract is already in the vault.\",\n    vaultBlockedMessage: \"SignGuard: Asset Locked in Vault. Unlock in options to continue.\",\n    vaultBlockedTitle: \"Vault blocked this action\",\n    vaultBlockedReason: \"The contract/asset is in the Vault. Unlock temporarily to proceed.\",\n    vault_unlock_5min: \"Unlock 5 min\",\n    vault_unlock_30min: \"Unlock 30 min\",\n    vault_unlocked_toast: \"Unlocked for {n} min\",\n    overlay_temp_allow_10min: \"Allow for 10 min\",\n    overlay_temp_allow_toast: \"Allowed for 10 min\",\n    page_risk_warning: \"Possible risk detected on this page.\",\n    reason_page_risk_high: \"High-risk page detected (e.g. lookalike, clickjacking).\",\n    reason_page_risk_medium: \"Medium-risk page (e.g. suspicious phrases, overlay).\",\n    addSuggested: \"Add suggested\",\n    save: \"Save\",\n    saved: \"Saved\",\n\n    intelTitle: \"Threat Intel\",\n    intelSubtitle: \"Domain lists (pluggable sources) used in analysis.\",\n    intelTrustedCountLabel: \"Trusted domains\",\n    intelBlockedCountLabel: \"Blocked domains\",\n    intelBlockedAddressCountLabel: \"Blocked addresses\",\n    intelUpdatedAtLabel: \"Last update\",\n    intelUpdateNow: \"Update now\",\n    enableIntelLabel: \"Use Threat Intel\",\n    enableIntelDesc: \"Uses trusted/blocked domain lists in analysis.\",\n    customTrustedDomainsLabel: \"Trusted domains (custom list)\",\n    customTrustedDomainsDesc: \"One per line. Example: mysite.io\",\n    customBlockedDomainsLabel: \"Blocked domains (custom list)\",\n    customBlockedDomainsDesc: \"One per line. Always blocked.\",\n    exportListsLabel: \"Export lists\",\n\n    privacyLimitsTitle: \"Privacy & Limitations\",\n    privacyLimitsLine1: \"The extension does not access your seed phrase and has no custody.\",\n    privacyLimitsLine2: \"It analyzes domains and transaction data displayed by the browser for alerts. No 100% guarantee.\",\n    privacyLimitsLine3: \"Threat intel may be updated from public sources (optional).\",\n    cloudIntelOptInLabel: \"Allow external checks\",\n    cloudIntelOptInDesc: \"More protection; may send domain/addresses for validation (prepared for P1).\",\n    showUsdLabel: \"Show USD values\",\n    showUsdDesc: \"Converts native and token amounts to USD when available.\",\n    tabSettings: \"Settings\",\n    tabHistory: \"History\",\n    tabPlan: \"Plan\",\n    historySubtitle: \"Recent overlay decisions.\",\n    historyExport: \"Export JSON\",\n    historyClear: \"Clear\",\n    historyEmpty: \"No entries.\",\n    request_expired_toast: \"Request expired. Redo the action on the site and try again.\",\n    failopen_armed_banner: \"Analysis took too long. You can Continue anyway or Cancel.\",\n    decision_allow: \"Allowed\",\n    decision_block: \"Blocked\",\n    planSubtitle: \"Manage your plan and license.\",\n    planCurrent: \"Current plan\",\n    planLicenseKey: \"License key\",\n    planActivate: \"Activate\",\n    planGoPro: \"Subscribe PRO\",\n    // Options: Safety notes + debug\n    safetyNotesTitle: \"Limitations & security\",\n    safetyNotesLine1: \"This extension monitors requests from injected wallets (window.ethereum / window.solana).\",\n    safetyNotesLine2: \"Connections via QR/WalletConnect may not be intercepted. Always verify in your wallet.\",\n    safetyNotesLinkRevoke: \"revoke.cash\",\n    safetyNotesLinkEtherscan: \"etherscan.io\",\n    debugModeLabel: \"Debug mode\",\n    debugModeDesc: \"Stores the last 20 events (without large payloads) for support.\",\n    exportDebug: \"Export\",\n\n    // Overlay: intent + permission + copy\n    looks_like: \"Looks like:\",\n    intent_NFT_PURCHASE: \"NFT purchase\",\n    intent_SWAP: \"Swap\",\n    intent_APPROVAL: \"Permission\",\n    intent_SEND: \"Send\",\n    intent_UNKNOWN: \"Unknown\",\n    intent_ETH_TRANSFER: \"ETH transfer\",\n    intent_TOKEN_TRANSFER: \"Token transfer\",\n    intent_NFT_TRANSFER: \"NFT transfer\",\n    intent_CONTRACT_INTERACTION: \"Contract interaction\",\n    intent_SWITCH_CHAIN: \"Network switch\",\n    intent_ADD_CHAIN: \"Add network\",\n    intent_WATCH_ASSET: \"Add token\",\n    intent_SOLANA: \"Solana signature/transaction\",\n    intent_SIGNATURE: \"Signature\",\n    intent_TYPED_DATA: \"Typed data\",\n    wallet_label: \"Wallet\",\n    wallet_detecting: \"Detecting\u2026\",\n    wallet_evm_generic: \"EVM Wallet\",\n    trust_disclaimer: \"Reference list \u2260 guarantee. Scammers may use similar domains.\",\n    hint_wallet_popup: \"Your wallet should open now. If it doesn't, click the wallet icon and check for pending requests.\",\n    add_chain_network_label: \"Network to add\",\n    add_chain_rpc_label: \"RPC\",\n    watch_asset_token_label: \"Token to add\",\n    modeLabel: \"Mode:\",\n    popupPauseProtection: \"PAUSE PROTECTION\",\n    popupStatusProtected: \"Protected\",\n    popupStatusPaused: \"Paused\",\n    fortressModeLabel: \"FORTRESS MODE\",\n    fortressModeDesc: \"Blocks all token approvals except on trusted sites.\",\n    fortress_block_message: \"SignGuard Fortress: Approval blocked on unknown site. Disable Fortress mode to proceed.\",\n    honeypot_message: \"\uD83E\uDEA4 HONEYPOT: You can buy, but you will NOT be able to sell.\",\n    info_unavailable: \"Information unavailable.\",\n    explain_switch_short: \"The site is requesting a network (chain) switch in your wallet.\",\n    human_chain_reco: \"Continue only if you expected a network switch and it looks correct.\",\n    trustReasonAllowlisted: \"Domain is present in a trusted seed list.\",\n    trustReasonPhishingBlacklist: \"Domain is in a phishing blacklist (reference list).\",\n    fee_unknown_wallet_will_estimate: \"Fee: will be displayed by wallet\",\n    label_you_send: \"You send\",\n    label_fee_likely: \"Estimated fee (likely)\",\n    label_fee_max: \"Max fee (worst case)\",\n    label_total_likely: \"Total likely\",\n    label_total_max: \"Total max\",\n    fee_gt_value: \"The max fee is HIGHER than the value being sent. Make sure this is expected.\",\n    check_wallet_network_fee: \"You haven't seen the fee yet. Check the wallet 'Network fee' before confirming.\",\n    label_max_fee: \"Max fee\",\n    label_max_total: \"Max total\",\n    switch_summary_no_gas: \"Switching networks usually has no gas fee, but it changes which assets you see.\",\n    permission_title: \"Permission\",\n    permission_token_contract: \"Contract\",\n    permission_spender: \"Spender\",\n    permission_operator: \"Operator\",\n    permission_unlimited: \"Unlimited\",\n    approval_unlimited_detected: \"Unlimited approval detected\",\n    permit_signature_detected: \"Permit-style signature detected (may authorize token spending)\",\n    token_transfer_detected: \"Token transfer detected\",\n    nft_transfer_detected: \"NFT transfer detected\",\n    transfer_token_title: \"Token transfer\",\n    transfer_nft_title: \"NFT transfer\",\n    transfer_amount: \"Amount\",\n    transfer_token_id: \"Token ID\",\n    yes: \"Yes\",\n    no: \"No\",\n    copy: \"Copy\",\n    chainChangeTitle: \"Network switch/add request\",\n    watchAssetTitle: \"Add asset request\",\n\n    domainPunycodeReason: \"Domain uses punycode (xn--); verify the URL.\",\n    reason_high_gas: \"High gas fee relative to value.\",\n    reason_new_spender: \"New spender \u2014 verify.\",\n    reason_contract_target: \"Destination is a contract.\",\n    reason_known_bad_spender: \"Spender blocked.\",\n    reason_known_safe_spender: \"Spender on allowlist.\",\n    reason_unlimited_approval: \"Simulation: unlimited approval detected.\",\n    reason_set_approval_for_all: \"Simulation: ApprovalForAll (allows moving all NFTs).\",\n    reason_snap_invoke: \"Snaps can run code in your wallet. Confirm the source.\",\n    reason_sign_tx: \"Transaction signature without immediate send. May be used later for broadcast.\",\n    reason_raw_broadcast: \"Broadcast of already-signed transaction. No prior visual confirmation of content.\",\n    reason_read_permissions: \"The site is reading the permissions already granted to the wallet.\",\n    summary_title_snaps: \"Snaps / Wallet extensions\",\n    summary_title_read_permissions: \"Read permissions\",\n    summary_title_sign_tx: \"Transaction signature\",\n    summary_title_raw_tx: \"Signed transaction broadcast\",\n    summary_title_switch_chain: \"Switch network\",\n    domainDoubleDashReason: \"Domain contains double hyphen (suspicious).\",\n    domainNumberPatternReason: \"Domain with many numbers (common in phishing).\",\n    domainLookalikeReason: \"Possible lookalike of official domain {legit}.\",\n    suspiciousWebsitePatterns: \"Suspicious website patterns.\",\n    page_risk_suspicious_banner: \"\u26A0\uFE0F SignGuard: Suspicious Site Detected\",\n    connectTitle: \"Connect wallet\",\n    connectReason: \"The site wants to connect to your wallet.\",\n    walletRequestPermissionsTitle: \"Request permissions\",\n    walletRequestPermissionsReason: \"The site wants additional wallet permissions.\",\n    typedDataWarnReason: \"Structured data signature (EIP-712); may authorize actions.\",\n    signatureRequest: \"Signature request\",\n    rawSignWarnReason: \"Raw message signature; may authorize off-chain actions.\",\n    tokenApproval: \"Token approval\",\n    unlimitedApprovalReason: \"Unlimited approval detected (MAX_UINT256).\",\n    unlimitedApprovalDetected: \"Unlimited approval detected\",\n    nftOperatorApprovalReason: \"Permission to move ALL NFTs in the collection.\",\n    nftOperatorApproval: \"NFT operator approval\",\n    txPreview: \"Transaction preview\",\n    txWarnReason: \"On-chain transaction; verify value, destination and network.\",\n    unknownMethodReason: \"Unknown wallet method.\",\n    warningsDisabledReason: \"Warnings disabled in settings.\",\n    analyzing: \"Analyzing\u2026\",\n    analyzing_subtitle: \"Site \u2022 Method\",\n    analyzing_hint: \"Validating domain and estimating impact\",\n    fallback_partial_check: \"No full verification right now \u2014 review the details below before proceeding.\",\n    fallback_partial_verification: \"Partial verification now \u2014 review the details below before proceeding.\",\n    loading_base: \"Loading base\u2026\",\n    analyzerUnavailableTitle: \"Analyzer unavailable\",\n    analysis_unavailable: \"Analysis unavailable \u2014 verify in your wallet before continuing.\",\n    dados_parciais_title: \"Partial data \u2014 confirm in wallet\",\n    dados_parciais_subtitle: \"Showing what we could analyze. Verify details in your wallet before continuing.\",\n    risk_low: \"Low\",\n    risk_warn: \"Warning\",\n    risk_high: \"High\",\n    risk_block: \"Blocked\",\n    trustReasonAllowlistedMatched: \"Domain in allowlist: {matched}.\",\n    list_empty_domains: \"List empty. Open options to add trusted domains.\",\n    btn_open_options: \"Open options\",\n    default_human_switch_what: \"Switches the active network in your wallet (e.g. Ethereum \u2192 another network).\",\n    default_human_switch_risk: \"You may sign/transact on the wrong network if the switch is unexpected.\",\n    default_human_switch_safe: \"Confirm the requested network and that the site is correct.\",\n    default_human_switch_next: \"If correct, approve in the wallet. If something looks wrong, cancel.\",\n    default_human_contract_what: \"Sends a transaction to a contract (action within the dApp).\",\n    default_human_contract_risk: \"Actual cost may vary and the action may move assets/tokens via the contract.\",\n    default_human_contract_safe: \"Check destination (to), network, value and fee (Network fee) in the wallet.\",\n    default_human_contract_next: \"If details match, proceed. Otherwise, cancel.\",\n    default_human_eth_what: \"Sends ETH directly to an address.\",\n    default_human_eth_risk: \"Transfers are irreversible if the destination is wrong.\",\n    default_human_eth_safe: \"Verify the address and amount. Be wary of links/shorteners.\",\n    default_human_eth_next: \"Only confirm if you recognize the recipient.\",\n    default_human_typed_what: \"Off-chain signature (EIP-712). May authorize actions without paying gas.\",\n    default_human_typed_risk: \"May grant permissions/authorizations (e.g. permit/approval) depending on content.\",\n    default_human_typed_safe: \"Review what is being authorized (spender/operator) and the domain/contract.\",\n    default_human_typed_next: \"If unsure, cancel and verify on the dApp\u2019s official site.\",\n    default_human_generic_what: \"Action requested by the dApp.\",\n    default_human_generic_risk: \"If something doesn\u2019t make sense, cancel.\",\n    default_human_generic_safe: \"Confirm domain, network and details in the wallet.\",\n    default_human_generic_next: \"Proceed only if everything looks correct.\",\n    verdict_ok: \"OK\",\n    verdict_warn: \"Warning\",\n    verdict_high: \"High risk\",\n    verdict_block: \"Blocked\",\n    coverage_label: \"Coverage\",\n    coverage_limited: \"limited coverage\",\n    trusted_domain_ref_empty: \"Reference list has not loaded yet.\",\n    trusted_domain_ref_loading: \"Loading reference list\u2026\",\n    trusted_domain_ref_refresh: \"Update lists\",\n    trusted_domain_ref_view_more: \"View more\",\n    trusted_domains_loading: \"Loading reference list\u2026\",\n    trusted_domains_more: \"+{n}\",\n    trusted_domains_search_placeholder: \"Filter domains\u2026\",\n    trusted_domains_update_now: \"Update now\",\n    trusted_domains_auto_update: \"Updates automatically in options\",\n    banner_ok_no_known_threats: \"OK: no known scam/threat signals detected.\",\n    banner_block_known_threat: \"Blocked: known threat detected.\",\n    banner_local_verification: \"Caution: local verification (cache). Review the details below before proceeding.\",\n    banner_basic_verification: \"Caution: basic verification. Review the details carefully before proceeding.\",\n    list_site_reputation: \"Site reputation\",\n    list_site_trusted: \"Trusted\",\n    list_site_blocked: \"Blocked\",\n    list_site_unknown: \"Unknown\",\n    updated_x_hours: \"Base updated {n} hour(s) ago\",\n    updated_x_days: \"Base updated {n} day(s) ago\",\n    tip_check_wallet_details: \"Verify amount, network and fee in your wallet.\",\n    no_alerts_known: \"No known alerts were detected for this context.\",\n    still_review_wallet: \"Still, review in your wallet (value, network, destination and fee).\",\n    site_status_known: \"known reference\",\n    site_status_not_in_list: \"Site is not on the reference list\",\n    destination_contract: \"Contract\",\n    destination_wallet: \"Wallet\",\n    overlay_coverage_title: \"Security coverage\",\n    overlay_simulation_title: \"Simulation\",\n    overlay_address_intel_title: \"Address intel\",\n    btn_copy: \"Copy\",\n    btn_copy_json: \"Copy JSON\",\n    chain_not_recognized: \"Chain not recognized\",\n    simulation_skipped_caution: \"No simulation \u2014 validate with extra care.\",\n    toast_copied: \"Copied\",\n    btn_ver_menos: \"Show less\",\n  }\n};\n\nfunction format(template: string, params?: Record<string, string | number>) {\n  if (!params) return template;\n  return template.replace(/\\{(\\w+)\\}/g, (_m, k) => (k in params ? String(params[k]) : `{${k}}`));\n}\n\nexport function t(key: string, params?: Record<string, string | number>): string {\n  const loc = detectLocale();\n  const v = dict[loc]?.[key] || dict.en[key] || key;\n  const rendered = format(v, params);\n  if (rendered !== key) return rendered;\n\n  // Fallback (best-effort) for legacy chrome.i18n keys, if any.\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const c: any = (globalThis as any).chrome;\n    const msg = c?.i18n?.getMessage?.(key);\n    if (msg) return format(msg, params);\n  } catch {}\n\n  return rendered;\n}\n\nexport function safeT(key: string, params?: Record<string, string | number>): string {\n  const out = t(key, params);\n  if (out && out !== key) return out;\n  // Only treat as missing key when it looks like an i18n key (identifier)\n  if (/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(key)) {\n    return detectLocale() === \"pt\" ? \"Texto indispon\u00EDvel\" : \"Text unavailable\";\n  }\n  return key; // Already human-readable text, not a key\n}\n\n/** Check if key exists in dict or chrome.i18n. */\nexport function tHasKey(key: string): boolean {\n  if (!key || typeof key !== \"string\") return false;\n  const loc = detectLocale();\n  if (dict[loc]?.[key]) return true;\n  if (dict.en?.[key]) return true;\n  try {\n    const c: any = (globalThis as any).chrome;\n    if (c?.i18n?.getMessage?.(key)) return true;\n  } catch {}\n  return false;\n}\n\n/** Resolve key from dict or chrome.i18n; NEVER return the raw key. Returns \"\" if missing. */\nexport function tKey(key: string, params?: Record<string, string | number>): string {\n  const loc = detectLocale();\n  const v = dict[loc]?.[key] || dict.en[key];\n  if (v) return format(v, params || {});\n  try {\n    const c: any = (globalThis as any).chrome;\n    const msg = c?.i18n?.getMessage?.(key);\n    if (msg) return format(msg, params || {});\n  } catch {}\n  return \"\";\n}\n\nconst KEY_PATTERN = /^(explain_|human_|trustReason|label_|fee_|summary_|action_|intent_|permission_|reason_|add_chain_|watch_asset_|switch_|sendtx_|phishing_|recommend_|risk_|trust_|btn_|cost_|tx_|network_|more_|tech_|details_|overlay_|queue_|modeLabel|wallet_label|looks_like|info_unavailable|gas_calculating|check_wallet|dash|onboarding|options|exportDebug)/;\n\n/** If maybeKeyOrText looks like an i18n key, resolve it; else return literal. Never show raw keys. */\nexport function renderText(maybeKeyOrText: string, params?: Record<string, any>): string {\n  const s = String(maybeKeyOrText || \"\").trim();\n  if (!s) return s;\n  const looksLikeKey = KEY_PATTERN.test(s) || /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(s);\n  if (looksLikeKey) {\n    const resolved = tKey(s, params as Record<string, string | number>);\n    if (resolved) return resolved;\n    return detectLocale() === \"pt\" ? \"Texto indispon\u00EDvel\" : \"Text unavailable\";\n  }\n  return s;\n}\n\n", "import { t } from \"../i18n\";\r\nimport { isAllowlisted } from \"./utils\";\r\n\r\nfunction safeUrl(url: string) {\r\n  try {\r\n    return new URL(url);\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction getTld(host: string) {\r\n  const parts = (host || \"\").split(\".\").filter(Boolean);\r\n  return parts.length ? parts[parts.length - 1] : \"\";\r\n}\r\n\r\nfunction countChar(haystack: string, ch: string) {\r\n  return (haystack.match(new RegExp(`\\\\${ch}`, \"g\")) || []).length;\r\n}\r\n\r\nfunction hasSuspiciousKeywords(host: string) {\r\n  const h = host.toLowerCase();\r\n  return /(login|secure|verify|account|wallet|airdrop|claim|support|auth)/.test(h);\r\n}\r\n\r\nfunction hasBrandLookalike(host: string) {\r\n  const h = host.toLowerCase();\r\n  const brands = [\"opensea\", \"uniswap\", \"blur\", \"metamask\", \"aave\", \"etherscan\", \"revoke\"];\r\n  return brands.some((b) => h.includes(b)) && !/(opensea\\.io|uniswap\\.org|blur\\.io|metamask\\.io|aave\\.com|etherscan\\.io|revoke\\.cash)$/.test(h);\r\n}\r\n\r\nexport function getDomainInfo(url: string): {\r\n  host: string;\r\n  normalizedHost: string;\r\n  isHttps: boolean;\r\n  isPunycode: boolean;\r\n  hasMixedScripts: boolean;\r\n  hasConfusablesHint: boolean;\r\n  hasDoubleDash: boolean;\r\n  hasWeirdSubdomain: boolean;\r\n  tld: string;\r\n  reasons: string[];\r\n} {\r\n  const u = safeUrl(url);\r\n  const host = (u?.hostname || \"\").toLowerCase();\r\n  const normalizedHost = host.replace(/\\.+$/, \"\");\r\n  const isHttps = (u?.protocol || \"\").toLowerCase() === \"https:\";\r\n  const isPunycode = normalizedHost.startsWith(\"xn--\") || normalizedHost.includes(\".xn--\");\r\n  const hasDoubleDash = normalizedHost.includes(\"--\");\r\n  const hyphens = countChar(normalizedHost, \"-\");\r\n  const dots = countChar(normalizedHost, \".\");\r\n  const digits = (normalizedHost.match(/\\d/g) || []).length;\r\n\r\n  // Lightweight hints only (URL.hostname is typically punycode already).\r\n  const hasConfusablesHint = isPunycode || /[^a-z0-9.-]/.test(normalizedHost);\r\n  const hasMixedScripts = false; // kept for API shape; hostname already normalized to ASCII in most cases\r\n\r\n  const parts = normalizedHost.split(\".\").filter(Boolean);\r\n  const subdomainParts = Math.max(0, parts.length - 2);\r\n  const hasWeirdSubdomain = subdomainParts >= 3;\r\n  const tld = getTld(normalizedHost);\r\n\r\n  const reasons: string[] = [];\r\n  if (!isHttps && host) reasons.push(t(\"trustReasonNotHttps\"));\r\n  if (isPunycode) reasons.push(t(\"domainPunycodeReason\"));\r\n  if (hasDoubleDash) reasons.push(t(\"domainDoubleDashReason\"));\r\n  if (digits >= 4) reasons.push(t(\"domainNumberPatternReason\"));\r\n  if (hyphens >= 3) reasons.push(t(\"trustReasonManyHyphens\"));\r\n  if (hasSuspiciousKeywords(normalizedHost)) reasons.push(t(\"trustReasonSuspiciousKeywords\"));\r\n  if (hasBrandLookalike(normalizedHost)) reasons.push(t(\"trustReasonBrandLookalike\"));\r\n  if (hasWeirdSubdomain && dots >= 4) reasons.push(t(\"trustReasonManySubdomains\"));\r\n\r\n  return {\r\n    host,\r\n    normalizedHost,\r\n    isHttps,\r\n    isPunycode,\r\n    hasMixedScripts,\r\n    hasConfusablesHint,\r\n    hasDoubleDash,\r\n    hasWeirdSubdomain,\r\n    tld,\r\n    reasons,\r\n  };\r\n}\r\n\r\nexport function computeTrustVerdict(host: string, allowlist: string[]): {\r\n  verdict: \"LIKELY_OFFICIAL\" | \"UNKNOWN\" | \"SUSPICIOUS\";\r\n  trustScore: number;\r\n  reasons: string[];\r\n  matchedAllowlistDomain?: string;\r\n} {\r\n  const h = (host || \"\").toLowerCase();\r\n  if (!h) {\r\n    return { verdict: \"UNKNOWN\", trustScore: 50, reasons: [t(\"trustReasonNoHost\")] };\r\n  }\r\n\r\n  let trustScore = 55;\r\n  const reasons: string[] = [];\r\n\r\n  // Allowlist match => likely official (heuristic / user-config)\r\n  const matched = allowlist.find((d) => {\r\n    const dom = (d || \"\").toLowerCase().trim();\r\n    if (!dom) return false;\r\n    return h === dom || h.endsWith(\".\" + dom);\r\n  });\r\n  if (matched) {\r\n    trustScore = 92;\r\n    reasons.push(t(\"trustReasonAllowlistedMatched\", { matched }));\r\n    return { verdict: \"LIKELY_OFFICIAL\", trustScore, reasons, matchedAllowlistDomain: matched };\r\n  }\r\n\r\n  const isPunycode = h.startsWith(\"xn--\") || h.includes(\".xn--\");\r\n  const hasDoubleDash = h.includes(\"--\");\r\n  const digits = (h.match(/\\d/g) || []).length;\r\n  const hyphens = countChar(h, \"-\");\r\n  const dots = countChar(h, \".\");\r\n  const parts = h.split(\".\").filter(Boolean);\r\n  const subdomainParts = Math.max(0, parts.length - 2);\r\n\r\n  const suspicious = [];\r\n  if (isPunycode) suspicious.push(t(\"domainPunycodeReason\"));\r\n  if (hasDoubleDash) suspicious.push(t(\"domainDoubleDashReason\"));\r\n  if (digits >= 4) suspicious.push(t(\"domainNumberPatternReason\"));\r\n  if (hyphens >= 3) suspicious.push(t(\"trustReasonManyHyphens\"));\r\n  if (hasSuspiciousKeywords(h)) suspicious.push(t(\"trustReasonSuspiciousKeywords\"));\r\n  if (hasBrandLookalike(h)) suspicious.push(t(\"trustReasonBrandLookalike\"));\r\n  if (subdomainParts >= 3 && dots >= 4) suspicious.push(t(\"trustReasonManySubdomains\"));\r\n\r\n  // If user already allowlisted parent domains elsewhere, lower suspicion in general.\r\n  // (Still keep allowlist as the only \"likely official\" signal.)\r\n  const allowlistedElsewhere = isAllowlisted(h, allowlist);\r\n  if (allowlistedElsewhere) {\r\n    trustScore = Math.max(trustScore, 70);\r\n    reasons.push(t(\"trustReasonAllowlistedVariant\"));\r\n  }\r\n\r\n  if (suspicious.length) {\r\n    trustScore = 22;\r\n    reasons.push(...suspicious.slice(0, 4));\r\n    return { verdict: \"SUSPICIOUS\", trustScore, reasons };\r\n  }\r\n\r\n  reasons.push(t(\"trustReasonUnknown\"));\r\n  return { verdict: \"UNKNOWN\", trustScore, reasons };\r\n}\r\n\r\n", "import { t } from \"../i18n\";\r\nimport type { HumanExplanation, TrustVerdict } from \"./types\";\r\nimport type { SGAction } from \"./classify\";\r\n\r\nexport function explainMethod(method: string): { title: string; short: string; why: string } {\r\n  const m = (method || \"\").toLowerCase();\r\n\r\n  if (m === \"eth_requestaccounts\" || m === \"wallet_requestpermissions\") {\r\n    return {\r\n      title: t(\"explain_connect_title\"),\r\n      short: t(\"explain_connect_short\"),\r\n      why: t(\"explain_connect_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"personal_sign\" || m === \"eth_sign\") {\r\n    return {\r\n      title: t(\"explain_sign_title\"),\r\n      short: t(\"explain_sign_short\"),\r\n      why: t(\"explain_sign_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"eth_signtypeddata\" || m === \"eth_signtypeddata_v3\" || m === \"eth_signtypeddata_v4\") {\r\n    return {\r\n      title: t(\"explain_typed_title\"),\r\n      short: t(\"explain_typed_short\"),\r\n      why: t(\"explain_typed_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"eth_sendtransaction\") {\r\n    return {\r\n      title: t(\"explain_tx_title\"),\r\n      short: t(\"explain_tx_short\"),\r\n      why: t(\"explain_tx_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"wallet_switchethereumchain\") {\r\n    return {\r\n      title: t(\"explain_switch_title\"),\r\n      short: t(\"explain_switch_short\"),\r\n      why: t(\"explain_switch_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"wallet_addethereumchain\") {\r\n    return {\r\n      title: t(\"explain_addchain_title\"),\r\n      short: t(\"explain_addchain_short\"),\r\n      why: t(\"explain_addchain_why\"),\r\n    };\r\n  }\r\n\r\n  if (m === \"wallet_watchasset\") {\r\n    return {\r\n      title: t(\"explain_watchasset_title\"),\r\n      short: t(\"explain_watchasset_short\"),\r\n      why: t(\"explain_watchasset_why\"),\r\n    };\r\n  }\r\n\r\n  return {\r\n    title: t(\"explain_generic_title\"),\r\n    short: t(\"explain_generic_short\"),\r\n    why: t(\"explain_generic_why\"),\r\n  };\r\n}\r\n\r\nexport function actionTitle(action: SGAction): string {\r\n  if (action === \"CONNECT\") return \"Conectar carteira\";\r\n  if (action === \"SWITCH_CHAIN\") return \"Trocar rede\";\r\n  if (action === \"ADD_CHAIN\") return \"Adicionar rede\";\r\n  if (action === \"REQUEST_PERMISSIONS\") return \"Conceder permiss\u00F5es\";\r\n  if (action === \"SIGN_MESSAGE\") return \"Assinar mensagem\";\r\n  if (action === \"SIGN_TYPED_DATA\") return \"Assinar mensagem (Typed Data)\";\r\n  if (action === \"SEND_TX\") return \"Enviar transa\u00E7\u00E3o\";\r\n  if (action === \"WATCH_ASSET\") return \"Adicionar token \u00E0 carteira\";\r\n  return \"A\u00E7\u00E3o desconhecida\";\r\n}\r\n\r\nexport function walletExpectation(action: SGAction): string {\r\n  if (action === \"SEND_TX\") return \"Voc\u00EA deve ver um pedido de transa\u00E7\u00E3o (Transaction request) com valor, taxa e contrato.\";\r\n  if (action === \"SWITCH_CHAIN\") return \"Voc\u00EA deve ver um pedido de troca de rede.\";\r\n  if (action === \"CONNECT\" || action === \"REQUEST_PERMISSIONS\") return \"Voc\u00EA deve ver um pedido de conex\u00E3o/sele\u00E7\u00E3o de conta.\";\r\n  if (action === \"SIGN_MESSAGE\" || action === \"SIGN_TYPED_DATA\") return \"Voc\u00EA deve ver um pedido de assinatura.\";\r\n  if (action === \"WATCH_ASSET\") return \"Voc\u00EA deve ver um pedido para adicionar token \u00E0 carteira.\";\r\n  return \"Voc\u00EA deve ver um pedido na carteira compat\u00EDvel com a a\u00E7\u00E3o solicitada.\";\r\n}\r\n\r\n// Reduced default arrays (to avoid UI bloat):\r\n// - CONNECT: whatItDoes max 2, risks max 3, safeNotes max 2, nextSteps max 3\r\n// - SIGN: max 2/3/2/3\r\n// - APPROVE/TX: max 2/3/1/3\r\nexport function buildHumanLists(method: string, trustVerdict: TrustVerdict): Pick<HumanExplanation, \"whatItDoes\" | \"risks\" | \"safeNotes\" | \"nextSteps\"> {\r\n  const m = (method || \"\").toLowerCase();\r\n\r\n  const suspicious = trustVerdict === \"SUSPICIOUS\";\r\n\r\n  if (m === \"eth_requestaccounts\" || m === \"wallet_requestpermissions\") {\r\n    return {\r\n      whatItDoes: [t(\"human_connect_whatIs\"), t(\"human_connect_why_1\")].slice(0, 2),\r\n      risks: [t(\"human_connect_risk_1\"), t(\"human_connect_risk_2\"), t(\"human_connect_risk_3\")].slice(0, 3),\r\n      safeNotes: [t(\"human_connect_safe_1\")].slice(0, 2),\r\n      nextSteps: [t(\"human_connect_next_1\"), t(\"human_connect_next_2\")].slice(0, 3),\r\n    };\r\n  }\r\n\r\n  const isTyped = m === \"eth_signtypeddata\" || m === \"eth_signtypeddata_v3\" || m === \"eth_signtypeddata_v4\";\r\n  if (m === \"personal_sign\" || m === \"eth_sign\" || isTyped) {\r\n    const risks = [t(\"human_sign_risk_1\"), t(\"human_sign_risk_2\")];\r\n    if (isTyped) risks.push(t(\"human_typed_risk_1\"));\r\n    return {\r\n      whatItDoes: [t(isTyped ? \"human_typed_whatIs\" : \"human_sign_whatIs\"), t(\"explain_sign_why\")].slice(0, 2),\r\n      risks: risks.slice(0, 3),\r\n      safeNotes: [t(\"human_sign_safe_1\")].slice(0, 2),\r\n      nextSteps: [t(\"human_sign_next_1\"), t(\"human_sign_next_2\")].slice(0, 3),\r\n    };\r\n  }\r\n\r\n  if (m === \"eth_sendtransaction\") {\r\n    return {\r\n      whatItDoes: [t(\"human_tx_whatIs\")].slice(0, 2),\r\n      risks: [t(\"human_tx_risk_1\")].slice(0, 3),\r\n      safeNotes: [t(\"human_tx_safe_1\")].slice(0, 1),\r\n      nextSteps: [t(\"human_tx_next_1\")].slice(0, 3),\r\n    };\r\n  }\r\n\r\n  if (m === \"wallet_switchethereumchain\" || m === \"wallet_addethereumchain\") {\r\n    return {\r\n      whatItDoes: [t(\"human_chain_whatIs\")].slice(0, 2),\r\n      risks: [t(\"human_chain_risk_1\")].slice(0, 3),\r\n      safeNotes: [t(\"human_chain_safe_1\")].slice(0, 1),\r\n      nextSteps: [t(\"human_chain_next_1\")].slice(0, 3),\r\n    };\r\n  }\r\n\r\n  if (m === \"wallet_watchasset\") {\r\n    return {\r\n      whatItDoes: [t(\"human_watchasset_whatIs\")].slice(0, 2),\r\n      risks: [t(\"human_watchasset_risk_1\")].slice(0, 3),\r\n      safeNotes: [t(\"human_watchasset_safe_1\")].slice(0, 1),\r\n      nextSteps: [t(\"human_watchasset_next_1\")].slice(0, 3),\r\n    };\r\n  }\r\n\r\n  // Generic\r\n  return {\r\n    whatItDoes: [t(\"human_generic_whatIs\")].slice(0, 2),\r\n    risks: [t(\"human_generic_risk_1\")].slice(0, 3),\r\n    safeNotes: [t(\"human_generic_safe_1\")].slice(0, 1),\r\n    nextSteps: [t(\"human_generic_next_1\")].slice(0, 3),\r\n  };\r\n}\r\n\r\n", "import { CRYPTO_TRUSTED_DOMAINS_SEED } from \"../lists/cryptoTrustedDomainsSeed\";\r\n\r\nexport const SUGGESTED_TRUSTED_DOMAINS = CRYPTO_TRUSTED_DOMAINS_SEED.slice(0, 24) as unknown as readonly string[];\r\n\r\n", "/** Pluggable threat intel sources \u2014 blocklists, allowlists, multiple formats */\r\n\r\nexport type IntelSource = {\r\n  id: string;\r\n  kind: \"blocklist\" | \"allowlist\";\r\n  url: string;\r\n  format: \"hosts\" | \"txt\" | \"json-array\" | \"defillama\" | \"uniswap-tokens\";\r\n};\r\n\r\nexport const DOMAIN_SOURCES: IntelSource[] = [\r\n  // Blocklists (Anti-Phishing)\r\n  {\r\n    id: \"metamask-phishing\",\r\n    kind: \"blocklist\",\r\n    url: \"https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/main/src/hosts.txt\",\r\n    format: \"hosts\",\r\n  },\r\n  {\r\n    id: \"phishdestroy\",\r\n    kind: \"blocklist\",\r\n    url: \"https://raw.githubusercontent.com/phishdestroy/destroylist/main/rootlist/formats/primary/domains.txt\",\r\n    format: \"txt\",\r\n  },\r\n  {\r\n    id: \"cryptoscamdb\",\r\n    kind: \"blocklist\",\r\n    url: \"https://raw.githubusercontent.com/CryptoScamDB/blacklist/master/data/urls.txt\",\r\n    format: \"txt\",\r\n  },\r\n  {\r\n    id: \"409h\",\r\n    kind: \"blocklist\",\r\n    url: \"https://raw.githubusercontent.com/409H/EtherAddressLookup/master/blacklists/domains.json\",\r\n    format: \"json-array\",\r\n  },\r\n  // Allowlists (Leg\u00EDtimos)\r\n  {\r\n    id: \"defillama\",\r\n    kind: \"allowlist\",\r\n    url: \"https://api.llama.fi/protocols\",\r\n    format: \"defillama\",\r\n  },\r\n  {\r\n    id: \"uniswap-tokens\",\r\n    kind: \"allowlist\",\r\n    url: \"https://gateway.ipfs.io/ipns/tokens.uniswap.org\",\r\n    format: \"uniswap-tokens\",\r\n  },\r\n];\r\n\r\nfunction normalizeDomain(raw: string): string {\r\n  let s = String(raw || \"\").trim().toLowerCase();\r\n  if (!s) return \"\";\r\n  if (s.startsWith(\"#\")) return \"\";\r\n  try {\r\n    if (s.startsWith(\"http://\") || s.startsWith(\"https://\")) {\r\n      const u = new URL(s);\r\n      s = u.hostname;\r\n    }\r\n  } catch {}\r\n  if (s.startsWith(\"www.\")) s = s.slice(4);\r\n  if (s.startsWith(\"0.0.0.0 \") || s.startsWith(\"127.0.0.1 \")) {\r\n    s = s.replace(/^(0\\.0\\.0\\.0|127\\.0\\.0\\.1)\\s+/, \"\");\r\n  }\r\n  if (s.startsWith(\"*.\")) s = s.slice(2);\r\n  s = s.replace(/\\.+$/, \"\").split(\"/\")[0] || \"\";\r\n  return s;\r\n}\r\n\r\nfunction normalizeAddress(raw: string): string {\r\n  const s = String(raw || \"\").trim().toLowerCase();\r\n  if (s.startsWith(\"0x\") && s.length === 42 && /^0x[a-f0-9]{40}$/.test(s)) return s;\r\n  return \"\";\r\n}\r\n\r\n/** hosts file: one host per line, optional 0.0.0.0 prefix */\r\nexport function parseHostsFormat(text: string): string[] {\r\n  const out: string[] = [];\r\n  for (const line of text.split(\"\\n\")) {\r\n    const h = normalizeDomain(line);\r\n    if (h) out.push(h);\r\n  }\r\n  return [...new Set(out)];\r\n}\r\n\r\n/** plain txt: one domain per line */\r\nexport function parseTxtFormat(text: string): string[] {\r\n  return parseHostsFormat(text);\r\n}\r\n\r\n/** JSON array of strings (e.g. [\"evil.com\", \"phish.site\"]) */\r\nexport function parseJsonArray(data: unknown): string[] {\r\n  const out: string[] = [];\r\n  if (!Array.isArray(data)) return out;\r\n  for (const item of data) {\r\n    const s = typeof item === \"string\" ? item : String((item as any)?.id ?? (item as any)?.domain ?? \"\");\r\n    const h = normalizeDomain(s);\r\n    if (h) out.push(h);\r\n  }\r\n  return [...new Set(out)];\r\n}\r\n\r\n/** DeFi Llama protocols: extract homepage/url from each protocol */\r\nexport function parseDefiLlama(data: unknown): string[] {\r\n  const out: string[] = [];\r\n  if (!data || typeof data !== \"object\") return out;\r\n  const list = Array.isArray(data) ? data : Array.isArray((data as any).protocols) ? (data as any).protocols : [];\r\n  for (const p of list) {\r\n    const obj = typeof p === \"object\" && p !== null ? p : {};\r\n    const url = (obj as any).url ?? (obj as any).homepage ?? (obj as any).website ?? \"\";\r\n    if (typeof url === \"string\" && url) {\r\n      const h = normalizeDomain(url);\r\n      if (h) out.push(h);\r\n    }\r\n    const gecko = (obj as any).gecko_id;\r\n    if (gecko && typeof (obj as any).name === \"string\") {\r\n      const slug = String((obj as any).slug || (obj as any).name || \"\").toLowerCase().replace(/\\s+/g, \"-\");\r\n      if (slug) out.push(normalizeDomain(slug + \".com\"));\r\n    }\r\n  }\r\n  return [...new Set(out)];\r\n}\r\n\r\n/** Uniswap token list: extract token addresses (for token verification, not domains) */\r\nexport function parseUniswapTokens(data: unknown): string[] {\r\n  const out: string[] = [];\r\n  if (!data || typeof data !== \"object\") return out;\r\n  const tokens = Array.isArray((data as any).tokens) ? (data as any).tokens : [];\r\n  for (const t of tokens) {\r\n    const addr = (t as any)?.address;\r\n    const a = normalizeAddress(typeof addr === \"string\" ? addr : \"\");\r\n    if (a) out.push(a);\r\n  }\r\n  return [...new Set(out)];\r\n}\r\n\r\nexport type FetchSourceResult = {\r\n  ok: boolean;\r\n  domains: string[];\r\n  addresses?: string[];\r\n  error?: string;\r\n};\r\n\r\nexport async function fetchSource(source: IntelSource, timeoutMs = 8000): Promise<FetchSourceResult> {\r\n  try {\r\n    const ctrl = new AbortController();\r\n    const t = setTimeout(() => ctrl.abort(), timeoutMs);\r\n    const res = await fetch(source.url, { cache: \"no-store\", signal: ctrl.signal });\r\n    clearTimeout(t);\r\n    if (!res.ok) return { ok: false, domains: [], error: `HTTP ${res.status}` };\r\n    const text = await res.text();\r\n    let domains: string[] = [];\r\n    let addresses: string[] | undefined;\r\n\r\n    switch (source.format) {\r\n      case \"hosts\":\r\n      case \"txt\":\r\n        domains = parseHostsFormat(text);\r\n        break;\r\n      case \"json-array\": {\r\n        try {\r\n          domains = parseJsonArray(JSON.parse(text));\r\n        } catch {\r\n          return { ok: false, domains: [], error: \"JSON parse failed\" };\r\n        }\r\n        break;\r\n      }\r\n      case \"defillama\": {\r\n        try {\r\n          domains = parseDefiLlama(JSON.parse(text));\r\n        } catch {\r\n          return { ok: false, domains: [], error: \"JSON parse failed\" };\r\n        }\r\n        break;\r\n      }\r\n      case \"uniswap-tokens\": {\r\n        try {\r\n          const parsed = JSON.parse(text);\r\n          addresses = parseUniswapTokens(parsed);\r\n        } catch {\r\n          return { ok: false, domains: [], addresses: [], error: \"JSON parse failed\" };\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        return { ok: false, domains: [], error: \"Unknown format\" };\r\n    }\r\n\r\n    return { ok: true, domains, addresses };\r\n  } catch (e: any) {\r\n    return { ok: false, domains: [], error: e?.message || String(e) };\r\n  }\r\n}\r\n", "import type { ThreatIntelAddress } from \"./shared/types\";\r\nimport { DOMAIN_SOURCES, fetchSource } from \"./intelSources\";\r\n\r\nexport type ThreatIntelSource = {\r\n  name: string;\r\n  ok: boolean;\r\n  count: number;\r\n  url: string;\r\n};\r\n\r\nexport type ThreatIntel = {\r\n  updatedAt: number;\r\n  sources: ThreatIntelSource[];\r\n  blockedDomains: Record<string, string[]>;\r\n  allowedDomains: Record<string, string[]>;\r\n  blockedAddresses: Record<string, string[]>;\r\n  trustedSeed: string[];\r\n  /** Token contract addresses from allowlists (e.g. Uniswap list) for verification */\r\n  trustedTokenAddresses: string[];\r\n  // Flat arrays for backward compat with background\r\n  blockedDomainsList: string[];\r\n  blockedAddressesList: ThreatIntelAddress[];\r\n};\r\n\r\nconst METAMASK_HOSTS =\r\n  \"https://raw.githubusercontent.com/MetaMask/eth-phishing-detect/main/src/hosts.txt\";\r\nconst MEW_DARKLIST =\r\n  \"https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-darklist.json\";\r\nconst MEW_LIGHTLIST =\r\n  \"https://raw.githubusercontent.com/MyEtherWallet/ethereum-lists/master/src/urls/urls-lightlist.json\";\r\nconst CRYPTO_SCAM_DB_BLACKLIST = \"https://api.cryptoscamdb.org/v1/blacklist\";\r\nconst CRYPTO_SCAM_DB_WHITELIST = \"https://api.cryptoscamdb.org/v1/whitelist\";\r\nconst CRYPTO_SCAM_DB_BLOCK_TXT =\r\n  \"https://gitlab.com/KevinThomas0/cryptoscamdb-lists/-/raw/master/cryptoscamdb-blocklist.txt\";\r\nconst CRYPTO_SCAM_DB_ALLOW_TXT =\r\n  \"https://gitlab.com/KevinThomas0/cryptoscamdb-lists/-/raw/master/cryptoscamdb-allowlist.txt\";\r\nconst POLKADOT_ALL =\r\n  \"https://raw.githubusercontent.com/polkadot-js/phishing/master/all.json\";\r\nconst POLKADOT_ADDRESSES =\r\n  \"https://raw.githubusercontent.com/polkadot-js/phishing/master/address.json\";\r\nconst SCAMSNIFFER_DOMAINS =\r\n  \"https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/domains.json\";\r\nconst SCAMSNIFFER_ADDRESSES =\r\n  \"https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/address.json\";\r\n\r\nconst FETCH_TIMEOUT_MS = 4000;\r\n\r\nasync function fetchWithTimeout(url: string, init?: RequestInit): Promise<Response> {\r\n  const ctrl = new AbortController();\r\n  const timer = setTimeout(() => ctrl.abort(), FETCH_TIMEOUT_MS);\r\n  try {\r\n    const res = await fetch(url, { ...init, signal: ctrl.signal, cache: \"no-store\" });\r\n    return res;\r\n  } finally {\r\n    clearTimeout(timer);\r\n  }\r\n}\r\n\r\nexport const TRUSTED_SEED: string[] = [\r\n  \"opensea.io\",\r\n  \"blur.io\",\r\n  \"looksrare.org\",\r\n  \"rarible.com\",\r\n  \"magiceden.io\",\r\n  \"x2y2.io\",\r\n  \"app.uniswap.org\",\r\n  \"uniswap.org\",\r\n  \"1inch.io\",\r\n  \"app.1inch.io\",\r\n  \"matcha.xyz\",\r\n  \"cow.fi\",\r\n  \"sushiswap.fi\",\r\n  \"curve.fi\",\r\n  \"balancer.fi\",\r\n  \"app.aave.com\",\r\n  \"aave.com\",\r\n  \"compound.finance\",\r\n  \"makerdao.com\",\r\n  \"lido.fi\",\r\n  \"etherscan.io\",\r\n  \"arbiscan.io\",\r\n  \"polygonscan.com\",\r\n  \"bscscan.com\",\r\n  \"basescan.org\",\r\n  \"optimistic.etherscan.io\",\r\n  \"snowtrace.io\",\r\n  \"bridge.arbitrum.io\",\r\n  \"bridge.base.org\",\r\n  \"app.optimism.io\",\r\n  \"polygon.technology\",\r\n  \"metamask.io\",\r\n  \"walletconnect.com\",\r\n  \"rabby.io\",\r\n  \"ledger.com\",\r\n  \"trezor.io\",\r\n  \"coinbase.com\",\r\n  \"binance.com\",\r\n  \"kraken.com\",\r\n  \"okx.com\",\r\n].map((x) => x.toLowerCase());\r\n\r\nexport function normalizeHost(host: string): string {\r\n  let h = String(host || \"\").trim().toLowerCase().replace(/\\.$/, \"\");\r\n  try {\r\n    if (h.startsWith(\"http\")) {\r\n      const u = new URL(h);\r\n      h = u.hostname;\r\n    }\r\n  } catch {}\r\n  return h;\r\n}\r\n\r\nexport function hostMatches(host: string, domain: string): boolean {\r\n  const h = normalizeHost(host);\r\n  let d = normalizeHost(domain);\r\n  if (d.startsWith(\"*.\")) d = d.slice(2);\r\n  return h === d || h.endsWith(\".\" + d);\r\n}\r\n\r\nfunction parseHostsTxt(txt: string): string[] {\r\n  return txt\r\n    .split(\"\\n\")\r\n    .map((l) => l.trim())\r\n    .filter((l) => !!l && !l.startsWith(\"#\"))\r\n    .map((l) => normalizeHost(l));\r\n}\r\n\r\nconst EVM_ADDRESS_REGEX = /^0x[a-fA-F0-9]{40}$/;\r\n\r\nfunction addToMap<T extends string>(map: Record<string, string[]>, key: string, source: string) {\r\n  const k = key.toLowerCase();\r\n  if (!map[k]) map[k] = [];\r\n  if (!map[k].includes(source)) map[k].push(source);\r\n}\r\n\r\nfunction parseMewId(id: string): string {\r\n  const s = String(id || \"\").trim();\r\n  if (!s) return \"\";\r\n  if (s.startsWith(\"http\")) {\r\n    try { return new URL(s).hostname.toLowerCase(); } catch { return \"\"; }\r\n  }\r\n  return normalizeHost(s);\r\n}\r\n\r\nasync function fetchScamSniffer(\r\n  blockedDomains: Record<string, string[]>,\r\n  blockedAddresses: Record<string, string[]>,\r\n  sources: ThreatIntelSource[]\r\n): Promise<void> {\r\n  let domCount = 0;\r\n  try {\r\n    const res = await fetchWithTimeout(SCAMSNIFFER_DOMAINS);\r\n    if (res.ok) {\r\n      const arr = (await res.json()) as unknown;\r\n      const list = Array.isArray(arr) ? arr : [];\r\n      for (const item of list) {\r\n        const h = normalizeHost(String(item || \"\"));\r\n        if (h) {\r\n          addToMap(blockedDomains, h, \"ScamSniffer-domains\");\r\n          domCount++;\r\n        }\r\n      }\r\n    }\r\n    sources.push({ name: \"ScamSniffer domains\", ok: res.ok, count: domCount, url: SCAMSNIFFER_DOMAINS });\r\n  } catch {\r\n    sources.push({ name: \"ScamSniffer domains\", ok: false, count: 0, url: SCAMSNIFFER_DOMAINS });\r\n  }\r\n\r\n  let addrCount = 0;\r\n  try {\r\n    const res = await fetchWithTimeout(SCAMSNIFFER_ADDRESSES);\r\n    if (res.ok) {\r\n      const arr = (await res.json()) as unknown;\r\n      const list = Array.isArray(arr) ? arr : [];\r\n      for (const item of list) {\r\n        const s = String(item || \"\").trim().toLowerCase();\r\n        if (s.startsWith(\"0x\") && s.length === 42 && EVM_ADDRESS_REGEX.test(s)) {\r\n          addToMap(blockedAddresses, s, \"ScamSniffer-addresses\");\r\n          addrCount++;\r\n        }\r\n      }\r\n    }\r\n    sources.push({ name: \"ScamSniffer addresses\", ok: res.ok, count: addrCount, url: SCAMSNIFFER_ADDRESSES });\r\n  } catch {\r\n    sources.push({ name: \"ScamSniffer addresses\", ok: false, count: 0, url: SCAMSNIFFER_ADDRESSES });\r\n  }\r\n}\r\n\r\nasync function fetchMewDarklist(blockedDomains: Record<string, string[]>, sources: ThreatIntelSource[]): Promise<void> {\r\n  try {\r\n    const res = await fetchWithTimeout(MEW_DARKLIST);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const arr = (await res.json()) as Array<{ id?: string }>;\r\n    const list = Array.isArray(arr) ? arr : [];\r\n    for (const item of list) {\r\n      const host = parseMewId(item?.id || \"\");\r\n      if (host) addToMap(blockedDomains, host, \"MEW-darklist\");\r\n    }\r\n    sources.push({ name: \"MEW darklist\", ok: true, count: list.length, url: MEW_DARKLIST });\r\n  } catch (e: any) {\r\n    sources.push({ name: \"MEW darklist\", ok: false, count: 0, url: MEW_DARKLIST });\r\n  }\r\n}\r\n\r\nasync function fetchMewLightlist(allowedDomains: Record<string, string[]>, sources: ThreatIntelSource[]): Promise<void> {\r\n  try {\r\n    const res = await fetchWithTimeout(MEW_LIGHTLIST);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const arr = (await res.json()) as Array<{ id?: string }>;\r\n    const list = Array.isArray(arr) ? arr : [];\r\n    for (const item of list) {\r\n      const host = parseMewId(item?.id || \"\");\r\n      if (host) addToMap(allowedDomains, host, \"MEW-lightlist\");\r\n    }\r\n    sources.push({ name: \"MEW lightlist\", ok: true, count: list.length, url: MEW_LIGHTLIST });\r\n  } catch (e: any) {\r\n    sources.push({ name: \"MEW lightlist\", ok: false, count: 0, url: MEW_LIGHTLIST });\r\n  }\r\n}\r\n\r\nasync function fetchMetamaskHosts(): Promise<{ blocked: string[]; source: ThreatIntelSource }> {\r\n  try {\r\n    const res = await fetchWithTimeout(METAMASK_HOSTS);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const blocked = parseHostsTxt(await res.text());\r\n    return {\r\n      blocked,\r\n      source: { name: \"MetaMask hosts\", ok: true, count: blocked.length, url: METAMASK_HOSTS },\r\n    };\r\n  } catch (e: any) {\r\n    return {\r\n      blocked: [],\r\n      source: {\r\n        name: \"MetaMask hosts\",\r\n        ok: false,\r\n        count: 0,\r\n        url: METAMASK_HOSTS,\r\n      },\r\n    };\r\n  }\r\n}\r\n\r\nasync function fetchCryptoScamDb(\r\n  blockedDomains: Record<string, string[]>,\r\n  allowedDomains: Record<string, string[]>,\r\n  sources: ThreatIntelSource[]\r\n): Promise<void> {\r\n  try {\r\n    const [blRes, wlRes] = await Promise.all([\r\n      fetchWithTimeout(CRYPTO_SCAM_DB_BLACKLIST),\r\n      fetchWithTimeout(CRYPTO_SCAM_DB_WHITELIST),\r\n    ]);\r\n    if (blRes.ok) {\r\n      const j = await blRes.json();\r\n      const list = Array.isArray(j?.result) ? j.result : [];\r\n      for (const d of list) {\r\n        const host = normalizeHost(String(d));\r\n        if (host) addToMap(blockedDomains, host, \"CryptoScamDB\");\r\n      }\r\n      sources.push({\r\n        name: \"CryptoScamDB blacklist\",\r\n        ok: true,\r\n        count: list.length,\r\n        url: CRYPTO_SCAM_DB_BLACKLIST,\r\n      });\r\n    } else throw new Error(\"blacklist failed\");\r\n  } catch {\r\n    try {\r\n      const res = await fetchWithTimeout(CRYPTO_SCAM_DB_BLOCK_TXT);\r\n      if (res.ok) {\r\n        const blocked = parseHostsTxt(await res.text());\r\n        for (const h of blocked) addToMap(blockedDomains, h, \"CryptoScamDB-txt\");\r\n        sources.push({\r\n          name: \"CryptoScamDB blocklist\",\r\n          ok: true,\r\n          count: blocked.length,\r\n          url: CRYPTO_SCAM_DB_BLOCK_TXT,\r\n        });\r\n      } else throw new Error(\"fallback failed\");\r\n    } catch {\r\n      sources.push({\r\n        name: \"CryptoScamDB blacklist\",\r\n        ok: false,\r\n        count: 0,\r\n        url: CRYPTO_SCAM_DB_BLACKLIST,\r\n      });\r\n    }\r\n  }\r\n\r\n  try {\r\n    const wlRes = await fetchWithTimeout(CRYPTO_SCAM_DB_WHITELIST);\r\n    if (wlRes.ok) {\r\n      const j = await wlRes.json();\r\n      const list = Array.isArray(j?.result) ? j.result : [];\r\n      for (const d of list) {\r\n        const host = normalizeHost(String(d));\r\n        if (host) addToMap(allowedDomains, host, \"CryptoScamDB\");\r\n      }\r\n      sources.push({\r\n        name: \"CryptoScamDB whitelist\",\r\n        ok: true,\r\n        count: list.length,\r\n        url: CRYPTO_SCAM_DB_WHITELIST,\r\n      });\r\n    }\r\n  } catch {\r\n    try {\r\n      const res = await fetchWithTimeout(CRYPTO_SCAM_DB_ALLOW_TXT);\r\n      if (res.ok) {\r\n        const allowed = parseHostsTxt(await res.text());\r\n        for (const h of allowed) addToMap(allowedDomains, h, \"CryptoScamDB-txt\");\r\n      }\r\n    } catch {}\r\n  }\r\n}\r\n\r\nasync function fetchPolkadot(\r\n  blockedDomains: Record<string, string[]>,\r\n  allowedDomains: Record<string, string[]>,\r\n  blockedAddresses: Record<string, string[]>,\r\n  sources: ThreatIntelSource[]\r\n): Promise<void> {\r\n  try {\r\n    const res = await fetchWithTimeout(POLKADOT_ALL);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const j = await res.json();\r\n    const allow = Array.isArray(j?.allow) ? j.allow : [];\r\n    const deny = Array.isArray(j?.deny) ? j.deny : [];\r\n    for (const d of allow) {\r\n      const host = normalizeHost(String(d));\r\n      if (host) addToMap(allowedDomains, host, \"polkadot-js\");\r\n    }\r\n    for (const d of deny) {\r\n      const host = normalizeHost(String(d));\r\n      if (host) addToMap(blockedDomains, host, \"polkadot-js\");\r\n    }\r\n    sources.push({\r\n      name: \"polkadot-js phishing\",\r\n      ok: true,\r\n      count: deny.length,\r\n      url: POLKADOT_ALL,\r\n    });\r\n  } catch (e: any) {\r\n    sources.push({\r\n      name: \"polkadot-js phishing\",\r\n      ok: false,\r\n      count: 0,\r\n      url: POLKADOT_ALL,\r\n    });\r\n  }\r\n\r\n  try {\r\n    const res = await fetchWithTimeout(POLKADOT_ADDRESSES);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const j = await res.json();\r\n    const entries = typeof j === \"object\" && j !== null ? Object.entries(j) : [];\r\n    let evmCount = 0;\r\n    for (const [_domain, arr] of entries) {\r\n      const list = Array.isArray(arr) ? arr : [];\r\n      for (const a of list) {\r\n        const s = String(a || \"\").trim();\r\n        if (EVM_ADDRESS_REGEX.test(s)) {\r\n          addToMap(blockedAddresses, s.toLowerCase(), \"polkadot-js\");\r\n          evmCount++;\r\n        }\r\n      }\r\n    }\r\n    sources.push({\r\n      name: \"polkadot-js addresses\",\r\n      ok: true,\r\n      count: evmCount,\r\n      url: POLKADOT_ADDRESSES,\r\n    });\r\n  } catch {\r\n    sources.push({\r\n      name: \"polkadot-js addresses\",\r\n      ok: false,\r\n      count: 0,\r\n      url: POLKADOT_ADDRESSES,\r\n    });\r\n  }\r\n}\r\n\r\nexport async function fetchThreatIntel(): Promise<ThreatIntel> {\r\n  const now = Date.now();\r\n  const blockedDomains: Record<string, string[]> = {};\r\n  const allowedDomains: Record<string, string[]> = {};\r\n  const blockedAddresses: Record<string, string[]> = {};\r\n  const sources: ThreatIntelSource[] = [];\r\n\r\n  const meta = await fetchMetamaskHosts();\r\n  sources.push(meta.source);\r\n  for (const h of meta.blocked) addToMap(blockedDomains, h, \"MetaMask\");\r\n\r\n  const trustedTokenAddresses: string[] = [];\r\n  for (const src of DOMAIN_SOURCES) {\r\n    if (src.id === \"metamask-phishing\") continue;\r\n    const r = await fetchSource(src);\r\n    if (src.kind === \"blocklist\") {\r\n      for (const h of r.domains) addToMap(blockedDomains, h, src.id);\r\n    } else {\r\n      for (const h of r.domains) addToMap(allowedDomains, h, src.id);\r\n    }\r\n    if (r.addresses?.length) trustedTokenAddresses.push(...r.addresses);\r\n    sources.push({\r\n      name: src.id,\r\n      ok: r.ok,\r\n      count: r.domains.length + (r.addresses?.length ?? 0),\r\n      url: src.url,\r\n    });\r\n  }\r\n\r\n  await fetchMewDarklist(blockedDomains, sources);\r\n  await fetchMewLightlist(allowedDomains, sources);\r\n  await fetchScamSniffer(blockedDomains, blockedAddresses, sources);\r\n  await fetchCryptoScamDb(blockedDomains, allowedDomains, sources);\r\n  await fetchPolkadot(blockedDomains, allowedDomains, blockedAddresses, sources);\r\n\r\n  const blockedDomainsList = Object.keys(blockedDomains);\r\n  const trustedDomainsList = Array.from(new Set([...Object.keys(allowedDomains), ...TRUSTED_SEED])).map(normalizeHost).filter(Boolean);\r\n  const blockedAddressesList: ThreatIntelAddress[] = Object.entries(blockedAddresses).map(\r\n    ([addr, srcs]) => ({\r\n      address: addr as `0x${string}`,\r\n      chainId: undefined,\r\n      label: `Blocked (${srcs.join(\", \")})`,\r\n      category: \"UNKNOWN\",\r\n      sourceId: srcs[0] || \"intel\",\r\n      confidence: 1,\r\n      updatedAt: now,\r\n    })\r\n  );\r\n\r\n  return {\r\n    updatedAt: now,\r\n    sources,\r\n    blockedDomains,\r\n    allowedDomains,\r\n    blockedAddresses,\r\n    trustedSeed: trustedDomainsList,\r\n    trustedTokenAddresses: [...new Set(trustedTokenAddresses.map((a) => a.toLowerCase()))],\r\n    blockedDomainsList,\r\n    blockedAddressesList,\r\n  };\r\n}\r\n\r\nexport function hostInBlocked(intel: ThreatIntel | null, host: string): boolean {\r\n  if (!intel) return false;\r\n  const h = normalizeHost(host);\r\n  return h in intel.blockedDomains || intel.blockedDomainsList.includes(h);\r\n}\r\n\r\nexport function hostInTrustedSeed(intel: ThreatIntel | null, host: string): boolean {\r\n  if (!intel) return false;\r\n  const h = normalizeHost(host);\r\n  return intel.trustedSeed.some((d) => hostMatches(h, d)) || h in intel.allowedDomains;\r\n}\r\n\r\nexport function addressInBlocked(intel: ThreatIntel | null, addr: string): ThreatIntelAddress | null {\r\n  if (!intel || !addr) return null;\r\n  const a = String(addr).toLowerCase();\r\n  return intel.blockedAddressesList.find((x) => x.address.toLowerCase() === a) || null;\r\n}\r\n", "/**\r\n * Address/contract/token intel (no-custody). Load from cache only on critical path; refresh async.\r\n */\r\n\r\nexport type AddressLabel =\r\n  | \"SANCTIONED\"\r\n  | \"SCAM_REPORTED\"\r\n  | \"PHISHING_REPORTED\"\r\n  | \"MALICIOUS_CONTRACT\"\r\n  | \"UNVERIFIED_TOKEN\"\r\n  | \"KNOWN_MARKETPLACE\"\r\n  | \"KNOWN_DEX\"\r\n  | \"KNOWN_BRIDGE\"\r\n  | \"KNOWN_EXPLORER\"\r\n  | \"KNOWN_WALLET_VENDOR\";\r\n\r\nexport type AddressIntel = {\r\n  updatedAt: number;\r\n  sources: { name: string; ok: boolean; count: number; url: string }[];\r\n  labelsByAddress: Record<string, AddressLabel[]>;\r\n  tokenFlagsByContract: Record<string, (\"SCAM_TOKEN\" | \"IMPERSONATOR\" | \"HONEY_POT_SUSPECT\")[]>;\r\n};\r\n\r\nconst STORAGE_ADDR_INTEL_KEY = \"sg_addr_intel\";\r\nconst ADDR_INTEL_VERSION = 1;\r\nconst ADDR_INTEL_TTL_MS = 24 * 60 * 60 * 1000;\r\nconst FETCH_TIMEOUT_MS = 6000;\r\n\r\nconst EVM_ADDRESS_REGEX = /^0x[a-fA-F0-9]{40}$/;\r\n\r\nexport function normalizeAddr(addr: string): string {\r\n  const s = String(addr || \"\").trim();\r\n  if (!s.startsWith(\"0x\")) return \"\";\r\n  const hex = s.slice(2).toLowerCase().replace(/^0x/, \"\");\r\n  if (hex.length !== 40 || !/^[a-f0-9]{40}$/.test(hex)) return \"\";\r\n  return \"0x\" + hex;\r\n}\r\n\r\nexport function mergeLabels(dst: Record<string, AddressLabel[]>, addr: string, labels: AddressLabel[]): void {\r\n  const a = normalizeAddr(addr);\r\n  if (!a || !labels.length) return;\r\n  if (!dst[a]) dst[a] = [];\r\n  for (const l of labels) {\r\n    if (!dst[a].includes(l)) dst[a].push(l);\r\n  }\r\n}\r\n\r\nfunction fetchWithTimeout(url: string): Promise<Response> {\r\n  const ctrl = new AbortController();\r\n  const timer = setTimeout(() => ctrl.abort(), FETCH_TIMEOUT_MS);\r\n  try {\r\n    return fetch(url, { signal: ctrl.signal, cache: \"no-store\" }).finally(() => clearTimeout(timer));\r\n  } catch {\r\n    clearTimeout(timer);\r\n    throw new Error(\"timeout\");\r\n  }\r\n}\r\n\r\nconst SCAMSNIFFER_ADDRESSES = \"https://raw.githubusercontent.com/scamsniffer/scam-database/main/blacklist/address.json\";\r\n\r\nasync function fetchScamSnifferAddresses(labelsByAddress: Record<string, AddressLabel[]>, sources: AddressIntel[\"sources\"]): Promise<void> {\r\n  try {\r\n    const res = await fetchWithTimeout(SCAMSNIFFER_ADDRESSES);\r\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n    const data = (await res.json()) as unknown;\r\n    const rawList = Array.isArray(data) ? data : (data && typeof data === \"object\" ? Object.keys(data as Record<string, unknown>) : []);\r\n    let count = 0;\r\n    for (const item of rawList) {\r\n      const s = String(item || \"\").trim().toLowerCase();\r\n      if (EVM_ADDRESS_REGEX.test(s)) {\r\n        mergeLabels(labelsByAddress, s, [\"SCAM_REPORTED\"]);\r\n        count++;\r\n      }\r\n    }\r\n    sources.push({ name: \"scamsniffer-addresses\", ok: true, count, url: SCAMSNIFFER_ADDRESSES });\r\n  } catch {\r\n    sources.push({ name: \"scamsniffer-addresses\", ok: false, count: 0, url: SCAMSNIFFER_ADDRESSES });\r\n  }\r\n}\r\n\r\nexport function seedKnownAddresses(): { labelsByAddress: Record<string, AddressLabel[]> } {\r\n  return { labelsByAddress: {} };\r\n}\r\n\r\nfunction getMinimalAddressIntel(): AddressIntel {\r\n  return {\r\n    updatedAt: 0,\r\n    sources: [{ name: \"local_seed\", ok: true, count: 0, url: \"\" }],\r\n    labelsByAddress: {},\r\n    tokenFlagsByContract: {},\r\n  };\r\n}\r\n\r\nfunction isValidIntelShape(r: unknown): r is AddressIntel {\r\n  if (!r || typeof r !== \"object\") return false;\r\n  const o = r as Record<string, unknown>;\r\n  return (\r\n    typeof o.updatedAt === \"number\" &&\r\n    Array.isArray(o.sources) &&\r\n    typeof o.labelsByAddress === \"object\" &&\r\n    o.labelsByAddress !== null &&\r\n    typeof o.tokenFlagsByContract === \"object\" &&\r\n    o.tokenFlagsByContract !== null\r\n  );\r\n}\r\n\r\nexport async function loadAddressIntelCachedFast(): Promise<{\r\n  intel: AddressIntel;\r\n  isMissing: boolean;\r\n  isStale: boolean;\r\n}> {\r\n  try {\r\n    const r = await (chrome.storage.local.get as (key: string) => Promise<Record<string, unknown>>)(STORAGE_ADDR_INTEL_KEY);\r\n    const raw = r?.[STORAGE_ADDR_INTEL_KEY];\r\n    if (!raw || !isValidIntelShape(raw)) {\r\n      const minimal = getMinimalAddressIntel();\r\n      return { intel: minimal, isMissing: true, isStale: true };\r\n    }\r\n    const intel = raw as AddressIntel;\r\n    const isStale = Date.now() - intel.updatedAt > ADDR_INTEL_TTL_MS;\r\n    return { intel, isMissing: false, isStale };\r\n  } catch {\r\n    const minimal = getMinimalAddressIntel();\r\n    return { intel: minimal, isMissing: true, isStale: true };\r\n  }\r\n}\r\n\r\nexport async function saveAddressIntel(intel: AddressIntel): Promise<void> {\r\n  try {\r\n    await (chrome.storage.local.set as (obj: Record<string, unknown>) => Promise<void>)({ [STORAGE_ADDR_INTEL_KEY]: intel });\r\n  } catch {}\r\n}\r\n\r\nexport async function refreshAddressIntel(): Promise<AddressIntel> {\r\n  const now = Date.now();\r\n  const labelsByAddress: Record<string, AddressLabel[]> = {};\r\n  const tokenFlagsByContract: Record<string, (\"SCAM_TOKEN\" | \"IMPERSONATOR\" | \"HONEY_POT_SUSPECT\")[]> = {};\r\n  const sources: AddressIntel[\"sources\"] = [];\r\n\r\n  await fetchScamSnifferAddresses(labelsByAddress, sources);\r\n\r\n  const seed = seedKnownAddresses();\r\n  for (const [addr, labels] of Object.entries(seed.labelsByAddress)) {\r\n    if (addr && labels?.length) mergeLabels(labelsByAddress, addr, labels);\r\n  }\r\n\r\n  return {\r\n    updatedAt: now,\r\n    sources,\r\n    labelsByAddress,\r\n    tokenFlagsByContract,\r\n  };\r\n}\r\n", "/**\r\n * Human-readable EVM tx decoding (selectors only, no ABI). Used for overlay labels and reasons.\r\n */\r\n\r\nexport type DecodedEvmTxKind =\r\n  | \"ERC20_TRANSFER\"\r\n  | \"ERC20_APPROVE\"\r\n  | \"ERC20_TRANSFER_FROM\"\r\n  | \"ERC721_TRANSFER\"\r\n  | \"NFT_APPROVAL_ALL\"\r\n  | \"ERC1155_TRANSFER\"\r\n  | \"ERC1155_BATCH_TRANSFER\"\r\n  | \"UNKNOWN\";\r\n\r\nexport type DecodedEvmTx = {\r\n  kind: DecodedEvmTxKind;\r\n  tokenContract?: string;\r\n  toAddress?: string;\r\n  fromAddress?: string;\r\n  spender?: string;\r\n  amountRaw?: string;\r\n  isUnlimited?: boolean;\r\n  selector?: string;\r\n  tokenIdRaw?: string;\r\n};\r\n\r\nconst SELECTOR_TRANSFER = \"0xa9059cbb\";\r\nconst SELECTOR_APPROVE = \"0x095ea7b3\";\r\nconst SELECTOR_TRANSFER_FROM = \"0x23b872dd\";\r\nconst SELECTOR_SET_APPROVAL_FOR_ALL = \"0xa22cb465\";\r\nconst SELECTOR_SAFE_TRANSFER_FROM_1 = \"0x42842e0e\";\r\nconst SELECTOR_SAFE_TRANSFER_FROM_2 = \"0xb88d4fde\";\r\nconst SELECTOR_ERC1155_SAFE_TRANSFER = \"0xf242432a\";\r\nconst SELECTOR_ERC1155_SAFE_BATCH_TRANSFER = \"0x2eb2c2d6\";\r\nconst MAX_UINT256 = 2n ** 256n - 1n;\r\n\r\nfunction readWord(dataHex: string, wordIndex: number): string {\r\n  const data = dataHex.startsWith(\"0x\") ? dataHex.slice(2) : dataHex;\r\n  const start = wordIndex * 64;\r\n  return data.slice(start, start + 64);\r\n}\r\n\r\nfunction readAddress(dataHex: string, wordIndex: number): string {\r\n  const word = readWord(dataHex, wordIndex);\r\n  return (\"0x\" + (word.length >= 40 ? word.slice(24) : word.padStart(40, \"0\"))).toLowerCase();\r\n}\r\n\r\nfunction readUint256(dataHex: string, wordIndex: number): bigint {\r\n  const word = readWord(dataHex, wordIndex);\r\n  if (!word) return 0n;\r\n  return BigInt(\"0x\" + word);\r\n}\r\n\r\nexport function decodeEvmTx(\r\n  tx: { to?: string; data?: string; value?: string },\r\n  _chainId?: string\r\n): DecodedEvmTx {\r\n  const to = (tx.to || \"\").toLowerCase();\r\n  const data = typeof tx.data === \"string\" ? tx.data.toLowerCase() : \"\";\r\n  if (!data || !data.startsWith(\"0x\") || data.length < 10) {\r\n    return { kind: \"UNKNOWN\", selector: undefined };\r\n  }\r\n  const selector = data.slice(0, 10);\r\n  const body = data.slice(10);\r\n\r\n  if (selector === SELECTOR_APPROVE) {\r\n    const spender = readAddress(body, 0);\r\n    const amount = readUint256(body, 2);\r\n    const isUnlimited = amount === MAX_UINT256;\r\n    return {\r\n      kind: \"ERC20_APPROVE\",\r\n      tokenContract: to,\r\n      spender,\r\n      amountRaw: amount.toString(),\r\n      isUnlimited,\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_TRANSFER) {\r\n    const toAddress = readAddress(body, 0);\r\n    const amount = readUint256(body, 2);\r\n    return {\r\n      kind: \"ERC20_TRANSFER\",\r\n      tokenContract: to,\r\n      toAddress,\r\n      amountRaw: amount.toString(),\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_TRANSFER_FROM) {\r\n    const fromAddress = readAddress(body, 0);\r\n    const toAddress = readAddress(body, 1);\r\n    const amount = readUint256(body, 2);\r\n    return {\r\n      kind: \"ERC20_TRANSFER_FROM\",\r\n      tokenContract: to,\r\n      fromAddress,\r\n      toAddress,\r\n      amountRaw: amount.toString(),\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_SET_APPROVAL_FOR_ALL) {\r\n    const operator = readAddress(body, 0);\r\n    const approved = readUint256(body, 2) !== 0n;\r\n    return {\r\n      kind: \"NFT_APPROVAL_ALL\",\r\n      tokenContract: to,\r\n      spender: operator,\r\n      isUnlimited: approved,\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_ERC1155_SAFE_TRANSFER) {\r\n    const fromAddress = readAddress(body, 0);\r\n    const toAddress = readAddress(body, 1);\r\n    const id = readUint256(body, 2);\r\n    const amount = readUint256(body, 3);\r\n    return {\r\n      kind: \"ERC1155_TRANSFER\",\r\n      tokenContract: to,\r\n      fromAddress,\r\n      toAddress,\r\n      amountRaw: amount.toString(),\r\n      tokenIdRaw: id.toString(),\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_ERC1155_SAFE_BATCH_TRANSFER) {\r\n    const fromAddress = readAddress(body, 0);\r\n    const toAddress = readAddress(body, 1);\r\n    return {\r\n      kind: \"ERC1155_BATCH_TRANSFER\",\r\n      tokenContract: to,\r\n      fromAddress,\r\n      toAddress,\r\n      selector,\r\n    };\r\n  }\r\n  if (selector === SELECTOR_SAFE_TRANSFER_FROM_1 || selector === SELECTOR_SAFE_TRANSFER_FROM_2) {\r\n    const fromAddress = readAddress(body, 0);\r\n    const toAddress = readAddress(body, 2);\r\n    const tokenId = readUint256(body, 4);\r\n    return {\r\n      kind: \"ERC721_TRANSFER\",\r\n      tokenContract: to,\r\n      fromAddress,\r\n      toAddress,\r\n      tokenIdRaw: tokenId.toString(),\r\n      selector,\r\n    };\r\n  }\r\n  return { kind: \"UNKNOWN\", selector };\r\n}\r\n\r\nexport type TypedDataPermitExtras = {\r\n  spender?: string;\r\n  value?: string;\r\n  deadline?: string;\r\n};\r\n\r\n/** Permit2 typed data decode (PermitSingle / PermitBatch). */\r\nexport type Permit2Decoded = {\r\n  spender: string;\r\n  tokens: string[];\r\n  amounts: string[];\r\n  expiration?: string;\r\n  sigDeadline?: string;\r\n  unlimited?: boolean;\r\n};\r\n\r\n/** Seaport typed data summary. */\r\nexport type SeaportDecoded = {\r\n  offerSummary: string;\r\n  considerationSummary: string;\r\n  primaryType?: string;\r\n};\r\n\r\nexport function extractPermit2FromTypedData(raw: string): Permit2Decoded | null {\r\n  try {\r\n    if (!raw || raw.length > 200_000) return null;\r\n    const j: any = JSON.parse(raw);\r\n    const domainName = String(j?.domain?.name || \"\").toLowerCase();\r\n    const primaryType = String(j?.primaryType || \"\").toLowerCase();\r\n    const msg = j?.message || {};\r\n    const isPermit2 = domainName.includes(\"permit2\") || (!!msg?.permitted && !!msg?.spender);\r\n    if (!isPermit2) return null;\r\n    const spender = typeof msg?.spender === \"string\" ? msg.spender.trim().toLowerCase() : \"\";\r\n    if (!spender) return null;\r\n    const tokens: string[] = [];\r\n    const amounts: string[] = [];\r\n    let unlimited = false;\r\n    const MAX_UINT = \"115792089237316195423570985008687907853269984665640564039457584007913129639935\";\r\n    if (msg?.permitted && Array.isArray(msg.permitted)) {\r\n      for (const p of msg.permitted) {\r\n        const tok = p?.token ?? p?.tokenAddress;\r\n        if (typeof tok === \"string\") tokens.push(tok.toLowerCase());\r\n        const amt = p?.amount ?? p?.amountMax ?? \"0\";\r\n        amounts.push(String(amt));\r\n        if (String(amt) === MAX_UINT || BigInt(amt) >= 2n ** 255n) unlimited = true;\r\n      }\r\n    } else if (msg?.token || msg?.tokenAddress) {\r\n      tokens.push(String(msg.token || msg.tokenAddress).toLowerCase());\r\n      const amt = msg?.amount ?? msg?.amountMax ?? \"0\";\r\n      amounts.push(String(amt));\r\n      if (String(amt) === MAX_UINT || BigInt(amt) >= 2n ** 255n) unlimited = true;\r\n    }\r\n    const expiration = msg?.expiration ?? msg?.nonce;\r\n    const sigDeadline = msg?.sigDeadline ?? msg?.deadline;\r\n    return { spender, tokens, amounts, expiration: expiration != null ? String(expiration) : undefined, sigDeadline: sigDeadline != null ? String(sigDeadline) : undefined, unlimited };\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function extractSeaportFromTypedData(raw: string): SeaportDecoded | null {\r\n  try {\r\n    if (!raw || raw.length > 200_000) return null;\r\n    const j: any = JSON.parse(raw);\r\n    const domainName = String(j?.domain?.name || \"\").toLowerCase();\r\n    const msg = j?.message || {};\r\n    const isSeaport = domainName.includes(\"seaport\") || (!!msg?.offer && !!msg?.consideration);\r\n    if (!isSeaport) return null;\r\n    const primaryType = j?.primaryType ?? \"OrderComponents\";\r\n    const offer = Array.isArray(msg?.offer) ? msg.offer : [];\r\n    const consideration = Array.isArray(msg?.consideration) ? msg.consideration : [];\r\n    const fmt = (arr: any[]) => {\r\n      if (arr.length === 0) return \"\u2014\";\r\n      if (arr.length === 1) {\r\n        const x = arr[0];\r\n        const amt = x?.startAmount ?? x?.amount ?? \"?\";\r\n        return `${amt} item(s)`;\r\n      }\r\n      return `${arr.length} itens`;\r\n    };\r\n    return { offerSummary: fmt(offer), considerationSummary: fmt(consideration), primaryType };\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function isBlurTypedData(raw: string): boolean {\r\n  try {\r\n    if (!raw || raw.length > 50_000) return false;\r\n    const j: any = JSON.parse(raw);\r\n    const domainName = String(j?.domain?.name || \"\").toLowerCase();\r\n    return domainName.includes(\"blur\");\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n/** Extract Permit-like fields from EIP-712 typed data (primaryType / message). */\r\nexport function extractTypedDataPermitExtras(raw: string): TypedDataPermitExtras | null {\r\n  try {\r\n    if (!raw || raw.length > 200_000) return null;\r\n    const j: any = JSON.parse(raw);\r\n    const domainName = String(j?.domain?.name || \"\").toLowerCase();\r\n    const primaryType = String(j?.primaryType || \"\").toLowerCase();\r\n    const msg = j?.message || {};\r\n    const looksPermit = domainName.includes(\"permit\") || primaryType.includes(\"permit\") || (!!msg?.permitted && !!msg?.spender);\r\n    const looksApproveLike = !!msg?.spender && ((\"value\" in msg) || (\"amount\" in msg));\r\n    if (!looksPermit && !looksApproveLike) return null;\r\n    const spender = typeof msg?.spender === \"string\" ? msg.spender.trim() : undefined;\r\n    const value = typeof msg?.value === \"string\" ? msg.value : (typeof msg?.amount === \"string\" ? msg.amount : undefined);\r\n    const deadline = typeof msg?.deadline === \"string\" ? msg.deadline : (typeof msg?.expiry === \"string\" ? msg.expiry : undefined);\r\n    if (!spender && !value && !deadline) return null;\r\n    return { spender: spender || undefined, value, deadline };\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n", "export function normalizeHost(host: string): string {\r\n  return String(host || \"\").trim().toLowerCase().replace(/\\.$/, \"\");\r\n}\r\n\r\nfunction getTld(host: string) {\r\n  const parts = normalizeHost(host).split(\".\").filter(Boolean);\r\n  return parts.length ? parts[parts.length - 1] : \"\";\r\n}\r\n\r\nfunction getLabels(host: string) {\r\n  return normalizeHost(host).split(\".\").filter(Boolean);\r\n}\r\n\r\n// Approximation: registrable domain label (2nd-level) using last 2 labels.\r\nfunction getRegistrableLabel(host: string) {\r\n  const parts = getLabels(host);\r\n  if (parts.length < 2) return parts[0] || \"\";\r\n  return parts[parts.length - 2] || \"\";\r\n}\r\n\r\nfunction hasPunycode(host: string) {\r\n  const h = normalizeHost(host);\r\n  return h.startsWith(\"xn--\") || h.includes(\".xn--\");\r\n}\r\n\r\nfunction levenshtein(a: string, b: string) {\r\n  const s = String(a || \"\");\r\n  const t = String(b || \"\");\r\n  const n = s.length;\r\n  const m = t.length;\r\n  if (n === 0) return m;\r\n  if (m === 0) return n;\r\n\r\n  const v0 = new Array(m + 1).fill(0);\r\n  const v1 = new Array(m + 1).fill(0);\r\n\r\n  for (let i = 0; i <= m; i++) v0[i] = i;\r\n  for (let i = 0; i < n; i++) {\r\n    v1[0] = i + 1;\r\n    for (let j = 0; j < m; j++) {\r\n      const cost = s[i] === t[j] ? 0 : 1;\r\n      v1[j + 1] = Math.min(\r\n        v1[j] + 1,        // insertion\r\n        v0[j + 1] + 1,    // deletion\r\n        v0[j] + cost      // substitution\r\n      );\r\n    }\r\n    for (let j = 0; j <= m; j++) v0[j] = v1[j];\r\n  }\r\n  return v0[m];\r\n}\r\n\r\nfunction isSuspiciousSubdomain(host: string, brands: string[]) {\r\n  const labels = getLabels(host);\r\n  if (labels.length < 3) return false;\r\n  const registrable = getRegistrableLabel(host);\r\n  const sub = labels.slice(0, -2).join(\".\");\r\n  if (!sub) return false;\r\n  for (const b of brands) {\r\n    if (!b) continue;\r\n    const hitInSub = labels.slice(0, -2).some((x) => x.includes(b));\r\n    if (hitInSub && !registrable.includes(b)) return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction findBrandTypo(host: string, brands: string[]) {\r\n  const reg = getRegistrableLabel(host);\r\n  const clean = reg.replace(/[^a-z0-9]/g, \"\");\r\n  const segments = reg.split(/[-_]/g).filter(Boolean);\r\n  const candidates = Array.from(new Set([reg, clean, ...segments].filter(Boolean)));\r\n\r\n  let best: { brand: string; cand: string; dist: number } | null = null;\r\n  for (const b of brands) {\r\n    const brand = String(b || \"\").toLowerCase();\r\n    if (!brand) continue;\r\n    for (const cand of candidates) {\r\n      const c = String(cand || \"\").toLowerCase();\r\n      if (!c) continue;\r\n      // quick: exact brand in label is also a lookalike signal\r\n      if (c.includes(brand) && c !== brand) {\r\n        return { brand, cand: c, dist: 0 };\r\n      }\r\n      const d = levenshtein(c, brand);\r\n      if (d <= 2 && c !== brand) {\r\n        if (!best || d < best.dist) best = { brand, cand: c, dist: d };\r\n      }\r\n    }\r\n  }\r\n  return best;\r\n}\r\n\r\nexport function assessDomainRisk(host: string, brandSeeds: string[]) {\r\n  const reasons: string[] = [];\r\n  let scoreDelta = 0;\r\n\r\n  const h = normalizeHost(host);\r\n  if (!h) return { scoreDelta, reasons };\r\n\r\n  const suspiciousTlds = new Set([\"zip\", \"mov\", \"top\", \"xyz\", \"click\", \"fit\"]);\r\n  const tld = getTld(h);\r\n\r\n  if (hasPunycode(h)) {\r\n    scoreDelta += 30;\r\n    reasons.push(\"Lookalike: punycode (xn--) detectado.\");\r\n  }\r\n\r\n  if (isSuspiciousSubdomain(h, brandSeeds)) {\r\n    scoreDelta += 35;\r\n    reasons.push(\"Lookalike: marca aparece no subdom\u00EDnio (n\u00E3o no dom\u00EDnio registr\u00E1vel).\");\r\n  }\r\n\r\n  const typo = findBrandTypo(h, brandSeeds);\r\n  if (typo) {\r\n    scoreDelta += 40;\r\n    reasons.push(`Lookalike: poss\u00EDvel typo/varia\u00E7\u00E3o de \"${typo.brand}\".`);\r\n  }\r\n\r\n  if (tld && suspiciousTlds.has(tld)) {\r\n    scoreDelta += 10;\r\n    reasons.push(`TLD suspeito (.${tld}).`);\r\n  }\r\n\r\n  // Clamp\r\n  scoreDelta = Math.max(0, Math.min(80, scoreDelta));\r\n  return { scoreDelta, reasons };\r\n}\r\n\r\n", "/**\r\n * Honeypot detection: simulate buy then sell/transfer to detect tokens that cannot be sold.\r\n * Uses Tenderly with state overrides for full cycle (buy -> approve -> sell) or transfer test.\r\n * MVP: structure + transfer test when state is available; full cycle requires state_overrides from Tenderly.\r\n */\r\n\r\nimport type { Settings } from \"../shared/types\";\r\nimport { simulateTransaction, type SimulateTransactionBody } from \"./simulationService\";\r\n\r\nconst HONEYPOT_SOFT_THRESHOLD = 0.8; // (Venda/Compra) < 0.8 => SOFT\r\n\r\nexport type HoneypotResult = {\r\n  isHoneypot: boolean;\r\n  type?: \"HARD\" | \"SOFT\";\r\n  reason?: string;\r\n  ethSpent?: string;\r\n  ethReceived?: string;\r\n  /** False when running without API (no keys). */\r\n  simulated?: boolean;\r\n  /** Message when simulated is false. */\r\n  message?: string;\r\n};\r\n\r\n/**\r\n * Run honeypot detection: Step A (buy), then if possible Step B/C (approve + sell or transfer).\r\n * MVP: runs buy simulation only; if success, attempts transfer simulation (requires state after buy).\r\n * When Tenderly returns state_overrides, we can run transfer with that state; if transfer reverts => HONEYPOT HARD.\r\n * When we have sell simulation result, (ethReceived/ethSpent) < 0.8 => HONEYPOT SOFT.\r\n */\r\nexport async function runHoneypotCheck(\r\n  networkId: string,\r\n  from: string,\r\n  to: string,\r\n  input: string,\r\n  value: string,\r\n  gas: number | undefined,\r\n  settings: Settings,\r\n  /** Token contract address to test transfer (e.g. from swap path or tx.to for approvals). */\r\n  tokenAddress?: string\r\n): Promise<HoneypotResult> {\r\n  try {\r\n    const body: SimulateTransactionBody = {\r\n      network_id: networkId,\r\n      from,\r\n      to,\r\n      input: input || \"0x\",\r\n      value: value || \"0x0\",\r\n    };\r\n    if (gas != null && gas > 0) body.gas = gas;\r\n\r\n    const raw = await simulateTransaction(body, settings);\r\n    if (!raw) return { isHoneypot: false, simulated: false, message: \"Modo Est\u00E1tico (Adicione chaves para Simula\u00E7\u00E3o)\" };\r\n\r\n    const txStatus = raw.transaction?.status;\r\n    if (txStatus === 1) return { isHoneypot: false }; // Buy reverted\r\n\r\n    const assetChanges = Array.isArray((raw as any).asset_changes) ? (raw as any).asset_changes : [];\r\n    let ethSpent = \"0\";\r\n    let ethReceived = \"0\";\r\n    let incomingTokenAddress: string | undefined;\r\n    let incomingTokenAmount: string | undefined;\r\n\r\n    for (const ch of assetChanges) {\r\n      const type = String(ch?.type || \"\").toUpperCase();\r\n      const fromAddr = (ch?.from ?? \"\").toLowerCase();\r\n      const toAddr = (ch?.to ?? \"\").toLowerCase();\r\n      const amount = ch?.amount ?? ch?.raw_amount ?? \"0\";\r\n      const info = ch?.asset_info;\r\n\r\n      if (type.includes(\"SEND\") && fromAddr === from.toLowerCase()) {\r\n        if (info?.symbol === \"ETH\" || !info?.symbol) ethSpent = String(amount);\r\n      } else if ((type.includes(\"RECEIVE\") || toAddr === from.toLowerCase()) && toAddr === from.toLowerCase()) {\r\n        if (info?.symbol === \"ETH\" || !info?.symbol) {\r\n          ethReceived = String(amount);\r\n        } else {\r\n          incomingTokenAddress = fromAddr.startsWith(\"0x\") ? fromAddr : undefined;\r\n          incomingTokenAmount = String(amount);\r\n        }\r\n      }\r\n    }\r\n\r\n    const _tokenToTest = tokenAddress || incomingTokenAddress;\r\n    const spendNum = parseFloat(ethSpent);\r\n    const receivedNum = parseFloat(ethReceived);\r\n    if (spendNum > 0 && receivedNum > 0 && receivedNum / spendNum < HONEYPOT_SOFT_THRESHOLD) {\r\n      return {\r\n        isHoneypot: true,\r\n        type: \"SOFT\",\r\n        reason: \"Sell returns < 80% of buy cost (abusive sell tax).\",\r\n        ethSpent,\r\n        ethReceived,\r\n      };\r\n    }\r\n\r\n    return { isHoneypot: false, ethSpent, ethReceived };\r\n  } catch {\r\n    return { isHoneypot: false };\r\n  }\r\n}\r\n", "/**\n * Single source of truth for optional host origins per feature.\n * No fetch to these domains without (a) feature ON in settings and (b) user-granted permissions.\n */\n\nexport type OptionalFeature = \"cloudIntel\" | \"pricing\" | \"simulation\" | \"telemetry\";\n\nexport const OPTIONAL_ORIGINS: Record<OptionalFeature, string[]> = {\n  cloudIntel: [\n    \"https://raw.githubusercontent.com/*\",\n    \"https://api.cryptoscamdb.org/*\",\n    \"https://gitlab.com/*\",\n    \"https://gateway.ipfs.io/*\",\n    \"https://api.llama.fi/*\",\n  ],\n  pricing: [\n    \"https://api.coingecko.com/*\",\n    \"https://api.dexscreener.com/*\",\n  ],\n  simulation: [\"https://api.tenderly.co/*\"],\n  telemetry: [\"https://cjnzidctntqzamhwmwkt.supabase.co/*\"],\n};\n\n/** Returns origins for a single feature. */\nexport function getOriginsForFeature(feature: OptionalFeature): string[] {\n  const list = OPTIONAL_ORIGINS[feature];\n  return list ? [...list] : [];\n}\n\n/** Returns origins for multiple features (deduplicated). */\nexport function getOriginsForFeatures(features: OptionalFeature[]): string[] {\n  const set = new Set<string>();\n  for (const f of features) {\n    const list = OPTIONAL_ORIGINS[f];\n    if (list) for (const o of list) set.add(o);\n  }\n  return [...set];\n}\n\n/** Union of all optional origins (deduplicated). */\nexport function getAllOptionalOrigins(): string[] {\n  return normalizeOrigins(\n    ([] as string[]).concat(\n      ...Object.keys(OPTIONAL_ORIGINS).map((k) => OPTIONAL_ORIGINS[k as OptionalFeature])\n    )\n  );\n}\n\n/** Dedupe and sort for stable manifest/validation. */\nexport function normalizeOrigins(origins: string[]): string[] {\n  return [...new Set(origins)].filter(Boolean).sort();\n}\n", "/**\n * Optional host permissions by feature. Uses optionalOrigins as single source of truth.\n */\n\nimport type { OptionalFeature } from \"./shared/optionalOrigins\";\nimport { getOriginsForFeature, getAllOptionalOrigins } from \"./shared/optionalOrigins\";\n\nasync function hasOrigins(origins: string[]): Promise<boolean> {\n  if (!origins.length) return true;\n  try {\n    if (!chrome?.permissions?.contains) return false;\n    return await chrome.permissions.contains({ origins });\n  } catch {\n    return false;\n  }\n}\n\nasync function requestOrigins(origins: string[]): Promise<boolean> {\n  if (!origins.length) return true;\n  try {\n    if (!chrome?.permissions?.request) return false;\n    return await chrome.permissions.request({ origins });\n  } catch {\n    return false;\n  }\n}\n\nasync function removeOrigins(origins: string[]): Promise<boolean> {\n  if (!origins.length) return true;\n  try {\n    if (!chrome?.permissions?.remove) return false;\n    return await chrome.permissions.remove({ origins });\n  } catch {\n    return false;\n  }\n}\n\nexport async function hasOptionalHostPermissions(feature: OptionalFeature): Promise<boolean> {\n  const origins = getOriginsForFeature(feature);\n  return hasOrigins(origins);\n}\n\nexport async function requestOptionalHostPermissions(feature: OptionalFeature): Promise<boolean> {\n  const origins = getOriginsForFeature(feature);\n  return requestOrigins(origins);\n}\n\nexport async function removeOptionalHostPermissions(feature: OptionalFeature): Promise<boolean> {\n  const origins = getOriginsForFeature(feature);\n  return removeOrigins(origins);\n}\n\n/** Legacy: pass explicit origins (e.g. from getOriginsForFeatures). */\nexport async function hasOptionalHostPermissionsOrigins(origins: string[]): Promise<boolean> {\n  return hasOrigins(origins);\n}\n\nexport async function requestOptionalHostPermissionsOrigins(origins: string[]): Promise<boolean> {\n  return requestOrigins(origins);\n}\n\nexport async function removeOptionalHostPermissionsOrigins(origins: string[]): Promise<boolean> {\n  return removeOrigins(origins);\n}\n\n/** True only if all optional origins (all features) are granted. Used by legacy handlers. */\nexport async function hasOptionalHostPermissionsAll(): Promise<boolean> {\n  return hasOrigins(getAllOptionalOrigins());\n}\n", "/**\n * Central gate: \"may this feature use the network?\" No fetch unless (a) feature ON and (b) permissions granted.\n * No fail-open: if gate fails, caller must use cache/seed/preflight only.\n */\nimport type { Settings } from \"../shared/types\";\nimport type { OptionalFeature } from \"../shared/optionalOrigins\";\nimport { OPTIONAL_ORIGINS, getOriginsForFeatures } from \"../shared/optionalOrigins\";\nimport { hasOptionalHostPermissions } from \"../permissions\";\n\nexport type NetGateResult = { ok: boolean; reason?: string };\n\nasync function hasOriginsForFeature(feature: OptionalFeature): Promise<boolean> {\n  return hasOptionalHostPermissions(feature);\n}\n\n/**\n * Returns whether the given feature may use the network.\n * - cloudIntel: settings.cloudIntelOptIn === true AND permissions for cloudIntel.\n * - pricing: settings.showUsd === true AND permissions for pricing.\n * - simulation: settings.simulation?.enabled === true AND permissions for simulation.\n * - telemetry: termsAccepted (from storage/caller) AND settings.telemetryOptIn AND permissions for telemetry.\n */\nexport async function canUseNetwork(\n  feature: OptionalFeature,\n  settings: Settings | null,\n  opts?: { termsAccepted?: boolean }\n): Promise<NetGateResult> {\n  const origins = OPTIONAL_ORIGINS[feature];\n  if (!origins?.length) return { ok: false, reason: \"no origins defined\" };\n\n  const granted = await hasOriginsForFeature(feature);\n  if (!granted) return { ok: false, reason: \"permissions not granted\" };\n\n  switch (feature) {\n    case \"cloudIntel\":\n      if (settings?.cloudIntelOptIn !== true) return { ok: false, reason: \"Cloud Intel disabled\" };\n      return { ok: true };\n    case \"pricing\":\n      if (settings?.showUsd !== true) return { ok: false, reason: \"USD/pricing disabled\" };\n      return { ok: true };\n    case \"simulation\":\n      if (settings?.simulation?.enabled !== true) return { ok: false, reason: \"Simulation disabled\" };\n      return { ok: true };\n    case \"telemetry\":\n      if (opts?.termsAccepted !== true) return { ok: false, reason: \"terms not accepted\" };\n      if (settings?.telemetryOptIn !== true) return { ok: false, reason: \"telemetry disabled\" };\n      return { ok: true };\n    default:\n      return { ok: false, reason: \"unknown feature\" };\n  }\n}\n\n/** Check if network is allowed for any of the given features (each checked independently; first OK wins). For \"all must be OK\" use sequential canUseNetwork. */\nexport async function canUseNetworkForAny(\n  features: OptionalFeature[],\n  settings: Settings | null,\n  opts?: { termsAccepted?: boolean }\n): Promise<NetGateResult> {\n  const origins = getOriginsForFeatures(features);\n  if (!origins.length) return { ok: true };\n  for (const f of features) {\n    const r = await canUseNetwork(f, settings, opts);\n    if (r.ok) return r;\n  }\n  return { ok: false, reason: \"no feature allowed\" };\n}\n", "/**\r\n * Token verification + cache: Uniswap list as verified tokens with symbol/logo.\r\n * TokenMap in storage for O(1) lookup; 7-day cache.\r\n * Network fetch only when Cloud Intel is on and permissions granted (see netGate).\r\n */\r\n\r\nimport { canUseNetwork } from \"./netGate\";\r\nimport { DEFAULT_SETTINGS } from \"../shared/types\";\r\nimport type { Settings } from \"../shared/types\";\r\n\r\n/** Compact entry: s = symbol, l = logoURI, v = verified */\r\nexport type TokenEntry = { s: string; l: string; v: boolean };\r\n\r\n/** Key = address (lowercase), value = TokenEntry */\r\nexport type TokenMap = Record<string, TokenEntry>;\r\n\r\nconst TOKEN_CACHE_KEY = \"tokenCache\";\r\nconst TOKEN_FIRST_SEEN_KEY = \"sg_token_first_seen_v1\";\r\nconst CACHE_AGE_MS = 7 * 24 * 60 * 60 * 1000; // 7 days\r\nconst NEW_TOKEN_DAYS = 7; // tokens seen < 7 days ago = \"low confidence\"\r\nconst UNISWAP_LIST_URL = \"https://gateway.ipfs.io/ipns/tokens.uniswap.org\";\r\nconst FETCH_TIMEOUT_MS = 15000;\r\n\r\nlet inMemoryMap: TokenMap = {};\r\n\r\nfunction normalizeAddr(addr: string): string {\r\n  const a = String(addr || \"\").trim().toLowerCase();\r\n  return a.startsWith(\"0x\") && a.length === 42 ? a : \"\";\r\n}\r\n\r\nfunction buildTokenMap(data: unknown): TokenMap {\r\n  const map: TokenMap = {};\r\n  if (!data || typeof data !== \"object\") return map;\r\n  const tokens = Array.isArray((data as any).tokens) ? (data as any).tokens : [];\r\n  for (const t of tokens) {\r\n    const addr = (t as any)?.address;\r\n    const a = normalizeAddr(typeof addr === \"string\" ? addr : \"\");\r\n    if (!a) continue;\r\n    const symbol = typeof (t as any).symbol === \"string\" ? (t as any).symbol : \"?\";\r\n    const logoURI = typeof (t as any).logoURI === \"string\" ? (t as any).logoURI : \"\";\r\n    map[a] = { s: symbol, l: logoURI, v: true };\r\n  }\r\n  return map;\r\n}\r\n\r\nasync function fetchUniswapList(): Promise<TokenMap> {\r\n  const ctrl = new AbortController();\r\n  const t = setTimeout(() => ctrl.abort(), FETCH_TIMEOUT_MS);\r\n  try {\r\n    const res = await fetch(UNISWAP_LIST_URL, { cache: \"no-store\", signal: ctrl.signal });\r\n    clearTimeout(t);\r\n    if (!res.ok) return {};\r\n    const data = await res.json();\r\n    return buildTokenMap(data);\r\n  } catch {\r\n    clearTimeout(t);\r\n    return {};\r\n  }\r\n}\r\n\r\nasync function getSettings(): Promise<Settings> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      chrome.storage.sync.get(DEFAULT_SETTINGS, (r) => resolve((r as Settings) ?? DEFAULT_SETTINGS));\r\n    } catch {\r\n      resolve(DEFAULT_SETTINGS);\r\n    }\r\n  });\r\n}\r\n\r\nasync function loadFromStorageAndMaybeRefresh(): Promise<void> {\r\n  try {\r\n    const raw = await new Promise<{ tokenCache?: { map?: TokenMap; updatedAt?: number } }>((resolve) => {\r\n      chrome.storage.local.get(TOKEN_CACHE_KEY, (r) => resolve(r as any));\r\n    });\r\n    const cache = raw?.tokenCache;\r\n    const map = cache?.map && typeof cache?.updatedAt === \"number\" ? cache.map : null;\r\n    const updatedAt = cache?.updatedAt ?? 0;\r\n    const isStale = Date.now() - updatedAt > CACHE_AGE_MS;\r\n\r\n    if (map && Object.keys(map).length > 0 && !isStale) {\r\n      inMemoryMap = map;\r\n      return;\r\n    }\r\n\r\n    const settings = await getSettings();\r\n    const gate = await canUseNetwork(\"cloudIntel\", settings);\r\n    if (!gate.ok) {\r\n      if (map && Object.keys(map).length > 0) inMemoryMap = map;\r\n      return;\r\n    }\r\n\r\n    const fresh = await fetchUniswapList();\r\n    if (Object.keys(fresh).length > 0) {\r\n      inMemoryMap = fresh;\r\n      await new Promise<void>((resolve, reject) => {\r\n        chrome.storage.local.set(\r\n          { [TOKEN_CACHE_KEY]: { map: fresh, updatedAt: Date.now() } },\r\n          () => (chrome.runtime?.lastError ? reject(chrome.runtime.lastError) : resolve())\r\n        );\r\n      });\r\n    } else if (map && Object.keys(map).length > 0) {\r\n      inMemoryMap = map;\r\n    }\r\n  } catch {\r\n    if (Object.keys(inMemoryMap).length > 0) return;\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize token security: load cache from storage; if missing or older than 7 days, fetch Uniswap list and save.\r\n * Call from background on startup or first use.\r\n */\r\nexport async function initTokenSecurity(): Promise<void> {\r\n  await loadFromStorageAndMaybeRefresh();\r\n}\r\n\r\n/**\r\n * O(1) lookup from in-memory map (loaded from storage on init).\r\n * Returns { symbol, logoURI, verified } or undefined if not in list.\r\n */\r\nexport function getTokenInfo(address: string): TokenEntry | undefined {\r\n  const a = normalizeAddr(address);\r\n  return a ? inMemoryMap[a] : undefined;\r\n}\r\n\r\n/** Legacy: whether the address is in the verified (Uniswap) list. */\r\nexport function isTokenVerified(_intel: unknown, address: string): boolean {\r\n  return getTokenInfo(address)?.v ?? false;\r\n}\r\n\r\nfunction tokenKey(chainIdHex: string, address: string): string {\r\n  const c = String(chainIdHex ?? \"\").trim().toLowerCase();\r\n  const a = normalizeAddr(address);\r\n  if (!a) return \"\";\r\n  const ch = c.startsWith(\"0x\") ? c : \"0x\" + parseInt(c || \"0\", 10).toString(16);\r\n  return ch + \":\" + a;\r\n}\r\n\r\n/** Get first-seen timestamp for a token (chainId, address). Returns null if never seen. */\r\nexport async function getTokenFirstSeen(chainIdHex: string, address: string): Promise<number | null> {\r\n  const key = tokenKey(chainIdHex, address);\r\n  if (!key) return null;\r\n  try {\r\n    const raw = await new Promise<Record<string, number>>((resolve) => {\r\n      chrome.storage.local.get(TOKEN_FIRST_SEEN_KEY, (r) => resolve((r as any)?.[TOKEN_FIRST_SEEN_KEY] ?? {}));\r\n    });\r\n    const ts = raw?.[key];\r\n    return typeof ts === \"number\" ? ts : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\n/** Mark token as seen; stores timestamp only if not already present. */\r\nexport async function markTokenSeen(chainIdHex: string, address: string): Promise<void> {\r\n  const key = tokenKey(chainIdHex, address);\r\n  if (!key) return;\r\n  try {\r\n    const raw = await new Promise<Record<string, number>>((resolve) => {\r\n      chrome.storage.local.get(TOKEN_FIRST_SEEN_KEY, (r) => resolve((r as any)?.[TOKEN_FIRST_SEEN_KEY] ?? {}));\r\n    });\r\n    const map = { ...(raw || {}) };\r\n    if (typeof map[key] !== \"number\") {\r\n      map[key] = Date.now();\r\n      await new Promise<void>((resolve, reject) => {\r\n        chrome.storage.local.set({ [TOKEN_FIRST_SEEN_KEY]: map }, () => (chrome.runtime?.lastError ? reject(chrome.runtime.lastError) : resolve()));\r\n      });\r\n    }\r\n  } catch {}\r\n}\r\n\r\n/** Resolve token address for a tx: contract (to) for ERC20, or from decoded action */\r\nexport function getTokenAddressForTx(\r\n  txTo: string | undefined,\r\n  decodedAction: { kind: string; token?: string } | null\r\n): string | undefined {\r\n  const to = (txTo ?? \"\").trim().toLowerCase();\r\n  if (decodedAction && \"token\" in decodedAction && decodedAction.token) {\r\n    return decodedAction.token.trim().toLowerCase();\r\n  }\r\n  if (to && to.startsWith(\"0x\") && to.length === 42) return to;\r\n  return undefined;\r\n}\r\n", "/**\n * Token risk analysis for swap/approve/permit flows.\n * Extracts token candidates and returns confidence (HIGH/MEDIUM/LOW).\n */\n\nimport type { DecodedAction } from \"../shared/types\";\nimport { getTokenInfo, getTokenFirstSeen, markTokenSeen } from \"./tokenSecurity\";\nimport { getTokenAddressForTx } from \"./tokenSecurity\";\nimport type { ListsCacheV1 } from \"../shared/types\";\nimport { isScamToken, isTrustedToken } from \"./listManager\";\n\nexport type TokenConfidence = \"HIGH\" | \"MEDIUM\" | \"LOW\";\n\nexport type TokenRiskResult = {\n  confidence: TokenConfidence;\n  signals: string[];\n  isNew?: boolean;\n  symbol?: string;\n};\n\nconst SWAP_PATH_SELECTORS = new Set([\n  \"0x38ed1739\", \"0x7ff36ab5\", \"0x18cbafe5\", \"0x04e45aaf\", \"0xb858183f\", \"0x5023b4df\", \"0x09b81346\",\n]);\n\nfunction normalizeAddr(a: string): string {\n  const s = String(a || \"\").trim().toLowerCase();\n  return s.startsWith(\"0x\") && s.length === 42 ? s : \"\";\n}\n\n/** Decode Uniswap V2\u2013style swap path from calldata (address[] path). */\nfunction decodeSwapPath(data: string): string[] {\n  const addrs: string[] = [];\n  if (!data || typeof data !== \"string\" || !data.startsWith(\"0x\") || data.length < 10) return addrs;\n  const body = data.slice(10).toLowerCase();\n  if (body.length < 192) return addrs; // selector(4) + 3 words min (amountIn, amountOutMin, pathOffset)\n  const pathOffsetHex = body.slice(128, 192); // word index 2 = path offset\n  const pathOffset = parseInt(pathOffsetHex, 16);\n  if (!Number.isFinite(pathOffset) || pathOffset < 0 || pathOffset * 2 > body.length) return addrs;\n  const pathStart = pathOffset * 2;\n  if (body.length < pathStart + 64) return addrs;\n  const lenHex = body.slice(pathStart, pathStart + 64);\n  const len = parseInt(lenHex, 16);\n  if (!Number.isFinite(len) || len <= 0 || len > 20) return addrs;\n  for (let i = 0; i < len; i++) {\n    const addrStart = pathStart + 64 + i * 64;\n    const addrEnd = addrStart + 64;\n    if (body.length < addrEnd) break;\n    const word = body.slice(addrStart, addrEnd);\n    const addr = \"0x\" + (word.length >= 40 ? word.slice(24) : word.padStart(40, \"0\"));\n    const n = normalizeAddr(addr);\n    if (n && !addrs.includes(n)) addrs.push(n);\n  }\n  return addrs;\n}\n\n/**\n * Extract token addresses involved in the tx (approve/permit/swap).\n */\nexport function extractTokenCandidates(\n  txTo: string | undefined,\n  data: string,\n  decodedAction: DecodedAction | null,\n  _simulation?: { outgoingAssets?: { symbol: string }[]; incomingAssets?: { symbol: string }[] }\n): string[] {\n  const candidates: string[] = [];\n  const to = (txTo ?? \"\").trim().toLowerCase();\n  const dataStr = typeof data === \"string\" ? data : \"\";\n\n  if (decodedAction) {\n    if (\"token\" in decodedAction && decodedAction.token) {\n      const t = normalizeAddr(decodedAction.token);\n      if (t) candidates.push(t);\n    }\n    if (\"spender\" in decodedAction && decodedAction.spender) {\n      const s = normalizeAddr(decodedAction.spender);\n      if (s && !candidates.includes(s)) candidates.push(s);\n    }\n  }\n\n  if (dataStr.length >= 10) {\n    const sel = dataStr.slice(0, 10).toLowerCase();\n    if (SWAP_PATH_SELECTORS.has(sel)) {\n      const path = decodeSwapPath(dataStr);\n      for (const p of path) {\n        if (p && !candidates.includes(p)) candidates.push(p);\n      }\n    }\n  }\n\n  const fromTo = getTokenAddressForTx(txTo, decodedAction);\n  if (fromTo && !candidates.includes(fromTo)) candidates.push(fromTo);\n\n  if (to && to.startsWith(\"0x\") && to.length === 42 && !candidates.includes(to)) {\n    candidates.push(to);\n  }\n\n  return [...new Set(candidates)];\n}\n\nconst NEW_TOKEN_DAYS_MS = 7 * 24 * 60 * 60 * 1000;\n\n/**\n * Get token risk (confidence + signals).\n * Uses tokenSecurity (Uniswap list), listManager (scam/trusted), and first-seen.\n */\nexport async function getTokenRisk(\n  address: string,\n  chainIdHex: string,\n  listCache: ListsCacheV1 | null\n): Promise<TokenRiskResult> {\n  const addr = normalizeAddr(address);\n  if (!addr) return { confidence: \"LOW\", signals: [\"Endere\u00E7o inv\u00E1lido.\"] };\n\n  const chainId = String(chainIdHex || \"0x1\").toLowerCase();\n  const ch = chainId.startsWith(\"0x\") ? chainId : \"0x\" + parseInt(chainId || \"0\", 10).toString(16);\n\n  await markTokenSeen(ch, addr);\n  const firstSeen = await getTokenFirstSeen(ch, addr);\n  const tokenInfo = getTokenInfo(addr);\n  const tokenScam = listCache ? isScamToken(ch, addr, listCache) : false;\n  const tokenTrusted = listCache ? isTrustedToken(ch, addr, listCache) : false;\n  const verified = tokenInfo?.v ?? false;\n\n  const signals: string[] = [];\n  let confidence: TokenConfidence = \"MEDIUM\";\n\n  if (tokenScam) {\n    return {\n      confidence: \"LOW\",\n      signals: [\"Token em lista de scam/bloqueado.\"],\n      symbol: tokenInfo?.s,\n    };\n  }\n\n  if (tokenTrusted || verified) {\n    return {\n      confidence: \"HIGH\",\n      signals: [\"Token em lista confi\u00E1vel ou verificado.\"],\n      symbol: tokenInfo?.s,\n    };\n  }\n\n  const isNew = !firstSeen || Date.now() - firstSeen < NEW_TOKEN_DAYS_MS;\n  if (isNew) {\n    signals.push(\"Token rec\u00E9m-visto ou sem hist\u00F3rico.\");\n    confidence = \"LOW\";\n  } else {\n    signals.push(\"Sem lista de reputa\u00E7\u00E3o conhecida.\");\n    confidence = \"MEDIUM\";\n  }\n\n  return {\n    confidence,\n    signals,\n    isNew,\n    symbol: tokenInfo?.s,\n  };\n}\n", "/**\r\n * V2: Chain registry \u2014 native symbol and CoinGecko id for USD pricing.\r\n */\r\n\r\nexport type ChainInfo = {\r\n  chainIdHex: string;\r\n  name: string;\r\n  nativeSymbol: string;\r\n  coingeckoId: string;\r\n  rpcUrls: string[];\r\n};\r\n\r\nconst CHAINS: ChainInfo[] = [\r\n  { chainIdHex: \"0x1\", name: \"Ethereum\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://eth.llamarpc.com\"] },\r\n  { chainIdHex: \"0xa\", name: \"Optimism\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.optimism.io\"] },\r\n  { chainIdHex: \"0xa4b1\", name: \"Arbitrum One\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://arb1.arbitrum.io/rpc\"] },\r\n  { chainIdHex: \"0x2105\", name: \"Base\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.base.org\"] },\r\n  { chainIdHex: \"0x89\", name: \"Polygon\", nativeSymbol: \"MATIC\", coingeckoId: \"matic-network\", rpcUrls: [\"https://polygon-rpc.com\"] },\r\n  { chainIdHex: \"0x38\", name: \"BNB Smart Chain\", nativeSymbol: \"BNB\", coingeckoId: \"binancecoin\", rpcUrls: [\"https://bsc-dataseed.binance.org\"] },\r\n  { chainIdHex: \"0xa86a\", name: \"Avalanche C-Chain\", nativeSymbol: \"AVAX\", coingeckoId: \"avalanche-2\", rpcUrls: [\"https://api.avax.network/ext/bc/C/rpc\"] },\r\n  { chainIdHex: \"0xfa\", name: \"Fantom\", nativeSymbol: \"FTM\", coingeckoId: \"fantom\", rpcUrls: [\"https://rpc.ftm.tools\"] },\r\n  { chainIdHex: \"0x64\", name: \"Gnosis\", nativeSymbol: \"xDAI\", coingeckoId: \"xdai\", rpcUrls: [\"https://rpc.gnosischain.com\"] },\r\n  { chainIdHex: \"0xa4ec\", name: \"Celo\", nativeSymbol: \"CELO\", coingeckoId: \"celo\", rpcUrls: [\"https://forno.celo.org\"] },\r\n  { chainIdHex: \"0x82750\", name: \"Scroll\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://rpc.scroll.io\"] },\r\n  { chainIdHex: \"0xe708\", name: \"Linea\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://rpc.linea.build\"] },\r\n  { chainIdHex: \"0x144\", name: \"zkSync Era\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.era.zksync.io\"] },\r\n  { chainIdHex: \"0x2a\", name: \"zkSync\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://mainnet.zksync.io\"] },\r\n  { chainIdHex: \"0x44d\", name: \"Polygon zkEVM\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://zkevm-rpc.com\"] },\r\n  { chainIdHex: \"0x13e31\", name: \"Polygon zkEVM (Chain 81489)\", nativeSymbol: \"ETH\", coingeckoId: \"ethereum\", rpcUrls: [\"https://zkevm-rpc.com\"] },\r\n];\r\n\r\nconst byChainId = new Map<string, ChainInfo>();\r\nfor (const c of CHAINS) {\r\n  const id = c.chainIdHex.toLowerCase();\r\n  byChainId.set(id, c);\r\n  const num = id.startsWith(\"0x\") ? id : \"0x\" + id;\r\n  if (num !== id) byChainId.set(num, c);\r\n}\r\n\r\nexport function getChainInfo(chainIdHex: string | undefined): ChainInfo | null {\r\n  if (!chainIdHex) return null;\r\n  const id = String(chainIdHex).toLowerCase();\r\n  if (!id.startsWith(\"0x\")) return byChainId.get(\"0x\" + id) ?? null;\r\n  return byChainId.get(id) ?? null;\r\n}\r\n\r\nexport function getNativeSymbol(chainIdHex: string | undefined): string {\r\n  const info = getChainInfo(chainIdHex);\r\n  return info?.nativeSymbol ?? \"ETH\";\r\n}\r\n\r\nexport function getAllChains(): ChainInfo[] {\r\n  return [...CHAINS];\r\n}\r\n", "/**\r\n * V2: Native USD per chain (CoinGecko) + token USD per contract (DexScreener). No API keys.\r\n */\r\n\r\nimport { getChainInfo } from \"../shared/chains\";\r\n\r\nconst NATIVE_CACHE_KEY = \"sg_price_native_v1\";\r\nconst TOKEN_CACHE_KEY = \"sg_price_token_v1\";\r\nconst NATIVE_TTL_MS = 60_000 * 5; // 5 min\r\nconst TOKEN_TTL_MS = 60_000 * 3;   // 3 min\r\nconst FETCH_TIMEOUT_MS = 8000;\r\n\r\ntype NativeCache = Record<string, { usd: number; updatedAt: number }>;\r\ntype TokenCache = Record<string, { priceUsd: number; updatedAt: number }>;\r\n\r\nfunction getNativeCache(): Promise<NativeCache> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve({});\r\n      chrome.storage.local.get(NATIVE_CACHE_KEY, (r) => {\r\n        const v = (r as Record<string, NativeCache>)?.[NATIVE_CACHE_KEY];\r\n        resolve(v && typeof v === \"object\" ? v : {});\r\n      });\r\n    } catch {\r\n      resolve({});\r\n    }\r\n  });\r\n}\r\n\r\nfunction setNativeCache(cache: NativeCache): Promise<void> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve();\r\n      chrome.storage.local.set({ [NATIVE_CACHE_KEY]: cache }, () => resolve());\r\n    } catch {\r\n      resolve();\r\n    }\r\n  });\r\n}\r\n\r\nfunction getTokenCache(): Promise<TokenCache> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve({});\r\n      chrome.storage.local.get(TOKEN_CACHE_KEY, (r) => {\r\n        const v = (r as Record<string, TokenCache>)?.[TOKEN_CACHE_KEY];\r\n        resolve(v && typeof v === \"object\" ? v : {});\r\n      });\r\n    } catch {\r\n      resolve({});\r\n    }\r\n  });\r\n}\r\n\r\nfunction setTokenCache(cache: TokenCache): Promise<void> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (!chrome?.storage?.local) return resolve();\r\n      chrome.storage.local.set({ [TOKEN_CACHE_KEY]: cache }, () => resolve());\r\n    } catch {\r\n      resolve();\r\n    }\r\n  });\r\n}\r\n\r\nasync function fetchWithTimeout(url: string): Promise<string | null> {\r\n  try {\r\n    const ctrl = new AbortController();\r\n    const t = setTimeout(() => ctrl.abort(), FETCH_TIMEOUT_MS);\r\n    const res = await fetch(url, { signal: ctrl.signal });\r\n    clearTimeout(t);\r\n    return res.ok ? await res.text() : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getNativeUsd(chainIdHex: string): Promise<{ ok: boolean; usdPerNative?: number; nativeSymbol?: string }> {\r\n  const info = getChainInfo(chainIdHex);\r\n  if (!info) return { ok: false };\r\n  const cache = await getNativeCache();\r\n  const now = Date.now();\r\n  const entry = cache[info.coingeckoId];\r\n  if (entry && (now - entry.updatedAt) < NATIVE_TTL_MS) {\r\n    return { ok: true, usdPerNative: entry.usd, nativeSymbol: info.nativeSymbol };\r\n  }\r\n  try {\r\n    const ids = info.coingeckoId;\r\n    const url = `https://api.coingecko.com/api/v3/simple/price?ids=${encodeURIComponent(ids)}&vs_currencies=usd`;\r\n    const body = await fetchWithTimeout(url);\r\n    if (!body) return { ok: false, nativeSymbol: info.nativeSymbol };\r\n    const j = JSON.parse(body) as Record<string, { usd?: number }>;\r\n    const usd = j[info.coingeckoId]?.usd;\r\n    if (typeof usd !== \"number\" || usd <= 0) return { ok: false, nativeSymbol: info.nativeSymbol };\r\n    cache[info.coingeckoId] = { usd, updatedAt: now };\r\n    await setNativeCache(cache);\r\n    return { ok: true, usdPerNative: usd, nativeSymbol: info.nativeSymbol };\r\n  } catch {\r\n    return { ok: false, nativeSymbol: info.nativeSymbol };\r\n  }\r\n}\r\n\r\nfunction normalizeAddr(addr: string): string {\r\n  const s = (addr || \"\").trim().toLowerCase();\r\n  return s.startsWith(\"0x\") && s.length === 42 ? s : \"\";\r\n}\r\n\r\nexport async function getTokenUsd(chainIdHex: string, tokenAddress: string): Promise<{ ok: boolean; priceUsd?: number; source?: string }> {\r\n  const addr = normalizeAddr(tokenAddress);\r\n  if (!addr) return { ok: false };\r\n  const key = `${(chainIdHex || \"\").toLowerCase()}:${addr}`;\r\n  const cache = await getTokenCache();\r\n  const now = Date.now();\r\n  const entry = cache[key];\r\n  if (entry && (now - entry.updatedAt) < TOKEN_TTL_MS) {\r\n    return { ok: true, priceUsd: entry.priceUsd, source: \"cache\" };\r\n  }\r\n  try {\r\n    const url = `https://api.dexscreener.com/latest/dex/tokens/${addr}`;\r\n    const body = await fetchWithTimeout(url);\r\n    if (!body) return { ok: false };\r\n    const j = JSON.parse(body) as { pairs?: Array<{ liquidity?: { usd?: number }; priceUsd?: string }> };\r\n    const pairs = Array.isArray(j.pairs) ? j.pairs : [];\r\n    let best: { priceUsd: string; liq: number } | null = null;\r\n    for (const p of pairs) {\r\n      const price = p.priceUsd;\r\n      const liq = typeof p.liquidity?.usd === \"number\" ? p.liquidity.usd : 0;\r\n      if (price && liq > (best?.liq ?? 0)) best = { priceUsd: price, liq };\r\n    }\r\n    if (!best) return { ok: false };\r\n    const priceUsd = parseFloat(best.priceUsd);\r\n    if (!Number.isFinite(priceUsd) || priceUsd <= 0) return { ok: false };\r\n    cache[key] = { priceUsd, updatedAt: now };\r\n    await setTokenCache(cache);\r\n    return { ok: true, priceUsd, source: \"dexscreener\" };\r\n  } catch {\r\n    return { ok: false };\r\n  }\r\n}\r\n", "/**\n * Token metadata (symbol, decimals, name) via page provider (eth_call through content script).\n * No background fetch to RPC URLs; avoids network opt-in leak.\n */\n\nconst DECIMALS_SEL = \"0x313ce567\" + \"0\".repeat(56);\nconst SYMBOL_SEL = \"0x95d89b41\" + \"0\".repeat(56);\nconst NAME_SEL = \"0x06fdde03\" + \"0\".repeat(56);\n\nconst CALL_TIMEOUT_MS = 1200;\nconst TOTAL_TIMEOUT_MS = 2500;\n\nexport type TokenMetaViaProviderOpts = {\n  tabId: number;\n  chainIdHex: string;\n  token: string;\n  rpc: (method: string, params: unknown[]) => Promise<{ ok: boolean; result?: unknown; error?: string } | null>;\n  timeoutMs?: number;\n  totalTimeoutMs?: number;\n};\n\nexport type TokenMetaViaProviderResult =\n  | { ok: true; symbol?: string; decimals?: number; name?: string }\n  | { ok: false; meta: { address: string; chainIdHex: string }; reason: string };\n\nfunction normalizeAddr(addr: string): string {\n  const s = (addr || \"\").trim().toLowerCase();\n  return s.startsWith(\"0x\") && s.length === 42 ? s : \"\";\n}\n\nfunction decodeStringResult(hex: string): string {\n  if (!hex || hex.length < 66) return \"\";\n  const data = hex.startsWith(\"0x\") ? hex.slice(2) : hex;\n  if (data.length < 64) return \"\";\n  const firstWord = data.slice(0, 64);\n  const offset = parseInt(firstWord.slice(0, 16), 16);\n  if (offset === 0x20 && data.length >= 128) {\n    const lenHex = data.slice(64, 128);\n    const len = parseInt(lenHex, 16) * 2;\n    const strHex = data.slice(128, 128 + len);\n    try {\n      return decodeURIComponent(strHex.replace(/(..)/g, \"%$1\")).replace(/\\0/g, \"\").trim();\n    } catch {\n      return \"\";\n    }\n  }\n  const ascii = firstWord.match(/.{2}/g)?.map((b) => String.fromCharCode(parseInt(b, 16))).join(\"\") ?? \"\";\n  return ascii.replace(/\\0/g, \"\").trim();\n}\n\nfunction withTimeout<T>(p: Promise<T>, ms: number): Promise<T> {\n  return Promise.race([\n    p,\n    new Promise<T>((_, rej) => setTimeout(() => rej(new Error(\"PROVIDER_CALL_FAILED\")), ms)),\n  ]);\n}\n\nexport async function getTokenMetaViaProvider(opts: TokenMetaViaProviderOpts): Promise<TokenMetaViaProviderResult> {\n  const addr = normalizeAddr(opts.token);\n  if (!addr) return { ok: false, meta: { address: opts.token, chainIdHex: opts.chainIdHex }, reason: \"INVALID_ADDRESS\" };\n\n  const callTimeout = opts.timeoutMs ?? CALL_TIMEOUT_MS;\n  const totalTimeout = opts.totalTimeoutMs ?? TOTAL_TIMEOUT_MS;\n  const rpc = opts.rpc;\n\n  const start = Date.now();\n  const mustFinishBy = start + totalTimeout;\n\n  const ethCall = async (to: string, data: string): Promise<string | null> => {\n    if (Date.now() >= mustFinishBy) throw new Error(\"PROVIDER_CALL_FAILED\");\n    const res = await withTimeout(\n      rpc(\"eth_call\", [{ to, data, gas: \"0x7530\" }, \"latest\"]),\n      Math.min(callTimeout, mustFinishBy - Date.now())\n    );\n    if (!res?.ok || res.result == null) return null;\n    return typeof res.result === \"string\" ? res.result : null;\n  };\n\n  try {\n    const [decRes, symRes, nameRes] = await Promise.all([\n      ethCall(addr, DECIMALS_SEL),\n      ethCall(addr, SYMBOL_SEL),\n      ethCall(addr, NAME_SEL),\n    ]);\n\n    let decimals: number | undefined;\n    if (decRes && decRes.length >= 66) {\n      const n = parseInt(decRes.slice(2, 66), 16);\n      if (Number.isFinite(n)) decimals = n;\n    }\n    let symbol = \"\";\n    if (symRes && symRes.length >= 66) symbol = decodeStringResult(symRes);\n    let name = \"\";\n    if (nameRes && nameRes.length >= 66) name = decodeStringResult(nameRes);\n\n    return { ok: true, symbol: symbol || undefined, decimals, name: name || undefined };\n  } catch {\n    return { ok: false, meta: { address: addr, chainIdHex: opts.chainIdHex }, reason: \"PROVIDER_CALL_FAILED\" };\n  }\n}\n", "/**\r\n * Telemetry: opt-in only. REST-only backend (no @supabase/supabase-js) to avoid Service Worker crash in MV3.\r\n * Sent only when termsAccepted AND telemetryOptIn are true. No ads/marketing. All failures are silent.\r\n */\r\n\r\nconst SUPABASE_URL = \"https://cjnzidctntqzamhwmwkt.supabase.co\";\r\nconst SUPABASE_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqbnppZGN0bnRxemFtaHdtd2t0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5MzIzNzQsImV4cCI6MjA4NjUwODM3NH0.NyUvGRPY1psOwpJytWG_d3IXwCwPxLtuSG6V1uX13mc\";\r\n\r\nconst INSTALL_ID_KEY = \"installId\";\r\n\r\ntype GetSettingsFn = () => Promise<import(\"../shared/types\").Settings>;\r\nlet getSettingsFn: GetSettingsFn | null = null;\r\n\r\nexport function initTelemetry(getSettings: GetSettingsFn): void {\r\n  getSettingsFn = getSettings;\r\n}\r\n\r\nasync function getTermsAccepted(): Promise<boolean> {\r\n  try {\r\n    const r = await new Promise<Record<string, boolean>>((resolve) => {\r\n      if (typeof chrome?.storage?.local?.get !== \"function\") return resolve({});\r\n      chrome.storage.local.get(\"termsAccepted\", (res) => {\r\n        resolve((res as Record<string, boolean>) ?? {});\r\n      });\r\n    });\r\n    return r?.termsAccepted === true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function getOptIn(): Promise<boolean> {\r\n  if (!(await getTermsAccepted())) return false;\r\n  if (!getSettingsFn) return false;\r\n  try {\r\n    const s = await getSettingsFn();\r\n    return s?.telemetryOptIn === true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n/** Helper: POST to Supabase REST (no SDK). Fails silently. Only sends if telemetry origin permission granted. */\r\nasync function sendToSupabase(table: string, data: Record<string, unknown>): Promise<void> {\r\n  try {\r\n    if (typeof navigator !== \"undefined\" && !navigator.onLine) return;\r\n    const origins = [\"https://cjnzidctntqzamhwmwkt.supabase.co/*\"];\r\n    if (typeof chrome?.permissions?.contains === \"function\" && !(await chrome.permissions.contains({ origins }))) return;\r\n    await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        apikey: SUPABASE_KEY,\r\n        Authorization: `Bearer ${SUPABASE_KEY}`,\r\n        \"Content-Type\": \"application/json\",\r\n        Prefer: \"return=minimal\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n  } catch {\r\n    // silent\r\n  }\r\n}\r\n\r\nexport async function getOrCreateInstallationId(): Promise<string> {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      if (typeof chrome?.storage?.local?.get !== \"function\") {\r\n        resolve(typeof crypto !== \"undefined\" && crypto.randomUUID ? crypto.randomUUID() : \"unknown\");\r\n        return;\r\n      }\r\n      chrome.storage.local.get(INSTALL_ID_KEY, (r) => {\r\n        if (chrome.runtime?.lastError) {\r\n          const id = typeof crypto !== \"undefined\" && crypto.randomUUID ? crypto.randomUUID() : \"unknown\";\r\n          chrome.storage.local.set({ [INSTALL_ID_KEY]: id }, () => resolve(id));\r\n          return;\r\n        }\r\n        const id = (r as Record<string, string>)?.[INSTALL_ID_KEY];\r\n        if (id && typeof id === \"string\") {\r\n          resolve(id);\r\n          return;\r\n        }\r\n        const newId = typeof crypto !== \"undefined\" && crypto.randomUUID ? crypto.randomUUID() : \"unknown\";\r\n        chrome.storage.local.set({ [INSTALL_ID_KEY]: newId }, () => resolve(newId));\r\n      });\r\n    } catch {\r\n      resolve(\"unknown\");\r\n    }\r\n  });\r\n}\r\n\r\nexport async function identifyUser(): Promise<string> {\r\n  try {\r\n    if (!(await getTermsAccepted())) return await getOrCreateInstallationId();\r\n    let uuid = await getOrCreateInstallationId();\r\n    if (uuid === \"unknown\") {\r\n      uuid = typeof crypto !== \"undefined\" && crypto.randomUUID ? crypto.randomUUID() : \"unknown\";\r\n      await new Promise<void>((resolve) => {\r\n        chrome.storage.local.set({ [INSTALL_ID_KEY]: uuid }, () => resolve());\r\n      });\r\n    }\r\n    if (await getOptIn()) {\r\n      await sendToSupabase(\"installations\", {\r\n        install_id: uuid,\r\n        user_agent: typeof navigator !== \"undefined\" ? navigator.userAgent : \"\",\r\n        language: typeof navigator !== \"undefined\" ? navigator.language : \"\",\r\n        timezone: typeof Intl !== \"undefined\" ? Intl.DateTimeFormat().resolvedOptions().timeZone : \"\",\r\n        last_active_at: new Date().toISOString(),\r\n      });\r\n    }\r\n    return uuid;\r\n  } catch {\r\n    return \"unknown\";\r\n  }\r\n}\r\n\r\nexport async function registerUser(): Promise<void> {\r\n  await identifyUser();\r\n}\r\n\r\nexport async function syncUserWallets(_wallets: string[]): Promise<void> {\r\n  // Optional: send to user_wallets table via sendToSupabase; no-op for stability\r\n}\r\n\r\nexport async function trackInterest(_category: string): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  // Optional: batch to user_interests; no-op for stability\r\n}\r\n\r\nexport async function trackTransaction(txData: {\r\n  chain_id?: string;\r\n  chainId?: string;\r\n  asset_address?: string;\r\n  contractAddress?: string;\r\n  method?: string;\r\n  status?: string;\r\n  [k: string]: unknown;\r\n}): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  try {\r\n    const installId = await getOrCreateInstallationId();\r\n    await sendToSupabase(\"tx_logs\", {\r\n      install_id: installId,\r\n      created_at: new Date().toISOString(),\r\n      chain_id: txData.chain_id ?? txData.chainId ? String(txData.chain_id ?? txData.chainId) : null,\r\n      asset_address: txData.asset_address ?? txData.contractAddress ?? null,\r\n      method: txData.method ?? \"unknown\",\r\n      status: txData.status ?? \"simulated\",\r\n    });\r\n  } catch {\r\n    // silent\r\n  }\r\n}\r\n\r\nexport async function trackTx(payload: {\r\n  chainId: string;\r\n  contractAddress: string;\r\n  method: string;\r\n  valueUsd?: number;\r\n}): Promise<void> {\r\n  await trackTransaction({\r\n    chain_id: payload.chainId,\r\n    asset_address: payload.contractAddress,\r\n    method: payload.method,\r\n    status: \"simulated\",\r\n  });\r\n}\r\n\r\nexport async function trackThreat(\r\n  url: string,\r\n  score: number,\r\n  reasons: string[],\r\n  metadata?: Record<string, unknown>\r\n): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  try {\r\n    const installId = await getOrCreateInstallationId();\r\n    let domain = \"\";\r\n    try {\r\n      domain = new URL(url).hostname;\r\n    } catch {\r\n      domain = url?.slice(0, 256) ?? \"\";\r\n    }\r\n    await sendToSupabase(\"threat_reports\", {\r\n      install_id: installId,\r\n      url: url?.slice(0, 2048) ?? \"\",\r\n      domain,\r\n      risk_score: score,\r\n      risk_reason: Array.isArray(reasons) ? reasons.join(\", \") : \"Unknown\",\r\n      created_at: new Date().toISOString(),\r\n      ...(metadata && typeof metadata === \"object\" ? metadata : {}),\r\n    });\r\n  } catch {\r\n    // silent\r\n  }\r\n}\r\n\r\nexport async function reportThreat(threatData: {\r\n  url?: string;\r\n  score?: number;\r\n  reasons?: string[];\r\n  metadata?: Record<string, unknown>;\r\n}): Promise<void> {\r\n  await trackThreat(\r\n    threatData.url ?? \"\",\r\n    threatData.score ?? 100,\r\n    Array.isArray(threatData.reasons) ? threatData.reasons : [],\r\n    threatData.metadata\r\n  );\r\n}\r\n\r\nexport async function trackEvent(_eventName: string, _props?: Record<string, unknown>): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  // Optional: usage_events; no-op for stability\r\n}\r\n\r\nexport async function trackSession(_data: { domain: string; referrer?: string; durationSec: number }): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  // Optional: web3_sessions; no-op for stability\r\n}\r\n\r\nexport async function trackInteraction(_data: {\r\n  domain: string;\r\n  kind?: string;\r\n  props?: Record<string, unknown>;\r\n}): Promise<void> {\r\n  if (!(await getOptIn())) return;\r\n  // Optional: ui_interactions; no-op for stability\r\n}\r\n\r\nexport async function updateExtendedProfile(_data: Record<string, unknown>): Promise<void> {\r\n  // Placeholder to avoid callers breaking\r\n}\r\n\r\nexport const telemetry = {\r\n  identifyUser,\r\n  registerUser,\r\n  syncUserWallets,\r\n  trackInterest,\r\n  trackThreat,\r\n  reportThreat,\r\n  trackTransaction,\r\n  trackEvent,\r\n  trackTx,\r\n  trackSession,\r\n  trackInteraction,\r\n  updateExtendedProfile,\r\n};\r\n", "/**\r\n * Maps partial domain patterns to interest categories for behavioral profiling.\r\n * Used to attribute tags and spending metrics before sending to Supabase.\r\n */\r\n\r\nexport const INTEREST_MAP: Record<string, string> = {\r\n  \"opensea.io\": \"NFT\",\r\n  \"blur.io\": \"NFT\",\r\n  \"magiceden.io\": \"NFT\",\r\n  \"uniswap.org\": \"DEFI\",\r\n  \"aave.com\": \"DEFI\",\r\n  \"curve.fi\": \"DEFI\",\r\n  \"1inch.io\": \"DEFI\",\r\n  \"pump.fun\": \"MEMECOINS\",\r\n  \"dexscreener.com\": \"TRADING\",\r\n  \"galxe.com\": \"AIRDROP\",\r\n  \"layer3.xyz\": \"AIRDROP\",\r\n};\r\n", "/**\n * P1-G: Standardized reason keys for analysis consistency.\n * Use these keys; i18n maps to human text where available.\n */\nexport const REASON_KEYS = {\n  NEW_DOMAIN: \"NEW_DOMAIN\",\n  KNOWN_BAD_DOMAIN: \"KNOWN_BAD_DOMAIN\",\n  KNOWN_SAFE_DOMAIN: \"KNOWN_SAFE_DOMAIN\",\n  UNLIMITED_APPROVAL: \"UNLIMITED_APPROVAL\",\n  SET_APPROVAL_FOR_ALL: \"SET_APPROVAL_FOR_ALL\",\n  PERMIT_GRANT: \"PERMIT_GRANT\",\n  PERMIT2_GRANT: \"PERMIT2_GRANT\",\n  HIGH_VALUE_TRANSFER: \"HIGH_VALUE_TRANSFER\",\n  NEW_SPENDER: \"NEW_SPENDER\",\n  FRESH_DEPLOY: \"FRESH_DEPLOY\",\n  SIM_FAILED: \"SIM_FAILED\",\n  TOKEN_LOW_CONFIDENCE: \"TOKEN_LOW_CONFIDENCE\",\n  ADDRESS_BLOCKLIST: \"ADDRESS_BLOCKLIST\",\n  KNOWN_BAD_SPENDER: \"KNOWN_BAD_SPENDER\",\n  KNOWN_SAFE_SPENDER: \"KNOWN_SAFE_SPENDER\",\n  TOKEN_SCAM: \"TOKEN_SCAM\",\n  PHISHING: \"PHISHING\",\n  PUNYCODE_DOMAIN: \"PUNYCODE_DOMAIN\",\n  LOOKALIKE: \"LOOKALIKE\",\n  NFT_PURCHASE: \"NFT_PURCHASE\",\n  TOKEN_SWAP: \"TOKEN_SWAP\",\n  MARKETPLACE_SIGNATURE: \"MARKETPLACE_SIGNATURE\",\n  MARKETPLACE_LISTING: \"MARKETPLACE_LISTING\",\n  HIGH_GAS: \"HIGH_GAS\",\n  CONTRACT_TARGET: \"CONTRACT_TARGET\",\n  VAULT_LOCKED: \"VAULT_LOCKED\",\n  SPENDER_DENYLIST: \"SPENDER_DENYLIST\",\n  SPENDER_ALLOWLIST: \"SPENDER_ALLOWLIST\",\n  PAGE_RISK_HIGH: \"PAGE_RISK_HIGH\",\n  PAGE_RISK_MEDIUM: \"PAGE_RISK_MEDIUM\",\n  FAILMODE_FALLBACK: \"FAILMODE_FALLBACK\",\n  SIMULATION_TIMEOUT: \"SIMULATION_TIMEOUT\",\n  SNAP_INVOKE: \"SNAP_INVOKE\",\n  REQUEST_SNAPS: \"REQUEST_SNAPS\",\n  SIGN_TRANSACTION: \"SIGN_TRANSACTION\",\n  RAW_TX_BROADCAST: \"RAW_TX_BROADCAST\",\n  READ_PERMISSIONS: \"READ_PERMISSIONS\",\n} as const;\n\nexport type ReasonKey = (typeof REASON_KEYS)[keyof typeof REASON_KEYS];\n", "export function normMethod(m: any) {\r\n  return String(m || \"\").trim();\r\n}\r\n\r\nexport function normMethodLower(m: any) {\r\n  return normMethod(m).toLowerCase();\r\n}\r\n\r\nexport type TypedDataNormalized = {\r\n  address?: string;\r\n  typedDataRaw?: string;\r\n  typedDataObj?: any;\r\n  rawShape: \"string\" | \"object\" | \"unknown\";\r\n};\r\n\r\n/** Centralized parsing for eth_signTypedData* variants. Handles string/object and param order. */\r\nexport function normalizeTypedDataParams(method: string, params: any): TypedDataNormalized {\r\n  const result: TypedDataNormalized = { rawShape: \"unknown\" };\r\n  if (!params || !Array.isArray(params) || params.length === 0) return result;\r\n\r\n  let address: string | undefined;\r\n  let typedData: string | object | undefined;\r\n\r\n  const p0 = params[0];\r\n  const p1 = params[1];\r\n\r\n  // Detect: [address, typedData] vs [typedData, address]\r\n  const p0IsAddr = typeof p0 === \"string\" && /^0x[a-fA-F0-9]{40}$/.test(p0);\r\n  const p1IsAddr = typeof p1 === \"string\" && /^0x[a-fA-F0-9]{40}$/.test(p1);\r\n  const p0IsTypedData = typeof p0 === \"string\" && (p0.startsWith(\"{\") || p0.startsWith(\"[\"))\r\n    || (typeof p0 === \"object\" && p0 !== null && (p0.domain || p0.types || p0.primaryType || p0.message));\r\n  const p1IsTypedData = typeof p1 === \"string\" && (p1.startsWith(\"{\") || p1.startsWith(\"[\"))\r\n    || (typeof p1 === \"object\" && p1 !== null && (p1.domain || p1.types || p1.primaryType || p1.message));\r\n\r\n  if (p0IsAddr && p1IsTypedData) {\r\n    address = p0;\r\n    typedData = p1;\r\n  } else if (p0IsTypedData && p1IsAddr) {\r\n    typedData = p0;\r\n    address = p1;\r\n  } else if (p0IsTypedData) {\r\n    typedData = p0;\r\n    address = p1IsAddr ? p1 : undefined;\r\n  } else if (p1IsTypedData) {\r\n    typedData = p1;\r\n    address = p0IsAddr ? p0 : undefined;\r\n  }\r\n\r\n  if (typeof typedData === \"string\") {\r\n    result.typedDataRaw = typedData;\r\n    result.rawShape = \"string\";\r\n    try {\r\n      result.typedDataObj = JSON.parse(typedData);\r\n    } catch {\r\n      result.typedDataObj = undefined;\r\n    }\r\n  } else if (typedData && typeof typedData === \"object\") {\r\n    result.typedDataObj = typedData;\r\n    result.typedDataRaw = JSON.stringify(typedData);\r\n    result.rawShape = \"object\";\r\n  }\r\n\r\n  if (address) result.address = address.trim().toLowerCase();\r\n  return result;\r\n}\r\n\r\nconst TYPED_DATA_METHODS = new Set([\r\n  \"eth_signtypeddata\",\r\n  \"eth_signtypeddata_v3\",\r\n  \"eth_signtypeddata_v4\",\r\n]);\r\n\r\nexport function isTypedDataMethod(method: string): boolean {\r\n  return TYPED_DATA_METHODS.has(String(method || \"\").toLowerCase());\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": ["t", "fetchWithTimeout", "FETCH_TIMEOUT_MS", "normalizeAddress", "t", "normalizeAddress", "normalizeHost", "FETCH_TIMEOUT_MS", "EVM_ADDRESS_REGEX", "fetchWithTimeout", "SCAMSNIFFER_ADDRESSES", "MAX_UINT256", "normalizeHost", "t", "FETCH_TIMEOUT_MS", "normalizeAddr", "t", "normalizeAddr", "normalizeAddr", "t", "TOKEN_CACHE_KEY", "FETCH_TIMEOUT_MS", "fetchWithTimeout", "t", "normalizeAddr", "normalizeAddr", "getSettings", "id", "SUGGESTED_TRUSTED_DOMAINS", "getSettings", "t", "lists", "importUserOverrides", "simulateTransaction", "flags", "SUGGESTED_TRUSTED_DOMAINS", "normalizeHost", "host"]
}
