{
  "version": 3,
  "sources": ["../src/feeEstimate.ts", "../src/shared/uiGate.ts", "../src/mainWorld.ts"],
  "sourcesContent": ["export type FeeEstimate = {\r\n  ok: boolean;\r\n  gasLimit?: bigint;\r\n  maxFeePerGas?: bigint;        // wei\r\n  maxPriorityFeePerGas?: bigint;// wei\r\n  gasPrice?: bigint;            // wei (legacy)\r\n  feeMaxWei?: bigint;           // wei\r\n  feeLikelyWei?: bigint;        // wei (baseFee + priority) * gas\r\n  reason?: string;\r\n};\r\n\r\nconst RPC_TIMEOUT_MS = 2500;\r\n\r\n/** Call RPC once; returns null on any error or timeout. Never throws, no console.error. */\r\nasync function tryRpc<T>(providerRequest: (a: any) => Promise<any>, method: string, params: any[], timeoutMs = RPC_TIMEOUT_MS): Promise<T | null> {\r\n  let t: ReturnType<typeof setTimeout>;\r\n  const timeout = new Promise<null>((res) => { t = setTimeout(() => res(null), timeoutMs); });\r\n  try {\r\n    const r = await Promise.race([providerRequest({ method, params }).then((x) => x as T), timeout]);\r\n    clearTimeout(t!);\r\n    return r;\r\n  } catch {\r\n    clearTimeout(t!);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function estimateFee(providerRequest: (args: any) => Promise<any>, tx: any): Promise<FeeEstimate> {\r\n  try {\r\n    // 1) gasLimit (estimateGas) - fallback for simple transfers\r\n    let gasLimit: bigint;\r\n    const gasHex = await tryRpc<string>(providerRequest, \"eth_estimateGas\", [tx]);\r\n    if (gasHex != null && typeof gasHex === \"string\") {\r\n      try { gasLimit = BigInt(gasHex); } catch { gasLimit = 150000n; }\r\n    } else {\r\n      const hasData = tx?.data && String(tx.data) !== \"0x\" && String(tx.data).toLowerCase() !== \"0x\";\r\n      const valueWei = BigInt(tx?.value || \"0x0\");\r\n      gasLimit = hasData ? 150000n : valueWei > 0n ? 21000n : 150000n;\r\n    }\r\n\r\n    // 2) Prefer dapp-provided EIP-1559 fields if present\r\n    const maxFeePerGas = tx?.maxFeePerGas ? BigInt(tx.maxFeePerGas) : undefined;\r\n    const maxPriorityFeePerGas = tx?.maxPriorityFeePerGas ? BigInt(tx.maxPriorityFeePerGas) : undefined;\r\n    const gasPrice = tx?.gasPrice ? BigInt(tx.gasPrice) : undefined;\r\n\r\n    // 3) If no fees provided, compute from feeHistory + priority (or gasPrice fallback)\r\n    let computedMaxFee: bigint | undefined = maxFeePerGas;\r\n    let computedPriority: bigint | undefined = maxPriorityFeePerGas;\r\n\r\n    if (!computedMaxFee && !gasPrice) {\r\n      let baseFee: bigint | undefined;\r\n      const fh = await tryRpc<{ baseFeePerGas?: string[] }>(providerRequest, \"eth_feeHistory\", [\"0x1\", \"latest\", []]);\r\n      const arr = fh?.baseFeePerGas;\r\n      if (Array.isArray(arr) && arr.length > 0) {\r\n        try { baseFee = BigInt(arr[arr.length - 1]); } catch { baseFee = undefined; }\r\n      } else {\r\n        baseFee = undefined;\r\n      }\r\n\r\n      if (baseFee != null) {\r\n        computedPriority = computedPriority ?? 1_000_000_000n;\r\n        computedMaxFee = baseFee * 2n + computedPriority;\r\n      } else {\r\n        const gpHex = await tryRpc<string>(providerRequest, \"eth_gasPrice\", []);\r\n        if (gpHex != null && gpHex !== \"\") return finalizeLegacy(gasLimit, BigInt(gpHex));\r\n        return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n      }\r\n    }\r\n\r\n    if (gasPrice) return finalizeLegacy(gasLimit, gasPrice);\r\n\r\n    if (!computedMaxFee) {\r\n      return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n    }\r\n\r\n    const maxP = computedMaxFee;\r\n    const prio = computedPriority ?? 0n;\r\n    const likelyPerGas = (maxP + prio) / 2n;\r\n\r\n    const feeMaxWei = gasLimit * maxP;\r\n    const feeLikelyWei = gasLimit * likelyPerGas;\r\n\r\n    return {\r\n      ok: true,\r\n      gasLimit,\r\n      maxFeePerGas: maxP,\r\n      maxPriorityFeePerGas: prio,\r\n      feeMaxWei,\r\n      feeLikelyWei\r\n    };\r\n  } catch {\r\n    return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n  }\r\n}\r\n\r\nfunction finalizeLegacy(gasLimit: bigint, gasPrice: bigint): FeeEstimate {\r\n  const feeMaxWei = gasLimit * gasPrice;\r\n  return { ok: true, gasLimit, gasPrice, feeMaxWei, feeLikelyWei: feeMaxWei };\r\n}\r\n", "/**\n * P0 UI Gate: methods that must NEVER bypass the SignGuard overlay (TEMP ALLOW, etc.)\n * User must always see and confirm in SignGuard before the wallet popup opens.\n */\n\nconst UI_GATED_METHODS_LIST = [\n  \"eth_requestAccounts\",\n  \"wallet_requestPermissions\",\n  \"wallet_addEthereumChain\",\n  \"wallet_switchEthereumChain\",\n  \"wallet_watchAsset\",\n  \"wallet_sendTransaction\",\n  \"eth_sendTransaction\",\n  \"eth_signTransaction\",\n  \"eth_sendRawTransaction\",\n  \"wallet_invokeSnap\",\n  \"wallet_requestSnaps\",\n  \"personal_sign\",\n  \"eth_sign\",\n  \"eth_signTypedData\",\n  \"eth_signTypedData_v3\",\n  \"eth_signTypedData_v4\",\n];\n\nconst UI_GATED_METHODS = new Set(UI_GATED_METHODS_LIST.map((m) => m.toLowerCase()));\n\nexport { UI_GATED_METHODS };\n\nexport function shouldGateUI(method: string): boolean {\n  return UI_GATED_METHODS.has(String(method || \"\").toLowerCase());\n}\n", "// ARQUIVO: src/mainWorld.ts\nimport { estimateFee } from \"./feeEstimate\";\nimport type { TxCostPreview } from \"./shared/types\";\nimport { shouldGateUI } from \"./shared/uiGate\";\n\nconst DEBUG_PREFIX = \"\uD83D\uDE80 [SignGuard MainWorld]\";\n/** CustomEvent name for decision (synchronous \u2192 preserves user activation for MetaMask). */\nconst SG_DECISION_EVENT = \"__sg_decision__\";\n\nfunction log(msg: string, ...args: any[]) {\n  console.log(`%c${DEBUG_PREFIX} ${msg}`, \"color: #00ff00; font-weight: bold;\", ...args);\n}\n\nfunction postToContent(type: \"SG_REQUEST\" | \"SG_PREVIEW\", requestId: string, payload: any) {\n  window.postMessage({ source: \"signguard\", type, requestId, payload }, \"*\");\n}\n\nfunction toDecStringWei(v: any): string {\n  try { return BigInt(v ?? \"0x0\").toString(10); } catch { return \"0\"; }\n}\n\nasync function buildTxCostPreview(\n  providerRequest: (args: any) => Promise<any>,\n  tx: any\n): Promise<TxCostPreview> {\n  const valueWeiDec = toDecStringWei(tx?.value ?? \"0x0\");\n  try {\n    const fee = await estimateFee(providerRequest, tx);\n\n    if (!fee.ok) {\n      return {\n        valueWei: valueWeiDec,\n        feeEstimated: false,\n        feeReasonKey: fee.reason ?? \"fee_unknown_wallet_will_estimate\",\n      };\n    }\n\n    const valueWei = BigInt(valueWeiDec);\n    const feeLikelyWei = BigInt(fee.feeLikelyWei ?? 0n);\n    const feeMaxWei = BigInt(fee.feeMaxWei ?? 0n);\n\n    return {\n      valueWei: valueWeiDec,\n      feeEstimated: true,\n      gasLimitWei: (fee.gasLimit ?? 0n).toString(10),\n      feeLikelyWei: feeLikelyWei.toString(10),\n      feeMaxWei: feeMaxWei.toString(10),\n      totalLikelyWei: (valueWei + feeLikelyWei).toString(10),\n      totalMaxWei: (valueWei + feeMaxWei).toString(10),\n    };\n  } catch {\n    return {\n      valueWei: valueWeiDec,\n      feeEstimated: false,\n      feeReasonKey: \"fee_unknown_wallet_will_estimate\",\n    };\n  }\n}\n\nfunction parseHexOrDecToBigInt(v: any): bigint {\n  try {\n    if (typeof v === \"bigint\") return v;\n    if (typeof v === \"number\" && Number.isFinite(v)) return BigInt(Math.trunc(v));\n    if (typeof v === \"string\") {\n      if (v.startsWith(\"0x\")) return BigInt(v);\n      if (/^\\d+$/.test(v)) return BigInt(v);\n    }\n  } catch {}\n  return 0n;\n}\n\nasync function safeGetChainIdHex(provider: any): Promise<string | null> {\n  try {\n    const direct = provider?.chainId;\n    if (typeof direct === \"string\" && direct.startsWith(\"0x\")) return direct;\n  } catch {}\n  try {\n    const cid = await provider?.request?.({ method: \"eth_chainId\", params: [] });\n    if (typeof cid === \"string\" && cid.startsWith(\"0x\")) return cid;\n  } catch {}\n  return null;\n}\n\nlog(\"Script injected and started.\");\n\nconst SENSITIVE_METHODS_LIST = [\n  \"eth_requestAccounts\",\n  \"wallet_requestPermissions\",\n  \"wallet_addEthereumChain\",\n  \"wallet_switchEthereumChain\",\n  \"wallet_watchAsset\",\n  \"eth_sendTransaction\",\n  \"wallet_sendTransaction\",\n  \"eth_sendRawTransaction\",\n  \"eth_signTransaction\",\n  \"wallet_getPermissions\",\n  \"wallet_invokeSnap\",\n  \"wallet_requestSnaps\",\n  \"personal_sign\",\n  \"eth_sign\",\n  \"eth_signTypedData\",\n  \"eth_signTypedData_v3\",\n  \"eth_signTypedData_v4\",\n];\n\nconst SENSITIVE_METHODS = new Set(SENSITIVE_METHODS_LIST.map((m) => String(m).toLowerCase()));\n\nfunction normalizeMethod(m: any): string {\n  if (m == null) return \"\";\n  if (typeof m === \"string\") return m;\n  if (typeof m === \"object\" && typeof (m as { method?: string }).method === \"string\") return (m as { method: string }).method;\n  return String(m);\n}\n\nfunction isSensitive(method: string): boolean {\n  return SENSITIVE_METHODS.has(String(method || \"\").toLowerCase());\n}\n\nif (typeof window !== \"undefined\") {\n  try {\n    if (!isSensitive(\"wallet_switchEthereumChain\") || !isSensitive(\"wallet_switchethereumchain\") || !isSensitive(\"eth_sendTransaction\")) {\n      console.error(DEBUG_PREFIX, \"Sensitive method self-check FAIL: gate methods must be detected\");\n    } else if (isSensitive(\"eth_accounts\")) {\n      console.error(DEBUG_PREFIX, \"Sensitive method self-check: eth_accounts is not in gate list (read-only)\");\n    } else {\n      log(\"Sensitive method self-check OK\");\n    }\n  } catch (e) {\n    console.error(DEBUG_PREFIX, \"Sensitive method self-check failed\", e);\n  }\n}\n\n/** Unified handler: HOLDING + SG_REQUEST + await decision for sensitive methods. */\nasync function handleSensitiveRpc(\n  method: string,\n  params: any[],\n  provider: any,\n  originalRequest: (args: any) => Promise<any>,\n  buildArgs: () => any\n): Promise<any> {\n  const requestId = crypto.randomUUID();\n  const m = String(method || \"\").toLowerCase();\n  const isUiGated = shouldGateUI(m);\n  const tx = Array.isArray(params) ? params[0] : undefined;\n\n  const DEFAULT_FAIL_MODE: \"fail_open\" | \"fail_closed\" = isUiGated ? \"fail_closed\" : \"fail_open\";\n  const DECISION_TIMEOUT_MS = isUiGated ? 60000 : 2500;\n\n  let chainIdHex: string | null = null;\n  try {\n    const direct = provider?.chainId;\n    if (typeof direct === \"string\" && direct.startsWith(\"0x\")) chainIdHex = direct;\n  } catch {}\n  if (!chainIdHex) chainIdHex = await safeGetChainIdHex(provider);\n\n  let chainIdRequested: string | undefined;\n  if (m === \"wallet_switchethereumchain\" || m === \"wallet_addethereumchain\") {\n    const p0 = params?.[0];\n    if (p0 && typeof p0 === \"object\") {\n      const cidReq = (p0 as any).chainId;\n      if (typeof cidReq === \"string\") chainIdRequested = cidReq;\n    }\n  }\n\n  const initialPreview =\n    (m === \"eth_sendtransaction\" || m === \"wallet_sendtransaction\") && tx && typeof tx === \"object\"\n      ? { valueWei: toDecStringWei(tx?.value ?? \"0x0\"), feeEstimated: false, feeReasonKey: \"fee_calculating\" as const }\n      : undefined;\n\n  /** failMode per requestId (content sends SG_SETTINGS); UI-gated defaults to fail_closed. */\n  const pendingFailMode: Record<string, \"fail_open\" | \"fail_closed\"> = {};\n  pendingFailMode[requestId] = DEFAULT_FAIL_MODE;\n\n  log(`\uD83D\uDCE8 Sending SG_REQUEST to content: ${method} requestId=${requestId}`);\n  postToContent(\"SG_REQUEST\", requestId, {\n    method,\n    params,\n    host: window.location.hostname,\n    url: window.location.href,\n    chainIdHex: chainIdHex ?? undefined,\n    txCostPreview: initialPreview,\n    meta: chainIdRequested ? { chainIdRequested } : undefined,\n  });\n\n  if (m === \"eth_sendtransaction\" || m === \"wallet_sendtransaction\") {\n    if (tx && typeof tx === \"object\") {\n      (async () => {\n        let cid: string | null = null;\n        try { cid = await originalRequest({ method: \"eth_chainId\", params: [] }); } catch {}\n        const txCostPreview = await buildTxCostPreview(originalRequest, tx);\n        postToContent(\"SG_PREVIEW\", requestId, { chainIdHex: cid ?? undefined, txCostPreview });\n      })();\n    }\n  }\n\n  return new Promise((resolve, reject) => {\n    let resolved = false;\n    let timeoutId: ReturnType<typeof setTimeout> | null = null;\n    const args = buildArgs();\n\n    const cleanup = () => {\n      if (timeoutId != null) {\n        clearTimeout(timeoutId);\n        timeoutId = null;\n      }\n      window.removeEventListener(SG_DECISION_EVENT, onDecision as EventListener);\n      window.removeEventListener(\"message\", onMessage);\n      delete pendingFailMode[requestId];\n    };\n\n    const applyDecision = (allow: boolean, meta?: { uiConfirmed?: boolean; uiGate?: boolean; reasonKeys?: string[] }) => {\n      if (resolved) return;\n      resolved = true;\n      cleanup();\n      if (!allow) {\n        reject({ code: 4001, message: \"SignGuard: Blocked by user\" });\n        return;\n      }\n      const gated = shouldGateUI(m);\n      const uiConfirmed = meta?.uiConfirmed === true;\n      const reasonKeys = meta?.reasonKeys ?? [];\n      const extensionPaused = reasonKeys.includes(\"EXTENSION_PAUSED\");\n      if (gated && !uiConfirmed && !extensionPaused) {\n        log(\"BLOCKED forward: uiConfirmed missing for gated method\", m);\n        reject(new Error(\"SignGuard: UI confirmation required before forwarding to wallet\"));\n        return;\n      }\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_RELEASED\", requestId, method: m }, \"*\");\n      originalRequest(args).then(resolve).catch(reject);\n    };\n\n    const onTimeout = () => {\n      if (resolved) return;\n      resolved = true;\n      cleanup();\n      const failMode = pendingFailMode[requestId] ?? DEFAULT_FAIL_MODE;\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_DIAG_TIMEOUT\", requestId, failMode, method: m }, \"*\");\n\n      if (isUiGated) {\n        log(\"Decision timeout on UI-gated method \u2014 blocking (never fail-open):\", m);\n        reject(new Error(\"SignGuard: aguardando confirma\u00E7\u00E3o no overlay (timeout).\"));\n        return;\n      }\n\n      if (failMode === \"fail_open\") {\n        log(\"Decision timeout: fail_open \u2014 releasing request\");\n        originalRequest(args).then(resolve).catch(reject);\n      } else {\n        log(\"Decision timeout: fail_closed \u2014 blocking request\");\n        reject(new Error(\"SignGuard: request timed out; reload the page and try again.\"));\n      }\n    };\n\n    const onDecision = (ev: Event) => {\n      const ce = ev as CustomEvent;\n      const data = ce?.detail ?? null;\n      if (!data || data.type !== \"SG_DECISION\" || data.requestId !== requestId) return;\n      applyDecision(!!data.allow, data.meta);\n    };\n    const onMessage = (ev: MessageEvent) => {\n      if (resolved) return;\n      const d = ev.data;\n      if (d?.source === \"signguard-content\" && d?.type === \"SG_SETTINGS\" && d?.requestId === requestId) {\n        const fm = d.failMode === \"fail_closed\" ? \"fail_closed\" : \"fail_open\";\n        pendingFailMode[requestId] = isUiGated ? \"fail_closed\" : fm;\n        return;\n      }\n      if (d?.source !== \"signguard-content\" || d?.type !== \"SG_DECISION\" || d?.requestId !== requestId) return;\n      applyDecision(!!d.allow, d.meta);\n    };\n    timeoutId = setTimeout(onTimeout, DECISION_TIMEOUT_MS);\n    window.addEventListener(SG_DECISION_EVENT, onDecision as EventListener);\n    window.addEventListener(\"message\", onMessage);\n  });\n}\n\n// Fun\u00E7\u00E3o para patchear o provider\nfunction patchProvider(provider: any) {\n  if (!provider || provider._sg_patched) return;\n\n  log(\"Patching found provider:\", provider);\n\n  const originalRequest = provider.request?.bind?.(provider);\n  if (!originalRequest) return;\n  (provider as any).__sg_originalRequest = originalRequest;\n\n  // (1) Intercept .request\n  Object.defineProperty(provider, \"request\", {\n    value: async (args: any) => {\n      const method = normalizeMethod(args?.method ?? args);\n      const sensitive = isSensitive(method);\n      log(`Intercepted request: ${method} (isSensitive=${sensitive})`, args);\n      if (!sensitive) {\n        log(`\u27A1\uFE0F PASS-THROUGH: ${method}`);\n        return originalRequest(args);\n      }\n      log(`\uD83D\uDED1 HOLDING request: ${method} (reason: sensitive)`);\n      return handleSensitiveRpc(method, args.params ?? [], provider, originalRequest, () => args);\n    },\n    configurable: true,\n    writable: true\n  });\n\n  // (2) Intercept .send \u2014 assinaturas: send(method, params?) | send(payload, callback?)\n  const origSend = provider.send?.bind?.(provider);\n  if (origSend) {\n    Object.defineProperty(provider, \"send\", {\n      value: function (a: any, b?: any) {\n        let method: string;\n        let params: any[];\n        let callback: (err: any, result?: any) => void | undefined;\n        if (typeof a === \"string\") {\n          method = normalizeMethod(a);\n          params = Array.isArray(b) ? b : [];\n          return new Promise((resolve, reject) => {\n            if (!isSensitive(method)) {\n              log(`\u27A1\uFE0F PASS-THROUGH: ${method}`);\n              origSend(method, params).then(resolve).catch(reject);\n              return;\n            }\n            log(`\uD83D\uDED1 HOLDING send: ${method} (reason: sensitive)`);\n            handleSensitiveRpc(method, params, provider, originalRequest, () => ({ method, params }))\n              .then(resolve)\n              .catch(reject);\n          });\n        }\n        if (a && typeof a === \"object\" && typeof b === \"function\") {\n          callback = b;\n          method = normalizeMethod(a.method ?? a);\n          params = a.params ?? [];\n          if (!isSensitive(method)) {\n            log(`\u27A1\uFE0F PASS-THROUGH: ${method}`);\n            return origSend(a, callback);\n          }\n          log(`\uD83D\uDED1 HOLDING send(payload,cb): ${method} (reason: sensitive)`);\n          handleSensitiveRpc(method, params, provider, originalRequest, () => a)\n            .then((res) => callback(null, res))\n            .catch((err) => callback(err, undefined));\n          return;\n        }\n        return origSend(a, b);\n      },\n      configurable: true,\n      writable: true\n    });\n  }\n\n  // (3) Intercept .sendAsync \u2014 sendAsync(payload, callback)\n  const origSendAsync = provider.sendAsync?.bind?.(provider);\n  if (origSendAsync) {\n    Object.defineProperty(provider, \"sendAsync\", {\n      value: function (payload: any, callback: (err: any, result?: any) => void) {\n        const method = normalizeMethod(payload?.method ?? payload);\n        const params = payload?.params ?? [];\n        if (!isSensitive(method)) {\n          log(`\u27A1\uFE0F PASS-THROUGH: ${method}`);\n          return origSendAsync(payload, callback);\n        }\n        log(`\uD83D\uDED1 HOLDING sendAsync: ${method} (reason: sensitive)`);\n        handleSensitiveRpc(method, params, provider, originalRequest, () => payload)\n          .then((res) => callback(null, res))\n          .catch((err) => callback(err, undefined));\n      },\n      configurable: true,\n      writable: true\n    });\n  }\n\n  (provider as any)._sg_patched = true;\n  log(\"Provider patched successfully.\");\n}\n\n/** Patch all providers in ethereum.providers array (multi-wallet). */\nfunction patchProvidersArray(providers: any[]): void {\n  if (!Array.isArray(providers)) return;\n  for (let i = 0; i < providers.length; i++) {\n    const p = providers[i];\n    if (p && !(p as any)._sg_patched) {\n      patchProvider(p);\n    }\n  }\n}\n\n// Inicializa\u00E7\u00E3o com m\u00FAltiplas tentativas\nfunction init() {\n  log(\"Initializing...\");\n\n  const ensureEthPatched = (eth: any) => {\n    if (!eth) return;\n    if (!(eth as any)._sg_patched) patchProvider(eth);\n    const providers = eth?.providers;\n    if (Array.isArray(providers)) patchProvidersArray(providers);\n  };\n\n  if ((window as any).ethereum) {\n    ensureEthPatched((window as any).ethereum);\n  }\n\n  // Monitora inje\u00E7\u00E3o do MetaMask / multi-provider\n  let storedEth = (window as any).ethereum;\n  try {\n    Object.defineProperty(window, \"ethereum\", {\n      get: () => storedEth,\n      set: (val) => {\n        log(\"window.ethereum was set externally!\");\n        storedEth = val;\n        ensureEthPatched(val);\n      },\n      configurable: true\n    });\n  } catch {\n    // Some pages may lock ethereum\n  }\n\n  // EIP-6963: intercept announced providers\n  window.addEventListener(\"eip6963:announceProvider\", ((ev: CustomEvent) => {\n    const detail = ev?.detail;\n    if (!detail || typeof detail !== \"object\") return;\n    const provider = detail.provider ?? detail;\n    if (provider && !(provider as any)._sg_patched) {\n      log(\"EIP-6963: Patching announced provider\", detail.info?.name ?? \"?\");\n      patchProvider(provider);\n    }\n  }) as EventListener);\n\n  // EIP-6963: request providers early + retry for late-announcing wallets\n  const requestProviders = () => {\n    try { window.dispatchEvent(new Event(\"eip6963:requestProvider\")); } catch {}\n  };\n  requestProviders();\n  setTimeout(requestProviders, 2000);\n  setTimeout(requestProviders, 5000);\n\n  // MutationObserver: re-patch when ethereum/providers change (injected late)\n  try {\n    const observer = new MutationObserver(() => {\n      const eth = (window as any).ethereum;\n      if (eth && !(eth as any)._sg_patched) {\n        log(\"MutationObserver: unpatched provider detected. Patching...\");\n        patchProvider(eth);\n        if (Array.isArray(eth?.providers)) patchProvidersArray(eth.providers);\n      }\n    });\n    observer.observe(document.documentElement, { childList: true, subtree: true });\n  } catch {}\n\n  // Poll 3-5s p\u00F3s-load para capturar providers que surgem depois (e EIP-6963 late)\n  const pollMs = 4000;\n  setInterval(() => {\n    const eth = (window as any).ethereum;\n    if (!eth) return;\n    if (!(eth as any)._sg_patched) {\n      log(\"Poll: unpatched provider. Patching now...\");\n      patchProvider(eth);\n    }\n    if (Array.isArray(eth?.providers)) patchProvidersArray(eth.providers);\n  }, pollMs);\n}\n\ninit();\n\nconst RPC_ALLOWED = new Set([\"eth_call\", \"eth_chainid\", \"eth_getcode\", \"eth_getblockbynumber\", \"eth_getlogs\", \"eth_estimategas\", \"eth_gasprice\", \"eth_getbalance\", \"eth_gettransactioncount\", \"eth_accounts\"]);\n\n/** Canonical method names for provider (do not send lowercased to provider). */\nconst METHOD_CANONICAL: Record<string, string> = {\n  eth_chainid: \"eth_chainId\",\n  eth_accounts: \"eth_accounts\",\n  eth_requestaccounts: \"eth_requestAccounts\",\n  eth_getlogs: \"eth_getLogs\",\n  eth_call: \"eth_call\",\n  eth_estimategas: \"eth_estimateGas\",\n  eth_gasprice: \"eth_gasPrice\",\n  eth_getbalance: \"eth_getBalance\",\n  eth_gettransactioncount: \"eth_getTransactionCount\",\n  eth_getblockbynumber: \"eth_getBlockByNumber\",\n  eth_getcode: \"eth_getCode\",\n  wallet_switchethereumchain: \"wallet_switchEthereumChain\",\n  wallet_addethereumchain: \"wallet_addEthereumChain\",\n};\n\nwindow.addEventListener(\"message\", async (ev: MessageEvent) => {\n  if (ev.source !== window || ev.data?.source !== \"signguard-content\") return;\n\n  if (ev.data?.type === \"SG_RPC_CALL_REQ\") {\n    const { requestId, method, params } = ev.data;\n    if (!requestId || !method) return;\n    const requested = String(method).trim();\n    const key = requested.toLowerCase();\n    if (!RPC_ALLOWED.has(key)) {\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_RPC_CALL_RES\", requestId, ok: false, error: \"method_not_allowed\" }, \"*\");\n      return;\n    }\n    const canonical = METHOD_CANONICAL[key] ?? requested;\n    const eth = (window as any).ethereum;\n    const orig = eth?.__sg_originalRequest ?? eth?.request?.bind?.(eth);\n    if (!orig) {\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_RPC_CALL_RES\", requestId, ok: false, error: \"no_provider\" }, \"*\");\n      return;\n    }\n    try {\n      const result = await orig({ method: canonical, params: params ?? [] });\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_RPC_CALL_RES\", requestId, ok: true, result }, \"*\");\n    } catch (e) {\n      window.postMessage({ source: \"signguard-mainworld\", type: \"SG_RPC_CALL_RES\", requestId, ok: false, error: String((e as Error)?.message ?? e) }, \"*\");\n    }\n    return;\n  }\n\n  if (ev.data?.type !== \"SG_FEE_ESTIMATE_REQ\") return;\n  const { requestId, tx } = ev.data?.payload ?? {};\n  if (!requestId || !tx) return;\n  const eth = (window as any).ethereum;\n  const orig = eth?.__sg_originalRequest ?? eth?.request?.bind?.(eth);\n  if (!orig) {\n    window.postMessage({ source: \"signguard\", type: \"SG_FEE_ESTIMATE_RES\", requestId, feeEstimate: { ok: false, feeEstimated: false, error: \"no_provider\" } }, \"*\");\n    return;\n  }\n  try {\n    const fee = await estimateFee((args: any) => orig(args), tx);\n    const valueWei = typeof tx?.value === \"string\" ? BigInt(tx.value) : BigInt(tx?.value || \"0x0\");\n    const gasLimit = fee.gasLimit ?? 150000n;\n    const feeLikelyWei = fee.feeLikelyWei ?? 0n;\n    const feeMaxWei = fee.feeMaxWei ?? 0n;\n    window.postMessage({\n      source: \"signguard\",\n      type: \"SG_FEE_ESTIMATE_RES\",\n      requestId,\n      feeEstimate: {\n        ok: fee.ok,\n        gasLimitHex: fee.ok && gasLimit ? \"0x\" + gasLimit.toString(16) : undefined,\n        feeLikelyWeiHex: fee.ok && feeLikelyWei ? \"0x\" + feeLikelyWei.toString(16) : undefined,\n        feeMaxWeiHex: fee.ok && feeMaxWei ? \"0x\" + feeMaxWei.toString(16) : undefined,\n        feeEstimated: fee.ok,\n        feeReasonKey: fee.reason,\n      },\n    }, \"*\");\n  } catch (e) {\n    window.postMessage({ source: \"signguard\", type: \"SG_FEE_ESTIMATE_RES\", requestId, feeEstimate: { ok: false, feeEstimated: false, error: String((e as Error)?.message ?? e) } }, \"*\");\n  }\n});\n"],
  "mappings": "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",
  "names": ["requestId", "eth", "orig"]
}
