{
  "version": 3,
  "sources": ["../src/feeEstimate.ts", "../src/mainWorld.ts"],
  "sourcesContent": ["export type FeeEstimate = {\r\n  ok: boolean;\r\n  gasLimit?: bigint;\r\n  maxFeePerGas?: bigint;        // wei\r\n  maxPriorityFeePerGas?: bigint;// wei\r\n  gasPrice?: bigint;            // wei (legacy)\r\n  feeMaxWei?: bigint;           // wei\r\n  feeLikelyWei?: bigint;        // wei (baseFee + priority) * gas\r\n  reason?: string;\r\n};\r\n\r\nconst RPC_TIMEOUT_MS = 2500;\r\n\r\n/** Call RPC once; returns null on any error or timeout. Never throws, no console.error. */\r\nasync function tryRpc<T>(providerRequest: (a: any) => Promise<any>, method: string, params: any[], timeoutMs = RPC_TIMEOUT_MS): Promise<T | null> {\r\n  let t: ReturnType<typeof setTimeout>;\r\n  const timeout = new Promise<null>((res) => { t = setTimeout(() => res(null), timeoutMs); });\r\n  try {\r\n    const r = await Promise.race([providerRequest({ method, params }).then((x) => x as T), timeout]);\r\n    clearTimeout(t!);\r\n    return r;\r\n  } catch {\r\n    clearTimeout(t!);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function estimateFee(providerRequest: (args: any) => Promise<any>, tx: any): Promise<FeeEstimate> {\r\n  try {\r\n    // 1) gasLimit (estimateGas) - fallback for simple transfers\r\n    let gasLimit: bigint;\r\n    const gasHex = await tryRpc<string>(providerRequest, \"eth_estimateGas\", [tx]);\r\n    if (gasHex != null && typeof gasHex === \"string\") {\r\n      try { gasLimit = BigInt(gasHex); } catch { gasLimit = 150000n; }\r\n    } else {\r\n      const hasData = tx?.data && String(tx.data) !== \"0x\" && String(tx.data).toLowerCase() !== \"0x\";\r\n      const valueWei = BigInt(tx?.value || \"0x0\");\r\n      gasLimit = hasData ? 150000n : valueWei > 0n ? 21000n : 150000n;\r\n    }\r\n\r\n    // 2) Prefer dapp-provided EIP-1559 fields if present\r\n    const maxFeePerGas = tx?.maxFeePerGas ? BigInt(tx.maxFeePerGas) : undefined;\r\n    const maxPriorityFeePerGas = tx?.maxPriorityFeePerGas ? BigInt(tx.maxPriorityFeePerGas) : undefined;\r\n    const gasPrice = tx?.gasPrice ? BigInt(tx.gasPrice) : undefined;\r\n\r\n    // 3) If no fees provided, compute from feeHistory + priority (or gasPrice fallback)\r\n    let computedMaxFee: bigint | undefined = maxFeePerGas;\r\n    let computedPriority: bigint | undefined = maxPriorityFeePerGas;\r\n\r\n    if (!computedMaxFee && !gasPrice) {\r\n      let baseFee: bigint | undefined;\r\n      const fh = await tryRpc<{ baseFeePerGas?: string[] }>(providerRequest, \"eth_feeHistory\", [\"0x1\", \"latest\", []]);\r\n      const arr = fh?.baseFeePerGas;\r\n      if (Array.isArray(arr) && arr.length > 0) {\r\n        try { baseFee = BigInt(arr[arr.length - 1]); } catch { baseFee = undefined; }\r\n      } else {\r\n        baseFee = undefined;\r\n      }\r\n\r\n      if (baseFee != null) {\r\n        computedPriority = computedPriority ?? 1_000_000_000n;\r\n        computedMaxFee = baseFee * 2n + computedPriority;\r\n      } else {\r\n        const gpHex = await tryRpc<string>(providerRequest, \"eth_gasPrice\", []);\r\n        if (gpHex != null && gpHex !== \"\") return finalizeLegacy(gasLimit, BigInt(gpHex));\r\n        return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n      }\r\n    }\r\n\r\n    if (gasPrice) return finalizeLegacy(gasLimit, gasPrice);\r\n\r\n    if (!computedMaxFee) {\r\n      return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n    }\r\n\r\n    const maxP = computedMaxFee;\r\n    const prio = computedPriority ?? 0n;\r\n    const likelyPerGas = (maxP + prio) / 2n;\r\n\r\n    const feeMaxWei = gasLimit * maxP;\r\n    const feeLikelyWei = gasLimit * likelyPerGas;\r\n\r\n    return {\r\n      ok: true,\r\n      gasLimit,\r\n      maxFeePerGas: maxP,\r\n      maxPriorityFeePerGas: prio,\r\n      feeMaxWei,\r\n      feeLikelyWei\r\n    };\r\n  } catch {\r\n    return { ok: false, reason: \"fee_unknown_wallet_will_estimate\" };\r\n  }\r\n}\r\n\r\nfunction finalizeLegacy(gasLimit: bigint, gasPrice: bigint): FeeEstimate {\r\n  const feeMaxWei = gasLimit * gasPrice;\r\n  return { ok: true, gasLimit, gasPrice, feeMaxWei, feeLikelyWei: feeMaxWei };\r\n}\r\n", "// ARQUIVO: src/mainWorld.ts\r\nimport { estimateFee } from \"./feeEstimate\";\r\nimport type { TxCostPreview } from \"./shared/types\";\r\n\r\nconst DEBUG_PREFIX = \"\uD83D\uDE80 [SignGuard MainWorld]\";\r\n/** CustomEvent name for decision (synchronous \u2192 preserves user activation for MetaMask). */\r\nconst SG_DECISION_EVENT = \"__sg_decision__\";\r\n\r\nfunction log(msg: string, ...args: any[]) {\r\n  console.log(`%c${DEBUG_PREFIX} ${msg}`, \"color: #00ff00; font-weight: bold;\", ...args);\r\n}\r\n\r\nfunction postToContent(type: \"SG_REQUEST\" | \"SG_PREVIEW\", requestId: string, payload: any) {\r\n  window.postMessage({ source: \"signguard\", type, requestId, payload }, \"*\");\r\n}\r\n\r\nfunction toDecStringWei(v: any): string {\r\n  try { return BigInt(v ?? \"0x0\").toString(10); } catch { return \"0\"; }\r\n}\r\n\r\nasync function buildTxCostPreview(\r\n  providerRequest: (args: any) => Promise<any>,\r\n  tx: any\r\n): Promise<TxCostPreview> {\r\n  const valueWeiDec = toDecStringWei(tx?.value ?? \"0x0\");\r\n  try {\r\n    const fee = await estimateFee(providerRequest, tx);\r\n\r\n    if (!fee.ok) {\r\n      return {\r\n        valueWei: valueWeiDec,\r\n        feeEstimated: false,\r\n        feeReasonKey: fee.reason ?? \"fee_unknown_wallet_will_estimate\",\r\n      };\r\n    }\r\n\r\n    const valueWei = BigInt(valueWeiDec);\r\n    const feeLikelyWei = BigInt(fee.feeLikelyWei ?? 0n);\r\n    const feeMaxWei = BigInt(fee.feeMaxWei ?? 0n);\r\n\r\n    return {\r\n      valueWei: valueWeiDec,\r\n      feeEstimated: true,\r\n      gasLimitWei: (fee.gasLimit ?? 0n).toString(10),\r\n      feeLikelyWei: feeLikelyWei.toString(10),\r\n      feeMaxWei: feeMaxWei.toString(10),\r\n      totalLikelyWei: (valueWei + feeLikelyWei).toString(10),\r\n      totalMaxWei: (valueWei + feeMaxWei).toString(10),\r\n    };\r\n  } catch {\r\n    return {\r\n      valueWei: valueWeiDec,\r\n      feeEstimated: false,\r\n      feeReasonKey: \"fee_unknown_wallet_will_estimate\",\r\n    };\r\n  }\r\n}\r\n\r\nfunction parseHexOrDecToBigInt(v: any): bigint {\r\n  try {\r\n    if (typeof v === \"bigint\") return v;\r\n    if (typeof v === \"number\" && Number.isFinite(v)) return BigInt(Math.trunc(v));\r\n    if (typeof v === \"string\") {\r\n      if (v.startsWith(\"0x\")) return BigInt(v);\r\n      if (/^\\d+$/.test(v)) return BigInt(v);\r\n    }\r\n  } catch {}\r\n  return 0n;\r\n}\r\n\r\nasync function safeGetChainIdHex(provider: any): Promise<string | null> {\r\n  try {\r\n    const direct = provider?.chainId;\r\n    if (typeof direct === \"string\" && direct.startsWith(\"0x\")) return direct;\r\n  } catch {}\r\n  try {\r\n    const cid = await provider?.request?.({ method: \"eth_chainId\", params: [] });\r\n    if (typeof cid === \"string\" && cid.startsWith(\"0x\")) return cid;\r\n  } catch {}\r\n  return null;\r\n}\r\n\r\nlog(\"Script injected and started.\");\r\n\r\n// Fun\u00E7\u00E3o para patchear o provider\r\nfunction patchProvider(provider: any) {\r\n  if (!provider || provider._sg_patched) return;\r\n\r\n  log(\"Patching found provider:\", provider);\r\n\r\n  const originalRequest = provider.request.bind(provider);\r\n  (provider as any).__sg_originalRequest = originalRequest;\r\n\r\n  // Define um Proxy para interceptar .request\r\n  Object.defineProperty(provider, \"request\", {\r\n    value: async (args: any) => {\r\n      const method = args?.method;\r\n      log(`Intercepted call to: ${method}`, args);\r\n\r\n      // Lista de m\u00E9todos que queremos parar\r\n      const methodsToIntercept = [\r\n        \"eth_sendTransaction\",\r\n        \"eth_signTypedData\",\r\n        \"eth_signTypedData_v3\",\r\n        \"eth_signTypedData_v4\",\r\n        \"personal_sign\",\r\n        \"wallet_switchEthereumChain\"\r\n      ];\r\n\r\n      if (!methodsToIntercept.includes(method)) {\r\n        log(`Passthrough method: ${method}`);\r\n        return originalRequest(args);\r\n      }\r\n\r\n      log(`\uD83D\uDED1 HOLDING Request: ${method}. Sending to Content Script...`);\r\n\r\n      const requestId = crypto.randomUUID();\r\n      const m = String(method || \"\").toLowerCase();\r\n      const tx = Array.isArray(args.params) ? args.params[0] : undefined;\r\n      const isTx = m === \"eth_sendtransaction\" || m === \"wallet_sendtransaction\";\r\n\r\n      // chainIdHex s\u00EDncrono quando poss\u00EDvel (provider.chainId)\r\n      let chainIdHex: string | null = null;\r\n      try {\r\n        const direct = provider?.chainId;\r\n        if (typeof direct === \"string\" && direct.startsWith(\"0x\")) chainIdHex = direct;\r\n      } catch {}\r\n      if (!chainIdHex) {\r\n        chainIdHex = await safeGetChainIdHex(provider);\r\n      }\r\n\r\n      let chainIdRequested: string | undefined;\r\n      if (m === \"wallet_switchethereumchain\" || m === \"wallet_addethereumchain\") {\r\n        const p0 = Array.isArray(args.params) ? args.params[0] : undefined;\r\n        if (p0 && typeof p0 === \"object\") {\r\n          const cidReq = (p0 as any).chainId;\r\n          if (typeof cidReq === \"string\") chainIdRequested = cidReq;\r\n        }\r\n      }\r\n\r\n      // (1) SG_REQUEST imediato (preview m\u00EDnimo para value + \"calculando\" nos fees)\r\n      const initialPreview =\r\n        method === \"eth_sendTransaction\" && tx && typeof tx === \"object\"\r\n          ? { valueWei: toDecStringWei(tx?.value ?? \"0x0\"), feeEstimated: false, feeReasonKey: \"fee_calculating\" as const }\r\n          : undefined;\r\n\r\n      postToContent(\"SG_REQUEST\", requestId, {\r\n        method,\r\n        params: args.params,\r\n        host: window.location.hostname,\r\n        url: window.location.href,\r\n        chainIdHex: chainIdHex ?? undefined,\r\n        txCostPreview: initialPreview,\r\n        meta: chainIdRequested ? { chainIdRequested } : undefined,\r\n      });\r\n\r\n      // (2) PRE-FLIGHT em paralelo (eth_sendTransaction): estima fee e posta SG_PREVIEW\r\n      if (method === \"eth_sendTransaction\" && tx && typeof tx === \"object\") {\r\n        (async () => {\r\n          let chainIdHexPreview: string | null = null;\r\n          try {\r\n            const cid = await originalRequest({ method: \"eth_chainId\" });\r\n            if (typeof cid === \"string\") chainIdHexPreview = cid;\r\n          } catch {}\r\n\r\n          const txCostPreview = await buildTxCostPreview(originalRequest, tx);\r\n          postToContent(\"SG_PREVIEW\", requestId, {\r\n            chainIdHex: chainIdHexPreview ?? undefined,\r\n            txCostPreview,\r\n          });\r\n          log(\"SG_PREVIEW posted\");\r\n        })();\r\n      }\r\n\r\n      // Espera resposta \u2014 via CustomEvent (s\u00EDncrono) para manter user activation e MetaMask abrir\r\n      return new Promise((resolve, reject) => {\r\n        let resolved = false;\r\n        const onDecision = (ev: Event) => {\r\n          const ce = ev as CustomEvent;\r\n          const data = ce?.detail ?? null;\r\n          if (!data || data.type !== \"SG_DECISION\" || data.requestId !== requestId) return;\r\n          if (resolved) return;\r\n          resolved = true;\r\n          window.removeEventListener(SG_DECISION_EVENT, onDecision as EventListener);\r\n          window.removeEventListener(\"message\", onMessage);\r\n\r\n          log(`\u2705 Decision received for ${requestId}: ${data.allow}`);\r\n          if (data.allow) {\r\n            log(\"Executing original request...\");\r\n            originalRequest(args).then(resolve).catch(reject);\r\n          } else {\r\n            log(\"Rejecting request (User Blocked).\");\r\n            reject({ code: 4001, message: \"SignGuard: Blocked by user\" });\r\n          }\r\n        };\r\n        const onMessage = (ev: MessageEvent) => {\r\n          if (resolved) return;\r\n          if (ev.data?.source !== \"signguard-content\" || ev.data?.type !== \"SG_DECISION\" || ev.data?.requestId !== requestId) return;\r\n          resolved = true;\r\n          window.removeEventListener(SG_DECISION_EVENT, onDecision as EventListener);\r\n          window.removeEventListener(\"message\", onMessage);\r\n          log(`\u2705 Decision (fallback postMessage) for ${requestId}: ${ev.data.allow}`);\r\n          if (ev.data.allow) originalRequest(args).then(resolve).catch(reject);\r\n          else reject({ code: 4001, message: \"SignGuard: Blocked by user\" });\r\n        };\r\n        window.addEventListener(SG_DECISION_EVENT, onDecision as EventListener);\r\n        window.addEventListener(\"message\", onMessage);\r\n        // Fallback: se em 3s n\u00E3o chegou por CustomEvent, postMessage ainda pode chegar\r\n        setTimeout(() => {\r\n          if (!resolved) {\r\n            // opcional: poderia remover s\u00F3 o listener de CustomEvent e deixar message\r\n          }\r\n        }, 3000);\r\n      });\r\n    },\r\n    configurable: true,\r\n    writable: true\r\n  });\r\n\r\n  provider._sg_patched = true;\r\n  log(\"Provider patched successfully.\");\r\n}\r\n\r\n// Inicializa\u00E7\u00E3o com m\u00FAltiplas tentativas\r\nfunction init() {\r\n  log(\"Initializing...\");\r\n\r\n  if ((window as any).ethereum) {\r\n    patchProvider((window as any).ethereum);\r\n  }\r\n\r\n  // Monitora inje\u00E7\u00E3o do MetaMask\r\n  let storedEth = (window as any).ethereum;\r\n  Object.defineProperty(window, \"ethereum\", {\r\n    get: () => storedEth,\r\n    set: (val) => {\r\n      log(\"window.ethereum was set externally!\");\r\n      storedEth = val;\r\n      patchProvider(val);\r\n    },\r\n    configurable: true\r\n  });\r\n\r\n  // Polling de seguran\u00E7a (caso o defineProperty falhe)\r\n  setInterval(() => {\r\n    const eth = (window as any).ethereum;\r\n    if (eth && !eth._sg_patched) {\r\n      log(\"Polling found unpatched provider. Patching now...\");\r\n      patchProvider(eth);\r\n    }\r\n  }, 1000);\r\n}\r\n\r\ninit();\r\n\r\nwindow.addEventListener(\"message\", async (ev: MessageEvent) => {\r\n  if (ev.source !== window || ev.data?.source !== \"signguard-content\" || ev.data?.type !== \"SG_FEE_ESTIMATE_REQ\") return;\r\n  const { requestId, tx } = ev.data?.payload ?? {};\r\n  if (!requestId || !tx) return;\r\n  const eth = (window as any).ethereum;\r\n  const orig = eth?.__sg_originalRequest ?? eth?.request?.bind?.(eth);\r\n  if (!orig) {\r\n    window.postMessage({ source: \"signguard\", type: \"SG_FEE_ESTIMATE_RES\", requestId, feeEstimate: { ok: false, feeEstimated: false, error: \"no_provider\" } }, \"*\");\r\n    return;\r\n  }\r\n  try {\r\n    const fee = await estimateFee((args: any) => orig(args), tx);\r\n    const valueWei = typeof tx?.value === \"string\" ? BigInt(tx.value) : BigInt(tx?.value || \"0x0\");\r\n    const gasLimit = fee.gasLimit ?? 150000n;\r\n    const feeLikelyWei = fee.feeLikelyWei ?? 0n;\r\n    const feeMaxWei = fee.feeMaxWei ?? 0n;\r\n    window.postMessage({\r\n      source: \"signguard\",\r\n      type: \"SG_FEE_ESTIMATE_RES\",\r\n      requestId,\r\n      feeEstimate: {\r\n        ok: fee.ok,\r\n        gasLimitHex: fee.ok && gasLimit ? \"0x\" + gasLimit.toString(16) : undefined,\r\n        feeLikelyWeiHex: fee.ok && feeLikelyWei ? \"0x\" + feeLikelyWei.toString(16) : undefined,\r\n        feeMaxWeiHex: fee.ok && feeMaxWei ? \"0x\" + feeMaxWei.toString(16) : undefined,\r\n        feeEstimated: fee.ok,\r\n        feeReasonKey: fee.reason,\r\n      },\r\n    }, \"*\");\r\n  } catch (e) {\r\n    window.postMessage({ source: \"signguard\", type: \"SG_FEE_ESTIMATE_RES\", requestId, feeEstimate: { ok: false, feeEstimated: false, error: String((e as Error)?.message ?? e) } }, \"*\");\r\n  }\r\n});\r\n"],
  "mappings": "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",
  "names": []
}
