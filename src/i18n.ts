export type Locale = "pt" | "en";

export function detectLocale(): Locale {
  const raw = (navigator.languages?.[0] || navigator.language || "en").toLowerCase();
  if (raw.startsWith("pt")) return "pt";
  return "en";
}

const dict: Record<Locale, Record<string, string>> = {
  pt: {
    tech_displayAction: "Ação (classificação)",
    tech_methodRaw: "Método (raw)",
    tech_recommendScoreLevel: "Recomendação/score/nível",
    tech_reasons: "Motivos",
    tech_decoded: "Decodificado",
    dash: "—",
    tx_to: "To",
    tx_data_length: "Tamanho do data",
    more_whatItDoes: "O que isso faz",
    more_risks: "Riscos",
    more_safeNotes: "Notas de segurança",
    more_nextSteps: "Próximos passos",
    // Brand
    extName: "Crypto Wallet SignGuard",

    // Overlay - generic labels
    overlay_requested_title: "O que está sendo solicitado",
    overlay_site_trusted_title: "Site confiável?",
    overlay_summary_title: "Resumo (linguagem simples)",
    overlay_recommended_title: "Ação recomendada",
    overlay_note_title: "Observação",

    // Overlay - details sections
    details_tx_title: "Detalhes da transação",
    details_tech_title: "Detalhes técnicos",
    details_more_title: "Mais explicações",

    // Queue
    queue_indicator: "Fila: {pos} de {total}",

    // Action titles
    action_CONNECT_title: "Conectar carteira",
    action_REQUEST_PERMISSIONS_title: "Solicitar permissões",
    action_SWITCH_CHAIN_title: "Trocar rede",
    action_ADD_CHAIN_title: "Adicionar rede",
    action_SIGN_MESSAGE_title: "Assinar mensagem",
    action_SIGN_TYPED_DATA_title: "Assinar dados (Typed Data)",
    action_SEND_TX_title: "Enviar transação",
    action_SEND_TX_contract_title: "Interagir com contrato",
    action_SEND_TX_eth_title: "Enviar ETH",
    action_WATCH_ASSET_title: "Adicionar token/ativo",
    action_SOLANA_title: "Assinatura/Transação Solana",
    action_UNKNOWN_title: "Solicitação",

    // Summary bullets (plain language)
    summary_CONNECT_1: "O site quer ver seus endereços e a rede atual.",
    summary_CONNECT_2: "Ele poderá pedir assinaturas/transações depois.",
    summary_CONNECT_3: "Conecte apenas se confiar no site.",
    summary_REQUEST_PERMISSIONS_1: "O site quer permissões adicionais na sua carteira.",
    summary_REQUEST_PERMISSIONS_2: "Revise as permissões na carteira antes de aceitar.",
    summary_SWITCH_CHAIN_1: "O site quer trocar a rede (chain) da sua carteira.",
    summary_SWITCH_CHAIN_2: "Troca de rede normalmente não custa gas.",
    explain_connect_title: "Conectar carteira",
    explain_connect_short: "Login com carteira (compartilha seu endereço público)",
    explain_connect_why: "Isso permite ao site mostrar sua conta e pedir assinaturas/aprovações/transações depois.",
    explain_sign_title: "Assinar mensagem",
    explain_sign_short: "Sem gas, mas assinaturas podem autorizar ações",
    explain_sign_why: "Sites usam assinaturas para login, verificação de posse ou autorizações off-chain.",
    explain_typed_title: "Assinar dados estruturados",
    explain_typed_short: "Typed-data pode incluir permits/autorizações",
    explain_typed_why: "Typed-data é frequentemente usado para permits (aprovações sem approve on-chain separado).",
    explain_tx_title: "Enviar transação",
    explain_tx_short: "Ação on-chain (pode ter taxa de gas)",
    explain_tx_why: "Isso criará uma transação on-chain se você aprovar na sua carteira.",
    explain_switch_title: "Trocar rede",
    explain_switch_why: "Alguns sites exigem uma rede específica para funcionar.",
    explain_addchain_title: "Adicionar rede",
    explain_addchain_short: "Adiciona uma configuração de chain na carteira",
    explain_add_chain_short: "Adicionar rede na carteira",
    add_chain_review_rpc: "RPC malicioso pode enganar saldos/transações; confirme a procedência.",
    add_chain_verify_chainid: "Confirme o chainId e o nome da rede antes de adicionar.",
    explain_addchain_why: "A carteira pode adicionar detalhes de RPC para a rede solicitada.",
    explain_watchasset_title: "Adicionar ativo",
    explain_watchasset_short: "Adiciona um token/ativo na UI da carteira",
    explain_watch_asset_short: "Adicionar token/ativo na carteira",
    watch_asset_no_spend_but_risk: "Adicionar token não gasta fundos, mas tokens podem ser golpe; confirme contrato.",
    watch_asset_verify_contract: "Verifique o endereço do contrato em um explorer confiável.",
    explain_watchasset_why: "Não gasta fundos, mas confirme se os detalhes do token estão corretos.",
    explain_generic_title: "Solicitação da carteira",
    explain_generic_short: "Um site está pedindo uma ação da carteira",
    explain_generic_why: "Revise os detalhes na carteira e confirme a URL do site.",
    human_connect_whatIs: "Conecta seu endereço de carteira a este site (como um login).",
    human_connect_sees_1: "Seu endereço público (e seleção de conta)",
    human_connect_sees_2: "Sua rede/chain selecionada",
    human_connect_sees_3: "Atividade on-chain pública (tokens/NFTs são dados públicos)",
    human_connect_not_1: "NÃO revela sua seed phrase nem a senha da carteira",
    human_connect_not_2: "NÃO move fundos automaticamente por si só",
    human_connect_why_1: "Para mostrar sua conta e saldos na interface",
    human_connect_why_2: "Para permitir assinar mensagens (login/verificação)",
    human_connect_why_3: "Para pedir aprovações/transações depois (com sua confirmação)",
    human_connect_risk_1: "Privacidade/rastreamento: pode vincular seu endereço a este site",
    human_connect_risk_2: "Phishing em etapas: os próximos prompts podem pedir assinatura/approve",
    human_connect_risk_3: "Domínios similares: sites falsos costumam começar com um connect inofensivo",
    human_connect_safe_1: "Trate connect como compartilhar identidade: faça isso só em sites que você reconhece.",
    human_connect_next_1: "Confira o domínio (ortografia, HTTPS, sem punycode)",
    human_connect_next_2: "Se tiver dúvida, cancele e abra o site por um favorito confiável",
    human_connect_reco_suspicious: "Cancele e verifique a URL por outro meio (favorito/busca), depois tente novamente.",
    human_connect_reco_ok: "Continue apenas se você reconhece o site e a URL parece correta.",
    human_sign_whatIs: "Cria uma assinatura criptográfica. Geralmente não custa gas, mas pode autorizar ações.",
    human_sign_risk_1: "Assinar textos desconhecidos pode autorizar ações/login que você não pretendia",
    human_sign_risk_2: "Blind sign pode esconder o que você está autorizando",
    human_typed_whatIs: "Assina dados estruturados (typed-data). Frequentemente usado para permits/autorizações.",
    human_typed_risk_1: "Typed-data pode incluir permits de token que funcionam como aprovações",
    human_sign_safe_1: "Prefira carteiras que mostrem detalhes de assinatura de forma legível.",
    human_sign_next_1: "Verifique a URL e leia a mensagem/typed-data com atenção",
    human_sign_next_2: "Se o prompt for vago, cancele e peça contexto ao site",
    human_sign_reco_suspicious: "Cancele. Domínio suspeito + assinatura é um padrão comum de phishing.",
    human_sign_reco_ok: "Só continue se você entende o motivo da assinatura e confia no site.",
    human_approve_whatIs: "Uma aprovação permite que um contrato gaste seus tokens depois (até o limite aprovado).",
    human_approve_risk_1: "Aprovações podem ser abusadas se o contrato gastador for malicioso ou comprometido",
    human_approve_risk_unlimited: "Aprovação ilimitada significa que pode gastar TODO o saldo do token",
    human_approve_safe_1: "Quando possível, aprove apenas o mínimo necessário.",
    human_approve_next_1: "Confira o spender/operador e se você reconhece o dApp",
    human_approve_next_2: "Considere revogar aprovações depois se não usar mais o site",
    human_approve_reco: "Continue apenas se você confia no site e o spender faz sentido.",
    human_approve_reco_unlimited: "Evite aprovações ilimitadas a menos que você confie muito no site e entenda o risco.",
    human_setApprovalForAll_whatIs: "Dá permissão a um operador para mover TODOS os NFTs de uma coleção por você.",
    human_setApprovalForAll_risk_1: "Isso pode permitir drenar NFTs se o operador for malicioso/comprometido",
    human_setApprovalForAll_safe_1: "Aprove apenas operadores que você reconhece (ex.: marketplaces conhecidos).",
    human_setApprovalForAll_next_1: "Verifique o endereço do operador e se o site é o marketplace pretendido",
    human_setApprovalForAll_reco: "Cancele a menos que você esteja em um marketplace reconhecido e espere essa ação.",
    human_tx_whatIs: "Isso criará uma transação on-chain se você aprovar na sua carteira.",
    human_tx_risk_1: "Transações podem mover fundos ou alterar permissões dependendo da chamada",
    human_tx_safe_1: "Sempre verifique destinatário, valor e o contrato com o qual está interagindo.",
    human_tx_next_1: "Confira o destino (to), valor e a ação decodificada (se houver)",
    human_tx_reco_suspicious: "Cancele. Não envie transações em domínios suspeitos.",
    human_tx_reco_ok: "Continue apenas se você pretendia essa ação e os detalhes parecem corretos.",
    human_chain_whatIs: "Muda a rede selecionada na sua carteira.",
    human_chain_risk_1: "Redes/RPCs errados podem te enganar sobre ativos ou transações",
    human_chain_safe_1: "Só troque/adicione redes que você reconhece.",
    human_chain_next_1: "Confirme nome da rede e chainId no prompt da carteira",
    human_watchasset_whatIs: "Adiciona um token/ativo na UI da carteira para facilitar a visualização.",
    human_watchasset_risk_1: "Tokens falsos podem se passar por reais—verifique endereço e símbolo",
    human_watchasset_safe_1: "Confirme detalhes do token em um explorer confiável (ex.: Etherscan).",
    human_watchasset_next_1: "Verifique o contrato do token e as decimais",
    human_watchasset_reco: "Continue apenas se os detalhes baterem com uma fonte oficial.",
    human_generic_whatIs: "Um site solicitou uma ação da carteira. Revise os detalhes com cuidado.",
    human_generic_risk_1: "Prompts desconhecidos podem fazer parte de fluxos de phishing",
    human_generic_safe_1: "Na dúvida, cancele e verifique o site.",
    human_generic_next_1: "Confira a URL e leia os detalhes do prompt da carteira",
    human_generic_reco: "Continue apenas se você entende e esperava essa solicitação.",
    human_revoke_link_text: "Revogar permissões depois: revoke.cash",
    trustReasonNotHttps: "Não é HTTPS (maior risco de spoofing/injeção).",
    trustReasonManyHyphens: "Muitos hífens no domínio (comum em similares).",
    trustReasonSuspiciousKeywords: "Domínio contém palavras de alto risco (login/verify/secure/...).",
    trustReasonBrandLookalike: "Nome lembra uma marca, mas não é o domínio oficial.",
    trustReasonManySubdomains: "Estrutura de subdomínio profunda/incomum.",
    trustReasonNoHost: "Não foi possível ler o hostname do site.",
    trustReasonAllowlistedVariant: "Domínio casa com um padrão confiável.",
    trustReasonUnknown: "Sem sinais fortes para um lado ou outro.",
    summary_ADD_CHAIN_1: "O site quer adicionar uma nova rede na sua carteira.",
    summary_ADD_CHAIN_2: "Confirme o chainId e o nome da rede com cuidado.",
    summary_SIGN_MESSAGE_1: "Você vai assinar uma mensagem (não é transação).",
    summary_SIGN_MESSAGE_2: "A assinatura pode ter efeitos fora da blockchain (login, termos, permissões).",
    summary_SIGN_TYPED_DATA_1: "Você vai assinar dados estruturados (EIP-712).",
    summary_SIGN_TYPED_DATA_2: "Isso pode autorizar gastos/ordens dependendo do conteúdo.",
    summary_SIGN_TYPED_DATA_3: "Verifique quem é o spender/contrato envolvido.",
    summary_SEND_TX_1: "Você vai enviar uma transação on-chain.",
    summary_SEND_TX_2: "Isso pode mover ETH/tokens ou interagir com um contrato.",
    summary_SEND_TX_3: "Confira valor, rede e destino antes de confirmar.",
    summary_WATCH_ASSET_1: "O site quer adicionar um token/ativo na sua carteira.",
    summary_WATCH_ASSET_2: "Confirme símbolo e endereço do contrato do token.",
    summary_SOLANA_1: "Assinatura ou transação Solana. Os valores serão confirmados na carteira.",
    summary_UNKNOWN_1: "O site está fazendo uma chamada de carteira desconhecida.",
    summary_UNKNOWN_2: "Se não souber o que é, cancele.",

    // Costs / TX labels
    btn_cancel: "Cancelar",
    btn_continue: "Continuar",
    toast_request_expired: "Solicitação expirada. Refaça a ação no site e tente novamente.",
    simulation_tx_will_fail: "ESTA TRANSAÇÃO VAI FALHAR",
    btn_close: "Fechar",
    btn_proceed_anyway: "Prosseguir mesmo assim",
    override_checkbox: "Eu entendo o risco e quero prosseguir",
    override_countdown: "({s}s)",

    tip_revoke: "Revogar permissões depois: revoke.cash",
    cost_summary_title: "Resumo de custos",
    costs_title: "Custos e impacto",
    impact_title: "Impacto",
    permission_for: "Permissão para",
    addr_marked_public: "Marcado em base pública",
    risk_title: "Risco e por quê",
    what_to_do_now: "O que fazer agora",
    site_label: "Site",
    network_label: "Rede",
    severity_BLOCKED: "BLOQUEADO",
    severity_HIGH: "ALTO",
    severity_WARN: "ATENÇÃO",
    severity_LOW: "BAIXO",
    cost_you_send: "Você envia",
    cost_fee_only: "apenas taxa",
    cost_value: "Valor (ETH)",
    cost_fee: "Taxa estimada (ETH)",
    cost_total: "Total estimado (ETH)",
    cost_fee_unknown: "Taxa será cobrada (confirme na carteira)",
    network_switch_title: "Troca de rede",
    network_current: "Rede atual",
    network_requested: "Rede solicitada",
    trusted_domain_ref_title: "Domínios confiáveis (referência)",
    tx_cost_sending: "Você está enviando {value} ETH + taxa de rede",
    tx_cost_gas_only: "Mesmo sem enviar ETH, você pagará taxa de rede (gas)",
    gas_calculating: "calculando…",

    tx_destination: "Destino",
    token_verified_uniswap: "Token Verificado (Uniswap List)",
    token_unknown_unverified: "Token Desconhecido (Não Verificado)",
    tx_contract_method: "Contrato/método",
    tx_max_gas_fee: "Gas máx (ETH)",
    tx_max_total: "Total máx (ETH)",
    tx_fee_estimated_by_wallet: "A carteira estimará a taxa na próxima etapa.",

    network_target: "Rede alvo",
    switch_no_gas: "A troca de rede normalmente NÃO custa gas.",
    switch_next_step_gas: "A próxima etapa (compra/transação) terá taxa de rede.",
    switch_note_inline: "A troca de rede normalmente NÃO custa gas. Porém a próxima etapa (compra/transação) terá taxa de rede.",
    sendtx_reco: "Confirme na carteira apenas se os detalhes (valor, rede e contrato) estiverem corretos.",

    // Risk/trust labels
    risk_LOW: "Baixo",
    risk_WARN: "Atenção",
    risk_HIGH: "Alto",
    recommend_ALLOW: "Permitir",
    recommend_WARN: "Avisar",
    recommend_HIGH: "Alto risco",
    recommend_BLOCK: "Bloquear",
    trust_unknown: "Desconhecido",
    trust_suspicious: "Suspeito",
    trust_likelyOfficial: "Domínio conhecido (lista de referência)",
    trust_domainNotRecognized: "Domínio não reconhecido",

    // Phishing hard-block
    phishing_hard_block: "Domínio em blacklist de phishing. Bloqueado.",

    // Toasts
    toast_extension_updated: "Extensão atualizada — recarregue a aba.",
    toast_cannot_analyze: "Não foi possível analisar. Recarregue a aba.",

    // Options page
    optionsTitle: "Crypto Wallet SignGuard — Configurações",
    optionsSubtitle: "Controle quando o SignGuard deve alertar e bloquear.",
    dashboardLink: "Dashboard",
    onboardingTitle: "Como usar",
    onboardingHowTo: "A extensão intercepta solicitações sensíveis (conexão, assinatura, transação) de carteiras injetadas (window.ethereum / window.solana). Ao detectar, mostra um overlay para você revisar antes de a carteira abrir.",
    onboardingWhatItDoes: "Faz: alerta antes de conectar, assinar ou enviar; verifica domínio contra listas de phishing; mostra intenção da transação (swap, NFT, approval).",
    onboardingWhatItDoesNot: "Não faz: não protege conexões via QR/WalletConnect; não garante que contratos sejam seguros; não substitui verificação manual.",
    onboardingLinkRevoke: "revoke.cash — revogar permissões",
    onboardingLinkEtherscan: "Etherscan — explorar transações",
    exportDebugRequiresDebugMode: "Ative o modo Debug primeiro para exportar eventos.",
    securityModeLabel: "Modo de segurança",
    securityModeDesc: "Strict bloqueia mais; Balanced alerta; Relaxed reduz fricção; Off desativa bloqueios.",
    modeStrict: "Strict",
    modeBalanced: "Balanced",
    modeRelaxed: "Relaxed",
    modeOff: "Off",
    strictBlockApprovalsUnlimitedLabel: "Strict: bloquear approve ilimitado",
    strictBlockApprovalsUnlimitedDesc: "Bloqueia aprovações ERC20 unlimited (MAX_UINT256).",
    strictBlockSetApprovalForAllLabel: "Strict: bloquear setApprovalForAll",
    strictBlockSetApprovalForAllDesc: "Bloqueia permissão para mover todos os NFTs.",
    strictBlockPermitLikeLabel: "Strict: bloquear Permit ilimitado",
    strictBlockPermitLikeDesc: "Bloqueia assinaturas Permit (EIP-2612) unlimited.",
    assetEnrichmentEnabledLabel: "Enriquecimento de ativos",
    assetEnrichmentEnabledDesc: "Busca símbolo/nome de tokens via eth_call.",
    addressIntelEnabledLabel: "Threat intel de endereços",
    addressIntelEnabledDesc: "Verifica spender/operator/to contra blacklist.",
    riskWarningsLabel: "Alertas de risco",
    riskWarningsDesc: "Mostra avisos e recomendações antes de abrir a carteira.",
    connectOverlayLabel: "Overlay ao conectar",
    connectOverlayDesc: "Mostra o overlay também para conexão/permissões.",
    blockHighRiskLabel: "Bloquear alto risco",
    blockHighRiskDesc: "Bloqueia automaticamente ações de alto risco.",
    requireTypedOverrideLabel: "Exigir override em Typed Data (alto risco)",
    requireTypedOverrideDesc: "Para assinaturas EIP-712 de alto risco, exige confirmação extra.",
    allowOverrideOnPhishingLabel: "Permitir override em phishing (NÃO recomendado)",
    allowOverrideOnPhishingDesc: "Se desativado (padrão), phishing em blacklist é bloqueado sem opção de prosseguir.",
    mode_off_reason: "Modo OFF: sem bloqueios.",
    address_flagged_reason: "Endereço/contrato sinalizado: {label} ({category})",
    addr_sanctioned_block: "Endereço em lista de sanções.",
    addr_scam_reported_warn: "Endereço marcado como suspeito/relatado.",
    addr_phishing_reported_warn: "Endereço marcado como suspeito/relatado.",
    addr_malicious_contract_warn: "Contrato marcado como malicioso.",
    asset_info_reason: "Ativo: {sym} ({kind})",
    reason_permission_tokens: "Permissão para gastar tokens",
    reason_permission_all_nfts: "Permissão para mover TODOS os NFTs",
    reason_transfer_tokens: "Transferência de tokens/NFT",
    domainChecksLabel: "Checagens de domínio",
    domainChecksDesc: "Alertas por padrões suspeitos no domínio quando não estiver na allowlist.",
    allowlistLabel: "Allowlist (domínios confiáveis)",
    allowlistDesc: "Um domínio por linha. Ex.: opensea.io",
    vaultTitle: "Cofre SignGuard",
    vaultDesc: "Contratos nesta lista nunca podem ser transacionados sem desbloqueio explícito nas opções.",
    vaultAddLabel: "Adicionar contrato ao cofre",
    vaultAddButton: "Adicionar ao Cofre",
    vaultListLabel: "Contratos bloqueados",
    vaultListEmpty: "Nenhum contrato no cofre.",
    vaultRemove: "Remover",
    vaultInvalidAddress: "Endereço inválido. Use 0x e 40 caracteres hexadecimais.",
    vaultAlreadyAdded: "Este contrato já está no cofre.",
    vaultBlockedMessage: "SignGuard: Ativo Bloqueado no Cofre. Desbloqueie nas opções para continuar.",
    addSuggested: "Adicionar sugeridos",
    save: "Salvar",
    saved: "Salvo",

    intelTitle: "Threat Intel",
    intelSubtitle: "Listas de domínios (fontes plugáveis) usadas na análise.",
    intelTrustedCountLabel: "Domínios confiáveis",
    intelBlockedCountLabel: "Domínios bloqueados",
    intelBlockedAddressCountLabel: "Endereços bloqueados",
    intelUpdatedAtLabel: "Última atualização",
    intelUpdateNow: "Atualizar agora",
    enableIntelLabel: "Usar Threat Intel",
    enableIntelDesc: "Usa listas de domínios confiáveis/bloqueados na análise.",
    customTrustedDomainsLabel: "Domínios confiáveis (lista personalizada)",
    customTrustedDomainsDesc: "Um por linha. Ex.: meusite.io",
    customBlockedDomainsLabel: "Domínios bloqueados (lista personalizada)",
    customBlockedDomainsDesc: "Um por linha. Sempre bloqueados.",
    exportListsLabel: "Exportar listas",

    privacyLimitsTitle: "Privacidade & Limitações",
    privacyLimitsLine1: "A extensão não acessa sua seed/frase secreta e não tem custódia.",
    privacyLimitsLine2: "Ela analisa domínios e dados de transação exibidos pelo navegador para alertas. Não garante 100%.",
    privacyLimitsLine3: "Threat intel pode ser atualizado via fontes públicas (opcional).",
    cloudIntelOptInLabel: "Permitir checagens externas",
    cloudIntelOptInDesc: "Mais proteção; pode enviar domínio/endereços para validação (preparado para P1).",
    showUsdLabel: "Mostrar valores em USD",
    showUsdDesc: "Exibe aproximação em dólares (USD) ao lado de valores em ETH.",
    tabSettings: "Configurações",
    tabHistory: "Histórico",
    tabPlan: "Plano",
    historySubtitle: "Últimas decisões do overlay.",
    historyExport: "Exportar JSON",
    historyClear: "Limpar",
    historyEmpty: "Nenhum registro.",
    decision_allow: "Permitido",
    decision_block: "Bloqueado",
    planSubtitle: "Gerencie seu plano e licença.",
    planCurrent: "Plano atual",
    planLicenseKey: "Chave de licença",
    planActivate: "Ativar",
    planGoPro: "Assinar PRO",
    // Options: Safety notes + debug
    safetyNotesTitle: "Limitações & segurança",
    safetyNotesLine1: "Esta extensão monitora solicitações feitas por carteiras injetadas (window.ethereum / window.solana).",
    safetyNotesLine2: "Conexões via QR/WalletConnect podem não ser interceptadas. Sempre verifique na sua carteira.",
    safetyNotesLinkRevoke: "revoke.cash",
    safetyNotesLinkEtherscan: "etherscan.io",
    debugModeLabel: "Modo debug",
    debugModeDesc: "Armazena os últimos 20 eventos (sem payload grande) para suporte.",
    exportDebug: "Exportar",

    // Overlay: intent + permission + copy
    looks_like: "Parece:",
    intent_NFT_PURCHASE: "Compra de NFT",
    intent_SWAP: "Swap",
    intent_APPROVAL: "Permissão",
    intent_SEND: "Envio",
    intent_UNKNOWN: "Desconhecido",
    intent_ETH_TRANSFER: "Envio de ETH",
    intent_TOKEN_TRANSFER: "Transferência de token",
    intent_NFT_TRANSFER: "Transferência de NFT",
    intent_CONTRACT_INTERACTION: "Interação com contrato",
    intent_SWITCH_CHAIN: "Troca de rede",
    intent_ADD_CHAIN: "Adicionar rede",
    intent_WATCH_ASSET: "Adicionar token",
    intent_SOLANA: "Assinatura/Transação Solana",
    intent_SIGNATURE: "Assinatura",
    intent_TYPED_DATA: "Dados tipados",
    wallet_label: "Carteira",
    wallet_detecting: "Detectando…",
    wallet_evm_generic: "Carteira EIP-1193",
    trust_disclaimer: "Lista de referência ≠ garantia. Golpistas podem usar domínios parecidos.",
    hint_wallet_popup: "Sua carteira deve abrir agora. Se não abrir, clique no ícone da carteira e verifique solicitações pendentes.",
    add_chain_network_label: "Rede a adicionar",
    add_chain_rpc_label: "RPC",
    watch_asset_token_label: "Token a adicionar",
    modeLabel: "Modo:",
    popupPauseProtection: "PAUSAR PROTEÇÃO",
    popupStatusProtected: "Protegido",
    popupStatusPaused: "Pausado",
    info_unavailable: "Informação indisponível.",
    explain_switch_short: "O site pediu para trocar a rede (chain) da sua carteira.",
    human_chain_reco: "Continue apenas se você esperava a troca de rede e ela parece correta.",
    trustReasonAllowlisted: "Domínio está em uma lista confiável (seed).",
    trustReasonPhishingBlacklist: "Domínio está em blacklist de phishing (lista de referência).",
    fee_unknown_wallet_will_estimate: "Taxa: será exibida pela carteira",
    label_you_send: "Você envia",
    label_fee_likely: "Taxa estimada (provável)",
    label_fee_max: "Taxa máxima (pior caso)",
    label_total_likely: "Total provável",
    label_total_max: "Total máximo",
    fee_gt_value: "A taxa máxima é MAIOR que o valor enviado. Confirme se faz sentido.",
    check_wallet_network_fee: "Você ainda não viu a taxa. Verifique o 'Network fee' na carteira antes de confirmar.",
    label_max_fee: "Taxa máxima (ETH)",
    label_max_total: "Total máximo (ETH)",
    switch_summary_no_gas: "Troca de rede normalmente não custa gas, mas pode mudar quais ativos você está vendo.",
    permission_title: "Permissão",
    permission_token_contract: "Contrato",
    permission_spender: "Spender",
    permission_operator: "Operator",
    permission_unlimited: "Ilimitado",
    approval_unlimited_detected: "Aprovação ilimitada detectada",
    permit_signature_detected: "Assinatura tipo Permit detectada (pode autorizar gasto de tokens)",
    token_transfer_detected: "Transferência de token detectada",
    nft_transfer_detected: "Transferência de NFT detectada",
    transfer_token_title: "Transferência de token",
    transfer_nft_title: "Transferência de NFT",
    transfer_amount: "Quantidade",
    transfer_token_id: "Token ID",
    yes: "Sim",
    no: "Não",
    copy: "Copiar",
    chainChangeTitle: "Solicitação de troca/adicionar rede",
    watchAssetTitle: "Solicitação de adicionar ativo",

    domainPunycodeReason: "Domínio usa punycode (xn--); verifique a URL.",
    domainDoubleDashReason: "Domínio contém hífen duplo (suspeito).",
    domainNumberPatternReason: "Domínio com muitos números (comum em phishing).",
    domainLookalikeReason: "Possível imitação do domínio oficial de {legit}.",
    suspiciousWebsitePatterns: "Padrões suspeitos no site.",
    page_risk_suspicious_banner: "⚠️ SignGuard: Site Suspeito Detetado",
    connectTitle: "Conectar carteira",
    connectReason: "O site quer conectar à sua carteira.",
    walletRequestPermissionsTitle: "Solicitar permissões",
    walletRequestPermissionsReason: "O site quer permissões adicionais na carteira.",
    typedDataWarnReason: "Assinatura de dados estruturados (EIP-712); pode autorizar ações.",
    signatureRequest: "Pedido de assinatura",
    rawSignWarnReason: "Assinatura de mensagem raw; pode autorizar ações fora da blockchain.",
    tokenApproval: "Aprovação de token",
    unlimitedApprovalReason: "Aprovação ilimitada detectada (MAX_UINT256).",
    unlimitedApprovalDetected: "Aprovação ilimitada detectada",
    nftOperatorApprovalReason: "Permissão para mover TODOS os NFTs da coleção.",
    nftOperatorApproval: "Permissão de operador NFT",
    txPreview: "Visualização da transação",
    txWarnReason: "Transação on-chain; confira valor, destino e rede.",
    unknownMethodReason: "Método de carteira desconhecido.",
    warningsDisabledReason: "Alertas desativados nas configurações.",
    analyzing: "Analisando…",
    analyzing_subtitle: "Site • Método",
    analyzing_hint: "Validando domínio e estimando impacto",
    fallback_partial_check: "Sem verificação completa agora — revise os detalhes abaixo antes de prosseguir.",
    fallback_partial_verification: "Verificação parcial agora — revise os detalhes abaixo antes de prosseguir.",
    loading_base: "Carregando base…",
    analyzerUnavailableTitle: "Analisador indisponível",
    analysis_unavailable: "Análise indisponível — confira na carteira antes de continuar.",
    dados_parciais_title: "Dados parciais — confirme na carteira",
    dados_parciais_subtitle: "Exibindo o que foi possível analisar. Verifique os detalhes na carteira antes de continuar.",
    risk_low: "Baixo",
    risk_warn: "Atenção",
    risk_high: "Alto",
    risk_block: "Bloqueado",
    trustReasonAllowlistedMatched: "Domínio em allowlist: {matched}.",
    list_empty_domains: "Lista vazia. Abra as opções para adicionar domínios confiáveis.",
    btn_open_options: "Abrir opções",
    default_human_switch_what: "Troca a rede ativa da carteira (ex.: Ethereum → outra rede).",
    default_human_switch_risk: "Você pode assinar/transacionar na rede errada se a troca não for esperada.",
    default_human_switch_safe: "Confirme a rede solicitada e se o site é o correto.",
    default_human_switch_next: "Se estiver certo, aprove na carteira. Se estiver estranho, cancele.",
    default_human_contract_what: "Envia uma transação para um contrato (ação dentro do dApp).",
    default_human_contract_risk: "O custo real pode variar e a ação pode mover ativos/tokens via contrato.",
    default_human_contract_safe: "Confira destino (to), rede, valor e a taxa (Network fee) na carteira.",
    default_human_contract_next: "Se os detalhes baterem, prossiga. Caso contrário, cancele.",
    default_human_eth_what: "Envia ETH diretamente para um endereço.",
    default_human_eth_risk: "Transferências são irreversíveis se o destino estiver errado.",
    default_human_eth_safe: "Verifique o endereço e o valor. Desconfie de links/encurtadores.",
    default_human_eth_next: "Só confirme se você reconhece o destinatário.",
    default_human_typed_what: "Assinatura off-chain (EIP-712). Pode autorizar ações sem pagar gas.",
    default_human_typed_risk: "Pode conceder permissões/autorizações (ex.: permit/approval) dependendo do conteúdo.",
    default_human_typed_safe: "Revise o que está sendo autorizado (spender/operator) e o domínio/contrato.",
    default_human_typed_next: "Se não entender, cancele e valide no site oficial do dApp.",
    default_human_generic_what: "Ação solicitada pela dApp.",
    default_human_generic_risk: "Se algo não fizer sentido, cancele.",
    default_human_generic_safe: "Confirme domínio, rede e detalhes na carteira.",
    default_human_generic_next: "Prossiga apenas se tudo estiver correto.",
    verdict_ok: "OK",
    verdict_warn: "Atenção",
    verdict_high: "Risco alto",
    verdict_block: "Bloqueado",
    coverage_label: "Cobertura",
    coverage_limited: "cobertura limitada",
    trusted_domain_ref_empty: "Lista de referência ainda não carregou.",
    trusted_domain_ref_loading: "Carregando lista de referência…",
    trusted_domain_ref_refresh: "Atualizar listas",
    trusted_domain_ref_view_more: "Ver mais",
    trusted_domains_loading: "Carregando lista de referência…",
    trusted_domains_more: "+{n}",
    trusted_domains_search_placeholder: "Filtrar domínios…",
    trusted_domains_update_now: "Atualizar agora",
    trusted_domains_auto_update: "Atualiza automaticamente nas opções",
    banner_ok_no_known_threats: "OK: nenhum sinal conhecido de golpe/scam detectado.",
    banner_block_known_threat: "Bloqueado: ameaça conhecida detectada.",
    banner_local_verification: "Atenção: verificação local (cache). Revise os detalhes abaixo antes de prosseguir.",
    banner_basic_verification: "Atenção: verificação básica. Revise cuidadosamente os detalhes antes de prosseguir.",
    updated_x_hours: "Base atualizada há {n} hora(s)",
    updated_x_days: "Base atualizada há {n} dia(s)",
    tip_check_wallet_details: "Confira valor, rede e taxa na carteira.",
    no_alerts_known: "Nenhum alerta conhecido foi detectado para este contexto.",
    still_review_wallet: "Mesmo assim, revise na carteira (valor, rede, destino e taxa).",
    site_status_known: "referência conhecida",
    site_status_not_in_list: "Site não está na lista de referência",
    destination_contract: "Contrato",
    destination_wallet: "Carteira",
  },
  en: {
    tech_displayAction: "Action (classification)",
    tech_methodRaw: "Method (raw)",
    tech_recommendScoreLevel: "Recommend/score/level",
    tech_reasons: "Reasons",
    tech_decoded: "Decoded",
    dash: "—",
    tx_to: "To",
    tx_data_length: "Data length",
    more_whatItDoes: "What it does",
    more_risks: "Risks",
    more_safeNotes: "Safety notes",
    more_nextSteps: "Next steps",
    // Brand
    extName: "Crypto Wallet SignGuard",

    // Overlay - generic labels
    overlay_requested_title: "What is being requested",
    overlay_site_trusted_title: "Is the site trusted?",
    overlay_summary_title: "Summary (plain language)",
    overlay_recommended_title: "Recommended action",
    overlay_note_title: "Note",

    // Overlay - details sections
    details_tx_title: "Transaction details",
    details_tech_title: "Technical details",
    details_more_title: "More explanations",

    // Queue
    queue_indicator: "Queue: {pos} of {total}",

    // Action titles
    action_CONNECT_title: "Connect wallet",
    action_REQUEST_PERMISSIONS_title: "Request permissions",
    action_SWITCH_CHAIN_title: "Switch network",
    action_ADD_CHAIN_title: "Add network",
    action_SIGN_MESSAGE_title: "Sign message",
    action_SIGN_TYPED_DATA_title: "Sign typed data",
    action_SEND_TX_title: "Send transaction",
    action_SEND_TX_contract_title: "Contract interaction",
    action_SEND_TX_eth_title: "Send ETH",
    action_WATCH_ASSET_title: "Add token/asset",
    action_SOLANA_title: "Solana signature/transaction",
    action_UNKNOWN_title: "Request",

    // Summary bullets
    summary_CONNECT_1: "The site wants to see your addresses and current network.",
    summary_CONNECT_2: "It may request signatures/transactions later.",
    summary_CONNECT_3: "Only connect if you trust the site.",
    summary_REQUEST_PERMISSIONS_1: "The site is requesting additional wallet permissions.",
    summary_REQUEST_PERMISSIONS_2: "Review permissions in your wallet before accepting.",
    summary_SWITCH_CHAIN_1: "The site wants to switch your wallet network (chain).",
    summary_SWITCH_CHAIN_2: "Switching networks usually costs no gas.",
    explain_connect_title: "Connect wallet",
    explain_connect_short: "Wallet login (share your public address)",
    explain_connect_why: "This lets the site show your account and ask for signatures/approvals/transactions later.",
    explain_sign_title: "Sign a message",
    explain_sign_short: "No gas, but signatures can authorize actions",
    explain_sign_why: "Sites use signatures to log in, verify ownership, or authorize off-chain actions.",
    explain_typed_title: "Sign structured data",
    explain_typed_short: "Typed-data signatures can include permits/authorizations",
    explain_typed_why: "Typed-data is often used for permits (token approvals without a separate on-chain approve).",
    explain_tx_title: "Send a transaction",
    explain_tx_short: "On-chain action (gas fees may apply)",
    explain_tx_why: "This will create an on-chain transaction if you approve it in your wallet.",
    explain_switch_title: "Switch network",
    explain_switch_why: "Some sites require a specific network to function.",
    explain_addchain_title: "Add network",
    explain_addchain_short: "Add a new chain configuration to your wallet",
    explain_add_chain_short: "Add network to wallet",
    add_chain_review_rpc: "Malicious RPC can deceive balances/transactions; verify the source.",
    add_chain_verify_chainid: "Verify chainId and network name before adding.",
    explain_addchain_why: "Wallet may add RPC details for a chain requested by the site.",
    explain_watchasset_title: "Watch asset",
    explain_watchasset_short: "Add a token/asset to your wallet UI",
    explain_watch_asset_short: "Add token/asset to wallet",
    watch_asset_no_spend_but_risk: "Adding a token does not spend funds, but scam tokens exist; verify the contract.",
    watch_asset_verify_contract: "Verify the contract address on a trusted explorer.",
    explain_watchasset_why: "This does not spend funds, but confirm the token details are correct.",
    explain_generic_title: "Wallet request",
    explain_generic_short: "A site is requesting a wallet action",
    explain_generic_why: "Review details in your wallet and confirm the site URL.",
    human_connect_whatIs: "Connects your wallet address to this site (like logging in).",
    human_connect_sees_1: "Your public address (and account selection)",
    human_connect_sees_2: "Your network/chain selection",
    human_connect_sees_3: "Public on-chain activity (tokens/NFTs are public data)",
    human_connect_not_1: "It does NOT reveal your seed phrase or wallet password",
    human_connect_not_2: "It does NOT move funds automatically by itself",
    human_connect_why_1: "To show your account and balances in the UI",
    human_connect_why_2: "To let you sign messages (login/verification)",
    human_connect_why_3: "To request approvals/transactions later (with your confirmation)",
    human_connect_risk_1: "Privacy/tracking: it can link your address to this site",
    human_connect_risk_2: "Phishing steps: next prompts may ask for signatures/approvals",
    human_connect_risk_3: "Lookalike domains: fake sites often start with a harmless connect",
    human_connect_safe_1: "Treat connect like sharing an identity: only do it on sites you recognize.",
    human_connect_next_1: "Double-check the domain (spelling, HTTPS, no punycode)",
    human_connect_next_2: "If unsure, cancel and open the site from a trusted bookmark",
    human_connect_reco_suspicious: "Cancel and verify the URL in another way (bookmark/search), then try again.",
    human_connect_reco_ok: "Continue only if you recognize the site and the URL looks right.",
    human_sign_whatIs: "Creates a cryptographic signature. It usually does not cost gas, but it can authorize actions.",
    human_sign_risk_1: "Signing unknown text can approve off-site actions or logins you didn't intend",
    human_sign_risk_2: "Blind signing can hide what you're authorizing",
    human_typed_whatIs: "Signs structured data (typed-data). Often used for permits/authorizations.",
    human_typed_risk_1: "Typed-data may include token permits that behave like approvals",
    human_sign_safe_1: "Prefer wallets that show clear human-readable signing details.",
    human_sign_next_1: "Verify the site URL and read the message/typed-data carefully",
    human_sign_next_2: "If you see vague prompts, cancel and ask the site for context",
    human_sign_reco_suspicious: "Cancel. Suspicious domains + signature prompts are a common phishing pattern.",
    human_sign_reco_ok: "Only continue if you understand what the signature is for and trust the site.",
    human_approve_whatIs: "An approval lets a contract spend your tokens later (up to the approved amount).",
    human_approve_risk_1: "Approvals can be abused if the spender contract is malicious or compromised",
    human_approve_risk_unlimited: "Unlimited approval means it may spend ALL your token balance",
    human_approve_safe_1: "Prefer approving the minimum needed amount whenever possible.",
    human_approve_next_1: "Check the spender address/operator and whether you recognize the dApp",
    human_approve_next_2: "Consider revoking approvals later if you no longer use the site",
    human_approve_reco: "Continue only if you trust the site and the spender makes sense.",
    human_approve_reco_unlimited: "Avoid unlimited approvals unless you strongly trust the site and understand the risk.",
    human_setApprovalForAll_whatIs: "Gives an operator permission to move ALL NFTs in a collection on your behalf.",
    human_setApprovalForAll_risk_1: "This can allow draining NFTs if the operator is malicious or compromised",
    human_setApprovalForAll_safe_1: "Only approve operators you fully recognize (e.g., known marketplaces).",
    human_setApprovalForAll_next_1: "Verify the operator address and confirm the site is the intended marketplace",
    human_setApprovalForAll_reco: "Cancel unless you are on a recognized marketplace and expect this action.",
    human_tx_whatIs: "This will create an on-chain transaction if you approve it in your wallet.",
    human_tx_risk_1: "Transactions can move funds or change permissions depending on the contract call",
    human_tx_safe_1: "Always verify recipient, value, and the contract you're interacting with.",
    human_tx_next_1: "Check the destination (to), value, and decoded action (if available)",
    human_tx_reco_suspicious: "Cancel. Do not send transactions from suspicious domains.",
    human_tx_reco_ok: "Continue only if you intended this action and the details look correct.",
    human_chain_whatIs: "Changes the selected network in your wallet.",
    human_chain_risk_1: "Wrong networks/RPCs can mislead you about assets or transactions",
    human_chain_safe_1: "Only switch/add networks you recognize.",
    human_chain_next_1: "Confirm chain name and chainId in the wallet prompt",
    human_watchasset_whatIs: "Adds a token/asset to your wallet UI for easier viewing.",
    human_watchasset_risk_1: "Fake tokens can impersonate real ones—verify contract address and symbol",
    human_watchasset_safe_1: "Cross-check token details on a trusted explorer (e.g., Etherscan).",
    human_watchasset_next_1: "Verify token contract address and decimals",
    human_watchasset_reco: "Continue only if token details match an official source.",
    human_generic_whatIs: "A site requested a wallet action. Review details carefully.",
    human_generic_risk_1: "Unknown prompts can be part of phishing flows",
    human_generic_safe_1: "If in doubt, cancel and verify the site.",
    human_generic_next_1: "Check the URL and read the wallet prompt details",
    human_generic_reco: "Continue only if you understand and expected this request.",
    human_revoke_link_text: "Revoke permissions later: revoke.cash",
    trustReasonNotHttps: "Not HTTPS (higher risk of spoofing/injection).",
    trustReasonManyHyphens: "Many hyphens in the domain (common in lookalikes).",
    trustReasonSuspiciousKeywords: "Domain contains high-risk keywords (login/verify/secure/...).",
    trustReasonBrandLookalike: "Brand-like wording in domain but not the official domain.",
    trustReasonManySubdomains: "Unusually deep subdomain structure.",
    trustReasonNoHost: "Could not read the site hostname.",
    trustReasonAllowlistedVariant: "Domain matches a trusted pattern.",
    trustReasonUnknown: "No strong signals either way.",
    summary_ADD_CHAIN_1: "The site wants to add a new network to your wallet.",
    summary_ADD_CHAIN_2: "Carefully verify the chainId and network name.",
    summary_SIGN_MESSAGE_1: "You are signing a message (not a transaction).",
    summary_SIGN_MESSAGE_2: "Signatures can be used for logins/terms/permissions.",
    summary_SIGN_TYPED_DATA_1: "You are signing structured data (EIP-712).",
    summary_SIGN_TYPED_DATA_2: "This may authorize spending/orders depending on the content.",
    summary_SIGN_TYPED_DATA_3: "Verify the spender/contract involved.",
    summary_SEND_TX_1: "You are sending an on-chain transaction.",
    summary_SEND_TX_2: "This may move ETH/tokens or interact with a contract.",
    summary_SEND_TX_3: "Verify value, network and destination before confirming.",
    summary_WATCH_ASSET_1: "The site wants to add a token/asset to your wallet.",
    summary_WATCH_ASSET_2: "Verify the token symbol and contract address.",
    summary_SOLANA_1: "Solana signature or transaction. Values will be confirmed in your wallet.",
    summary_UNKNOWN_1: "The site is making an unknown wallet request.",
    summary_UNKNOWN_2: "If you don't recognize it, cancel.",

    // Buttons / friction
    btn_cancel: "Cancel",
    btn_continue: "Continue",
    toast_request_expired: "Request expired. Please retry the action on the site.",
    simulation_tx_will_fail: "THIS TRANSACTION WILL FAIL",
    btn_close: "Close",
    btn_proceed_anyway: "Proceed anyway",
    override_checkbox: "I understand the risk and want to proceed",
    override_countdown: "({s}s)",

    tip_revoke: "Revoke permissions later: revoke.cash",
    cost_summary_title: "Cost summary",
    costs_title: "Costs and impact",
    impact_title: "Impact",
    permission_for: "Permission for",
    addr_marked_public: "Flagged in public database",
    risk_title: "Risk and why",
    what_to_do_now: "What to do now",
    site_label: "Site",
    network_label: "Network",
    severity_BLOCKED: "BLOCKED",
    severity_HIGH: "HIGH",
    severity_WARN: "WARNING",
    severity_LOW: "LOW",
    cost_you_send: "You send",
    cost_fee_only: "fee only",
    cost_value: "Value (ETH)",
    cost_fee: "Estimated fee (ETH)",
    cost_total: "Estimated total (ETH)",
    cost_fee_unknown: "A network fee will be charged (confirm in wallet)",
    network_switch_title: "Network switch",
    network_current: "Current network",
    network_requested: "Requested network",
    trusted_domain_ref_title: "Trusted domains (reference)",
    tx_cost_sending: "You are sending {value} ETH + network fee",
    tx_cost_gas_only: "Even with 0 ETH, you will pay a network fee (gas)",
    gas_calculating: "calculating…",

    tx_destination: "Destination",
    token_verified_uniswap: "Token Verified (Uniswap List)",
    token_unknown_unverified: "Token Unknown (Not Verified)",
    tx_contract_method: "Contract/method",
    tx_max_gas_fee: "Max gas fee (ETH)",
    tx_max_total: "Max total (ETH)",
    tx_fee_estimated_by_wallet: "The wallet will estimate the fee in the next step.",

    network_target: "Target network",
    switch_no_gas: "Switching networks usually costs NO gas.",
    switch_next_step_gas: "The next step (purchase/transaction) will have a network fee.",
    switch_note_inline: "Switching networks usually costs NO gas. The next step (purchase/transaction) will have a network fee.",
    sendtx_reco: "Confirm in your wallet only if the details (value, network and contract) are correct.",

    // Risk/trust labels
    risk_LOW: "Low",
    risk_WARN: "Warning",
    risk_HIGH: "High",
    recommend_ALLOW: "Allow",
    recommend_WARN: "Warn",
    recommend_HIGH: "High risk",
    recommend_BLOCK: "Block",
    trust_unknown: "Unknown",
    trust_suspicious: "Suspicious",
    trust_likelyOfficial: "Known domain (reference list)",
    trust_domainNotRecognized: "Domain not recognized",

    // Phishing hard-block
    phishing_hard_block: "Domain is in a phishing blacklist. Blocked.",

    // Toasts
    toast_extension_updated: "Extension updated — reload the tab.",
    toast_cannot_analyze: "Couldn't analyze. Reload the tab.",

    // Options page
    optionsTitle: "Crypto Wallet SignGuard — Settings",
    optionsSubtitle: "Control when SignGuard should warn and block.",
    dashboardLink: "Dashboard",
    onboardingTitle: "How to use",
    onboardingHowTo: "The extension intercepts sensitive requests (connect, sign, transaction) from injected wallets (window.ethereum / window.solana). When detected, it shows an overlay for you to review before the wallet opens.",
    onboardingWhatItDoes: "Does: warns before connecting, signing, or sending; checks domain against phishing lists; shows transaction intent (swap, NFT, approval).",
    onboardingWhatItDoesNot: "Does not: protect QR/WalletConnect connections; guarantee contracts are safe; replace manual verification.",
    onboardingLinkRevoke: "revoke.cash — revoke permissions",
    onboardingLinkEtherscan: "Etherscan — explore transactions",
    exportDebugRequiresDebugMode: "Enable Debug Mode first to export events.",
    securityModeLabel: "Security mode",
    securityModeDesc: "Strict blocks more; Balanced warns; Relaxed reduces friction; Off disables blocking.",
    modeStrict: "Strict",
    modeBalanced: "Balanced",
    modeRelaxed: "Relaxed",
    modeOff: "Off",
    strictBlockApprovalsUnlimitedLabel: "Strict: block unlimited approve",
    strictBlockApprovalsUnlimitedDesc: "Blocks ERC20 unlimited approvals (MAX_UINT256).",
    strictBlockSetApprovalForAllLabel: "Strict: block setApprovalForAll",
    strictBlockSetApprovalForAllDesc: "Blocks permission to move all NFTs.",
    strictBlockPermitLikeLabel: "Strict: block unlimited Permit",
    strictBlockPermitLikeDesc: "Blocks Permit (EIP-2612) unlimited signatures.",
    assetEnrichmentEnabledLabel: "Asset enrichment",
    assetEnrichmentEnabledDesc: "Fetches token symbol/name via eth_call.",
    addressIntelEnabledLabel: "Address threat intel",
    addressIntelEnabledDesc: "Checks spender/operator/to against blacklist.",
    riskWarningsLabel: "Risk warnings",
    riskWarningsDesc: "Shows warnings and recommendations before opening your wallet.",
    connectOverlayLabel: "Overlay on connect",
    connectOverlayDesc: "Also show the overlay for connect/permissions requests.",
    blockHighRiskLabel: "Block high risk",
    blockHighRiskDesc: "Automatically blocks high-risk actions.",
    requireTypedOverrideLabel: "Require override for typed data (high risk)",
    requireTypedOverrideDesc: "For high-risk EIP-712 signatures, requires extra confirmation.",
    allowOverrideOnPhishingLabel: "Allow override on phishing (NOT recommended)",
    allowOverrideOnPhishingDesc: "If disabled (default), phishing blacklist matches are blocked with no option to proceed.",
    mode_off_reason: "OFF mode: no blocking.",
    address_flagged_reason: "Flagged address/contract: {label} ({category})",
    addr_sanctioned_block: "Address is on a sanctions list.",
    addr_scam_reported_warn: "Address marked as suspected/reported.",
    addr_phishing_reported_warn: "Address marked as suspected/reported.",
    addr_malicious_contract_warn: "Contract marked as malicious.",
    asset_info_reason: "Asset: {sym} ({kind})",
    reason_permission_tokens: "Permission to spend tokens",
    reason_permission_all_nfts: "Permission to move ALL NFTs",
    reason_transfer_tokens: "Token/NFT transfer",
    domainChecksLabel: "Domain checks",
    domainChecksDesc: "Warns about suspicious domain patterns when not on your allowlist.",
    allowlistLabel: "Allowlist (trusted domains)",
    allowlistDesc: "One domain per line. Example: opensea.io",
    vaultTitle: "SignGuard Vault",
    vaultDesc: "Contracts in this list can never be transacted without explicit unlock in options.",
    vaultAddLabel: "Add contract to vault",
    vaultAddButton: "Add to Vault",
    vaultListLabel: "Locked contracts",
    vaultListEmpty: "No contracts in vault.",
    vaultRemove: "Remove",
    vaultInvalidAddress: "Invalid address. Use 0x and 40 hex characters.",
    vaultAlreadyAdded: "This contract is already in the vault.",
    vaultBlockedMessage: "SignGuard: Asset Locked in Vault. Unlock in options to continue.",
    addSuggested: "Add suggested",
    save: "Save",
    saved: "Saved",

    intelTitle: "Threat Intel",
    intelSubtitle: "Domain lists (pluggable sources) used in analysis.",
    intelTrustedCountLabel: "Trusted domains",
    intelBlockedCountLabel: "Blocked domains",
    intelBlockedAddressCountLabel: "Blocked addresses",
    intelUpdatedAtLabel: "Last update",
    intelUpdateNow: "Update now",
    enableIntelLabel: "Use Threat Intel",
    enableIntelDesc: "Uses trusted/blocked domain lists in analysis.",
    customTrustedDomainsLabel: "Trusted domains (custom list)",
    customTrustedDomainsDesc: "One per line. Example: mysite.io",
    customBlockedDomainsLabel: "Blocked domains (custom list)",
    customBlockedDomainsDesc: "One per line. Always blocked.",
    exportListsLabel: "Export lists",

    privacyLimitsTitle: "Privacy & Limitations",
    privacyLimitsLine1: "The extension does not access your seed phrase and has no custody.",
    privacyLimitsLine2: "It analyzes domains and transaction data displayed by the browser for alerts. No 100% guarantee.",
    privacyLimitsLine3: "Threat intel may be updated from public sources (optional).",
    cloudIntelOptInLabel: "Allow external checks",
    cloudIntelOptInDesc: "More protection; may send domain/addresses for validation (prepared for P1).",
    showUsdLabel: "Show USD values",
    showUsdDesc: "Shows an approximate USD value next to ETH amounts.",
    tabSettings: "Settings",
    tabHistory: "History",
    tabPlan: "Plan",
    historySubtitle: "Recent overlay decisions.",
    historyExport: "Export JSON",
    historyClear: "Clear",
    historyEmpty: "No entries.",
    decision_allow: "Allowed",
    decision_block: "Blocked",
    planSubtitle: "Manage your plan and license.",
    planCurrent: "Current plan",
    planLicenseKey: "License key",
    planActivate: "Activate",
    planGoPro: "Subscribe PRO",
    // Options: Safety notes + debug
    safetyNotesTitle: "Limitations & security",
    safetyNotesLine1: "This extension monitors requests from injected wallets (window.ethereum / window.solana).",
    safetyNotesLine2: "Connections via QR/WalletConnect may not be intercepted. Always verify in your wallet.",
    safetyNotesLinkRevoke: "revoke.cash",
    safetyNotesLinkEtherscan: "etherscan.io",
    debugModeLabel: "Debug mode",
    debugModeDesc: "Stores the last 20 events (without large payloads) for support.",
    exportDebug: "Export",

    // Overlay: intent + permission + copy
    looks_like: "Looks like:",
    intent_NFT_PURCHASE: "NFT purchase",
    intent_SWAP: "Swap",
    intent_APPROVAL: "Permission",
    intent_SEND: "Send",
    intent_UNKNOWN: "Unknown",
    intent_ETH_TRANSFER: "ETH transfer",
    intent_TOKEN_TRANSFER: "Token transfer",
    intent_NFT_TRANSFER: "NFT transfer",
    intent_CONTRACT_INTERACTION: "Contract interaction",
    intent_SWITCH_CHAIN: "Network switch",
    intent_ADD_CHAIN: "Add network",
    intent_WATCH_ASSET: "Add token",
    intent_SOLANA: "Solana signature/transaction",
    intent_SIGNATURE: "Signature",
    intent_TYPED_DATA: "Typed data",
    wallet_label: "Wallet",
    wallet_detecting: "Detecting…",
    wallet_evm_generic: "EVM Wallet",
    trust_disclaimer: "Reference list ≠ guarantee. Scammers may use similar domains.",
    hint_wallet_popup: "Your wallet should open now. If it doesn't, click the wallet icon and check for pending requests.",
    add_chain_network_label: "Network to add",
    add_chain_rpc_label: "RPC",
    watch_asset_token_label: "Token to add",
    modeLabel: "Mode:",
    popupPauseProtection: "PAUSE PROTECTION",
    popupStatusProtected: "Protected",
    popupStatusPaused: "Paused",
    info_unavailable: "Information unavailable.",
    explain_switch_short: "The site is requesting a network (chain) switch in your wallet.",
    human_chain_reco: "Continue only if you expected a network switch and it looks correct.",
    trustReasonAllowlisted: "Domain is present in a trusted seed list.",
    trustReasonPhishingBlacklist: "Domain is in a phishing blacklist (reference list).",
    fee_unknown_wallet_will_estimate: "Fee: will be displayed by wallet",
    label_you_send: "You send",
    label_fee_likely: "Estimated fee (likely)",
    label_fee_max: "Max fee (worst case)",
    label_total_likely: "Total likely",
    label_total_max: "Total max",
    fee_gt_value: "The max fee is HIGHER than the value being sent. Make sure this is expected.",
    check_wallet_network_fee: "You haven't seen the fee yet. Check the wallet 'Network fee' before confirming.",
    label_max_fee: "Max fee (ETH)",
    label_max_total: "Max total (ETH)",
    switch_summary_no_gas: "Switching networks usually has no gas fee, but it changes which assets you see.",
    permission_title: "Permission",
    permission_token_contract: "Contract",
    permission_spender: "Spender",
    permission_operator: "Operator",
    permission_unlimited: "Unlimited",
    approval_unlimited_detected: "Unlimited approval detected",
    permit_signature_detected: "Permit-style signature detected (may authorize token spending)",
    token_transfer_detected: "Token transfer detected",
    nft_transfer_detected: "NFT transfer detected",
    transfer_token_title: "Token transfer",
    transfer_nft_title: "NFT transfer",
    transfer_amount: "Amount",
    transfer_token_id: "Token ID",
    yes: "Yes",
    no: "No",
    copy: "Copy",
    chainChangeTitle: "Network switch/add request",
    watchAssetTitle: "Add asset request",

    domainPunycodeReason: "Domain uses punycode (xn--); verify the URL.",
    domainDoubleDashReason: "Domain contains double hyphen (suspicious).",
    domainNumberPatternReason: "Domain with many numbers (common in phishing).",
    domainLookalikeReason: "Possible lookalike of official domain {legit}.",
    suspiciousWebsitePatterns: "Suspicious website patterns.",
    page_risk_suspicious_banner: "⚠️ SignGuard: Suspicious Site Detected",
    connectTitle: "Connect wallet",
    connectReason: "The site wants to connect to your wallet.",
    walletRequestPermissionsTitle: "Request permissions",
    walletRequestPermissionsReason: "The site wants additional wallet permissions.",
    typedDataWarnReason: "Structured data signature (EIP-712); may authorize actions.",
    signatureRequest: "Signature request",
    rawSignWarnReason: "Raw message signature; may authorize off-chain actions.",
    tokenApproval: "Token approval",
    unlimitedApprovalReason: "Unlimited approval detected (MAX_UINT256).",
    unlimitedApprovalDetected: "Unlimited approval detected",
    nftOperatorApprovalReason: "Permission to move ALL NFTs in the collection.",
    nftOperatorApproval: "NFT operator approval",
    txPreview: "Transaction preview",
    txWarnReason: "On-chain transaction; verify value, destination and network.",
    unknownMethodReason: "Unknown wallet method.",
    warningsDisabledReason: "Warnings disabled in settings.",
    analyzing: "Analyzing…",
    analyzing_subtitle: "Site • Method",
    analyzing_hint: "Validating domain and estimating impact",
    fallback_partial_check: "No full verification right now — review the details below before proceeding.",
    fallback_partial_verification: "Partial verification now — review the details below before proceeding.",
    loading_base: "Loading base…",
    analyzerUnavailableTitle: "Analyzer unavailable",
    analysis_unavailable: "Analysis unavailable — verify in your wallet before continuing.",
    dados_parciais_title: "Partial data — confirm in wallet",
    dados_parciais_subtitle: "Showing what we could analyze. Verify details in your wallet before continuing.",
    risk_low: "Low",
    risk_warn: "Warning",
    risk_high: "High",
    risk_block: "Blocked",
    trustReasonAllowlistedMatched: "Domain in allowlist: {matched}.",
    list_empty_domains: "List empty. Open options to add trusted domains.",
    btn_open_options: "Open options",
    default_human_switch_what: "Switches the active network in your wallet (e.g. Ethereum → another network).",
    default_human_switch_risk: "You may sign/transact on the wrong network if the switch is unexpected.",
    default_human_switch_safe: "Confirm the requested network and that the site is correct.",
    default_human_switch_next: "If correct, approve in the wallet. If something looks wrong, cancel.",
    default_human_contract_what: "Sends a transaction to a contract (action within the dApp).",
    default_human_contract_risk: "Actual cost may vary and the action may move assets/tokens via the contract.",
    default_human_contract_safe: "Check destination (to), network, value and fee (Network fee) in the wallet.",
    default_human_contract_next: "If details match, proceed. Otherwise, cancel.",
    default_human_eth_what: "Sends ETH directly to an address.",
    default_human_eth_risk: "Transfers are irreversible if the destination is wrong.",
    default_human_eth_safe: "Verify the address and amount. Be wary of links/shorteners.",
    default_human_eth_next: "Only confirm if you recognize the recipient.",
    default_human_typed_what: "Off-chain signature (EIP-712). May authorize actions without paying gas.",
    default_human_typed_risk: "May grant permissions/authorizations (e.g. permit/approval) depending on content.",
    default_human_typed_safe: "Review what is being authorized (spender/operator) and the domain/contract.",
    default_human_typed_next: "If unsure, cancel and verify on the dApp’s official site.",
    default_human_generic_what: "Action requested by the dApp.",
    default_human_generic_risk: "If something doesn’t make sense, cancel.",
    default_human_generic_safe: "Confirm domain, network and details in the wallet.",
    default_human_generic_next: "Proceed only if everything looks correct.",
    verdict_ok: "OK",
    verdict_warn: "Warning",
    verdict_high: "High risk",
    verdict_block: "Blocked",
    coverage_label: "Coverage",
    coverage_limited: "limited coverage",
    trusted_domain_ref_empty: "Reference list has not loaded yet.",
    trusted_domain_ref_loading: "Loading reference list…",
    trusted_domain_ref_refresh: "Update lists",
    trusted_domain_ref_view_more: "View more",
    trusted_domains_loading: "Loading reference list…",
    trusted_domains_more: "+{n}",
    trusted_domains_search_placeholder: "Filter domains…",
    trusted_domains_update_now: "Update now",
    trusted_domains_auto_update: "Updates automatically in options",
    banner_ok_no_known_threats: "OK: no known scam/threat signals detected.",
    banner_block_known_threat: "Blocked: known threat detected.",
    banner_local_verification: "Caution: local verification (cache). Review the details below before proceeding.",
    banner_basic_verification: "Caution: basic verification. Review the details carefully before proceeding.",
    updated_x_hours: "Base updated {n} hour(s) ago",
    updated_x_days: "Base updated {n} day(s) ago",
    tip_check_wallet_details: "Verify amount, network and fee in your wallet.",
    no_alerts_known: "No known alerts were detected for this context.",
    still_review_wallet: "Still, review in your wallet (value, network, destination and fee).",
    site_status_known: "known reference",
    site_status_not_in_list: "Site is not on the reference list",
    destination_contract: "Contract",
    destination_wallet: "Wallet",
  }
};

function format(template: string, params?: Record<string, string | number>) {
  if (!params) return template;
  return template.replace(/\{(\w+)\}/g, (_m, k) => (k in params ? String(params[k]) : `{${k}}`));
}

export function t(key: string, params?: Record<string, string | number>): string {
  const loc = detectLocale();
  const v = dict[loc]?.[key] || dict.en[key] || key;
  const rendered = format(v, params);
  if (rendered !== key) return rendered;

  // Fallback (best-effort) for legacy chrome.i18n keys, if any.
  try {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    const c: any = (globalThis as any).chrome;
    const msg = c?.i18n?.getMessage?.(key);
    if (msg) return format(msg, params);
  } catch {}

  return rendered;
}

export function safeT(key: string, params?: Record<string, string | number>): string {
  const out = t(key, params);
  if (out && out !== key) return out;
  // Only treat as missing key when it looks like an i18n key (identifier)
  if (/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(key)) {
    return detectLocale() === "pt" ? "Texto indisponível" : "Text unavailable";
  }
  return key; // Already human-readable text, not a key
}

/** Check if key exists in dict or chrome.i18n. */
export function tHasKey(key: string): boolean {
  if (!key || typeof key !== "string") return false;
  const loc = detectLocale();
  if (dict[loc]?.[key]) return true;
  if (dict.en?.[key]) return true;
  try {
    const c: any = (globalThis as any).chrome;
    if (c?.i18n?.getMessage?.(key)) return true;
  } catch {}
  return false;
}

/** Resolve key from dict or chrome.i18n; NEVER return the raw key. Returns "" if missing. */
export function tKey(key: string, params?: Record<string, string | number>): string {
  const loc = detectLocale();
  const v = dict[loc]?.[key] || dict.en[key];
  if (v) return format(v, params || {});
  try {
    const c: any = (globalThis as any).chrome;
    const msg = c?.i18n?.getMessage?.(key);
    if (msg) return format(msg, params || {});
  } catch {}
  return "";
}

const KEY_PATTERN = /^(explain_|human_|trustReason|label_|fee_|summary_|action_|intent_|permission_|reason_|add_chain_|watch_asset_|switch_|sendtx_|phishing_|recommend_|risk_|trust_|btn_|cost_|tx_|network_|more_|tech_|details_|overlay_|queue_|modeLabel|wallet_label|looks_like|info_unavailable|gas_calculating|check_wallet|dash|onboarding|options|exportDebug)/;

/** If maybeKeyOrText looks like an i18n key, resolve it; else return literal. Never show raw keys. */
export function renderText(maybeKeyOrText: string, params?: Record<string, any>): string {
  const s = String(maybeKeyOrText || "").trim();
  if (!s) return s;
  const looksLikeKey = KEY_PATTERN.test(s) || /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(s);
  if (looksLikeKey) {
    const resolved = tKey(s, params as Record<string, string | number>);
    if (resolved) return resolved;
    return detectLocale() === "pt" ? "Texto indisponível" : "Text unavailable";
  }
  return s;
}

